var accMandate=[];function newCustomerOpenATab(b,a){openATab(b,a+"&custID="+$("#custID").val())}function validateCustomerForm(j,n,o,k,e,m,b,f,a,h,c,d,g,l){if(j===""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#title").css("border-color","red");$("#title").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Title</b>!",callback:function(){}});return false}else{if(n.trim()==""||n=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#firstName").css("border-color","red");$("#firstName").css("border-width","2px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter <b>First Name</b>!",callback:function(){}});return false}else{if(o.trim()==""||o=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#surName").css("border-color","red");$("#surName").css("border-width","2px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter <b>Surname</b>!",callback:function(){}});return false}else{if(k===""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#gender").css("border-color","red");$("#gender").css("border-width","2px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Gender</b>",callback:function(){}});return false}else{if(e==""||e=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#maritalStatus").css("border-color","red");$("#maritalStatus").css("border-width","2px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Marital Status</b>!",callback:function(){}});return false}else{if(m==""||m=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#dob").css("border-color","red");$("#dob").css("border-width","2px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please choose <b>Date of Birth</b>!",callback:function(){}});return false}else{if(b==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#nationality").css("border-color","red");$("#nationality").css("border-width","2px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Nationality</b>!",callback:function(){}});return false}else{if((f.trim()==""||f=="undefined")&&(a.trim()==""||a=="undefined")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#mobileNo").css("border-color","red");$("#mobileNo").css("border-width","2px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter at lease one <b>Contact Number</b>!",callback:function(){}});return false}else{if(h.trim()==""||h=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#residentialAddress").css("border-color","red");$("#residentialAddress").css("border-width","2px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a <b>Residential address</b>!",callback:function(){}});return false}else{if(c==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#relation").css("border-color","red");$("#relation").css("border-width","2px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Person Type</b>!",callback:function(){}});return false}else{if(d==""||d=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#startDate").css("border-color","red");$("#startDate").css("border-width","2px");$("#relation").css("border-color","#ccc");$("#relation").css("border-width","1px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select the <b>Effective Start Date</b> of this Customer setup!",callback:function(){}});return false}else{if(g.trim()==""||g=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#lnkdFirmName").css("border-color","red");$("#lnkdFirmName").css("border-width","2px");$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px");$("#relation").css("border-color","#ccc");$("#relation").css("border-width","1px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide the <b>Workplace</b> of this Customer!",callback:function(){}});return false}else{if(l.trim()==""||l=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#lnkdFirmLoc").css("border-color","red");$("#lnkdFirmLoc").css("border-width","2px");$("#lnkdFirmName").css("border-color","#ccc");$("#lnkdFirmName").css("border-width","1px");$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px");$("#relation").css("border-color","#ccc");$("#relation").css("border-width","1px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide the <b>Site/Branch</b> of tje Workplace!",callback:function(){}});return false}else{$("#lnkdFirmLoc").css("border-color","#ccc");$("#lnkdFirmLoc").css("border-width","1px");$("#lnkdFirmName").css("border-color","#ccc");$("#lnkdFirmName").css("border-width","1px");$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px");$("#relation").css("border-color","#ccc");$("#relation").css("border-width","1px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");return true}}}}}}}}}}}}}}function saveBasicData(d,f,h,c){var g;var j;var a="Saving";if(c>0){a="Submitting for AUTHORIZATION"}var b=$(".nav-tabs .active").text();var e=1;if(b.indexOf("Additional Data")>=0){e=2}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var n;var ad=typeof $("#profileID").val()==="undefined"?-1:$("#profileID").val();var af=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var ab=typeof $("#idNo").val()==="undefined"?"":$("#idNo").val();var I=typeof $("#title").val()==="undefined"?"":$("#title").val();var Y=typeof $("#firstName").val()==="undefined"?"":$("#firstName").val();var aM=typeof $("#surName").val()==="undefined"?"":$("#surName").val();var ax=typeof $("#otherNames").val()==="undefined"?"":$("#otherNames").val();var aw=typeof $("#gender").val()==="undefined"?"":$("#gender").val();var ai=typeof $("#maritalStatus").val()==="undefined"?"":$("#maritalStatus").val();var aa=typeof $("#dob").val()==="undefined"?"":$("#dob").val();var aK=typeof $("#pob").val()==="undefined"?"":$("#pob").val();var J=typeof $("#nationality").val()==="undefined"?"":$("#nationality").val();var ag=typeof $("#homeTown").val()==="undefined"?"":$("#homeTown").val();var s=typeof $("#religion").val()==="undefined"?"":$("#religion").val();var aj=typeof $("#lnkdFirmName").val()==="undefined"?"":$("#lnkdFirmName").val();var aF=typeof $("#lnkdFirmLoc").val()==="undefined"?"":$("#lnkdFirmLoc").val();var H=typeof $("#email").val()==="undefined"?"":$("#email").val();var G=typeof $("#telNo").val()==="undefined"?"":$("#telNo").val();var aN=typeof $("#mobileNo").val()==="undefined"?"":$("#mobileNo").val();var Z=typeof $("#faxNo").val()==="undefined"?"":$("#faxNo").val();var O=typeof $("#postalAddress").val()==="undefined"?"":$("#postalAddress").val();var ae=typeof $("#residentialAddress").val()==="undefined"?"":$("#residentialAddress").val();var aH=typeof $("#relation").val()==="undefined"?"":$("#relation").val();var k=typeof $("#bnkBranchID").val()==="undefined"?"":$("#bnkBranchID").val();var aL=typeof $("#startDate").val()==="undefined"?"":$("#startDate").val();var ak=typeof $("#endDate").val()==="undefined"?"":$("#endDate").val();var X=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var R=validateCustomerForm(I,Y,aM,aw,ai,aa,J,aN,G,ae,aH,aL,aj,aF);if(!R){return false}if(c>0&&$("#nationalIDTblEDT > tbody > tr").length<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'><i>Please provide at least One(1) National ID for Customer</i></span>",callback:function(){}});return false}g=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">'+a+". Please Wait...</span></div>"});g.find(".modal-content").css({"margin-top":function(){var aP=$(window).height();var aO=$(".modal-dialog").height();var aQ=aP/2;return aQ+"px"}});var S="Personal Customer";var F=typeof $("#addtnlCstmrDataCol1").val()==="undefined"?"":$("#addtnlCstmrDataCol1").val();var E=typeof $("#addtnlCstmrDataCol2").val()==="undefined"?"":$("#addtnlCstmrDataCol2").val();var D=typeof $("#addtnlCstmrDataCol3").val()==="undefined"?"":$("#addtnlCstmrDataCol3").val();var C=typeof $("#addtnlCstmrDataCol4").val()==="undefined"?"":$("#addtnlCstmrDataCol4").val();var B=typeof $("#addtnlCstmrDataCol5").val()==="undefined"?"":$("#addtnlCstmrDataCol5").val();var A=typeof $("#addtnlCstmrDataCol6").val()==="undefined"?"":$("#addtnlCstmrDataCol6").val();var z=typeof $("#addtnlCstmrDataCol7").val()==="undefined"?"":$("#addtnlCstmrDataCol7").val();var y=typeof $("#addtnlCstmrDataCol8").val()==="undefined"?"":$("#addtnlCstmrDataCol8").val();var x=typeof $("#addtnlCstmrDataCol9").val()==="undefined"?"":$("#addtnlCstmrDataCol9").val();var W=typeof $("#addtnlCstmrDataCol10").val()==="undefined"?"":$("#addtnlCstmrDataCol10").val();var V=typeof $("#addtnlCstmrDataCol11").val()==="undefined"?"":$("#addtnlCstmrDataCol11").val();var U=typeof $("#addtnlCstmrDataCol12").val()==="undefined"?"":$("#addtnlCstmrDataCol12").val();var T=typeof $("#addtnlCstmrDataCol13").val()==="undefined"?"":$("#addtnlCstmrDataCol13").val();var Q=typeof $("#addtnlCstmrDataCol14").val()==="undefined"?"":$("#addtnlCstmrDataCol14").val();var P=typeof $("#addtnlCstmrDataCol15").val()==="undefined"?"":$("#addtnlCstmrDataCol15").val();var N=typeof $("#addtnlCstmrDataCol16").val()==="undefined"?"":$("#addtnlCstmrDataCol16").val();var M=typeof $("#addtnlCstmrDataCol17").val()==="undefined"?"":$("#addtnlCstmrDataCol17").val();var L=typeof $("#addtnlCstmrDataCol18").val()==="undefined"?"":$("#addtnlCstmrDataCol18").val();var K=typeof $("#addtnlCstmrDataCol19").val()==="undefined"?"":$("#addtnlCstmrDataCol19").val();var w=typeof $("#addtnlCstmrDataCol20").val()==="undefined"?"":$("#addtnlCstmrDataCol20").val();var v=typeof $("#addtnlCstmrDataCol21").val()==="undefined"?"":$("#addtnlCstmrDataCol21").val();var u=typeof $("#addtnlCstmrDataCol22").val()==="undefined"?"":$("#addtnlCstmrDataCol22").val();var t=typeof $("#addtnlCstmrDataCol23").val()==="undefined"?"":$("#addtnlCstmrDataCol23").val();var r=typeof $("#addtnlCstmrDataCol24").val()==="undefined"?"":$("#addtnlCstmrDataCol24").val();var q=typeof $("#addtnlCstmrDataCol25").val()==="undefined"?"":$("#addtnlCstmrDataCol25").val();var p=typeof $("#addtnlCstmrDataCol26").val()==="undefined"?"":$("#addtnlCstmrDataCol26").val();var o=typeof $("#addtnlCstmrDataCol27").val()==="undefined"?"":$("#addtnlCstmrDataCol27").val();var m=typeof $("#addtnlCstmrDataCol28").val()==="undefined"?"":$("#addtnlCstmrDataCol28").val();var l=typeof $("#addtnlCstmrDataCol29").val()==="undefined"?"":$("#addtnlCstmrDataCol29").val();var aJ=typeof $("#addtnlCstmrDataCol30").val()==="undefined"?"":$("#addtnlCstmrDataCol30").val();var aI=typeof $("#addtnlCstmrDataCol31").val()==="undefined"?"":$("#addtnlCstmrDataCol31").val();var aG=typeof $("#addtnlCstmrDataCol32").val()==="undefined"?"":$("#addtnlCstmrDataCol32").val();var aE=typeof $("#addtnlCstmrDataCol33").val()==="undefined"?"":$("#addtnlCstmrDataCol33").val();var aD=typeof $("#addtnlCstmrDataCol34").val()==="undefined"?"":$("#addtnlCstmrDataCol34").val();var aC=typeof $("#addtnlCstmrDataCol35").val()==="undefined"?"":$("#addtnlCstmrDataCol35").val();var aB=typeof $("#addtnlCstmrDataCol36").val()==="undefined"?"":$("#addtnlCstmrDataCol36").val();var aA=typeof $("#addtnlCstmrDataCol37").val()==="undefined"?"":$("#addtnlCstmrDataCol37").val();var az=typeof $("#addtnlCstmrDataCol38").val()==="undefined"?"":$("#addtnlCstmrDataCol38").val();var ay=typeof $("#addtnlCstmrDataCol39").val()==="undefined"?"":$("#addtnlCstmrDataCol39").val();var av=typeof $("#addtnlCstmrDataCol40").val()==="undefined"?"":$("#addtnlCstmrDataCol40").val();var au=typeof $("#addtnlCstmrDataCol41").val()==="undefined"?"":$("#addtnlCstmrDataCol41").val();var at=typeof $("#addtnlCstmrDataCol42").val()==="undefined"?"":$("#addtnlCstmrDataCol42").val();var ar=typeof $("#addtnlCstmrDataCol43").val()==="undefined"?"":$("#addtnlCstmrDataCol43").val();var aq=typeof $("#addtnlCstmrDataCol44").val()==="undefined"?"":$("#addtnlCstmrDataCol44").val();var ap=typeof $("#addtnlCstmrDataCol45").val()==="undefined"?"":$("#addtnlCstmrDataCol45").val();var ao=typeof $("#addtnlCstmrDataCol46").val()==="undefined"?"":$("#addtnlCstmrDataCol46").val();var an=typeof $("#addtnlCstmrDataCol47").val()==="undefined"?"":$("#addtnlCstmrDataCol47").val();var am=typeof $("#addtnlCstmrDataCol48").val()==="undefined"?"":$("#addtnlCstmrDataCol48").val();var al=typeof $("#addtnlCstmrDataCol49").val()==="undefined"?"":$("#addtnlCstmrDataCol49").val();var ah=typeof $("#addtnlCstmrDataCol50").val()==="undefined"?"":$("#addtnlCstmrDataCol50").val();var ac=new FormData();ac.append("custPicture",$("#custPicture")[0].files[0]);ac.append("signPicture",$("#signPicture")[0].files[0]);ac.append("grp",17);ac.append("typ",1);ac.append("q","UPDATE");ac.append("pg",d);ac.append("subPgNo",f);ac.append("vtyp",h);ac.append("profileID",ad);ac.append("custID",af);ac.append("idNo",ab);ac.append("title",I);ac.append("firstName",Y);ac.append("surName",aM);ac.append("otherNames",ax);ac.append("gender",aw);ac.append("maritalStatus",ai);ac.append("dob",aa);ac.append("pob",aK);ac.append("nationality",J);ac.append("homeTown",ag);ac.append("religion",s);ac.append("lnkdFirmName",aj);ac.append("lnkdFirmLoc",aF);ac.append("email",H);ac.append("telNo",G);ac.append("mobileNo",aN);ac.append("faxNo",Z);ac.append("postalAddress",O);ac.append("residentialAddress",ae);ac.append("relation",aH);ac.append("bnkBranchID",k);ac.append("startDate",aL);ac.append("endDate",ak);ac.append("srcType",S);ac.append("shdSbmt",c);ac.append("rvsnTtl",X);ac.append("addtnlCstmrDataCol1",F);ac.append("addtnlCstmrDataCol2",E);ac.append("addtnlCstmrDataCol3",D);ac.append("addtnlCstmrDataCol4",C);ac.append("addtnlCstmrDataCol5",B);ac.append("addtnlCstmrDataCol6",A);ac.append("addtnlCstmrDataCol7",z);ac.append("addtnlCstmrDataCol8",y);ac.append("addtnlCstmrDataCol9",x);ac.append("addtnlCstmrDataCol10",W);ac.append("addtnlCstmrDataCol11",V);ac.append("addtnlCstmrDataCol12",U);ac.append("addtnlCstmrDataCol13",T);ac.append("addtnlCstmrDataCol14",Q);ac.append("addtnlCstmrDataCol15",P);ac.append("addtnlCstmrDataCol16",N);ac.append("addtnlCstmrDataCol17",M);ac.append("addtnlCstmrDataCol18",L);ac.append("addtnlCstmrDataCol19",K);ac.append("addtnlCstmrDataCol20",w);ac.append("addtnlCstmrDataCol21",v);ac.append("addtnlCstmrDataCol22",u);ac.append("addtnlCstmrDataCol23",t);ac.append("addtnlCstmrDataCol24",r);ac.append("addtnlCstmrDataCol25",q);ac.append("addtnlCstmrDataCol26",p);ac.append("addtnlCstmrDataCol27",o);ac.append("addtnlCstmrDataCol28",m);ac.append("addtnlCstmrDataCol29",l);ac.append("addtnlCstmrDataCol30",aJ);ac.append("addtnlCstmrDataCol31",aI);ac.append("addtnlCstmrDataCol32",aG);ac.append("addtnlCstmrDataCol33",aE);ac.append("addtnlCstmrDataCol34",aD);ac.append("addtnlCstmrDataCol35",aC);ac.append("addtnlCstmrDataCol36",aB);ac.append("addtnlCstmrDataCol37",aA);ac.append("addtnlCstmrDataCol38",az);ac.append("addtnlCstmrDataCol39",ay);ac.append("addtnlCstmrDataCol40",av);ac.append("addtnlCstmrDataCol41",au);ac.append("addtnlCstmrDataCol42",at);ac.append("addtnlCstmrDataCol43",ar);ac.append("addtnlCstmrDataCol44",aq);ac.append("addtnlCstmrDataCol45",ap);ac.append("addtnlCstmrDataCol46",ao);ac.append("addtnlCstmrDataCol47",an);ac.append("addtnlCstmrDataCol48",am);ac.append("addtnlCstmrDataCol49",al);ac.append("addtnlCstmrDataCol50",ah);ac.append("myFormPage",e);$.ajax({url:"index.php",type:"POST",data:ac,async:true,success:function(aO){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var aP="";if(/^[\],:{}\s]*$/.test(aO.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){n=$.parseJSON(aO);if(c<=0){$("#custID").val(n.custID);$("#profileID").val(n.profileID);$("#idNo").val(n.localIdNo);aP="Customer Data Successfully Saved!"}else{aP="Change Request submitted successfully for AUTHORIZATION"}if(e==2){g.modal("hide");openATab("#prfBCOPAddPrsnDataEDT","grp=17&typ=1&pg=11&subPgNo=1.6&vtyp=1&vtypActn=EDIT&custID="+n.custID+"&formType=Personal Customer&rvsnTtlAPD="+X);bootbox.alert({size:"small",title:"Rhomicom Message",message:aP,callback:function(){}})}else{getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Customer Profile",11,f,0,"EDIT",n.custID,"","indCustTableRow1",-1,function(){g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:aP,callback:function(){}})})}}else{aP=aO;g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:aP,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function updateIndCustListData(){if($("#addOrEditForm").val()==="Add"){getCustData("","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.1","mcfIndCstmr")}else{var c=$("#idNo").val();var h=$("#surName").val()+", "+$("#firstName").val()+" "+$.trim($("#otherNames").val())+" ("+$("#title").val()+")";var e=$("#lnkdFirmName").val();var d=$("#email").val();var a=$("#status").val();var g=$("#bnkBranch").val();var f=$("#tblRowID").val();var b=1;$("#"+f).find("td").each(function(){switch(b){case 5:$(this).html(c);break;case 6:$(this).html(h);break;case 7:$(this).html(e);break;case 8:$(this).html(d);break;case 9:$(this).html(g);break;case 10:$(this).html(a);break}b=b+1})}}function getCustData(p,q,m,k){var d;var g;var a;if(typeof k==="undefined"||k===null){k="dataAdmin"}if($("#addOrEditForm").val()==="Add"){$("#"+k+"SrchFor").val($("#idNo").val());var d=$("#"+k+"SrchFor").val();$("#"+k+"SrchIn").val("ID");var g=$("#"+k+"SrchIn").val()}else{d=typeof $("#"+k+"SrchFor").val()==="undefined"?"%":$("#"+k+"SrchFor").val();g=typeof $("#"+k+"SrchIn").val()==="undefined"?"Both":$("#"+k+"SrchIn").val()}var v=typeof $("#"+k+"PageNo").val()==="undefined"?1:$("#"+k+"PageNo").val();var h=typeof $("#"+k+"DsplySze").val()==="undefined"?10:$("#"+k+"DsplySze").val();var n=typeof $("#"+k+"SortBy").val()==="undefined"?"":$("#"+k+"SortBy").val();var f=typeof $("#"+k+"OtherPrsnType").val()==="undefined"?"All":$("#"+k+"OtherPrsnType").val();var s=typeof $("#trnsType").val()==="undefined"?"":$("#trnsType").val();var r=$("#"+k+"IsEnabled:checked").length>0;var e=typeof $("#"+k+"BranchSrchIn").val()==="undefined"?"All Branches":$("#"+k+"BranchSrchIn").val();var b=typeof $("#"+k+"StatusSrchIn").val()==="undefined"?"All Statuses":$("#"+k+"StatusSrchIn").val();var u=typeof $("#"+k+"PrdtTypeSrchIn").val()==="undefined"?"Savings":$("#"+k+"PrdtTypeSrchIn").val();var t=typeof $("#"+k+"CrdtTypeSrchIn").val()==="undefined"?"All Credit Types":$("#"+k+"CrdtTypeSrchIn").val();var l=typeof $("#"+k+"RqstStatusSrchIn").val()==="undefined"?"All Statuses":$("#"+k+"RqstStatusSrchIn").val();var c=typeof $("#"+k+"BnkPrdtTypeSrchInID").val()==="undefined"?-1:$("#"+k+"BnkPrdtTypeSrchInID").val();var j=typeof $("#"+k+"StrtDate").val()==="undefined"?"":$("#"+k+"StrtDate").val();var o=typeof $("#"+k+"EndDate").val()==="undefined"?"":$("#"+k+"EndDate").val();if(p=="clear"){d="%";v=1}else{if(p=="next"){v=parseInt(v)+1}else{if(p=="previous"){v=parseInt(v)-1}}}m=m+"&searchfor="+d+"&searchin="+g+"&pageNo="+v+"&limitSze="+h+"&sortBy="+n+"&prsnType="+f+"&trnsType="+s+"&isEnabled="+r+"&branchSrchIn="+e+"&statusSrchIn="+b+"&prdtTypeSrchIn="+u+"&crdtTypeSrchIn="+t+"&qStrtDte="+j+"&qEndDte="+o+"&rqstStatusSrchIn="+l+"&bnkPrdtTypeSrchInID="+c;$body=$("body");openATab(q,m)}function enterKeyFuncCust(d,c,g,f,b){var a=(typeof d.which==="number")?d.which:d.keyCode;if(a==13){getCustData(c,g,f,b)}}function validateCustomerForm(h,l,m,j,d,k,b,e,a,g,f,c){if(h===""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#title").css("border-color","red");$("#title").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Title</b>!",callback:function(){}});return false}else{if(l.trim()==""||l=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#firstName").css("border-color","red");$("#firstName").css("border-width","2px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter <b>First Name</b>!",callback:function(){}});return false}else{if(m.trim()==""||m=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#surName").css("border-color","red");$("#surName").css("border-width","2px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter <b>Surname</b>!",callback:function(){}});return false}else{if(j===""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#gender").css("border-color","red");$("#gender").css("border-width","2px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Gender</b>",callback:function(){}});return false}else{if(d==""||d=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#maritalStatus").css("border-color","red");$("#maritalStatus").css("border-width","2px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Marital Status</b>!",callback:function(){}});return false}else{if(k==""||k=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#dob").css("border-color","red");$("#dob").css("border-width","2px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please choose <b>Date of Birth</b>!",callback:function(){}});return false}else{if(b==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#nationality").css("border-color","red");$("#nationality").css("border-width","2px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Nationality</b>!",callback:function(){}});return false}else{if((e.trim()==""||e=="undefined")&&(a.trim()==""||a=="undefined")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#mobileNo").css("border-color","red");$("#mobileNo").css("border-width","2px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter at lease one <b>Contact Number</b>!",callback:function(){}});return false}else{if(g.trim()==""||g=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#residentialAddress").css("border-color","red");$("#residentialAddress").css("border-width","2px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a <b>Residential address</b>!",callback:function(){}});return false}else{if(f==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#relation").css("border-color","red");$("#relation").css("border-width","2px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Person Type</b>!",callback:function(){}});return false}else{if(c==""||c=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#startDate").css("border-color","red");$("#startDate").css("border-width","2px");$("#relation").css("border-color","#ccc");$("#relation").css("border-width","1px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select the <b>Effective Start Date</b> of this Customer setup!",callback:function(){}});return false}else{$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px");$("#prsnType").css("border-color","#ccc");$("#prsnType").css("border-width","1px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");return true}}}}}}}}}}}}function saveBasicDataOP(a,f,e,h){var g;var b;var c=$(".nav-tabs .active").text();var d=1;if(c.indexOf("Additional Data")>=0){d=2}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var l=$("#OPtabContent"),u=l.find(".tab-pane.active");var o;var aP=typeof $("#bnkCustomerID").val()==="undefined"?-1:$("#bnkCustomerID").val();var ah=typeof $("#personID").val()==="undefined"?-1:$("#personID").val();var ad=typeof $("#idNo").val()==="undefined"?"":$("#idNo").val();var K=typeof $("#title").val()==="undefined"?"":$("#title").val();var aa=typeof $("#firstName").val()==="undefined"?"":$("#firstName").val();var aO=typeof $("#surName").val()==="undefined"?"":$("#surName").val();var ay=typeof $("#otherNames").val()==="undefined"?"":$("#otherNames").val();var ax=typeof $("#gender").val()==="undefined"?"":$("#gender").val();var aj=typeof $("#maritalStatus").val()==="undefined"?"":$("#maritalStatus").val();var ac=typeof $("#dob").val()==="undefined"?"":$("#dob").val();var aM=typeof $("#pob").val()==="undefined"?"":$("#pob").val();var L=typeof $("#nationality").val()==="undefined"?"":$("#nationality").val();var ag=typeof $("#homeTown").val()==="undefined"?"":$("#homeTown").val();var t=typeof $("#religion").val()==="undefined"?"":$("#religion").val();var ak=typeof $("#lnkdFirmName").val()==="undefined"?"":$("#lnkdFirmName").val();var aI=typeof $("#lnkdFirmLoc").val()==="undefined"?"":$("#lnkdFirmLoc").val();var J=typeof $("#email").val()==="undefined"?"":$("#email").val();var I=typeof $("#telNo").val()==="undefined"?"":$("#telNo").val();var aQ=typeof $("#mobileNo").val()==="undefined"?"":$("#mobileNo").val();var ab=typeof $("#faxNo").val()==="undefined"?"":$("#faxNo").val();var Q=typeof $("#postalAddress").val()==="undefined"?"":$("#postalAddress").val();var af=typeof $("#residentialAddress").val()==="undefined"?"":$("#residentialAddress").val();var j=typeof $("input[name='isSignatory']:checked").val()==="undefined"?"":$("input[name='isSignatory']:checked").val();var k=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var aN=typeof $("#startDate").val()==="undefined"?"":$("#startDate").val();var al=typeof $("#endDate").val()==="undefined"?"":$("#endDate").val();var aD=$("#relationTyp option:selected").map(function(){return $(this).val()}).get();var az=aD;var T=validateOtherPersonForm(K,aa,aO,ax,aj,ac,L,aQ,I,af,az,aN);if(!T){return false}if(h>0&&$("#nationalIDTblEDT > tbody > tr").length<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'><i>Please provide at least One(1) National ID for Person</i></span>",callback:function(){}});return false}g=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});g.find(".modal-content").css({"margin-top":function(){var aS=$(window).height();var aR=$(".modal-dialog").height();var aT=aS/2;return aT+"px"}});var U="Other Person";var H=typeof $("#addtnlCstmrDataCol1").val()==="undefined"?"":$("#addtnlCstmrDataCol1").val();var G=typeof $("#addtnlCstmrDataCol2").val()==="undefined"?"":$("#addtnlCstmrDataCol2").val();var F=typeof $("#addtnlCstmrDataCol3").val()==="undefined"?"":$("#addtnlCstmrDataCol3").val();var E=typeof $("#addtnlCstmrDataCol4").val()==="undefined"?"":$("#addtnlCstmrDataCol4").val();var D=typeof $("#addtnlCstmrDataCol5").val()==="undefined"?"":$("#addtnlCstmrDataCol5").val();var C=typeof $("#addtnlCstmrDataCol6").val()==="undefined"?"":$("#addtnlCstmrDataCol6").val();var B=typeof $("#addtnlCstmrDataCol7").val()==="undefined"?"":$("#addtnlCstmrDataCol7").val();var A=typeof $("#addtnlCstmrDataCol8").val()==="undefined"?"":$("#addtnlCstmrDataCol8").val();var z=typeof $("#addtnlCstmrDataCol9").val()==="undefined"?"":$("#addtnlCstmrDataCol9").val();var Z=typeof $("#addtnlCstmrDataCol10").val()==="undefined"?"":$("#addtnlCstmrDataCol10").val();var X=typeof $("#addtnlCstmrDataCol11").val()==="undefined"?"":$("#addtnlCstmrDataCol11").val();var W=typeof $("#addtnlCstmrDataCol12").val()==="undefined"?"":$("#addtnlCstmrDataCol12").val();var V=typeof $("#addtnlCstmrDataCol13").val()==="undefined"?"":$("#addtnlCstmrDataCol13").val();var S=typeof $("#addtnlCstmrDataCol14").val()==="undefined"?"":$("#addtnlCstmrDataCol14").val();var R=typeof $("#addtnlCstmrDataCol15").val()==="undefined"?"":$("#addtnlCstmrDataCol15").val();var P=typeof $("#addtnlCstmrDataCol16").val()==="undefined"?"":$("#addtnlCstmrDataCol16").val();var O=typeof $("#addtnlCstmrDataCol17").val()==="undefined"?"":$("#addtnlCstmrDataCol17").val();var N=typeof $("#addtnlCstmrDataCol18").val()==="undefined"?"":$("#addtnlCstmrDataCol18").val();var M=typeof $("#addtnlCstmrDataCol19").val()==="undefined"?"":$("#addtnlCstmrDataCol19").val();var y=typeof $("#addtnlCstmrDataCol20").val()==="undefined"?"":$("#addtnlCstmrDataCol20").val();var x=typeof $("#addtnlCstmrDataCol21").val()==="undefined"?"":$("#addtnlCstmrDataCol21").val();var w=typeof $("#addtnlCstmrDataCol22").val()==="undefined"?"":$("#addtnlCstmrDataCol22").val();var v=typeof $("#addtnlCstmrDataCol23").val()==="undefined"?"":$("#addtnlCstmrDataCol23").val();var s=typeof $("#addtnlCstmrDataCol24").val()==="undefined"?"":$("#addtnlCstmrDataCol24").val();var r=typeof $("#addtnlCstmrDataCol25").val()==="undefined"?"":$("#addtnlCstmrDataCol25").val();var q=typeof $("#addtnlCstmrDataCol26").val()==="undefined"?"":$("#addtnlCstmrDataCol26").val();var p=typeof $("#addtnlCstmrDataCol27").val()==="undefined"?"":$("#addtnlCstmrDataCol27").val();var n=typeof $("#addtnlCstmrDataCol28").val()==="undefined"?"":$("#addtnlCstmrDataCol28").val();var m=typeof $("#addtnlCstmrDataCol29").val()==="undefined"?"":$("#addtnlCstmrDataCol29").val();var aL=typeof $("#addtnlCstmrDataCol30").val()==="undefined"?"":$("#addtnlCstmrDataCol30").val();var aK=typeof $("#addtnlCstmrDataCol31").val()==="undefined"?"":$("#addtnlCstmrDataCol31").val();var aJ=typeof $("#addtnlCstmrDataCol32").val()==="undefined"?"":$("#addtnlCstmrDataCol32").val();var aH=typeof $("#addtnlCstmrDataCol33").val()==="undefined"?"":$("#addtnlCstmrDataCol33").val();var aG=typeof $("#addtnlCstmrDataCol34").val()==="undefined"?"":$("#addtnlCstmrDataCol34").val();var aF=typeof $("#addtnlCstmrDataCol35").val()==="undefined"?"":$("#addtnlCstmrDataCol35").val();var aE=typeof $("#addtnlCstmrDataCol36").val()==="undefined"?"":$("#addtnlCstmrDataCol36").val();var aC=typeof $("#addtnlCstmrDataCol37").val()==="undefined"?"":$("#addtnlCstmrDataCol37").val();var aB=typeof $("#addtnlCstmrDataCol38").val()==="undefined"?"":$("#addtnlCstmrDataCol38").val();var aA=typeof $("#addtnlCstmrDataCol39").val()==="undefined"?"":$("#addtnlCstmrDataCol39").val();var aw=typeof $("#addtnlCstmrDataCol40").val()==="undefined"?"":$("#addtnlCstmrDataCol40").val();var av=typeof $("#addtnlCstmrDataCol41").val()==="undefined"?"":$("#addtnlCstmrDataCol41").val();var au=typeof $("#addtnlCstmrDataCol42").val()==="undefined"?"":$("#addtnlCstmrDataCol42").val();var at=typeof $("#addtnlCstmrDataCol43").val()==="undefined"?"":$("#addtnlCstmrDataCol43").val();var ar=typeof $("#addtnlCstmrDataCol44").val()==="undefined"?"":$("#addtnlCstmrDataCol44").val();var aq=typeof $("#addtnlCstmrDataCol45").val()==="undefined"?"":$("#addtnlCstmrDataCol45").val();var ap=typeof $("#addtnlCstmrDataCol46").val()==="undefined"?"":$("#addtnlCstmrDataCol46").val();var ao=typeof $("#addtnlCstmrDataCol47").val()==="undefined"?"":$("#addtnlCstmrDataCol47").val();var an=typeof $("#addtnlCstmrDataCol48").val()==="undefined"?"":$("#addtnlCstmrDataCol48").val();var am=typeof $("#addtnlCstmrDataCol49").val()==="undefined"?"":$("#addtnlCstmrDataCol49").val();var ai=typeof $("#addtnlCstmrDataCol50").val()==="undefined"?"":$("#addtnlCstmrDataCol50").val();var Y=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var ae=new FormData();ae.append("custPicture",$("#custPicture")[0].files[0]);ae.append("signPicture",$("#signPicture")[0].files[0]);ae.append("grp",17);ae.append("typ",1);ae.append("q","UPDATE");ae.append("pg",a);ae.append("subPgNo",f);ae.append("vtyp",e);ae.append("bnkCustomerID",aP);ae.append("personID",ah);ae.append("idNo",ad);ae.append("title",K);ae.append("firstName",aa);ae.append("surName",aO);ae.append("otherNames",ay);ae.append("gender",ax);ae.append("maritalStatus",aj);ae.append("dob",ac);ae.append("pob",aM);ae.append("nationality",L);ae.append("homeTown",ag);ae.append("religion",t);ae.append("lnkdFirmName",ak);ae.append("lnkdFirmLoc",aI);ae.append("email",J);ae.append("telNo",I);ae.append("mobileNo",aQ);ae.append("faxNo",ab);ae.append("postalAddress",Q);ae.append("residentialAddress",af);ae.append("isSignatory",j);ae.append("prsnType",az);ae.append("bnkBranchID",k);ae.append("startDate",aN);ae.append("endDate",al);ae.append("srcType",U);ae.append("shdSbmt",h);ae.append("addtnlCstmrDataCol1",H);ae.append("addtnlCstmrDataCol2",G);ae.append("addtnlCstmrDataCol3",F);ae.append("addtnlCstmrDataCol4",E);ae.append("addtnlCstmrDataCol5",D);ae.append("addtnlCstmrDataCol6",C);ae.append("addtnlCstmrDataCol7",B);ae.append("addtnlCstmrDataCol8",A);ae.append("addtnlCstmrDataCol9",z);ae.append("addtnlCstmrDataCol10",Z);ae.append("addtnlCstmrDataCol11",X);ae.append("addtnlCstmrDataCol12",W);ae.append("addtnlCstmrDataCol13",V);ae.append("addtnlCstmrDataCol14",S);ae.append("addtnlCstmrDataCol15",R);ae.append("addtnlCstmrDataCol16",P);ae.append("addtnlCstmrDataCol17",O);ae.append("addtnlCstmrDataCol18",N);ae.append("addtnlCstmrDataCol19",M);ae.append("addtnlCstmrDataCol20",y);ae.append("addtnlCstmrDataCol21",x);ae.append("addtnlCstmrDataCol22",w);ae.append("addtnlCstmrDataCol23",v);ae.append("addtnlCstmrDataCol24",s);ae.append("addtnlCstmrDataCol25",r);ae.append("addtnlCstmrDataCol26",q);ae.append("addtnlCstmrDataCol27",p);ae.append("addtnlCstmrDataCol28",n);ae.append("addtnlCstmrDataCol29",m);ae.append("addtnlCstmrDataCol30",aL);ae.append("addtnlCstmrDataCol31",aK);ae.append("addtnlCstmrDataCol32",aJ);ae.append("addtnlCstmrDataCol33",aH);ae.append("addtnlCstmrDataCol34",aG);ae.append("addtnlCstmrDataCol35",aF);ae.append("addtnlCstmrDataCol36",aE);ae.append("addtnlCstmrDataCol37",aC);ae.append("addtnlCstmrDataCol38",aB);ae.append("addtnlCstmrDataCol39",aA);ae.append("addtnlCstmrDataCol40",aw);ae.append("addtnlCstmrDataCol41",av);ae.append("addtnlCstmrDataCol42",au);ae.append("addtnlCstmrDataCol43",at);ae.append("addtnlCstmrDataCol44",ar);ae.append("addtnlCstmrDataCol45",aq);ae.append("addtnlCstmrDataCol46",ap);ae.append("addtnlCstmrDataCol47",ao);ae.append("addtnlCstmrDataCol48",an);ae.append("addtnlCstmrDataCol49",am);ae.append("addtnlCstmrDataCol50",ai);ae.append("rvsnTtl",Y);$.ajax({url:"index.php",type:"POST",data:ae,async:true,success:function(aR){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var aS="";if(/^[\],:{}\s]*$/.test(aR.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){o=$.parseJSON(aR);$("#idNo").val(o.localIDNo);$("#personID").val(o.personID);aS="Person Data Successfully Saved!";if(d==2){g.modal("hide");openATab("#prfBCOPAddPrsnDataEDT","grp=17&typ=1&pg=11&subPgNo=1.6&vtyp=1&vtypActn=EDIT&custID="+o.personID+"&formType=Other Person&rvsnTtlAPD="+Y);bootbox.alert({size:"small",title:"Rhomicom Message",message:aS,callback:function(){}})}else{getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Person Profile",11,f,0,"EDIT",o.personID,"","indCustTableRow1",-1,function(){g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:aS,callback:function(){}})})}}else{aS=aR;g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:aS,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function validateOtherPersonForm(h,l,m,j,d,k,b,e,a,g,f,c){if(h===""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#title").css("border-color","red");$("#title").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Title</b>!",callback:function(){}});return false}else{if(l.trim()==""||l=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#firstName").css("border-color","red");$("#firstName").css("border-width","2px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter <b>First Name</b>!",callback:function(){}});return false}else{if(m.trim()==""||m=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#surName").css("border-color","red");$("#surName").css("border-width","2px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter <b>Surname</b>!",callback:function(){}});return false}else{if(j===""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#gender").css("border-color","red");$("#gender").css("border-width","2px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Gender</b>",callback:function(){}});return false}else{if(d==""||d=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#maritalStatus").css("border-color","red");$("#maritalStatus").css("border-width","2px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Marital Status</b>!",callback:function(){}});return false}else{if(k==""||k=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#dob").css("border-color","red");$("#dob").css("border-width","2px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please choose <b>Date of Birth</b>!",callback:function(){}});return false}else{if(b==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#nationality").css("border-color","red");$("#nationality").css("border-width","2px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Nationality</b>!",callback:function(){}});return false}else{if((e.trim()==""||e=="undefined")&&(a.trim()==""||a=="undefined")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#mobileNo").css("border-color","red");$("#mobileNo").css("border-width","2px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter at lease one <b>Contact Number</b>!",callback:function(){}});return false}else{if(g.trim()==""||g=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#residentialAddress").css("border-color","red");$("#residentialAddress").css("border-width","2px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a <b>Residential address</b>!",callback:function(){}});return false}else{if(f==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#relation").css("border-color","red");$("#relation").css("border-width","2px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Person Type</b>!",callback:function(){}});return false}else{if(c==""||c=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#startDate").css("border-color","red");$("#startDate").css("border-width","2px");$("#relation").css("border-color","#ccc");$("#relation").css("border-width","1px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select the <b>Effective Start Date</b> of this Customer setup!",callback:function(){}});return false}else{$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px");$("#prsnType").css("border-color","#ccc");$("#prsnType").css("border-width","1px");$("#residentialAddress").css("border-color","#ccc");$("#residentialAddress").css("border-width","1px");$("#mobileNo").css("border-color","#ccc");$("#mobileNo").css("border-width","1px");$("#nationality").css("border-color","#ccc");$("#nationality").css("border-width","1px");$("#dob").css("border-color","#ccc");$("#dob").css("border-width","1px");$("#maritalStatus").css("border-color","#ccc");$("#maritalStatus").css("border-width","1px");$("#gender").css("border-color","#ccc");$("#gender").css("border-width","1px");$("#surName").css("border-color","#ccc");$("#surName").css("border-width","1px");$("#firstName").css("border-color","#ccc");$("#firstName").css("border-width","1px");$("#title").css("border-color","#ccc");$("#title").css("border-width","1px");return true}}}}}}}}}}}}function onClickLinkedCustName(){var c=typeof $("#bnkCustomerID").val()==="undefined"?-1:$("#bnkCustomerID").val();var b=typeof $("#personID").val()==="undefined"?-1:$("#personID").val();var a=typeof $("#status").val()==="undefined"?-1:$("#status").val();getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","MCF All Individual Customers","gnrlOrgID","","","radio",true,"","bnkCustomerID","bnkCustomer","clear",1,"",function(){saveLinkedCustomer(c,b,a)})}function saveLinkedCustomer(e,c,b){var d;var a;var f;f=bootbox.confirm({size:"small",message:"Are you sure you want to replace the current person's details with that of the selected linked Person?</br>Please not that this action cannot be undone when completed!</br>The form will close when completed.",callback:function(g){if(g){if(!(b=="Incomplete"||b=="Rejected"||b=="Withdrawn")){f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Customers with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be linked.",callback:function(){}});return false}d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Saving. Please Wait...</div>'});d.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j)/2;return l+"px"}});var h;if(window.XMLHttpRequest){h=new XMLHttpRequest()}else{h=new ActiveXObject("Microsoft.XMLHTTP")}h.onreadystatechange=function(){if(h.readyState===4&&h.status===200){var j=h.responseText;d.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:j+"Please requery the person to see changes!",callback:function(){getCustData("","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.4")}});a.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k-150)/2;return m+"px"}})}};h.open("POST","index.php",true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send("grp=17&typ=1&pg=11&subPgNo=1.4&q=UPDATE&vtyp=0&PKeyID="+c+"&bnkCustomerID="+e)}}});f.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g-150)/2;return k+"px"}})}function deleteOtherPersonRcrd(e,b,c){var d;var a;var f;f=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Lien?",callback:function(g){if(g){if(!(c=="Incomplete"||c=="Rejected"||c=="Withdrawn")){f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Liens with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});d.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j)/2;return l+"px"}});var h;if(window.XMLHttpRequest){h=new XMLHttpRequest()}else{h=new ActiveXObject("Microsoft.XMLHTTP")}h.onreadystatechange=function(){if(h.readyState===4&&h.status===200){var j=h.responseText;d.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:j,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k-150)/2;return m+"px"}});$("table#acctLiensTblAdd tbody tr#acctLiensTblAddRow"+e).remove()}};h.open("POST","index.php",true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send("grp=17&typ=1&pg=13&subPgNo=2.1&q=DELETE&vtyp=6&PKeyID="+b+"&acctLienId="+e)}}});f.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g-150)/2;return k+"px"}})}function getCustomersForm(n,o,b,r,c,e,f,g,d,q,h,m,p,k){if(typeof p==="undefined"||p===null){p=function(){var s=1}}if(typeof k==="undefined"||k===null){k=0}var j="";if(e==1.1){j="mcfIndCstmr"}else{if(e==1.2){j="mcfCorpCstmr"}else{if(e==1.3){j="mcfGrpCstmr"}else{if(e==1.4){j="mcfOthPCstmr"}}}}if(typeof m==="undefined"||m===null){m=-1}$("#tblRowID").val(h);if(1==2){if(!$.fn.DataTable.isDataTable("#indCustTable")){var l=$("#indCustTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#indCustTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{l.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#indCustTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{l.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}}$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){if(m<=0){}$("#"+b).html(r);$("#"+o).html(a.responseText);$("#"+n).off("hidden.bs.modal");$("#"+n).one("hidden.bs.modal",function(s){if(k<=0){getCustData("","#allmodules","grp=17&typ=1&pg=1&subPgNo="+e,j)}$("#"+b).html("");$("#"+o).html("");$(s.currentTarget).unbind()});$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+n).off("show.bs.modal");$("#"+n).on("show.bs.modal",function(s){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+n).modal({backdrop:"static",keyboard:false});if(m=1){$("#"+n).modal({backdrop:"static",keyboard:false})}$body=$("body");$(document).ready(function(){$("#meetingDays").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"335px"});$("#relationTyp").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"205px"});p()})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");if(c==11){a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+g+"&custID="+d+"&prsnType="+q)}else{if(c==12||c==18){a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+g+"&prdtID="+d)}else{if(c==14){a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+g+"&PKeyID="+d)}}}}function getOtherPersonsList(c,g,b,f,a,e){$body=$("body");$body.addClass("mdlloadingDiag");var d;if(window.XMLHttpRequest){d=new XMLHttpRequest()}else{d=new ActiveXObject("Microsoft.XMLHTTP")}d.onreadystatechange=function(){if(d.readyState===4&&d.status===200){$("#"+b).html(f);$("#"+g).html(d.responseText);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+c).on("show.bs.modal",function(h){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+c).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){prepareCustEDT("grp=17&typ=1&pg="+a+"&subPgNo="+e+"&vtyp="+vtyp+"&vtypActn="+vtypActn+"&custID="+pKeyID,$body,"prflHomeEDTtab",d.responseText)})}};d.open("POST","index.php",true);d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.send("grp=17&typ=1&pg="+a+"&subPgNo="+e)}function getIndCustNtnlIDForm(l,m,b,g,o,n,c,e,f,j,d){var k=-1;var h="Please Save Customer First";if(e==1.1){k=typeof $("#custID").val()==="undefined"?-1:$("#custID").val()}else{if(e==1.4){k=typeof $("#personID").val()==="undefined"?-1:$("#personID").val();h="Please save Person First"}}if(k<=0){bootbox.alert({size:"small",title:"Rhomicom Message",message:h,callback:function(){}});return false}$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(n);$("#"+m).html(a.responseText);$("#"+l).off("hidden.bs.modal");$("#"+l).one("hidden.bs.modal",function(q){$("#"+b).html("");$("#"+m).html("");$(q.currentTarget).unbind()});$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(f===5&&j==="EDIT"){var p=$("#"+o).find("td");$("#ntnlIDCardsCountry").val($.trim(p.eq(2).text()));$("#ntnlIDCardsIDTyp").val($.trim(p.eq(3).text()));$("#ntnlIDCardsIDNo").val($.trim(p.eq(4).text()));$("#ntnlIDCardsDateIssd").val($.trim(p.eq(5).text()));$("#ntnlIDCardsExpDate").val($.trim(p.eq(6).text()));$("#ntnlIDCardsOtherInfo").val($.trim(p.eq(7).text()))}$("#"+l).on("show.bs.modal",function(q){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){$("#"+g).submit(function(q){q.preventDefault();return false})})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+j+"&ntnlIDpKey="+d)}function saveIndCustNtnlIDForm(e,j,k,l){var h;var p;var m=-1;var g="Please Save Customer First";var r="";if(k==1.1){r="Customer";m=typeof $("#custID").val()==="undefined"?-1:$("#custID").val()}else{if(k==1.4){r="Person";m=typeof $("#personID").val()==="undefined"?-1:$("#personID").val();g="Please save Person First"}}var n=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();if(m<=0){bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});return false}var f=typeof $("#ntnlIDCardsCountry").val()==="undefined"?"":$("#ntnlIDCardsCountry").val();var d=typeof $("#ntnlIDCardsIDTyp").val()==="undefined"?"":$("#ntnlIDCardsIDTyp").val();var b=typeof $("#ntnlIDCardsIDNo").val()==="undefined"?"":$("#ntnlIDCardsIDNo").val();var t=typeof $("#ntnlIDCardsDateIssd").val()==="undefined"?"":$("#ntnlIDCardsDateIssd").val();var s=typeof $("#ntnlIDCardsExpDate").val()==="undefined"?"":$("#ntnlIDCardsExpDate").val();var c=typeof $("#ntnlIDCardsOtherInfo").val()==="undefined"?"":$("#ntnlIDCardsOtherInfo").val();var q="<span style='color:red; font-weigh:bold !important;'>Please provide the following:</br></span>";var o="";var a=0;if(f=="undefined"||f==undefined||f=="Please Select..."){o=o+"Country</br>";a=a+1}if(d=="undefined"||d==undefined||d=="Please Select..."){o=o+"ID Type</br>";a=a+1}if(b.trim()==""||b=="undefined"){o=o+"ID No.</br>";a=a+1}if(t==""){o=o+"Date Issued</br>";a=a+1}if(s==""){o=o+"Expiry Date</br>";a=a+1}if(a>0){bootbox.alert({size:"small",title:"Rhomicom Message",message:q+o,callback:function(){}});return false}$body=$("body");$body.addClass("mdlloadingDiag");h=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});h.find(".modal-content").css({"margin-top":function(){var x=$(window).height();var v=$(".modal-dialog").height();var y=x/2;return y+"px"}});var u;if(window.XMLHttpRequest){u=new XMLHttpRequest()}else{u=new ActiveXObject("Microsoft.XMLHTTP")}u.onreadystatechange=function(){if(u.readyState===4&&u.status===200){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var v=u.responseText;var x="";if(/^[\],:{}\s]*$/.test(v.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var w=$.parseJSON(v);x="National ID Saved Successfylly!";getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit "+r+" Profile",11,k,0,"EDIT",m,"","indCustTableRow1",-1,function(){$("#"+e).modal("hide");h.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:x,callback:function(){}})})}else{x=v;h.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:x,callback:function(){}})}}};u.open("POST","index.php",true);u.setRequestHeader("Content-type","application/x-www-form-urlencoded");u.send("grp=17&typ=1&pg=11&q=UPDATE&vtyp="+l+"&subPgNo="+k+"&actyp=2&ntnlIDCardsCountry="+f+"&ntnlIDCardsIDTyp="+d+"&ntnlIDCardsIDNo="+b+"&ntnlIDCardsDateIssd="+t+"&ntnlIDCardsExpDate="+s+"&ntnlIDCardsOtherInfo="+c+"&ntnlIDpKey="+j+"&custPrsnID="+m+"&rvsnTtl="+n)}function advancedAccountSearch(){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","MCF All Bank Acccounts(Advanced Search)","","","","radio",true,"","acctNoFindAccId","acctNoFindRawTxt","clear",1,"",function(){$("#acctNoFind").val($("#acctNoFindRawTxt").val().split(" [")[0])})}function getChqBookRegisterForm(k,l,b,m,c,e,f,g,d,h){$("#tblRowID").val(h);if(!$.fn.DataTable.isDataTable("#indCustTable")){var j=$("#indCustTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#indCustTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{j.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#indCustTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{j.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+l).html(a.responseText);var n="";if(g!="ADD"){n=$("#status").val()}$("#"+b).html(m);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+k).on("show.bs.modal",function(o){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+k).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+g+"&PKeyID="+d)}function getChqRegisterForm(k,l,b,m,c,e,f,g,d,h){$("#tblRowID").val(h);if(!$.fn.DataTable.isDataTable("#indCustTable")){var j=$("#indCustTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#indCustTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{j.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#indCustTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{j.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+l).html(a.responseText);var n="";if(g!="ADD"){n=$("#status").val()}$("#"+b).html(m);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+k).on("show.bs.modal",function(o){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+k).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+g+"&PKeyID="+d)}function autoCalcLastSerialNo(){var b=$("#chqNoFirst").val();var a=$("#noOfPages").val();if(a!=""&&b!=""){$("#chqNoLast").val(Number(b)+Number(a)-1)}}function onChangeOfChqType(){var a=$("#chqType option:selected").val();$("#acctID").val(-1);$("#acctNo").val("");$("#acctTitle").val("");if(a=="Personal Cheque"||a=="Corporate Cheque"||a=="Group Cheque"||a=="Passbook"||a=="Loan Application Form"){$("#acctTitleDiv").css("display","block");$("#acctNoDiv").css("display","block");$(".chqBkRvnDiv").css("display","block")}else{if(a=="Counter Cheque"||a=="Banker's Draft"||a=="Withdrawal Slip"||a=="Deposit Slip"){$("#acctTitleDiv").css("display","none");$("#acctNoDiv").css("display","none");$(".chqBkRvnDiv").css("display","none")}}}function onChqBkStatusChng(){var a=$("#status option:selected").val();if(a=="Issued"){$("#issueDateDiv").css("display","block")}else{$("#issueDateDiv").css("display","none")}}function submitChqBookForm(o,l,c){var h=typeof $("#chqBookId").val()==="undefined"?-1:$("#chqBookId").val();var p=typeof $("#chqType").val()==="undefined"?"":$("#chqType").val();var a=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();var m=typeof $("#noOfPages").val()==="undefined"?-1:$("#noOfPages").val();var q=typeof $("#chqNoFirst").val()==="undefined"?-1:$("#chqNoFirst").val();var n=typeof $("#chqNoLast").val()==="undefined"?-1:$("#chqNoLast").val();var r=typeof $("#issueDate").val()==="undefined"?"":$("#issueDate").val();var e=typeof $("#status").val()==="undefined"?"":$("#status").val();var b=typeof $("#chqBkFee").val()==="undefined"?0:$("#chqBkFee").val().trim().length===0?0:$("#chqBkFee").val();var f=typeof $("#chqBkFeeRvnueAcctID").val()==="undefined"?-1:$("#chqBkFeeRvnueAcctID").val().trim().length===0?-1:$("#chqBkFeeRvnueAcctID").val();var k=validateChqBookForm(p,a,m,q,n,e,r,b,f);if(!k){return false}var g;var j;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to process this request?",callback:function(s){if(s){g=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Processing... Please Wait...</div>'});g.find(".modal-content").css({"margin-top":function(){var v=$(window).height();var u=$(".modal-dialog").height();var x=(v-u)/2;return x+"px"}});var t;if(window.XMLHttpRequest){t=new XMLHttpRequest()}else{t=new ActiveXObject("Microsoft.XMLHTTP")}t.onreadystatechange=function(){if(t.readyState===4&&t.status===200){var u=t.responseText;var v="";g.modal("hide");if(/^[\],:{}\s]*$/.test(u.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){obj=$.parseJSON(u);$("#chqBookId").val(obj.chqBookId);$("#chqBookNo").val(obj.chqBookNo);$("#approvalStatus").val("Initiated");$("#statusTitle").html("Initiated");v="Cheque Book Successfully Processed!";j=bootbox.alert({size:"small",title:"Rhomicom Message",message:v,callback:function(){$("#"+o).modal("hide");getCustData("","#allmodules","grp=17&typ=1&pg=3&subPgNo=3.4.1")}})}else{v=u;j=bootbox.alert({size:"small",title:"Rhomicom Message",message:v,callback:function(){getCustData("","#allmodules","grp=17&typ=1&pg=3&subPgNo=3.4.1")}})}j.find(".modal-content").css({"margin-top":function(){var y=$(window).height();var x=$(".modal-dialog").height();var z=(y-x-150)/2;return z+"px"}})}};t.open("POST","index.php",true);t.setRequestHeader("Content-type","application/x-www-form-urlencoded");t.send("grp=17&typ=1&pg=19&subPgNo=3.4.1&q=UPDATE&vtyp=0&chqBookId="+h+"&chqType="+p+"&acctID="+a+"&noOfPages="+m+"&chqNoFirst="+q+"&chqNoLast="+n+"&issueDate="+r+"&status="+e+"&chqBkFee="+b+"&chqBkFeeRvnueAcctID="+f+"&optn="+c)}}});d.find(".modal-content").css({"margin-top":function(){var t=$(window).height();var s=$(".modal-dialog").height();var u=(t-s-150)/2;return u+"px"}})}function submitChqForm(j,g){var a=typeof $("#chqId").val()==="undefined"?-1:$("#chqId").val();var k=typeof $("#chqNo").val()==="undefined"?-1:$("#chqNo").val();var e=typeof $("#comments").val()==="undefined"?"":$("#comments").val();var c=typeof $("#status").val()==="undefined"?"":$("#status").val();var h=validateChqForm(c,e);if(!h){return false}var d;var f;var b;b=bootbox.confirm({size:"small",message:"Are you sure you want to save and submit this change request form for approval?",callback:function(l){if(l){d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Saving and Submitting. Please Wait...</div>'});d.find(".modal-content").css({"margin-top":function(){var o=$(window).height();var n=$(".modal-dialog").height();var p=(o-n)/2;return p+"px"}});var m;if(window.XMLHttpRequest){m=new XMLHttpRequest()}else{m=new ActiveXObject("Microsoft.XMLHTTP")}m.onreadystatechange=function(){if(m.readyState===4&&m.status===200){var n=m.responseText;var o="";d.modal("hide");if(/^[\],:{}\s]*$/.test(n.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){obj=$.parseJSON(n);$("#chqId").val(obj.chqId);$("#approvalStatus").val("Initiated");$("#statusTitle").html("Initiated");o="Cheque Successfully saved and submitted for Approval!";f=bootbox.alert({size:"small",title:"Rhomicom Message",message:o,callback:function(){$("#"+j).modal("hide");getCustData("","#allmodules","grp=17&typ=1&pg=3&subPgNo=3.4.2")}})}else{o=n;f=bootbox.alert({size:"small",title:"Rhomicom Message",message:o,callback:function(){getCustData("","#allmodules","grp=17&typ=1&pg=3&subPgNo=3.4.2")}})}f.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=(q-p-150)/2;return r+"px"}})}};m.open("POST","index.php",true);m.setRequestHeader("Content-type","application/x-www-form-urlencoded");m.send("grp=17&typ=1&pg=19&subPgNo=3.4.2&q=UPDATE&vtyp=0&chqId="+a+"&chqNo="+k+"&comments="+e+"&status="+c)}}});b.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l-150)/2;return n+"px"}})}function validateChqBookForm(g,a,e,h,f,c,j,b,d){if(g===""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#chqType").css("border-color","red");$("#chqType").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select the <b>Cheque Type</b>!",callback:function(){}});return false}else{if((g=="Personal Cheque"||g=="Corporate Cheque"||g=="Group Cheque"||g=="Passbook"||g=="Loan Application Form")&&(a==""||a==-1)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#acctNo").css("border-color","red");$("#acctNo").css("border-width","2px");$("#chqType").css("border-color","#ccc");$("#chqType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select the <b>Linked Account</b>!",callback:function(){}});return false}else{if(e==""||Number(e)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#noOfPages").css("border-color","red");$("#noOfPages").css("border-width","2px");$("#acctNo").css("border-color","#ccc");$("#acctNo").css("border-width","1px");$("#chqType").css("border-color","#ccc");$("#chqType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter a positive <b>Number of Pages</b>!",callback:function(){}});return false}else{if(h===""||Number(h)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#chqNoFirst").css("border-color","red");$("#chqNoFirst").css("border-width","2px");$("#noOfPages").css("border-color","#ccc");$("#noOfPages").css("border-width","1px");$("#acctNo").css("border-color","#ccc");$("#acctNo").css("border-width","1px");$("#chqType").css("border-color","#ccc");$("#chqType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter the <b>Serial No</b> of the first cheque in the book",callback:function(){}});return false}else{if(f===""||Number(f)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#chqNoLast").css("border-color","red");$("#chqNoLast").css("border-width","2px");$("#chqNoFirst").css("border-color","#ccc");$("#chqNoFirst").css("border-width","1px");$("#noOfPages").css("border-color","#ccc");$("#noOfPages").css("border-width","1px");$("#acctNo").css("border-color","#ccc");$("#acctNo").css("border-width","1px");$("#chqType").css("border-color","#ccc");$("#chqType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter the <b>Serial No</b> of the last cheque in the book",callback:function(){}});return false}else{if(Number(h)>Number(f)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#chqNoLast").css("border-color","red");$("#chqNoLast").css("border-width","2px");$("#chqNoFirst").css("border-color","#ccc");$("#chqNoFirst").css("border-width","1px");$("#noOfPages").css("border-color","#ccc");$("#noOfPages").css("border-width","1px");$("#acctNo").css("border-color","#ccc");$("#acctNo").css("border-width","1px");$("#chqType").css("border-color","#ccc");$("#chqType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<b>Serial No</b> of the last cheque must be greater than the first",callback:function(){}});return false}else{if(c==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#status").css("border-color","red");$("#status").css("border-width","2px");$("#chqNoLast").css("border-color","#ccc");$("#chqNoLast").css("border-width","1px");$("#chqNoFirst").css("border-color","#ccc");$("#chqNoFirst").css("border-width","1px");$("#noOfPages").css("border-color","#ccc");$("#noOfPages").css("border-width","1px");$("#acctNo").css("border-color","#ccc");$("#acctNo").css("border-width","1px");$("#chqType").css("border-color","#ccc");$("#chqType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Cheque Book Status</b>!",callback:function(){}});return false}else{if(c=="Issued"&&(j==""||j=="undefined")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#issueDate").css("border-color","red");$("#issueDate").css("border-width","2px");$("#status").css("border-color","#ccc");$("#status").css("border-width","1px");$("#chqNoLast").css("border-color","#ccc");$("#chqNoLast").css("border-width","1px");$("#chqNoFirst").css("border-color","#ccc");$("#chqNoFirst").css("border-width","1px");$("#noOfPages").css("border-color","#ccc");$("#noOfPages").css("border-width","1px");$("#acctNo").css("border-color","#ccc");$("#acctNo").css("border-width","1px");$("#chqType").css("border-color","#ccc");$("#chqType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter the <b>Date</b> the cheque book was issued to customer!",callback:function(){}});return false}else{if((g=="Personal Cheque"||g=="Corporate Cheque"||g=="Group Cheque"||g=="Passbook"||g=="Loan Application Form")&&(d==""||d==-1)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#chqBkFeeRvnueAcct").css("border-color","red");$("#chqBkFeeRvnueAcct").css("border-width","2px");$("#issueDate").css("border-color","#ccc");$("#issueDate").css("border-width","1px");$("#status").css("border-color","#ccc");$("#status").css("border-width","1px");$("#chqNoLast").css("border-color","#ccc");$("#chqNoLast").css("border-width","1px");$("#chqNoFirst").css("border-color","#ccc");$("#chqNoFirst").css("border-width","1px");$("#noOfPages").css("border-color","#ccc");$("#noOfPages").css("border-width","1px");$("#acctNo").css("border-color","#ccc");$("#acctNo").css("border-width","1px");$("#chqType").css("border-color","#ccc");$("#chqType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Revenue Account</b>!",callback:function(){}});return false}else{$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#chqBkFeeRvnueAcct").css("border-color","#ccc");$("#chqBkFeeRvnueAcct").css("border-width","1px");$("#issueDate").css("border-color","#ccc");$("#issueDate").css("border-width","1px");$("#status").css("border-color","#ccc");$("#status").css("border-width","1px");$("#chqNoLast").css("border-color","#ccc");$("#chqNoLast").css("border-width","1px");$("#chqNoFirst").css("border-color","#ccc");$("#chqNoFirst").css("border-width","1px");$("#noOfPages").css("border-color","#ccc");$("#noOfPages").css("border-width","1px");$("#acctNo").css("border-color","#ccc");$("#acctNo").css("border-width","1px");$("#chqType").css("border-color","#ccc");$("#chqType").css("border-width","1px");return true}}}}}}}}}}function validateChqForm(a,b){if(a==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#status").css("border-color","red");$("#status").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select the <b>Cheque Status</b>!",callback:function(){}});return false}else{if(b==""||b.trim()==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#comments").css("border-color","red");$("#comments").css("border-width","2px");$("#status").css("border-color","#ccc");$("#status").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter a reason <b>(Comments)</b> for the new status of the cheque!",callback:function(){}});return false}else{$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#comments").css("border-color","#ccc");$("#comments").css("border-width","1px");$("#status").css("border-color","#ccc");$("#status").css("border-width","1px");return true}}}function deleteChqBook(d){var b;var a;var c;c=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Cheque Book?",callback:function(e){if(e){b=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});b.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;b.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=3&subPgNo=3.4.1")}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=19&subPgNo=3.4.1&q=DELETE&chqBookId="+d)}}});c.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function newSvngsPrdtOpenATab(b,a){openATab(b,a+"&prdtID="+$("#prdtID").val()+"&prdtTypeSEA="+$("#prdtType").val())}function saveProductMainData(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var m=$(".nav-tabs .active").text();var w=$(".nav-tabs .active").attr("id");var v=1;if(m.indexOf("Standard Events Accounting")>=0){v=2}var h;var ak=typeof $("#prdtID").val()==="undefined"?-1:$("#prdtID").val().trim().length===0?-1:$("#prdtID").val();var A=typeof $("#pdtCode").val()==="undefined"?"":$("#pdtCode").val();var S=typeof $("#prdtName").val()==="undefined"?"":$("#prdtName").val();var j=typeof $("#prdtDesc").val()==="undefined"?"":$("#prdtDesc").val();var l=typeof $("#prdtCrncy").val()==="undefined"?"":$("#prdtCrncy").val();var I=typeof $("#prdtType").val()==="undefined"?"":$("#prdtType").val();var B=typeof $("input[name='chrgInterest']:checked").val()==="undefined"?"":$("input[name='chrgInterest']:checked").val();var H=typeof $("#intRate").val()==="undefined"?0:$("#intRate").val().trim().length===0?0:$("#intRate").val();var u=typeof $("#accrualFrqncy").val()==="object"?"":$("#accrualFrqncy").val();var au=typeof $("#pstnFrqncy").val()==="object"?"":$("#pstnFrqncy").val();var ao=typeof $("#calcMethod").val()==="object"?"":$("#calcMethod").val();var an=typeof $("#calcType").val()==="object"?"":$("#calcType").val();var aC=typeof $("#crdtnFrqncy").val()==="object"?"":$("#crdtnFrqncy").val();var am=typeof $("#crdtnType").val()==="object"?"":$("#crdtnType").val();var Y=typeof $("#invstmntType").val()==="object"?"":$("#invstmntType").val();var V=typeof $("#drtnNo").val()==="undefined"?0:$("#drtnNo").val().trim().length===0?0:$("#drtnNo").val();var Q=typeof $("#drtnType").val()==="object"?"":$("#drtnType").val();var s=typeof $("#intRate1").val()==="undefined"?0:$("#intRate1").val().trim().length===0?0:$("#intRate1").val();var az=typeof $("#dscntRate").val()==="undefined"?0:$("#dscntRate").val().trim().length===0?0:$("#dscntRate").val();var at=typeof $("#minAmount").val()==="undefined"?0:$("#minAmount").val().trim().length===0?0:$("#minAmount").val();var F=typeof $("#maxAmount").val()==="undefined"?0:$("#maxAmount").val().trim().length===0?0:$("#maxAmount").val();var ay=typeof $("#invstmntFeeFlat").val()==="undefined"?0:$("#invstmntFeeFlat").val().trim().length===0?0:$("#invstmntFeeFlat").val();var W=typeof $("#invstmntFeePrcnt").val()==="undefined"?0:$("#invstmntFeePrcnt").val().trim().length===0?0:$("#invstmntFeePrcnt").val();var f=typeof $("#feeApplctnType").val()==="object"?"":$("#feeApplctnType").val();var R=typeof $("input[name='indCust']:checked").val()==="undefined"?"NO":"YES";var aw=typeof $("input[name='corpCust']:checked").val()==="undefined"?"NO":"YES";var af=typeof $("input[name='custGrp']:checked").val()==="undefined"?"NO":"YES";var D=typeof $("input[name='wtdwlLimitType']:checked").val()==="undefined"?"":$("input[name='wtdwlLimitType']:checked").val();var T=typeof $("#wtdwlLimitNo").val()==="undefined"?0:$("#wtdwlLimitNo").val().trim().length===0?0:$("#wtdwlLimitNo").val();var ai=typeof $("#wtdwlLimitAmt").val()==="undefined"?0:$("#wtdwlLimitAmt").val().trim().length===0?0:$("#wtdwlLimitAmt").val();var av=typeof $("#wtdwlPnltyFlat").val()==="undefined"?0:$("#wtdwlPnltyFlat").val().trim().length===0?0:$("#wtdwlPnltyFlat").val();var z=typeof $("#wtdwlPnltyPercent").val()==="undefined"?0:$("#wtdwlPnltyPercent").val().trim().length===0?0:$("#wtdwlPnltyPercent").val();var K=typeof $("input[name='chrgCOT']:checked").val()==="undefined"?"":$("input[name='chrgCOT']:checked").val();var ah=typeof $("#cotFreeWtdwlNo").val()==="undefined"?0:$("#cotFreeWtdwlNo").val().trim().length===0?0:$("#cotFreeWtdwlNo").val();var e=typeof $("#depstOpnBal").val()==="undefined"?0:$("#depstOpnBal").val().trim().length===0?0:$("#depstOpnBal").val();var ap=typeof $("#accBalMin").val()==="undefined"?0:$("#accBalMin").val().trim().length===0?0:$("#accBalMin").val();var aE=typeof $("input[name='ovdrftAllowed']:checked").val()==="undefined"?"":$("input[name='ovdrftAllowed']:checked").val();var ar=typeof $("input[name='useAsColtrl']:checked").val()==="undefined"?"":$("input[name='useAsColtrl']:checked").val();var ag=typeof $("#entryFees").val()==="undefined"?0:$("#entryFees").val().trim().length===0?0:$("#entryFees").val();var ac=typeof $("#closeFees").val()==="undefined"?0:$("#closeFees").val().trim().length===0?0:$("#closeFees").val();var o=typeof $("#reOpenFees").val()==="undefined"?0:$("#reOpenFees").val().trim().length===0?0:$("#reOpenFees").val();var aj=typeof $("#minBalForInterest").val()==="undefined"?0:$("#minBalForInterest").val().trim().length===0?0:$("#minBalForInterest").val();var L=typeof $("#svngsAccntnEvntId").val()==="undefined"?-1:$("#svngsAccntnEvntId").val().trim().length===0?-1:$("#svngsAccntnEvntId").val();var P=typeof $("#cashDepositDbtAccID").val()==="undefined"?-1:$("#cashDepositDbtAccID").val().trim().length===0?-1:$("#cashDepositDbtAccID").val();var ax=typeof $("#cashDepositCrdtAccID").val()==="undefined"?-1:$("#cashDepositCrdtAccID").val().trim().length===0?-1:$("#cashDepositCrdtAccID").val();var Z=typeof $("#chqDepositDbtAccID").val()==="undefined"?-1:$("#chqDepositDbtAccID").val().trim().length===0?-1:$("#chqDepositDbtAccID").val();var q=typeof $("#chqDepositCrdtAccID").val()==="undefined"?-1:$("#chqDepositCrdtAccID").val().trim().length===0?-1:$("#chqDepositCrdtAccID").val();var aq=typeof $("#cashWtdwlDbtAccID").val()==="undefined"?-1:$("#cashWtdwlDbtAccID").val().trim().length===0?-1:$("#cashWtdwlDbtAccID").val();var M=typeof $("#cashWtdwlCrdtAccID").val()==="undefined"?-1:$("#cashWtdwlCrdtAccID").val().trim().length===0?-1:$("#cashWtdwlCrdtAccID").val();var E=typeof $("#entryFeesDbtAccID").val()==="undefined"?-1:$("#entryFeesDbtAccID").val().trim().length===0?-1:$("#entryFeesDbtAccID").val();var X=typeof $("#entryFeesCrdtAccID").val()==="undefined"?-1:$("#entryFeesCrdtAccID").val().trim().length===0?-1:$("#entryFeesCrdtAccID").val();var aD=typeof $("#closeFeesDbtAccID").val()==="undefined"?-1:$("#closeFeesDbtAccID").val().trim().length===0?-1:$("#closeFeesDbtAccID").val();var C=typeof $("#closeFeesCrdtAccID").val()==="undefined"?-1:$("#closeFeesCrdtAccID").val().trim().length===0?-1:$("#closeFeesCrdtAccID").val();var x=typeof $("#reopenFeesDbtAccID").val()==="undefined"?-1:$("#reopenFeesDbtAccID").val().trim().length===0?-1:$("#reopenFeesDbtAccID").val();var al=typeof $("#reopenFeesCrdtAccID").val()==="undefined"?-1:$("#reopenFeesCrdtAccID").val().trim().length===0?-1:$("#reopenFeesCrdtAccID").val();var p=typeof $("#wtdwlPnltyFlatDbtAccID").val()==="undefined"?-1:$("#wtdwlPnltyFlatDbtAccID").val().trim().length===0?-1:$("#wtdwlPnltyFlatDbtAccID").val();var g=typeof $("#wtdwlPnltyFlatCrdtAccID").val()==="undefined"?-1:$("#wtdwlPnltyFlatCrdtAccID").val().trim().length===0?-1:$("#wtdwlPnltyFlatCrdtAccID").val();var n=typeof $("#wtdwlPnltyPrcntDbtAccID").val()==="undefined"?-1:$("#wtdwlPnltyPrcntDbtAccID").val().trim().length===0?-1:$("#wtdwlPnltyPrcntDbtAccID").val();var G=typeof $("#wtdwlPnltyPrcntCrdtAccID").val()==="undefined"?-1:$("#wtdwlPnltyPrcntCrdtAccID").val().trim().length===0?-1:$("#wtdwlPnltyPrcntCrdtAccID").val();var ab=typeof $("#cotFeeFlatDbtAccID").val()==="undefined"?-1:$("#cotFeeFlatDbtAccID").val().trim().length===0?-1:$("#cotFeeFlatDbtAccID").val();var ad=typeof $("#cotFeeFlatCrdtAccID").val()==="undefined"?-1:$("#cotFeeFlatCrdtAccID").val().trim().length===0?-1:$("#cotFeeFlatCrdtAccID").val();var k=typeof $("#invstmntFeeDbtAccID").val()==="undefined"?-1:$("#invstmntFeeDbtAccID").val().trim().length===0?-1:$("#invstmntFeeDbtAccID").val();var O=typeof $("#invstmntFeeCrdtAccID").val()==="undefined"?-1:$("#invstmntFeeCrdtAccID").val().trim().length===0?-1:$("#invstmntFeeCrdtAccID").val();var J=typeof $("#interesPyblDbtAccID").val()==="undefined"?-1:$("#interesPyblDbtAccID").val().trim().length===0?-1:$("#interesPyblDbtAccID").val();var aa=typeof $("#interesPyblCrdtAccID").val()==="undefined"?-1:$("#interesPyblCrdtAccID").val().trim().length===0?-1:$("#interesPyblCrdtAccID").val();var t=typeof $("#interesExpenseDbtAccID").val()==="undefined"?-1:$("#interesExpenseDbtAccID").val().trim().length===0?-1:$("#interesExpenseDbtAccID").val();var aB=typeof $("#interesExpenseCrdtAccID").val()==="undefined"?-1:$("#interesExpenseCrdtAccID").val().trim().length===0?-1:$("#interesExpenseCrdtAccID").val();var y=typeof $("#rvsnTtl").val()==="object"?0:$("#rvsnTtl").val();var aA=typeof $("#codeLnght").val()==="undefined"?10:$("#codeLnght").val();var ae=typeof $("#isStaffAccountProduct").val()==="undefined"?"No":$("#isStaffAccountProduct").val();var r=typeof $("#smsAlertFee").val()==="undefined"?0:$("#smsAlertFee").val().trim().length===0?0:$("#smsAlertFee").val();var U=typeof $("#smsAlertFeeRvnueAcctID").val()==="undefined"?-1:$("#smsAlertFeeRvnueAcctID").val().trim().length===0?-1:$("#smsAlertFeeRvnueAcctID").val();if(parseFloat(A.length)!=parseFloat(aA)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#codeLnght").css("border-color","red");$("#codeLnght").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'>Product Code Length must be "+aA+"</span>",callback:function(){}});return false}else{$("#codeLnght").css("border-color","#ccc");$("#codeLnght").css("border-width","1px")}if(d==1){}var N=new FormData();N.append("grp",17);N.append("typ",1);N.append("q","UPDATE");N.append("pg",a);N.append("subPgNo",c);N.append("vtyp",b);N.append("prdtID",ak);N.append("pdtCode",A);N.append("prdtName",S);N.append("prdtDesc",j);N.append("prdtCrncy",l);N.append("prdtType",I);N.append("chrgInterest",B);N.append("intRate",H);N.append("accrualFrqncy",u);N.append("pstnFrqncy",au);N.append("calcMethod",ao);N.append("calcType",an);N.append("indCust",R);N.append("corpCust",aw);N.append("custGrp",af);N.append("wtdwlLimitType",D);N.append("wtdwlLimitNo",T);N.append("wtdwlLimitAmt",ai);N.append("wtdwlPnltyFlat",av);N.append("wtdwlPnltyPercent",z);N.append("chrgCOT",K);N.append("cotFreeWtdwlNo",ah);N.append("depstOpnBal",e);N.append("accBalMin",ap);N.append("ovdrftAllowed",aE);N.append("useAsColtrl",ar);N.append("entryFees",ag);N.append("closeFees",ac);N.append("reOpenFees",o);N.append("crdtnFrqncy",aC);N.append("crdtnType",am);N.append("invstmntType",Y);N.append("drtnNo",V);N.append("drtnType",Q);N.append("intRate1",s);N.append("dscntRate",az);N.append("minAmount",at);N.append("maxAmount",F);N.append("invstmntFeeFlat",ay);N.append("invstmntFeePrcnt",W);N.append("feeApplctnType",f);N.append("svngsAccntnEvntId",L);N.append("cashDepositDbtAccID",P);N.append("cashDepositCrdtAccID",ax);N.append("chqDepositDbtAccID",Z);N.append("chqDepositCrdtAccID",q);N.append("cashWtdwlDbtAccID",aq);N.append("cashWtdwlCrdtAccID",M);N.append("entryFeesDbtAccID",E);N.append("entryFeesCrdtAccID",X);N.append("closeFeesDbtAccID",aD);N.append("closeFeesCrdtAccID",C);N.append("reopenFeesDbtAccID",x);N.append("reopenFeesCrdtAccID",al);N.append("wtdwlPnltyFlatDbtAccID",p);N.append("wtdwlPnltyFlatCrdtAccID",g);N.append("wtdwlPnltyPrcntDbtAccID",n);N.append("wtdwlPnltyPrcntCrdtAccID",G);N.append("cotFeeFlatDbtAccID",ab);N.append("cotFeeFlatCrdtAccID",ad);N.append("invstmntFeeDbtAccID",k);N.append("invstmntFeeCrdtAccID",O);N.append("interesPyblDbtAccID",J);N.append("interesPyblCrdtAccID",aa);N.append("interesExpenseDbtAccID",t);N.append("interesExpenseCrdtAccID",aB);N.append("shdSbmt",d);N.append("myFormPage",v);N.append("rvsnTtl",y);N.append("isStaffAccountProduct",ae);N.append("minBalForInterest",aj);N.append("smsAlertFee",r);N.append("smsAlertFeeRvnueAcctID",U);if(d===1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.confirm({title:"Rhomicom Message",message:"Are you sure you want to submit this Product for Authorization? Note: This action cannot be undone",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(aF){if(aF){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:N,async:true,success:function(aG){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var aH="";if(/^[\],:{}\s]*$/.test(aG.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){h=$.parseJSON(aG);ak=h.prdtID;aH="Product submitted successfully for AUTHORIZATION"}else{aH=aG}if(ak>0){if(v==2){newSvngsPrdtOpenATab("#prfBPStndEvntsAcctEDT","grp=17&typ=1&pg=12&subPgNo=7.1&vtyp=1&vtypActn=EDIT&prdtID="+ak+"&rvsnTtlAPD="+y);bootbox.alert({size:"small",title:"Rhomicom Message",message:aH,callback:function(){}})}else{getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Savings and Investment Product",12,7.1,0,"EDIT",h.prdtID,"","indCustTableRow1",-1,function(){bootbox.alert({size:"small",title:"Rhomicom Message",message:aH,callback:function(){}})})}}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:aH,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})}else{var h;$.ajax({url:"index.php",type:"POST",data:N,async:true,success:function(aF){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var aG="";if(/^[\],:{}\s]*$/.test(aF.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){h=$.parseJSON(aF);ak=h.prdtID;aG="Savings Product Successfully Saved!"}else{aG=aF}if(parseFloat(ak)>0){if(v==2){newSvngsPrdtOpenATab("#prfBPStndEvntsAcctEDT","grp=17&typ=1&pg=12&subPgNo=7.1&vtyp=1&vtypActn=EDIT&prdtID="+ak+"&rvsnTtlAPD="+y);bootbox.alert({size:"small",title:"Rhomicom Message",message:aG,callback:function(){}})}else{getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Savings and Investment Product",12,7.1,0,"EDIT",ak,"","indCustTableRow1",-1,function(){bootbox.alert({size:"small",title:"Rhomicom Message",message:aG,callback:function(){}})})}}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:aG,callback:function(){}})}},cache:false,contentType:false,processData:false})}})}function getSvngsPrdtData(d,a,j){var c;var h;if($("#addOrEditForm").val()==="Add"){$("#dataAdminSrchFor").val($("#pdtCode").val());var c=$("#dataAdminSrchFor").val();$("#dataAdminSrchIn").val("Product Code");var h=$("#dataAdminSrchIn").val()}else{c=typeof $("#dataAdminSrchFor").val()==="undefined"?"%":$("#dataAdminSrchFor").val();h=typeof $("#dataAdminSrchIn").val()==="undefined"?"Both":$("#dataAdminSrchIn").val()}var b=typeof $("#dataAdminPageNo").val()==="undefined"?1:$("#dataAdminPageNo").val();var f=typeof $("#dataAdminDsplySze").val()==="undefined"?10:$("#dataAdminDsplySze").val();var g=typeof $("#dataAdminSortBy").val()==="undefined"?"":$("#dataAdminSortBy").val();var e=typeof $("#dataAdminOtherPrsnType").val()==="undefined"?"":$("#dataAdminOtherPrsnType").val();if(d=="clear"){c="%";b=1}else{if(d=="next"){b=parseInt(b)+1}else{if(d=="previous"){b=parseInt(b)-1}}}j=j+"&searchfor="+c+"&searchin="+h+"&pageNo="+b+"&limitSze="+f+"&sortBy="+g+"&prsnType="+e;openATab(a,j)}function updateSvngsPrdtListData(){if($("#addOrEditForm").val()==="Add"){getSvngsPrdtData("","#allmodules","grp=17&typ=1&pg=7&subPgNo=7.1")}else{var k=$("#pdtCode").val();var j=$("#prdtName").val();var c=$("#prdtDesc").val();var g=$("#prdtCrncy").val();var d=$("#prdtType").val();var a;var l=typeof $("input[name='indCust']:checked").val()==="undefined"?"NO":"YES";var f=typeof $("input[name='corpCust']:checked").val()==="undefined"?"NO":"YES";var b=typeof $("input[name='custGrp']:checked").val()==="undefined"?"NO":"YES";if(l=="YES"&&f=="YES"){a="Individual Customer, Corporate Customer"}else{if(l=="YES"&&f=="YES"&&b=="Yes"){a="Individual Customer, Corporate Customer, Customer Group"}else{if(l=="YES"&&f=="YES"&&b=="NO"){a="Individual Customer, Corporate Customer"}else{if(l=="YES"&&f=="NO"&&b=="NO"){a="Individual Customer"}else{if(l=="YES"&&f=="NO"&&b=="YES"){a="Individual Customer, Customer Group"}else{if(l=="NO"&&f=="YES"&&b=="Yes"){a="Corporate Customer, Customer Group"}else{if(l=="NO"&&f=="NO"&&b=="Yes"){a="Customer Group"}else{if(l=="NO"&&f=="YES"&&b=="NO"){a="Corporate Customer"}else{if(l=="NO"&&f=="NO"&&b=="NO"){a=""}}}}}}}}}var h=$("#tblRowID").val();var e=1;$("#"+h).find("td").each(function(){switch(e){case 4:$(this).html(k);break;case 5:$(this).html(j);break;case 6:$(this).html(c);break;case 7:$(this).html(g);break;case 8:$(this).html(d);break;case 9:$(this).html(a);break}e=e+1})}}function deleteSvngsPrdt(d){var b;var a;var c;c=bootbox.confirm({size:"small",message:"Are you sure you want to delete this product?",callback:function(e){if(e){b=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});b.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;b.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getSvngsPrdtData("","#allmodules","grp=17&typ=1&pg=7&subPgNo=7.1")}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=12&subPgNo=7.1&q=DELETE&prdtID="+d)}}});c.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function getSvngsWtdwlForm(j,k,b,g,m,l,c,e,f,h,d){$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(l);$("#"+k).html(a.responseText);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(f===5&&h==="EDIT"){var n=$("#"+m).find("td");$("#lowRange").val($.trim(n.eq(3).text()));$("#highRange").val($.trim(n.eq(4).text()));$("#amountFlat").val($.trim(n.eq(5).text()));$("#amountPrcnt").val($.trim(n.eq(6).text()));$("#remarks").val($.trim(n.eq(7).text()));$("#tblRowElementID").val(m)}$("#"+j).on("show.bs.modal",function(o){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+j).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){$("#"+g).submit(function(o){o.preventDefault();return false})})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+h+"&rowID="+d)}function saveSvngsWtdwlCmsnForm(l,h){var e;$body=$("body");$body.addClass("mdlloadingDiag");var k=typeof $("#lowRange").val()==="undefined"?0:$("#lowRange").val().trim().length===0?0:$("#lowRange").val();var b=typeof $("#highRange").val()==="undefined"?0:$("#highRange").val().trim().length===0?0:$("#highRange").val();var j=typeof $("#amountFlat").val()==="undefined"?0:$("#amountFlat").val().trim().length===0?0:$("#amountFlat").val();var d=typeof $("#amountPrcnt").val()==="undefined"?0:$("#amountPrcnt").val().trim().length===0?0:$("#amountPrcnt").val();var g=typeof $("#remarks").val()==="undefined"?"":$("#remarks").val();var c=typeof $("#prdtID").val()==="undefined"?-1:$("#prdtID").val();var m=typeof $("#tblRowElementID").val()==="undefined"?-1:$("#tblRowElementID").val();var f=typeof $("#rvsnTtl").val()==="undefined"?-1:$("#rvsnTtl").val();var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){var p="";var o=a.responseText;var n=-1;if(/^[\],:{}\s]*$/.test(o.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=$.parseJSON(o);n=e.rowID}getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Savings and Investment Product",12,7.1,0,"EDIT",c,"","indCustTableRow1",-1,function(){bootbox.alert({size:"small",title:"Rhomicom Message",message:o,callback:function(){}});$body.removeClass("mdlloadingDiag");$("#"+l).modal("hide")})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg=12&subPgNo=7.1&vtyp=5&q=UPDATE&lowRange="+k+"&highRange="+b+"&amountFlat="+j+"&amountPrcnt="+d+"&remarks="+g+"&rowID="+h+"&prdtID="+c+"&rvsnTtl="+f)}function createDisbmntPymntCustAccount(){var b=1;var a=bootbox.confirm({title:"Finalize Request?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">CREATE LOAN PAYMENT ACCOUNTS</span> for Bank Branches?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(c){if(c===true){var d=bootbox.alert({title:"Create Loan Payment Account for Branches?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Finalizing Request...Please Wait...</p>',callback:function(){if(b>0){getSvngsPrdtData("","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.1")}}});d.init(function(){if(b>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,q:"LNPYACCT"},success:function(e){setTimeout(function(){d.find(".bootbox-body").html(e)},500)},error:function(g,e,f){d.find(".bootbox-body").html(f)}})})}else{setTimeout(function(){d.find(".bootbox-body").html('<span style="color:red;">Nothing to Withdraw!</span>')},500)}})}}})}function getCustAcctsForm(l,m,c,o,d,f,g,j,e,a,k,h,n){$("#allOtherInputData99").val(0);if(h===""||h==="undefined"){h=$("#acctNoFind").val()}if(typeof n==="undefined"||n===null){n=function(){var p=1}}accMandate=["--Please Select--","All to sign","Anyone to sign","Any two to sign","Any three to sign","Any four to sign","Both to sign"];$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+m).html(b.responseText);var q=$("#status").val();$("#"+c).html(o);$("#"+l).off("hidden.bs.modal");$("#"+l).one("hidden.bs.modal",function(r){if(j!=="VIEW"){getCustData("","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.1")}$("#"+c).html("");$("#"+m).html("");$(r.currentTarget).unbind()});$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(!$.fn.DataTable.isDataTable("#"+a)){var p=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{p.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{p.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){$("#prpsOfAcct").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"335px"});$("#acctTrnsTyp").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"335px"});$("#srcOfFunds").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"335px",maxHeight:250});$("#smsTriggers").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"335px",maxHeight:250});if(j!=="VIEW"){}if(e>0){if(q=="Initiated"){$("#withdrawCustAccountBtn").css("display","inline-block");$("#saveCustAccountBtn").css("display","none");$("#submitCustAccountBtn").css("display","none");$("#getSigntryBtn").css("display","none")}else{if(q=="Incomplete"||q=="Rejected"||q=="Withdrawn"||q=="Requires Reapproval"){$("#withdrawCustAccountBtn").css("display","none");$("#saveCustAccountBtn").css("display","inline-block");$("#submitCustAccountBtn").css("display","inline-block");$("#getSigntryBtn").css("display","block")}else{if(q=="Approved"){$("#withdrawCustAccountBtn").css("display","none");$("#saveCustAccountBtn").css("display","inline-block");$("#submitCustAccountBtn").css("display","none");$("#getSigntryBtn").css("display","block")}}}}n()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+j+"&PKeyID="+e+"&acctNo="+h)}function getCustAcctsForm_OLD(l,m,c,o,d,f,g,j,e,a,k,h,n){$("#allOtherInputData99").val(0);if(h===""||h==="undefined"){h=$("#acctNoFind").val()}if(typeof n==="undefined"||n===null){n=function(){var p=1}}accMandate=["--Please Select--","All to sign","Anyone to sign","Any two to sign","Any three to sign","Any four to sign","Both to sign"];$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+m).html(b.responseText);var q=$("#status").val();$("#"+c).html(o);$("#"+l).off("hidden.bs.modal");$("#"+l).one("hidden.bs.modal",function(r){if(j!=="VIEW"){getCustData("","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.1")}$("#"+c).html("");$("#"+m).html("");$(r.currentTarget).unbind()});$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(!$.fn.DataTable.isDataTable("#"+a)){var p=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{p.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{p.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){$("#prpsOfAcct").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"335px"});$("#acctTrnsTyp").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"335px"});$("#srcOfFunds").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"335px",maxHeight:250});if(j!=="VIEW"){}if(e>0){if(q=="Initiated"){$("#withdrawCustAccountBtn").css("display","inline-block");$("#saveCustAccountBtn").css("display","none");$("#submitCustAccountBtn").css("display","none");$("#getSigntryBtn").css("display","none")}else{if(q=="Incomplete"||q=="Rejected"||q=="Withdrawn"||q=="Requires Reapproval"){$("#withdrawCustAccountBtn").css("display","none");$("#saveCustAccountBtn").css("display","inline-block");$("#submitCustAccountBtn").css("display","inline-block");$("#getSigntryBtn").css("display","block")}else{if(q=="Approved"){$("#withdrawCustAccountBtn").css("display","none");$("#saveCustAccountBtn").css("display","inline-block");$("#submitCustAccountBtn").css("display","none");$("#getSigntryBtn").css("display","block")}}}}n()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+j+"&PKeyID="+e+"&acctNo="+h)}function updateCustAccountsListData1(){return true;if($("#addOrEditForm").val()==="Add"){getSvngsPrdtData("","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.1")}else{var k=$("#pdtCode").val();var j=$("#prdtName").val();var c=$("#prdtDesc").val();var g=$("#prdtCrncy").val();var d=$("#prdtType").val();var a;var l=typeof $("input[name='indCust']:checked").val()==="undefined"?"NO":"YES";var f=typeof $("input[name='corpCust']:checked").val()==="undefined"?"NO":"YES";var b=typeof $("input[name='custGrp']:checked").val()==="undefined"?"NO":"YES";if(l=="YES"&&f=="YES"){a="Individual Customer, Corporate Customer"}else{if(l=="YES"&&f=="YES"&&b=="Yes"){a="Individual Customer, Corporate Customer, Customer Group"}else{if(l=="YES"&&f=="YES"&&b=="NO"){a="Individual Customer, Corporate Customer"}else{if(l=="YES"&&f=="NO"&&b=="NO"){a="Individual Customer"}else{if(l=="YES"&&f=="NO"&&b=="YES"){a="Individual Customer, Customer Group"}else{if(l=="NO"&&f=="YES"&&b=="Yes"){a="Corporate Customer, Customer Group"}else{if(l=="NO"&&f=="NO"&&b=="Yes"){a="Customer Group"}else{if(l=="NO"&&f=="YES"&&b=="NO"){a="Corporate Customer"}else{if(l=="NO"&&f=="NO"&&b=="NO"){a=""}}}}}}}}}var h=$("#tblRowID").val();var e=1;$("#"+h).find("td").each(function(){switch(e){case 4:$(this).html(k);break;case 5:$(this).html(j);break;case 6:$(this).html(c);break;case 7:$(this).html(g);break;case 8:$(this).html(d);break;case 9:$(this).html(a);break}e=e+1})}}function onClickSvngsProduct(a,b){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","Bank Product Types","","acctType","","radio",true,"","prdtTypeID","prdtType","clear",1,"",function(){getSvngsPrdtDetsForAccnt(a,b)})}function viewCustProfile(){var b=$("#bnkCustomerID").val();if(b==="undefined"||b===""){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Please select a customer first!",callback:function(){}});return false}else{var d=$("#custType").val();var a=1.1;if(d=="Corporate"){a=1.2}else{if(d=="Group"){a=1.3}else{if(d=="Joint-Individual"){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! No profile for Joint Indivual Customers",callback:function(){}});return false}}}var c=typeof $("#grpApplicantType").val()==="undefined"?"N/A":$("#grpApplicantType").val();if(c=="Individual"){a=1.1}getCustomersForm("myFormsModalLgCA","myFormsModalBodyLgCA","myFormsModalTitleLgCA","Customer Profile",11,a,0,"VIEW",b,"","indCustTableRow1",-1,function(){var e=1},1)}}function deleteCustAccnt(b,c){var d;var a;var e;e=bootbox.confirm({size:"small",message:"Are you sure you want to delete this account?",callback:function(f){if(f){if(!(c=="Incomplete"||c=="Rejected"||c=="Withdrawn")){e.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Accunts with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});d.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j)/2;return l+"px"}});var g;if(window.XMLHttpRequest){g=new XMLHttpRequest()}else{g=new ActiveXObject("Microsoft.XMLHTTP")}g.onreadystatechange=function(){if(g.readyState===4&&g.status===200){var h=g.responseText;d.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:h,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.1")}};g.open("POST","index.php",true);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send("grp=17&typ=1&pg=13&subPgNo=2.1&q=DELETE&vtyp=0&PKeyID="+b)}}});e.find(".modal-content").css({"margin-top":function(){var g=$(window).height();var f=$(".modal-dialog").height();var j=(g-f-150)/2;return j+"px"}})}function validateCustAcctsForm(r,o,f,l,k,d,m,h,b,g,j,s,a,p,e,n,c,q){if(r==="--Please Select--"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#custType").css("border-color","red");$("#custType").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select the <b>Type</b> of customer!",callback:function(){}});return false}else{if(o==""||o==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#bnkCustomer").css("border-color","red");$("#bnkCustomer").css("border-width","2px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Customer</b>!",callback:function(){}});return false}else{if(f==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#acctTitle").css("border-color","red");$("#acctTitle").css("border-width","2px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide an <b>Account Title</b>!",callback:function(){}});return false}else{if(l==="--Please Select--"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#acctType").css("border-color","red");$("#acctType").css("border-width","2px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select an <b>Account Type</b>",callback:function(){}});return false}else{if(k==""||k==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prdtType").css("border-color","red");$("#prdtType").css("border-width","2px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Product</b>!",callback:function(){}});return false}else{if(d==""||d=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#acctTrnsTyp").css("border-color","red");$("#acctTrnsTyp").css("border-width","2px");$("#acctTrnsTypLbl").css("color","red");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select at lease one <b>Transaction Type</b>!",callback:function(){}});return false}else{if(m==""||m=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prsnTypeEntity").css("border-color","red");$("#prsnTypeEntity").css("border-width","2px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select <b>Person Type/Entity</b>!",callback:function(){}});return false}else{if(h==""||h=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prpsOfAcct").css("border-color","red");$("#prpsOfAcct").css("border-width","2px");$("#prpsOfAcctLbl").css("color","red");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select at least one <b>Purpose</b>!",callback:function(){}});return false}else{if(h=="Other"&&(b.trim()=="")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prpsOfAcctOther").css("border-color","red");$("#prpsOfAcctOther").css("border-width","2px");$("#prpsOfAcct").css("border-color","#ccc");$("#prpsOfAcct").css("border-width","1px");$("#prpsOfAcctLbl").css("color","#333");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide some purpose(s) other than the predefined list above!",callback:function(){}});return false}else{if(g==""||g=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#srcOfFunds").css("border-color","red");$("#srcOfFunds").css("border-width","2px");$("#srcOfFundsLbl").css("color","red");$("#prpsOfAcctOther").css("border-color","#ccc");$("#prpsOfAcctOther").css("border-width","1px");$("#prpsOfAcct").css("border-color","#ccc");$("#prpsOfAcct").css("border-width","1px");$("#prpsOfAcctLbl").css("color","#333");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select at least one <b>Source of Funds</b>!",callback:function(){}});return false}else{if(g=="Other Income"&&(j.trim()=="")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#srcOfFundsOther").css("border-color","red");$("#srcOfFundsOther").css("border-width","2px");$("#srcOfFunds").css("border-color","#ccc");$("#srcOfFunds").css("border-width","1px");$("#srcOfFundsLbl").css("color","#333");$("#prpsOfAcctOther").css("border-color","#ccc");$("#prpsOfAcctOther").css("border-width","1px");$("#prpsOfAcct").css("border-color","#ccc");$("#prpsOfAcct").css("border-width","1px");$("#prpsOfAcctLbl").css("color","#333");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide some funds source(s) other than the predefined list above",callback:function(){}});return false}else{if(parseFloat(s)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#trnsPerMnthNo").css("border-color","red");$("#trnsPerMnthNo").css("border-width","2px");$("#srcOfFundsOther").css("border-color","#ccc");$("#srcOfFundsOther").css("border-width","1px");$("#srcOfFunds").css("border-color","#ccc");$("#srcOfFunds").css("border-width","1px");$("#srcOfFundsLbl").css("color","#333");$("#prpsOfAcctOther").css("border-color","#ccc");$("#prpsOfAcctOther").css("border-width","1px");$("#prpsOfAcct").css("border-color","#ccc");$("#prpsOfAcct").css("border-width","1px");$("#prpsOfAcctLbl").css("color","#333");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<b>Expected Monthly Transaction Volume</b> must be greater than 0",callback:function(){}});return false}else{if(Number(s)>0&&Number(a)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#amountPerMnth").css("border-color","red");$("#amountPerMnth").css("border-width","2px");$("#trnsPerMnthNo").css("border-color","#ccc");$("#trnsPerMnthNo").css("border-width","1px");$("#srcOfFundsOther").css("border-color","#ccc");$("#srcOfFundsOther").css("border-width","1px");$("#srcOfFunds").css("border-color","#ccc");$("#srcOfFunds").css("border-width","1px");$("#srcOfFundsLbl").css("color","#333");$("#prpsOfAcctOther").css("border-color","#ccc");$("#prpsOfAcctOther").css("border-width","1px");$("#prpsOfAcct").css("border-color","#ccc");$("#prpsOfAcct").css("border-width","1px");$("#prpsOfAcctLbl").css("color","#333");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<b>Expected Monthly Amount</b> must be greater than zero!",callback:function(){}});return false}else{if(1==1&&(e==""||e==-1)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#reltnOfficer").css("border-color","red");$("#reltnOfficer").css("border-width","2px");$("#amountPerMnth").css("border-color","#ccc");$("#amountPerMnth").css("border-width","1px");$("#trnsPerMnthNo").css("border-color","#ccc");$("#trnsPerMnthNo").css("border-width","1px");$("#srcOfFundsOther").css("border-color","#ccc");$("#srcOfFundsOther").css("border-width","1px");$("#srcOfFunds").css("border-color","#ccc");$("#srcOfFunds").css("border-width","1px");$("#srcOfFundsLbl").css("color","#333");$("#prpsOfAcctOther").css("border-color","#ccc");$("#prpsOfAcctOther").css("border-width","1px");$("#prpsOfAcct").css("border-color","#ccc");$("#prpsOfAcct").css("border-width","1px");$("#prpsOfAcctLbl").css("color","#333");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a <b>Relationship Officer</b> for this account!",callback:function(){}});return false}else{if(n==="--Please Select--"||n==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#accMndte").css("border-color","red");$("#accMndte").css("border-width","2px");$("#reltnOfficer").css("border-color","#ccc");$("#reltnOfficer").css("border-width","1px");$("#amountPerMnth").css("border-color","#ccc");$("#amountPerMnth").css("border-width","1px");$("#trnsPerMnthNo").css("border-color","#ccc");$("#trnsPerMnthNo").css("border-width","1px");$("#srcOfFundsOther").css("border-color","#ccc");$("#srcOfFundsOther").css("border-width","1px");$("#srcOfFunds").css("border-color","#ccc");$("#srcOfFunds").css("border-width","1px");$("#srcOfFundsLbl").css("color","#333");$("#prpsOfAcctOther").css("border-color","#ccc");$("#prpsOfAcctOther").css("border-width","1px");$("#prpsOfAcct").css("border-color","#ccc");$("#prpsOfAcct").css("border-width","1px");$("#prpsOfAcctLbl").css("color","#333");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Mandate</b> for this account",callback:function(){}});return false}else{if(c<=-1&&q!="Everyone"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#groupName").css("border-color","red");$("#groupName").css("border-width","2px");$("#accMndte").css("border-color","#ccc");$("#accMndte").css("border-width","1px");$("#reltnOfficer").css("border-color","#ccc");$("#reltnOfficer").css("border-width","1px");$("#amountPerMnth").css("border-color","#ccc");$("#amountPerMnth").css("border-width","1px");$("#trnsPerMnthNo").css("border-color","#ccc");$("#trnsPerMnthNo").css("border-width","1px");$("#srcOfFundsOther").css("border-color","#ccc");$("#srcOfFundsOther").css("border-width","1px");$("#srcOfFunds").css("border-color","#ccc");$("#srcOfFunds").css("border-width","1px");$("#srcOfFundsLbl").css("color","#333");$("#prpsOfAcctOther").css("border-color","#ccc");$("#prpsOfAcctOther").css("border-width","1px");$("#prpsOfAcct").css("border-color","#ccc");$("#prpsOfAcct").css("border-width","1px");$("#prpsOfAcctLbl").css("color","#333");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select an <b>Allowed Group Name</b> for this account",callback:function(){}});return false}else{$("#groupName").css("border-color","#ccc");$("#groupName").css("border-width","1px");$("#accMndte").css("border-color","#ccc");$("#accMndte").css("border-width","1px");$("#reltnOfficer").css("border-color","#ccc");$("#reltnOfficer").css("border-width","1px");$("#amountPerMnth").css("border-color","#ccc");$("#amountPerMnth").css("border-width","1px");$("#trnsPerMnthNo").css("border-color","#ccc");$("#trnsPerMnthNo").css("border-width","1px");$("#srcOfFundsOther").css("border-color","#ccc");$("#srcOfFundsOther").css("border-width","1px");$("#srcOfFunds").css("border-color","#ccc");$("#srcOfFunds").css("border-width","1px");$("#srcOfFundsLbl").css("color","#333");$("#prpsOfAcctOther").css("border-color","#ccc");$("#prpsOfAcctOther").css("border-width","1px");$("#prpsOfAcct").css("border-color","#ccc");$("#prpsOfAcct").css("border-width","1px");$("#prpsOfAcctLbl").css("color","#333");$("#prsnTypeEntity").css("border-color","#ccc");$("#prsnTypeEntity").css("border-width","1px");$("#acctTrnsTyp").css("border-color","#ccc");$("#acctTrnsTyp").css("border-width","1px");$("#acctTrnsTypLbl").css("color","#333");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#acctType").css("border-color","#ccc");$("#acctType").css("border-width","1px");$("#acctTitle").css("border-color","#ccc");$("#acctTitle").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");return true}}}}}}}}}}}}}}}}}function saveCustAccountsData(a,d,c,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var l=$("#prpsOfAcct option:selected").map(function(){return $(this).val()}).get();var t=$("#srcOfFunds option:selected").map(function(){return $(this).val()}).get();var H=$("#acctTrnsTyp option:selected").map(function(){return $(this).val()}).get();var M=$("#smsTriggers option:selected").map(function(){return $(this).val()}).get();var f;var A=typeof $("#custType").val()==="undefined"?"":$("#custType").val();var L=typeof $("#bnkCustomerID").val()==="undefined"?-1:$("#bnkCustomerID").val();var E=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val().trim().length===0?-1:$("#acctID").val();var J=typeof $("#acctNumber").val()==="undefined"?"":$("#acctNumber").val();var C=typeof $("#acctTitle").val()==="undefined"?"":$("#acctTitle").val();var g=typeof $("#acctType").val()==="undefined"?"":$("#acctType").val();var P=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();var O=H;var x=typeof $("#prsnTypeEntity").val()==="undefined"?"":$("#prsnTypeEntity").val();var N=typeof $("#prdtCrncy").val()==="undefined"?"":$("#prdtCrncy").val();var w=l;var k=typeof $("#prpsOfAcctOther").val()==="undefined"?-1:$("#prpsOfAcctOther").val();var o=t;var u=typeof $("#srcOfFundsOther").val()==="undefined"?-1:$("#srcOfFundsOther").val();var B=typeof $("#trnsPerMnthNo").val()==="undefined"?-1:$("#trnsPerMnthNo").val().trim().length===0?0:$("#trnsPerMnthNo").val();var y=typeof $("#amountPerMnth").val()==="undefined"?-1:$("#amountPerMnth").val().trim().length===0?0:$("#amountPerMnth").val();var G=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var p=typeof $("#reltnOfficerID").val()==="undefined"?"":$("#reltnOfficerID").val();var v=typeof $("#closeReason").val()==="undefined"?"":$("#closeReason").val();var D=typeof $("#status").val()==="undefined"?-1:$("#status").val();var z=typeof $("#accMndte").val()==="undefined"?-1:$("#accMndte").val();var n=typeof $("#grpType").val()==="undefined"?"Everyone":$("#grpType").val();var m=typeof $("#groupID").val()==="undefined"?-1:$("#groupID").val();var j=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var q=typeof $("#canOverdrawAcct").val()==="undefined"?"No":$("#canOverdrawAcct").val();var K=M;var e=validateCustAcctsForm(A,L,C,g,P,O,x,w,k,o,u,B,y,G,p,z,m,n);if(!e){return false}var r;var s="Are you sure you want to submit account for Approval?";if(b===1){r=2;var z=typeof $("#accMndte").val()==="undefined"?-1:$("#accMndte").val();var F=0;if(z==="Anyone to sign"){F=1}else{if(z==="Any two to sign"){F=2}else{if(z==="Any three to sign"){F=3}else{if(z==="Any four to sign"){F=4}else{if(z==="All to sign"){F=1}else{if(z==="Both to sign"){F=2}else{if(z==="Only to sign"){F=1}}}}}}}if(Number($("table#acctSignatoryTblAdd tbody tr:last").index()+1)<Number(F)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide at least <b>"+F+" Signatory(s)</b> before submitting this account for approval!",callback:function(){}});return false}else{if(z==="Only to sign"&&(Number($("table#acctSignatoryTblAdd tbody tr:last").index()+1)>1)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>One signatory</b> is required. </br>Please delete excess signatories!",callback:function(){}});return false}else{if(z==="Both to sign"&&(Number($("table#acctSignatoryTblAdd tbody tr:last").index()+1)>2)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>Two signatories</b> are required. </br>Please delete excess signatories!",callback:function(){}});return false}else{var I=0;$("table#acctSignatoryTblAdd tr").each(function(){if($(this).find("td:eq(5)").text()=="Yes"){I=I+1}});if(z==="Anyone to sign"&&Number(I)>1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>One Mandatory Signatory</b> is required, but "+I+" specified</br>Please do needful!",callback:function(){}});return false}else{if(z==="Any two to sign"&&Number(I)>2){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>Two Mandatory Signatories</b> are required, but "+I+" specified</br>Please do needful!",callback:function(){}});return false}else{if(z==="Any three to sign"&&Number(I)>2){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>Three Mandatory Signatories</b> are required, but "+I+" specified</br>Please do needful!",callback:function(){}});return false}else{if(z==="Any four to sign"&&Number(I)>2){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>Four Mandatory Signatories</b> are required, but "+I+" specified</br>Please do needful!",callback:function(){}});return false}}}}}}}}var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("q","UPDATE");h.append("pg",a);h.append("subPgNo",d);h.append("vtyp",c);h.append("acctID",E);h.append("acctNumber",J);h.append("acctTitle",C);h.append("actyp",1);h.append("acctType",g);h.append("prdtCrncy",N);h.append("prdtTypeID",P);h.append("acctTrnsTyp",O);h.append("prsnTypeEntity",x);h.append("custType",A);h.append("bnkCustomerID",L);h.append("prpsOfAcct",w);h.append("prpsOfAcctOther",k);h.append("srcOfFunds",o);h.append("srcOfFundsOther",u);h.append("trnsPerMnthNo",B);h.append("amountPerMnth",y);h.append("bnkBranchID",G);h.append("reltnOfficerID",p);h.append("canOverdrawAcct",q);h.append("smsTriggers",K);h.append("statusReason",v);h.append("status",D);h.append("accMndte",z);h.append("grpType",n);h.append("groupID",m);h.append("rvsnTtl",j);h.append("shdSbmit",b);if(b===1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.confirm({title:"Rhomicom Message",message:s,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(Q){if(Q){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(R){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var S="";if(/^[\],:{}\s]*$/.test(R.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){f=$.parseJSON(R);E=f.acctID}else{}bootbox.alert({size:"small",title:"Rhomicom Message",message:"Customer Account Submitted Successfully",callback:function(){getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",E,"custAcctTable","indCustTableRow1")}})},cache:false,contentType:false,processData:false})}}})}else{$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(Q){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var R="";if(/^[\],:{}\s]*$/.test(Q.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){f=$.parseJSON(Q);E=f.acctID;$("#acctID").val(f.acctID);$("#acctNumber").val(f.acctNumber);$("#submitCustAccountBtn").css("display","inline-block");$("#standardEvtns").css("display","block");$("#customEvnts").css("display","block");R="Customer Accounts Successfully Saved!"}else{R=Q}if(E>0){bootbox.alert({size:"small",title:"Rhomicom Message",message:R,callback:function(){getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",E,"custAcctTable","indCustTableRow1")}})}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:R,callback:function(){}})}},cache:false,contentType:false,processData:false})}})}function saveCustAccountsData_old(a,d,c,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var l=$("#prpsOfAcct option:selected").map(function(){return $(this).val()}).get();var e=$("#srcOfFunds option:selected").map(function(){return $(this).val()}).get();var H=$("#acctTrnsTyp option:selected").map(function(){return $(this).val()}).get();var x;var N=typeof $("#custType").val()==="undefined"?"":$("#custType").val();var G=typeof $("#bnkCustomerID").val()==="undefined"?-1:$("#bnkCustomerID").val();var p=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val().trim().length===0?-1:$("#acctID").val();var q=typeof $("#acctNumber").val()==="undefined"?"":$("#acctNumber").val();var o=typeof $("#acctTitle").val()==="undefined"?"":$("#acctTitle").val();var y=typeof $("#acctType").val()==="undefined"?"":$("#acctType").val();var v=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();var m=H;var z=typeof $("#prsnTypeEntity").val()==="undefined"?"":$("#prsnTypeEntity").val();var J=typeof $("#prdtCrncy").val()==="undefined"?"":$("#prdtCrncy").val();var s=l;var j=typeof $("#prpsOfAcctOther").val()==="undefined"?-1:$("#prpsOfAcctOther").val();var r=e;var t=typeof $("#srcOfFundsOther").val()==="undefined"?-1:$("#srcOfFundsOther").val();var M=typeof $("#trnsPerMnthNo").val()==="undefined"?-1:$("#trnsPerMnthNo").val().trim().length===0?0:$("#trnsPerMnthNo").val();var f=typeof $("#amountPerMnth").val()==="undefined"?-1:$("#amountPerMnth").val().trim().length===0?0:$("#amountPerMnth").val();var L=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var n=typeof $("#reltnOfficerID").val()==="undefined"?"":$("#reltnOfficerID").val();var B=typeof $("#closeReason").val()==="undefined"?"":$("#closeReason").val();var C=typeof $("#status").val()==="undefined"?-1:$("#status").val();var E=typeof $("#accMndte").val()==="undefined"?-1:$("#accMndte").val();var u=typeof $("#grpType").val()==="undefined"?"Everyone":$("#grpType").val();var k=typeof $("#groupID").val()==="undefined"?-1:$("#groupID").val();var A=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var w=typeof $("#canOverdrawAcct").val()==="undefined"?"No":$("#canOverdrawAcct").val();var K=validateCustAcctsForm(N,G,o,y,v,m,z,s,j,r,t,M,f,L,n,E,k,u);if(!K){return false}var h;var I="Are you sure you want to submit account for Approval?";if(b===1){h=2;var E=typeof $("#accMndte").val()==="undefined"?-1:$("#accMndte").val();var g=0;if(E==="Anyone to sign"){g=1}else{if(E==="Any two to sign"){g=2}else{if(E==="Any three to sign"){g=3}else{if(E==="Any four to sign"){g=4}else{if(E==="All to sign"){g=1}else{if(E==="Both to sign"){g=2}else{if(E==="Only to sign"){g=1}}}}}}}if(Number($("table#acctSignatoryTblAdd tbody tr:last").index()+1)<Number(g)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide at least <b>"+g+" Signatory(s)</b> before submitting this account for approval!",callback:function(){}});return false}else{if(E==="Only to sign"&&(Number($("table#acctSignatoryTblAdd tbody tr:last").index()+1)>1)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>One signatory</b> is required. </br>Please delete excess signatories!",callback:function(){}});return false}else{if(E==="Both to sign"&&(Number($("table#acctSignatoryTblAdd tbody tr:last").index()+1)>2)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>Two signatories</b> are required. </br>Please delete excess signatories!",callback:function(){}});return false}else{var F=0;$("table#acctSignatoryTblAdd tr").each(function(){if($(this).find("td:eq(5)").text()=="Yes"){F=F+1}});if(E==="Anyone to sign"&&Number(F)>1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>One Mandatory Signatory</b> is required, but "+F+" specified</br>Please do needful!",callback:function(){}});return false}else{if(E==="Any two to sign"&&Number(F)>2){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>Two Mandatory Signatories</b> are required, but "+F+" specified</br>Please do needful!",callback:function(){}});return false}else{if(E==="Any three to sign"&&Number(F)>2){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>Three Mandatory Signatories</b> are required, but "+F+" specified</br>Please do needful!",callback:function(){}});return false}else{if(E==="Any four to sign"&&Number(F)>2){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Only <b>Four Mandatory Signatories</b> are required, but "+F+" specified</br>Please do needful!",callback:function(){}});return false}}}}}}}}var D=new FormData();D.append("grp",17);D.append("typ",1);D.append("q","UPDATE");D.append("pg",a);D.append("subPgNo",d);D.append("vtyp",c);D.append("acctID",p);D.append("acctNumber",q);D.append("acctTitle",o);D.append("actyp",1);D.append("acctType",y);D.append("prdtCrncy",J);D.append("prdtTypeID",v);D.append("acctTrnsTyp",m);D.append("prsnTypeEntity",z);D.append("custType",N);D.append("bnkCustomerID",G);D.append("prpsOfAcct",s);D.append("prpsOfAcctOther",j);D.append("srcOfFunds",r);D.append("srcOfFundsOther",t);D.append("trnsPerMnthNo",M);D.append("amountPerMnth",f);D.append("bnkBranchID",L);D.append("reltnOfficerID",n);D.append("canOverdrawAcct",w);D.append("statusReason",B);D.append("status",C);D.append("accMndte",E);D.append("grpType",u);D.append("groupID",k);D.append("rvsnTtl",A);D.append("shdSbmit",b);if(b===1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.confirm({title:"Rhomicom Message",message:I,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(O){if(O){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:D,async:true,success:function(P){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var Q="";if(/^[\],:{}\s]*$/.test(P.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){x=$.parseJSON(P);p=x.acctID}else{}bootbox.alert({size:"small",title:"Rhomicom Message",message:"Customer Account Submitted Successfully",callback:function(){getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",p,"custAcctTable","indCustTableRow1")}})},cache:false,contentType:false,processData:false})}}})}else{$.ajax({url:"index.php",type:"POST",data:D,async:true,success:function(O){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var P="";if(/^[\],:{}\s]*$/.test(O.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){x=$.parseJSON(O);p=x.acctID;$("#acctID").val(x.acctID);$("#acctNumber").val(x.acctNumber);$("#submitCustAccountBtn").css("display","inline-block");$("#standardEvtns").css("display","block");$("#customEvnts").css("display","block");P="Customer Accounts Successfully Saved!"}else{P=O}if(p>0){bootbox.alert({size:"small",title:"Rhomicom Message",message:P,callback:function(){getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",p,"custAcctTable","indCustTableRow1")}})}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:P,callback:function(){}})}},cache:false,contentType:false,processData:false})}})}function onClickCustName(){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","All Bank Customers","gnrlOrgID","custType","","radio",true,"","bnkCustomerID","bnkCustomer","clear",1,"",function(){$("#acctTitle").val($("#bnkCustomer").val())})}function empty_selectList(b){var a=document.getElementById(b);a.options.length=0}function populate_selectListIndv(b){empty_selectList(b);var a=document.getElementById(b);a.options[a.options.length]=new Option("Only to sign","Only to sign")}function populate_selectListIndvFrmArray(b){empty_selectList(b);var a=document.getElementById(b);for(var c in accMandate){a.options[a.options.length]=new Option(accMandate[c],accMandate[c])}}function loadPrsnTypeEntiries(b){$body=$("body");if($("#custType").val()=="--Please Select--"){empty_selectList("accMndte");return false}$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#prsnTypeEntity").html(a.responseText);$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$(document).ready(function(){if($("#custType").val()=="Individual"){populate_selectListIndv("accMndte")}else{populate_selectListIndvFrmArray("accMndte")}})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg=13&subPgNo=2.1&vtyp=0&vtypActn=PTYPENT&cType="+$("#custType").val())}function getSignatoryForm(m,n,b,j,q,p,d,g,h,k,f){var r=$("#custType").val();var e=$("#prsnTypeEntity").val();var l=$("#bnkCustomerID").val();var c=$("#acctID").val();var o=f;if(c==="undefined"||c===""||c===-1){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please save Account first!",callback:function(){}});return false}else{if(r==="undefined"||r===""||l==="undefined"||l===""){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Customer Type and Name are mandatory!",callback:function(){}});return false}else{$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(p);$("#"+n).html(a.responseText);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(h===5&&k==="EDIT"){var s=$("#"+q).find("td");$("#lowRange").val($.trim(s.eq(2).text()));$("#highRange").val($.trim(s.eq(3).text()));$("#amountFlat").val($.trim(s.eq(4).text()));$("#amountPrcnt").val($.trim(s.eq(5).text()));$("#remarks").val($.trim(s.eq(6).text()));$("#tblRowElementID").val(q)}$("#"+m).on("show.bs.modal",function(t){$(this).find(".modal-body").css({"max-height":"100%"})});$("#myLovModal").off("hidden.bs.modal");$("#myLovModal").one("hidden.bs.modal",function(t){$("#"+n).html("");$(t.currentTarget).unbind()});$body.removeClass("mdlloadingDiag");$("#"+m).modal({backdrop:"static",keyboard:false});$(document).ready(function(){$("#"+j).submit(function(t){t.preventDefault();return false});if(r=="Corporate"&&e!="CORP-Partnership"){$("#srcTypeDiv").css("display","block")}else{$("#srcTypeDiv").css("display","none")}})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+d+"&subPgNo="+g+"&vtyp="+h+"&vtypActn="+k+"&acctID="+c+"&acctSignId="+o)}}}function getAccountSignatories(){var f=$("#custType").val();var c=$("#bnkCustomerID").val();var e=$("#srcType").val();var a="Bank Individual Customers";var b=" AND 1 = 1";var d="custTypeIndividual";switch(f){case"Individual":b=" AND tbl1.a = '"+c+"'";d="custType";getLovsPage("myLovModal1","myLovModal1Title","myLovModal1Body",a,"gnrlOrgID",d,"","radio",true,"","bnkSignatoryID","bnkSignatory","clear",1,b);break;case"Corporate":if(e==="Other Persons"){a="Bank Other Persons";d="isSignatory"}getLovsPage("myLovModal1","myLovModal1Title","myLovModal1Body",a,"gnrlOrgID",d,"","radio",true,"","bnkSignatoryID","bnkSignatory","clear",1,b);break;case"Group":a="MCF Customer Group Members";getLovsPage("myLovModal1","myLovModal1Title","myLovModal1Body",a,"gnrlOrgID","bnkCustomerID","","radio",true,"","bnkSignatoryID","bnkSignatory","clear",1,"");break;case"Joint-Individual":b="";getLovsPage("myLovModal1","myLovModal1Title","myLovModal1Body",a,"gnrlOrgID",d,"","radio",true,"","bnkSignatoryID","bnkSignatory","clear",1,b);break}}function saveAccountSignatoriesForm(m,k,h){var e;$body=$("body");$body.addClass("mdlloadingDiag");var d=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();var n=typeof $("#srcType").val()==="undefined"?"":$("#srcType").val();var a=typeof $("#bnkSignatoryID").val()==="undefined"?-1:$("#bnkSignatoryID").val();var c=typeof $("#bnkSignatory").val()==="undefined"?-1:$("#bnkSignatory").val();var j=typeof $("#toSignMndtry").val()==="undefined"?"No":$("#toSignMndtry").val();var g=typeof $("#endDate").val()==="undefined"?"":$("#endDate").val();var f=typeof $("#rvsnTtl").val()==="undefined"?"":$("#rvsnTtl").val();if(h=="ADD"){var l=true;$("table#acctSignatoryTblAdd tr").each(function(){if($(this).find("td:eq(7)").text()==n&&$(this).find("td:eq(8)").text()==a){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");l=false;return false}});if(l==false){$("#myLovModalTitle99").html("Rhomicom Message");$("#myLovModalBody99").html("<span style='color:red !important;'><b>Signatory already exists. Please select another person!</b></span>");$("#myLovModal99").modal("show",{backdrop:"static"});return false}}var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){var r="";var q=b.responseText;var o=-1;if(/^[\],:{}\s]*$/.test(q.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=$.parseJSON(q);var o=e.rowID;var p=e.localIDNo}getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",d,"custAcctTable","indCustTableRow1",-1,function(){bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}});$body.removeClass("mdlloadingDiag");$("#"+m).modal("hide")})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg=13&subPgNo=2.1&vtyp=5&q=UPDATE&srcType="+n+"&bnkSignatoryID="+a+"&toSignMndtry="+j+"&endDate="+g+"&rowID="+k+"&acctID="+d+"&rvsnTtl="+f)}function getSvngsPrdtDetsForAccnt(a,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var c;var e=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();var d=new FormData();d.append("grp",17);d.append("typ",1);d.append("pg",a);d.append("subPgNo",b);d.append("vtyp",4);d.append("prdtTypeID",e);$.ajax({url:"index.php",type:"POST",data:d,async:true,success:function(f){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");if(/^[\],:{}\s]*$/.test(f.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){c=$.parseJSON(f);$("#prdtCrncy").val(c.svngsPrdtDetArry.currencyId);$("#prdtCrncyIsoCode").val(c.svngsPrdtDetArry.crncyIsoCode)}else{alert(f+" Error!")}},cache:false,contentType:false,processData:false})})}function deleteCustAccntsSignatory(d,c,e){var b=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var f;var a;var g;g=bootbox.confirm({size:"small",message:"Are you sure you want to delete this signatory?",callback:function(h){if(h){if(!($("#status").val()=="Incomplete"||$("#status").val()=="Rejected"||$("#status").val()=="Withdrawn")){g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Signatories Accunts with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});f.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k)/2;return m+"px"}});var j;if(window.XMLHttpRequest){j=new XMLHttpRequest()}else{j=new ActiveXObject("Microsoft.XMLHTTP")}j.onreadystatechange=function(){if(j.readyState===4&&j.status===200){var k=j.responseText;f.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:k,callback:function(){getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",c,"custAcctTable","indCustTableRow1")}});a.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l-150)/2;return n+"px"}})}};j.open("POST","index.php",true);j.setRequestHeader("Content-type","application/x-www-form-urlencoded");j.send("grp=17&typ=1&pg=13&subPgNo=2.1&q=DELETE&vtyp=5&PKeyID="+c+"&acctSignId="+d+"&rvsnTtl="+b+"&isApproved="+e)}}});g.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function submitWithdrawCustAccnt(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var j;var f=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();var e=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var g;var k="Are you sure you want to submit account for Approval?";if(d=="REJECT"){g=2;k="Are you sure you want to reject this Customer Account?"}else{if(d=="WITHDRAW"){g=3;k="Are you sure you want to withdraw this Customer Account?"}else{g=4;k="Are you sure you want to Authorize this Customer Account?"}}var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("pg",a);h.append("subPgNo",c);h.append("q","UPDATE");h.append("vtyp",b);h.append("actyp",g);h.append("acctID",f);h.append("accMndte",accMndte);h.append("rvsnTtl",e);bootbox.confirm({title:"Rhomicom Message",message:k,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(l){if(l){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(m){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var n="";if(/^[\],:{}\s]*$/.test(m.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=$.parseJSON(m);f=j.acctID}else{}getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",f,"custAcctTable","indCustTableRow1",-1,function(){bootbox.alert({size:"small",title:"Rhomicom Message",message:m,callback:function(){}})})},cache:false,contentType:false,processData:false})}}})})}function viewSignatoryForm(k,m,b,h,p,o,d,f,g,j,e,l){if(l==="undefined"||l===""){l="acctSignID"}var c=$("#acctID").val();var n=e;$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(o);$("#"+m).html(a.responseText);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+k).on("show.bs.modal",function(q){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+k).modal({backdrop:"static",keyboard:false});$(document).ready(function(){$("#"+h).submit(function(q){q.preventDefault();return false})})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+j+"&acctID="+c+"&acctSignId="+n+"&idSrc="+l)}function validateAcctTrnsSignatories(){var o="No";var s="";var n="";var l=0;var u=[];var r=[];var a=[];var b=typeof $("#mandate").val()==="undefined"?-1:$("#mandate").val();var g=0;var t="Signatory";var p="is";if(b==="Anyone to sign"){g=1}else{if(b==="Any two to sign"){g=2}else{if(b==="Any three to sign"){g=3}else{if(b==="Any four to sign"){g=4}else{if(b==="All to sign"){g=1}else{if(b==="Both to sign"){g=2}else{if(b==="Only to sign"){g=1}}}}}}}if(Number(g)>1){t="Signatories";p="are"}$("#acctSignatoriesTblAdd").find("tr").each(function(j,k){if(j>0){if(typeof $(k).attr("id")==="undefined"){}else{var f=$(k).attr("id").split("_")[1];if(typeof $("#acctSignatoriesTblAddRow_"+f).val()==="undefined"){}else{s=$("#acctSignatoriesTblAddRow"+f+"_name").text();o=$("#acctSignatoriesTblAddRow"+f+"_MndtrySign").text();if($("#acctSignatoriesTblAddRow_"+f).find('input[type="checkbox"]:checked').length=="1"){r[l]="Yes"}else{r[l]="No"}u[l]=o;a[l]=s;l=l+1}}}});var c=0;for(var e=0;e<u.length;e++){if(u[e]==="Yes"){c=c+1}}var q=0;for(var d=0;d<u.length;d++){if(r[d]==="Yes"){q=q+1}}if(Number(q)<Number(g)){n=n+"<b>"+g+" "+t+" "+p+" required but "+q+" provided!</b></br>"}for(var h=0;h<u.length;h++){if((b==="Anyone to sign"||b==="Any two to sign"||b==="Any three to sign"||b==="Any four to sign")&&(u[h]==="Yes"&&r[h]==="No")){n=n+"Sorry!<b> "+a[h]+"</b> has to sign!</br>"}else{if((b==="All to sign"||b==="Both to sign")&&(r[h]==="No")){n=n+"<b> "+a[h]+"</b> has to sign!</br>"}}}if(n.trim()!=""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Validation Errors",message:n,callback:function(){}});return false}else{return true}}function getLienForm(l,m,b,j,p,o,d,g,h,k,f,n){if(typeof n==="undefined"||n===null){n=function(){var q=1}}var c=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();var e=f;if(c=="undefined"||c==""||c==-1){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please save Account first!",callback:function(){}});return false}else{$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(o);$("#"+m).html(a.responseText);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(h===5&&k==="EDIT"){var q=$("#"+p).find("td");$("#lowRange").val($.trim(q.eq(2).text()));$("#highRange").val($.trim(q.eq(3).text()));$("#amountFlat").val($.trim(q.eq(4).text()));$("#amountPrcnt").val($.trim(q.eq(5).text()));$("#remarks").val($.trim(q.eq(6).text()));$("#tblRowElementID").val(p)}$("#"+l).on("show.bs.modal",function(r){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$(document).ready(function(){$("#"+j).submit(function(r){r.preventDefault();return false});n()})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+d+"&subPgNo="+g+"&vtyp="+h+"&vtypActn="+k+"&acctID="+c+"&rowID="+e)}}function saveAccountLienForm(e,c){var n;$body=$("body");var h=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();var u=typeof $("#lienAmnt").val()==="undefined"?0:$("#lienAmnt").val();var g=typeof $("#startDate").val()==="undefined"?"":$("#startDate").val();var t=typeof $("#endDate").val()==="undefined"?"":$("#endDate").val();var q=typeof $("#narration").val()==="undefined"?"":$("#narration").val();var d=typeof $("#lienStatus").val()==="undefined"?"Incomplete":$("#lienStatus").val();var x=typeof $("#tblRowElementID").val()==="undefined"?-1:$("#tblRowElementID").val();var r=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var a;var j;var o;var f;var b;var l;var s;var k;var v=new Date();var p=v.getDate();var w=v.getMonth()+1;var m=v.getFullYear();if(g!=""){a=new Date(g);j=a.getDate();o=a.getMonth()+1;f=a.getFullYear()}if(t!=""){b=new Date(t);l=b.getDate();if(l<10){l="0"+l}s=b.getMonth()+1;k=b.getFullYear()}if((u==""||Number(u)<=0)&&d!="Remove"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#myLovModalTitle99").html("Rhomicom Message");$("#myLovModalBody99").html("<span style='color:red !important;'><b>Lien Amount must be greater than zero!</b></span>");$("#myLovModal99").modal("show",{backdrop:"static"});return false}else{if(g==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#myLovModalTitle99").html("Rhomicom Message");$("#myLovModalBody99").html("<span style='color:red !important;'><b>Please provide lien start date!</b></span>");$("#myLovModal99").modal("show",{backdrop:"static"});return false}else{if(g!=""&&t!=""&&a>b){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#myLovModalTitle99").html("Rhomicom Message");$("#myLovModalBody99").html("<span style='color:red !important;'><b>Lien End Date must be greater than Start date!</b></span>");$("#myLovModal99").modal("show",{backdrop:"static"});return false}else{if(q.trim()==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#myLovModalTitle99").html("Rhomicom Message");$("#myLovModalBody99").html("<span style='color:red !important;'><b>Please provide a comprehensive narration for this Lien!</b></span>");$("#myLovModal99").modal("show",{backdrop:"static"});return false}}}}$("#myLovModal").modal("hide");if(t==""){t="31-Dec-4000"}box=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> <span style="color:green;"><b>Saving. Please Wait...</b></span></div>'});box.find(".modal-content").css({"margin-top":function(){var A=$(window).height();var z=$(".modal-dialog").height();var B=(A-z)/2;return B+"px"}});var y;if(window.XMLHttpRequest){y=new XMLHttpRequest()}else{y=new ActiveXObject("Microsoft.XMLHTTP")}y.onreadystatechange=function(){if(y.readyState===4&&y.status===200){var B="";var A=y.responseText;var z=-1;if(/^[\],:{}\s]*$/.test(A.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){n=$.parseJSON(A);var z=n.rowID;getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",h,"custAcctTable","indCustTableRow1",-1,function(){box.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:n.lnMsg,callback:function(){}});$body.removeClass("mdlloadingDiag");$("#"+e).modal("hide")})}else{getLienForm("myLovModal","myLovModalBody","myLovModalTitle","acctLienForm","","Edit Lien",13,2.1,6,"EDIT",c,function(){box.modal("hide");$("#myLovModalTitle99").html("Rhomicom Message");$("#myLovModalBody99").html("<span style='color:red !important;'><b>"+A+"</b></span>");$("#myLovModal99").modal("show",{backdrop:"static"})})}}};y.open("POST","index.php",true);y.setRequestHeader("Content-type","application/x-www-form-urlencoded");y.send("grp=17&typ=1&pg=13&subPgNo=2.1&vtyp=6&q=UPDATE&lienAmnt="+fmtAsNumberLcl(u)+"&startDate="+g+"&endDate="+t+"&narration="+q+"&rowID="+c+"&acctID="+h+"&rvsnTtl="+r+"&lienStatus="+d)}function deleteCustLienRcrd(g,c,d,e){var f;var b;var h;var a=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();h=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Lien?",callback:function(j){if(j){if(!(d=="Inactive")){h.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Liens with Status <b>Inactive</b> can be deleted.",callback:function(){}});return false}f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});f.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l)/2;return n+"px"}});var k;if(window.XMLHttpRequest){k=new XMLHttpRequest()}else{k=new ActiveXObject("Microsoft.XMLHTTP")}k.onreadystatechange=function(){if(k.readyState===4&&k.status===200){var l=k.responseText;getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",c,"custAcctTable","indCustTableRow1",-1,function(){f.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}});b.find(".modal-content").css({"margin-top":function(){var n=$(window).height();var m=$(".modal-dialog").height();var o=(n-m-150)/2;return o+"px"}})})}};k.open("POST","index.php",true);k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.send("grp=17&typ=1&pg=13&subPgNo=2.1&q=DELETE&vtyp=6&PKeyID="+c+"&acctLienId="+g+"&rvsnTtl="+a+"&isApproved="+e+"&lienStatus="+d)}}});h.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function saveSvngsPrdtStdAcctnEvents(a,c,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var n;var q=typeof $("#prdtID").val()==="undefined"?-1:$("#prdtID").val();var j=typeof $("#svngsAccntnEvntId").val()==="undefined"?-1:$("#svngsAccntnEvntId").val().trim().length===0?-1:$("#svngsAccntnEvntId").val();var y=typeof $("#cashDepositDbtAccID").val()==="undefined"?-1:$("#cashDepositDbtAccID").val().trim().length===0?-1:$("#cashDepositDbtAccID").val();var F=typeof $("#cashDepositCrdtAccID").val()==="undefined"?-1:$("#cashDepositCrdtAccID").val().trim().length===0?-1:$("#cashDepositCrdtAccID").val();var A=typeof $("#chqDepositDbtAccID").val()==="undefined"?-1:$("#chqDepositDbtAccID").val().trim().length===0?-1:$("#chqDepositDbtAccID").val();var e=typeof $("#chqDepositCrdtAccID").val()==="undefined"?-1:$("#chqDepositCrdtAccID").val().trim().length===0?-1:$("#chqDepositCrdtAccID").val();var t=typeof $("#cashWtdwlDbtAccID").val()==="undefined"?-1:$("#cashWtdwlDbtAccID").val().trim().length===0?-1:$("#cashWtdwlDbtAccID").val();var h=typeof $("#cashWtdwlCrdtAccID").val()==="undefined"?-1:$("#cashWtdwlCrdtAccID").val().trim().length===0?-1:$("#cashWtdwlCrdtAccID").val();var d=typeof $("#entryFeesDbtAccID").val()==="undefined"?-1:$("#entryFeesDbtAccID").val().trim().length===0?-1:$("#entryFeesDbtAccID").val();var x=typeof $("#entryFeesCrdtAccID").val()==="undefined"?-1:$("#entryFeesCrdtAccID").val().trim().length===0?-1:$("#entryFeesCrdtAccID").val();var k=typeof $("#closeFeesDbtAccID").val()==="undefined"?-1:$("#closeFeesDbtAccID").val().trim().length===0?-1:$("#closeFeesDbtAccID").val();var f=typeof $("#closeFeesCrdtAccID").val()==="undefined"?-1:$("#closeFeesCrdtAccID").val().trim().length===0?-1:$("#closeFeesCrdtAccID").val();var r=typeof $("#reopenFeesDbtAccID").val()==="undefined"?-1:$("#reopenFeesDbtAccID").val().trim().length===0?-1:$("#reopenFeesDbtAccID").val();var o=typeof $("#reopenFeesCrdtAccID").val()==="undefined"?-1:$("#reopenFeesCrdtAccID").val().trim().length===0?-1:$("#reopenFeesCrdtAccID").val();var p=typeof $("#wtdwlPnltyFlatDbtAccID").val()==="undefined"?-1:$("#wtdwlPnltyFlatDbtAccID").val().trim().length===0?-1:$("#wtdwlPnltyFlatDbtAccID").val();var z=typeof $("#wtdwlPnltyFlatCrdtAccID").val()==="undefined"?-1:$("#wtdwlPnltyFlatCrdtAccID").val().trim().length===0?-1:$("#wtdwlPnltyFlatCrdtAccID").val();var w=typeof $("#wtdwlPnltyPrcntDbtAccID").val()==="undefined"?-1:$("#wtdwlPnltyPrcntDbtAccID").val().trim().length===0?-1:$("#wtdwlPnltyPrcntDbtAccID").val();var E=typeof $("#wtdwlPnltyPrcntCrdtAccID").val()==="undefined"?-1:$("#wtdwlPnltyPrcntCrdtAccID").val().trim().length===0?-1:$("#wtdwlPnltyPrcntCrdtAccID").val();var C=typeof $("#cotFeeFlatDbtAccID").val()==="undefined"?-1:$("#cotFeeFlatDbtAccID").val().trim().length===0?-1:$("#cotFeeFlatDbtAccID").val();var m=typeof $("#cotFeeFlatCrdtAccID").val()==="undefined"?-1:$("#cotFeeFlatCrdtAccID").val().trim().length===0?-1:$("#cotFeeFlatCrdtAccID").val();var l=typeof $("#invstmntFeeDbtAccID").val()==="undefined"?-1:$("#invstmntFeeDbtAccID").val().trim().length===0?-1:$("#invstmntFeeDbtAccID").val();var B=typeof $("#invstmntFeeCrdtAccID").val()==="undefined"?-1:$("#invstmntFeeCrdtAccID").val().trim().length===0?-1:$("#invstmntFeeCrdtAccID").val();var D=typeof $("#interesPyblDbtAccID").val()==="undefined"?-1:$("#interesPyblDbtAccID").val().trim().length===0?-1:$("#interesPyblDbtAccID").val();var g=typeof $("#interesPyblCrdtAccID").val()==="undefined"?-1:$("#interesPyblCrdtAccID").val().trim().length===0?-1:$("#interesPyblCrdtAccID").val();var u=typeof $("#interesExpenseDbtAccID").val()==="undefined"?-1:$("#interesExpenseDbtAccID").val().trim().length===0?-1:$("#interesExpenseDbtAccID").val();var s=typeof $("#interesExpenseCrdtAccID").val()==="undefined"?-1:$("#interesExpenseCrdtAccID").val().trim().length===0?-1:$("#interesExpenseCrdtAccID").val();var v=new FormData();v.append("grp",17);v.append("typ",1);v.append("q","UPDATE");v.append("pg",a);v.append("subPgNo",c);v.append("vtyp",b);v.append("svngsAccntnEvntId",j);v.append("cashDepositDbtAccID",y);v.append("cashDepositCrdtAccID",F);v.append("chqDepositDbtAccID",A);v.append("chqDepositCrdtAccID",e);v.append("cashWtdwlDbtAccID",t);v.append("cashWtdwlCrdtAccID",h);v.append("entryFeesDbtAccID",d);v.append("entryFeesCrdtAccID",x);v.append("closeFeesDbtAccID",k);v.append("closeFeesCrdtAccID",f);v.append("reopenFeesDbtAccID",r);v.append("reopenFeesCrdtAccID",o);v.append("wtdwlPnltyFlatDbtAccID",p);v.append("wtdwlPnltyFlatCrdtAccID",z);v.append("wtdwlPnltyPrcntDbtAccID",w);v.append("wtdwlPnltyPrcntCrdtAccID",E);v.append("cotFeeFlatDbtAccID",C);v.append("cotFeeFlatCrdtAccID",m);v.append("invstmntFeeDbtAccID",l);v.append("invstmntFeeCrdtAccID",B);v.append("interesPyblDbtAccID",D);v.append("interesPyblCrdtAccID",g);v.append("interesExpenseDbtAccID",u);v.append("interesExpenseCrdtAccID",s);v.append("prdtID",q);$.ajax({url:"index.php",type:"POST",data:v,async:true,success:function(G){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var H="";if(/^[\],:{}\s]*$/.test(G.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){n=$.parseJSON(G);$("#svngsAccntnEvntId").val(n.svngsAccntnEvntId);$("#standardEvtns").css("display","block");$("#customEvnts").css("display","block");H="Savings Product Event Accounting Successfully Saved!"}else{H=G}bootbox.alert({size:"small",title:"Rhomicom Message",message:H,callback:function(){}})},cache:false,contentType:false,processData:false})})}function resetLoanCalculator(){}function deleteGrpMember(f,e,b){var c;var a;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Member?",callback:function(g){if(g){if(!(e=="Incomplete"||e=="Rejected"||e=="Withdrawn")){d.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Members of Groups with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l)/2;return n+"px"}});var k=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var h=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var j;if(window.XMLHttpRequest){j=new XMLHttpRequest()}else{j=new ActiveXObject("Microsoft.XMLHTTP")}j.onreadystatechange=function(){if(j.readyState===4&&j.status===200){var l=j.responseText;c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var n=$(window).height();var m=$(".modal-dialog").height();var o=(n-m-150)/2;return o+"px"}});getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","EDIT CORPORATE CUSTOMER PROFILE",11,1.3,0,"EDIT",k,"EDIT","indCustTableRow1",-1,function(){})}};j.open("POST","index.php",true);j.setRequestHeader("Content-type","application/x-www-form-urlencoded");j.send("grp=17&typ=1&pg=11&subPgNo=1.3&q=DELETE&actyp=1&PKeyID="+f+"&custStatus="+e+"&custID="+k+"&rvsnTtl="+h+"&isApproved="+b)}}});d.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g-150)/2;return k+"px"}})}function saveGrpMemberForm(p,m,k){var g;var h;var n;$body=$("body");$body.addClass("mdlloadingDiag");var a=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var e=typeof $("#mbrPstn").val()==="undefined"?"":$("#mbrPstn").val();var c=typeof $("#memberID").val()==="undefined"?-1:$("#memberID").val();var l=typeof $("#member").val()==="undefined"?"":$("#member").val();var j=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var f=typeof $("#startDateActive").val()==="undefined"?"":$("#startDateActive").val();var d=typeof $("#endDateActive").val()==="undefined"?"":$("#endDateActive").val();if(c==""||c==-1){$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Director first",callback:function(){}});return false}else{if(f==""||f=="undefined"){$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Enter a Start Date for this relationship",callback:function(){}});return false}}var o=true;var q="";if(k=="ADD"){$("table#grpMemberTblAdd tr").each(function(){if($.trim($(this).find("td:eq(3)").text())==$.trim(l)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");q="Member "+l.toUpperCase()+" already exists for this group. Please select another Member!";o=false;return false}if($.trim($(this).find("td:eq(4)").text())==$.trim(e)&&e.toUpperCase()!="MEMBER"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");q="Position "+e.toUpperCase()+" already exists for this group. Please select another Position!";o=false;return false}})}if(o==false){$("#myLovModalTitle99").html("Rhomicom Message");$("#myLovModalBody99").html("<span style='color:red !important;'><b>"+q+"</b></span>");$("#myLovModal99").modal("show",{backdrop:"static"});return false}var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){var s="";var r=b.responseText;if(/^[\],:{}\s]*$/.test(r.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){g=$.parseJSON(r);$("#"+p).modal("hide");getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","EDIT CUSTOMER GROUP PROFILE",11,1.3,0,"EDIT",a,"EDIT","indCustTableRow1",-1,function(){$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Successfully Saved Director",callback:function(){}})})}else{$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:r,callback:function(){}});return false}}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg=11&subPgNo=1.3&vtyp=5&q=UPDATE&memberID="+c+"&rowID="+m+"&custID="+a+"&mbrPstn="+e+"&startDateActive="+f+"&endDateActive="+d+"&rvsnTtl="+j)}function getGrpMembers(){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","Bank Individual Customers","gnrlOrgID","","","radio",true,"","memberID","member","clear",1,"",function(){})}function deleteCorpDirector(e,f,b){var c;var a;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Director?",callback:function(g){if(g){if(!(f=="Incomplete"||f=="Rejected"||f=="Withdrawn")){d.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Directors for Customers with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l)/2;return n+"px"}});var k=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var h=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var j;if(window.XMLHttpRequest){j=new XMLHttpRequest()}else{j=new ActiveXObject("Microsoft.XMLHTTP")}j.onreadystatechange=function(){if(j.readyState===4&&j.status===200){var l=j.responseText;c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var n=$(window).height();var m=$(".modal-dialog").height();var o=(n-m-150)/2;return o+"px"}});getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","EDIT CORPORATE CUSTOMER PROFILE",11,1.2,0,"EDIT",k,"EDIT","indCustTableRow1",-1,function(){})}};j.open("POST","index.php",true);j.setRequestHeader("Content-type","application/x-www-form-urlencoded");j.send("grp=17&typ=1&pg=11&subPgNo=1.2&q=DELETE&actyp=1&PKeyID="+e+"&custStatus="+f+"&custID="+k+"&rvsnTtl="+h+"&isApproved="+b)}}});d.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g-150)/2;return k+"px"}})}function saveCorpDirectorForm(l,h){var e;var f;var j;$body=$("body");$body.addClass("mdlloadingDiag");var a=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var m=typeof $("#srcType").val()==="undefined"?"":$("#srcType").val();var k=typeof $("#directorID").val()==="undefined"?-1:$("#directorID").val();var g=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var d=typeof $("#startDateActive").val()==="undefined"?"":$("#startDateActive").val();var c=typeof $("#endDateActive").val()==="undefined"?"":$("#endDateActive").val();if(k==""||k==-1){$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Director first",callback:function(){}});return false}else{if(d==""||d=="undefined"){$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Enter a Start Date for this relationship",callback:function(){}});return false}}var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){var o="";var n=b.responseText;if(/^[\],:{}\s]*$/.test(n.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=$.parseJSON(n);$("#"+l).modal("hide");getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","EDIT CORPORATE CUSTOMER PROFILE",11,1.2,0,"EDIT",a,"EDIT","indCustTableRow1",-1,function(){$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Successfully Saved Director",callback:function(){}})})}else{$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:n,callback:function(){}});return false}}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg=11&subPgNo=1.2&vtyp=5&q=UPDATE&directorID="+k+"&rowID="+h+"&custID="+a+"&srcType="+m+"&startDateActive="+d+"&endDateActive="+c+"&rvsnTtl="+g)}function getCorpDirectors(){var d=$("#srcType").val();var a="Bank Individual Customers";var b=" AND 1 = 1";var c="custTypeIndividual";if(d==="Other Persons"){a="MCF Bank Other Persons - Directors, Joint and Trust Persons";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"gnrlOrgID","","","radio",true,"","directorID","director","clear",1,b)}else{getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"gnrlOrgID",c,"","radio",true,"","directorID","director","clear",1,b)}}function getcorpDirectorForm(m,n,c,k,p,o,d,f,g,l,e){var a=$("#custID").val();var j=e;var h=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();if(a==="undefined"||a===""||a===-1){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please save Customer first!",callback:function(){}});return false}else{$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+c).html(o);$("#"+n).html(b.responseText);$("#"+m).off("hidden.bs.modal");$("#"+m).one("hidden.bs.modal",function(r){$("#"+c).html("");$("#"+n).html("");$(r.currentTarget).unbind()});$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(g===5&&l==="EDIT"){var q=$("#"+p).find("td");$("#lowRange").val($.trim(q.eq(2).text()));$("#highRange").val($.trim(q.eq(3).text()));$("#amountFlat").val($.trim(q.eq(4).text()));$("#amountPrcnt").val($.trim(q.eq(5).text()));$("#remarks").val($.trim(q.eq(6).text()));$("#tblRowElementID").val(p)}$("#"+m).on("show.bs.modal",function(r){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+m).modal({backdrop:"static",keyboard:false});$(document).ready(function(){$("#"+k).submit(function(r){r.preventDefault();return false})})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+l+"&custID="+a+"&rowID="+j+"&rvsnTtl="+h)}}function saveBasicDataCorp(a,f,e,h){var g;var b;var c=$(".nav-tabs .active").text();var d=1;if(c.indexOf("Additional Data")>=0){d=2}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var m;var ah=typeof $("#profileID").val()==="undefined"?-1:$("#profileID").val();var aj=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var aa=typeof $("#idNo").val()==="undefined"?"":$("#idNo").val();var an=typeof $("#clsfctn").val()==="undefined"?"":$("#clsfctn").val();var E=typeof $("#custName").val()==="undefined"?"":$("#custName").val();var Y=typeof $("#natureOfBus").val()==="undefined"?"":$("#natureOfBus").val();var aK=typeof $("#relation").val()==="undefined"?"":$("#relation").val();var ab=typeof $("#dateOfEstblshmnt").val()==="undefined"?"":$("#dateOfEstblshmnt").val();var j=typeof $("#bnkBranchID").val()==="undefined"?"":$("#bnkBranchID").val();var aP=typeof $("#startDate").val()==="undefined"?"":$("#startDate").val();var am=typeof $("#endDate").val()==="undefined"?"":$("#endDate").val();var ag=typeof $("#pstlAddress").val()==="undefined"?"":$("#pstlAddress").val();var aO=typeof $("#resAddress").val()==="undefined"?"":$("#resAddress").val();var G=typeof $("#email").val()==="undefined"?"":$("#email").val();var ad=typeof $("#contactNos").val()==="undefined"?"":$("#contactNos").val();var Z=typeof $("#faxNo").val()==="undefined"?"":$("#faxNo").val();var aM=typeof $("#brandName").val()==="undefined"?"":$("#brandName").val();var R=typeof $("#orgType").val()==="undefined"?"":$("#orgType").val();var ap=typeof $("#regNo").val()==="undefined"?"":$("#regNo").val();var U=typeof $("#dateOfIncorp").val()==="undefined"?"":$("#dateOfIncorp").val();var ai=typeof $("#typeOfIncorp").val()==="undefined"?"":$("#typeOfIncorp").val();var ae=typeof $("#vatNo").val()==="undefined"?"":$("#vatNo").val();var I=typeof $("#tinNo").val()==="undefined"?"":$("#tinNo").val();var H=typeof $("#ssnitRegNo").val()==="undefined"?"":$("#ssnitRegNo").val();var r=typeof $("#noOfEmp").val()==="undefined"?0:$("#noOfEmp").val().trim().length===0?0:$("#noOfEmp").val();var aB=$("#meetingDays option:selected").map(function(){return $(this).val()}).get();var af=aB;var P=validateCorpCustomerForm(E,Y,ab,aP,aO,G,ad,aM,ap,U,I,r,af,f);if(!P){return false}var ao="Director";if(f==1.3){ao="Member of Group"}if(h>0&&$("#grpMemberTblAdd > tbody > tr").length<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'><i>Please provide at least One(1) "+ao+"</i></span>",callback:function(){}});return false}if(f==1.3){var ak=$("#grpMemberTblAdd > tbody > tr").length;if(h>0&&(parseFloat(ak)!=parseFloat(r))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'><i>Group Members Count (<b>"+ak+"</b>) must equal Group Size <b>"+r+"</b></i></span>",callback:function(){}});return false}}g=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});g.find(".modal-content").css({"margin-top":function(){var aR=$(window).height();var aQ=$(".modal-dialog").height();var aS=aR/2;return aS+"px"}});var Q="Corporate Customer";if(f==1.3){Q="Customer Group"}var F=typeof $("#addtnlCstmrDataCol1").val()==="undefined"?"":$("#addtnlCstmrDataCol1").val();var D=typeof $("#addtnlCstmrDataCol2").val()==="undefined"?"":$("#addtnlCstmrDataCol2").val();var C=typeof $("#addtnlCstmrDataCol3").val()==="undefined"?"":$("#addtnlCstmrDataCol3").val();var B=typeof $("#addtnlCstmrDataCol4").val()==="undefined"?"":$("#addtnlCstmrDataCol4").val();var A=typeof $("#addtnlCstmrDataCol5").val()==="undefined"?"":$("#addtnlCstmrDataCol5").val();var z=typeof $("#addtnlCstmrDataCol6").val()==="undefined"?"":$("#addtnlCstmrDataCol6").val();var y=typeof $("#addtnlCstmrDataCol7").val()==="undefined"?"":$("#addtnlCstmrDataCol7").val();var x=typeof $("#addtnlCstmrDataCol8").val()==="undefined"?"":$("#addtnlCstmrDataCol8").val();var w=typeof $("#addtnlCstmrDataCol9").val()==="undefined"?"":$("#addtnlCstmrDataCol9").val();var X=typeof $("#addtnlCstmrDataCol10").val()==="undefined"?"":$("#addtnlCstmrDataCol10").val();var V=typeof $("#addtnlCstmrDataCol11").val()==="undefined"?"":$("#addtnlCstmrDataCol11").val();var T=typeof $("#addtnlCstmrDataCol12").val()==="undefined"?"":$("#addtnlCstmrDataCol12").val();var S=typeof $("#addtnlCstmrDataCol13").val()==="undefined"?"":$("#addtnlCstmrDataCol13").val();var O=typeof $("#addtnlCstmrDataCol14").val()==="undefined"?"":$("#addtnlCstmrDataCol14").val();var N=typeof $("#addtnlCstmrDataCol15").val()==="undefined"?"":$("#addtnlCstmrDataCol15").val();var M=typeof $("#addtnlCstmrDataCol16").val()==="undefined"?"":$("#addtnlCstmrDataCol16").val();var L=typeof $("#addtnlCstmrDataCol17").val()==="undefined"?"":$("#addtnlCstmrDataCol17").val();var K=typeof $("#addtnlCstmrDataCol18").val()==="undefined"?"":$("#addtnlCstmrDataCol18").val();var J=typeof $("#addtnlCstmrDataCol19").val()==="undefined"?"":$("#addtnlCstmrDataCol19").val();var v=typeof $("#addtnlCstmrDataCol20").val()==="undefined"?"":$("#addtnlCstmrDataCol20").val();var u=typeof $("#addtnlCstmrDataCol21").val()==="undefined"?"":$("#addtnlCstmrDataCol21").val();var t=typeof $("#addtnlCstmrDataCol22").val()==="undefined"?"":$("#addtnlCstmrDataCol22").val();var s=typeof $("#addtnlCstmrDataCol23").val()==="undefined"?"":$("#addtnlCstmrDataCol23").val();var q=typeof $("#addtnlCstmrDataCol24").val()==="undefined"?"":$("#addtnlCstmrDataCol24").val();var p=typeof $("#addtnlCstmrDataCol25").val()==="undefined"?"":$("#addtnlCstmrDataCol25").val();var o=typeof $("#addtnlCstmrDataCol26").val()==="undefined"?"":$("#addtnlCstmrDataCol26").val();var n=typeof $("#addtnlCstmrDataCol27").val()==="undefined"?"":$("#addtnlCstmrDataCol27").val();var l=typeof $("#addtnlCstmrDataCol28").val()==="undefined"?"":$("#addtnlCstmrDataCol28").val();var k=typeof $("#addtnlCstmrDataCol29").val()==="undefined"?"":$("#addtnlCstmrDataCol29").val();var aN=typeof $("#addtnlCstmrDataCol30").val()==="undefined"?"":$("#addtnlCstmrDataCol30").val();var aL=typeof $("#addtnlCstmrDataCol31").val()==="undefined"?"":$("#addtnlCstmrDataCol31").val();var aJ=typeof $("#addtnlCstmrDataCol32").val()==="undefined"?"":$("#addtnlCstmrDataCol32").val();var aI=typeof $("#addtnlCstmrDataCol33").val()==="undefined"?"":$("#addtnlCstmrDataCol33").val();var aH=typeof $("#addtnlCstmrDataCol34").val()==="undefined"?"":$("#addtnlCstmrDataCol34").val();var aG=typeof $("#addtnlCstmrDataCol35").val()==="undefined"?"":$("#addtnlCstmrDataCol35").val();var aF=typeof $("#addtnlCstmrDataCol36").val()==="undefined"?"":$("#addtnlCstmrDataCol36").val();var aE=typeof $("#addtnlCstmrDataCol37").val()==="undefined"?"":$("#addtnlCstmrDataCol37").val();var aD=typeof $("#addtnlCstmrDataCol38").val()==="undefined"?"":$("#addtnlCstmrDataCol38").val();var aC=typeof $("#addtnlCstmrDataCol39").val()==="undefined"?"":$("#addtnlCstmrDataCol39").val();var aA=typeof $("#addtnlCstmrDataCol40").val()==="undefined"?"":$("#addtnlCstmrDataCol40").val();var az=typeof $("#addtnlCstmrDataCol41").val()==="undefined"?"":$("#addtnlCstmrDataCol41").val();var ay=typeof $("#addtnlCstmrDataCol42").val()==="undefined"?"":$("#addtnlCstmrDataCol42").val();var ax=typeof $("#addtnlCstmrDataCol43").val()==="undefined"?"":$("#addtnlCstmrDataCol43").val();var aw=typeof $("#addtnlCstmrDataCol44").val()==="undefined"?"":$("#addtnlCstmrDataCol44").val();var av=typeof $("#addtnlCstmrDataCol45").val()==="undefined"?"":$("#addtnlCstmrDataCol45").val();var au=typeof $("#addtnlCstmrDataCol46").val()==="undefined"?"":$("#addtnlCstmrDataCol46").val();var at=typeof $("#addtnlCstmrDataCol47").val()==="undefined"?"":$("#addtnlCstmrDataCol47").val();var ar=typeof $("#addtnlCstmrDataCol48").val()==="undefined"?"":$("#addtnlCstmrDataCol48").val();var aq=typeof $("#addtnlCstmrDataCol49").val()==="undefined"?"":$("#addtnlCstmrDataCol49").val();var al=typeof $("#addtnlCstmrDataCol50").val()==="undefined"?"":$("#addtnlCstmrDataCol50").val();var W=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var ac=new FormData();ac.append("grp",17);ac.append("typ",1);ac.append("q","UPDATE");ac.append("pg",a);ac.append("subPgNo",f);ac.append("vtyp",e);ac.append("profileID",ah);ac.append("custID",aj);ac.append("idNo",aa);ac.append("clsfctn",an);ac.append("custName",E);ac.append("natureOfBus",Y);ac.append("relation",aK);ac.append("dateOfEstblshmnt",ab);ac.append("bnkBranchID",j);ac.append("startDate",aP);ac.append("endDate",am);ac.append("pstlAddress",ag);ac.append("resAddress",aO);ac.append("email",G);ac.append("contactNos",ad);ac.append("faxNo",Z);ac.append("brandName",aM);ac.append("orgType",R);ac.append("regNo",ap);ac.append("dateOfIncorp",U);ac.append("typeOfIncorp",ai);ac.append("vatNo",ae);ac.append("tinNo",I);ac.append("ssnitRegNo",H);ac.append("noOfEmp",r);ac.append("meetingDays",af);ac.append("srcType",Q);ac.append("shdSbmt",h);ac.append("addtnlCstmrDataCol1",F);ac.append("addtnlCstmrDataCol2",D);ac.append("addtnlCstmrDataCol3",C);ac.append("addtnlCstmrDataCol4",B);ac.append("addtnlCstmrDataCol5",A);ac.append("addtnlCstmrDataCol6",z);ac.append("addtnlCstmrDataCol7",y);ac.append("addtnlCstmrDataCol8",x);ac.append("addtnlCstmrDataCol9",w);ac.append("addtnlCstmrDataCol10",X);ac.append("addtnlCstmrDataCol11",V);ac.append("addtnlCstmrDataCol12",T);ac.append("addtnlCstmrDataCol13",S);ac.append("addtnlCstmrDataCol14",O);ac.append("addtnlCstmrDataCol15",N);ac.append("addtnlCstmrDataCol16",M);ac.append("addtnlCstmrDataCol17",L);ac.append("addtnlCstmrDataCol18",K);ac.append("addtnlCstmrDataCol19",J);ac.append("addtnlCstmrDataCol20",v);ac.append("addtnlCstmrDataCol21",u);ac.append("addtnlCstmrDataCol22",t);ac.append("addtnlCstmrDataCol23",s);ac.append("addtnlCstmrDataCol24",q);ac.append("addtnlCstmrDataCol25",p);ac.append("addtnlCstmrDataCol26",o);ac.append("addtnlCstmrDataCol27",n);ac.append("addtnlCstmrDataCol28",l);ac.append("addtnlCstmrDataCol29",k);ac.append("addtnlCstmrDataCol30",aN);ac.append("addtnlCstmrDataCol31",aL);ac.append("addtnlCstmrDataCol32",aJ);ac.append("addtnlCstmrDataCol33",aI);ac.append("addtnlCstmrDataCol34",aH);ac.append("addtnlCstmrDataCol35",aG);ac.append("addtnlCstmrDataCol36",aF);ac.append("addtnlCstmrDataCol37",aE);ac.append("addtnlCstmrDataCol38",aD);ac.append("addtnlCstmrDataCol39",aC);ac.append("addtnlCstmrDataCol40",aA);ac.append("addtnlCstmrDataCol41",az);ac.append("addtnlCstmrDataCol42",ay);ac.append("addtnlCstmrDataCol43",ax);ac.append("addtnlCstmrDataCol44",aw);ac.append("addtnlCstmrDataCol45",av);ac.append("addtnlCstmrDataCol46",au);ac.append("addtnlCstmrDataCol47",at);ac.append("addtnlCstmrDataCol48",ar);ac.append("addtnlCstmrDataCol49",aq);ac.append("addtnlCstmrDataCol50",al);ac.append("rvsnTtl",W);$.ajax({url:"index.php",type:"POST",data:ac,async:true,success:function(aQ){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var aR="";if(/^[\],:{}\s]*$/.test(aQ.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(aQ);$("#custID").val(m.custID);$("#profileID").val(m.profileID);$("#idNo").val(m.localIdNo);aR="Customer Data Successfully Saved!";if(h>0){aR="Customer Data Successfully Submitted for Approval!"}if(d==2){g.modal("hide");openATab("#prfBCOPAddPrsnDataEDT","grp=17&typ=1&pg=11&subPgNo=1.6&vtyp=1&vtypActn=EDIT&custID="+m.custID+"&formType=Corporate Customer&rvsnTtlAPD="+W);bootbox.alert({size:"small",title:"Rhomicom Message",message:aR,callback:function(){}})}else{getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Customer Profile",11,f,0,"EDIT",m.custID,"","indCustTableRow1",-1,function(){g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:aR,callback:function(){}})})}}else{aR=aQ;g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:aR,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function validateCorpCustomerForm(h,b,q,d,k,n,f,r,c,e,l,g,p,j){var m=0;var a="";var o="<span style='font-weight: bold !important;'>The following is/are required:</span></br>";if(h.trim()==""||h=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#custName").css("border-color","red");$("#custName").css("border-width","2px");a=a+"<b>Customer Name,</b></br>";m=m+1}else{$("#custName").css("border-color","#ccc");$("#custName").css("border-width","1px")}if(j==1.2){if(b.trim()==""||b=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#natureOfBus").css("border-color","red");$("#natureOfBus").css("border-width","2px");a=a+"<b>Nature of Business,</b></br>";m=m+1}else{$("#natureOfBus").css("border-color","#ccc");$("#natureOfBus").css("border-width","1px")}}if(q==""||q=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#dateOfEstblshmnt").css("border-color","red");$("#dateOfEstblshmnt").css("border-width","2px");a=a+"<b>Date of Establishment,</b></br>";m=m+1}else{$("#dateOfEstblshmnt").css("border-color","#ccc");$("#dateOfEstblshmnt").css("border-width","1px")}if(d==""||d=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#startDate").css("border-color","red");$("#startDate").css("border-width","2px");a=a+"Relationship <b>Start Date,</b></br>";m=m+1}else{$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px")}if(k.trim()==""||k=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#resAddress").css("border-color","red");$("#resAddress").css("border-width","2px");if(j==1.2){a=a+"<b>Trading Address,</b></br>"}else{a=a+"<b>Meeting Place,</b></br>"}m=m+1}else{$("#resAddress").css("border-color","#ccc");$("#resAddress").css("border-width","1px")}if(j==1.2){if(n.trim()==""||n=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#email").css("border-color","red");$("#email").css("border-width","2px");a=a+"<b>Email Address,</b></br>";m=m+1}else{$("#email").css("border-color","#ccc");$("#email").css("border-width","1px")}}if(f.trim()==""||f=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#contactNos").css("border-color","red");$("#contactNos").css("border-width","2px");a=a+"<b>Contact Numbers(Separated by commas),</b></br>";m=m+1}else{$("#contactNos").css("border-color","#ccc");$("#contactNos").css("border-width","1px")}if(j==1.3){if(p==""||p=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#meetingDaysLbl").css("border-color","red");$("#meetingDaysLbl").css("border-width","2px");a=a+"<b>Meeting Days,</b></br>";m=m+1}else{$("#meetingDaysLbl").css("border-color","#ccc");$("#meetingDaysLbl").css("border-width","1px")}}if(j==1.2){if(r.trim()==""||r=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#brandName").css("border-color","red");$("#brandName").css("border-width","2px");a=a+"<b>Brand Name,</b></br>";m=m+1}else{$("#brandName").css("border-color","#ccc");$("#brandName").css("border-width","1px")}if(c.trim()==""||c=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#regNo").css("border-color","red");$("#regNo").css("border-width","2px");a=a+"<b>Registration Number,</b></br>";m=m+1}else{$("#regNo").css("border-color","#ccc");$("#regNo").css("border-width","1px")}if(e==""||e=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#dateOfIncorp").css("border-color","red");$("#dateOfIncorp").css("border-width","2px");a=a+"<b>Date of Incorporation,</b></br>";m=m+1}else{$("#dateOfIncorp").css("border-color","#ccc");$("#dateOfIncorp").css("border-width","1px")}if(l.trim()==""||l=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#tinNo").css("border-color","red");$("#tinNo").css("border-width","2px");a=a+"<b>Tax Identification Number(TIN)</b></br>";m=m+1}else{$("#tinNo").css("border-color","#ccc");$("#tinNo").css("border-width","1px")}}if(g==""||g=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#noOfEmp").css("border-color","red");$("#noOfEmp").css("border-width","2px");a=a+"<b>Number of Employees</b></br>";m=m+1}else{$("#noOfEmp").css("border-color","#ccc");$("#noOfEmp").css("border-width","1px")}if(m>0){bootbox.alert({size:"small",title:"Validation Errors",message:o+"<span style='color:red; font-weight:bold !important;'>"+a+"</span>",callback:function(){}});return false}else{$("#custName").css("border-color","#ccc");$("#custName").css("border-width","1px");$("#natureOfBus").css("border-color","#ccc");$("#natureOfBus").css("border-width","1px");$("#dateOfEstblshmnt").css("border-color","#ccc");$("#dateOfEstblshmnt").css("border-width","1px");$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px");$("#resAddress").css("border-color","#ccc");$("#resAddress").css("border-width","1px");$("#email").css("border-color","#ccc");$("#email").css("border-width","1px");$("#contactNos").css("border-color","#ccc");$("#contactNos").css("border-width","1px");$("#brandName").css("border-color","#ccc");$("#brandName").css("border-width","1px");$("#regNo").css("border-color","#ccc");$("#regNo").css("border-width","1px");$("#dateOfIncorp").css("border-color","#ccc");$("#dateOfIncorp").css("border-width","1px");$("#tinNo").css("border-color","#ccc");$("#tinNo").css("border-width","1px");$("#meetingDaysLbl").css("border-color","#ccc");$("#meetingDaysLbl").css("border-width","1px");$("#noOfEmp").css("border-color","#ccc");$("#noOfEmp").css("border-width","1px");return true}}function getCstmrAddtnlDataForm(j,l,a,f,n,m,d,g,c,h,k,b){var e=typeof $("#formTypeInpt").val()==="undefined"?"":$("#formTypeInpt").val();getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var o;if(window.XMLHttpRequest){o=new XMLHttpRequest()}else{o=new ActiveXObject("Microsoft.XMLHTTP")}o.onreadystatechange=function(){if(o.readyState===4&&o.status===200){$("#"+a).html(m);$("#"+l).html(o.responseText);$("#"+j).off("hidden.bs.modal");$("#"+j).one("hidden.bs.modal",function(t){$("#"+a).html("");$("#"+l).html("");$(t.currentTarget).unbind()});$("#"+l+"Diag").draggable();$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(g==="EDIT"){var s=h.split("|");var q=$("#"+n).find("td");for(var p=0;p<s.length;p++){var r=s[p].replace(/^\s*/,"").replace(/\s*$/,"");$("#"+r).val($.trim(q.eq(p+1).text()))}}$("#"+j).on("show.bs.modal",function(t){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+j).modal({backdrop:"static",keyboard:false});$body.removeClass("mdlloading");$(document).ready(function(){$("#"+f).submit(function(t){t.preventDefault();return false})})}};o.open("POST","index.php",true);o.setRequestHeader("Content-type","application/x-www-form-urlencoded");o.send("grp=17&typ=1&pg=11&subPgNo=1.6&vtyp="+d+"&addtnlCstmrPkey="+c+"&extDtColNum="+k+"&pipeSprtdFieldIDs="+h+"&tableElmntID="+b+"&tRowElementID="+n+"&addOrEdit="+g+"&formType="+e)})}function saveCstmrAddtnlDataForm(h,g,c,f,a,b,e){var d=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var n=c.split("|");var r=c.split("|");var m="";var s="";var j=$("#"+b).find("td");var t=Math.floor((Math.random()*99999)+parseInt(f));for(var q=0;q<n.length;q++){var o=n[q].replace(/^\s*/,"").replace(/\s*$/,"");n[q]=o;r[q]=typeof $("#"+o).val()==="undefined"?"%":$("#"+o).val();m=m+"&"+o+"="+r[q];if(e==="EDIT"){j.eq(q+1).html(r[q])}else{s=s+"<td>"+r[q]+"</td>"}}if(e==="ADD"){var l="<td><button type=\"button\" class=\"btn btn-default btn-sm\" onclick=\"getCstmrAddtnlDataForm('myFormsModal', 'myFormsModalBody', 'myFormsModalTitle', 'addtnlCstmrTblrDataForm','cstrExtrTblrDtCol_"+f+"_Row"+t+"', 'Add/Edit Data', 12, 'EDIT', "+g+", '"+c+"', "+f+", 'extDataTblCol_"+f+'\');"><img src="cmn_images/edit32.png" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td>';$("#"+a).append('<tr id="cstmrExtrTblrDtCol_'+f+"_Row"+t+'">'+l+s+"</tr>")}var p="";$("#"+a).find("tr").each(function(v,w){var u=$(this).find("td");for(var v=0;v<n.length;v++){if(v==n.length-1){p=p+u.eq(v+1).text()}else{p=p+u.eq(v+1).text()+"~"}}p=p+"|"});var k;if(window.XMLHttpRequest){k=new XMLHttpRequest()}else{k=new ActiveXObject("Microsoft.XMLHTTP")}k.onreadystatechange=function(){if(k.readyState===4&&k.status===200){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#"+h).html(k.responseText);var u='<span style="font-weight:bold;">Status: </span><span style="color:red;font-weight: bold;">Requires Approval </span>';$("#mySelfStatusBtn").html(u)}};k.open("POST","index.php",true);k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.send("grp=17&typ=1&pg=11&q=UPDATE&actyp=4&addtnlCstmrPkey="+g+"&extDtColNum="+f+"&tableElmntID="+a+"&allTblValues="+p+"&custID="+d)})}function loadCstmrExtrData(){var a=typeof $("#formSrcType").val()==="undefined"?"--Please Select--":$("#formSrcType").val();openATab("#allmodules","grp=17&typ=1&pg=1&subPgNo=1.6&srcType="+a)}function saveCstmrExtrDataCol(g,f){var c="";var a=true;var d="";var e=typeof $("#formSrcType").val()==="undefined"?"--Please Select--":$("#formSrcType").val();if(e=="--Please Select--"){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a <b>Form</b>",callback:function(){}});return false}$("#extrCstmrDtColsTable").find("tr").each(function(p,k){if(p>0){if(typeof $(k).attr("id")==="undefined"){}else{var u=$(k).attr("id").split("_")[1];var t=$("#extrCstmrDtColsRow"+u+"_FieldLbl").val();var h=$("#extrCstmrDtColsRow"+u+"_ColNum").val();if(typeof $("#extrCstmrDtColsRow"+u+"_ColNum").val()==="undefined"){a=false}if(h.trim()===""){a=false}else{if(t.trim()!==""){var n=$("#extrCstmrDtColsRow"+u+"_DtTyp").val();if(n.trim()===""){a=false;d+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Data Type for Column No. '+h+" cannot be empty!</span></p>";$("#extrCstmrDtColsRow"+u+"_DtTyp").addClass("rho-error")}else{$("#extrCstmrDtColsRow"+u+"_DtTyp").removeClass("rho-error")}var q=$("#extrCstmrDtColsRow"+u+"_Ctgry").val();if(q.trim()===""){a=false;d+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Category for Column No. '+h+" cannot be empty!</span></p>";$("#extrCstmrDtColsRow"+u+"_Ctgry").addClass("rho-error")}else{$("#extrCstmrDtColsRow"+u+"_Ctgry").removeClass("rho-error")}var s=$("#extrCstmrDtColsRow"+u+"_DspTyp").val();if(s.trim()===""){a=false;d+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Display Type for Column No. '+h+" cannot be empty!</span></p>";$("#extrCstmrDtColsRow"+u+"_DspTyp").addClass("rho-error")}else{$("#extrCstmrDtColsRow"+u+"_DspTyp").removeClass("rho-error")}var r=$("#extrCstmrDtColsRow"+u+"_DtLen").val();if(r.trim()===""){$("#extrCstmrDtColsRow"+u+"_DtLen").val(200)}var m=$("#extrCstmrDtColsRow"+u+"_Order").val();if(m.trim()===""){$("#extrCstmrDtColsRow"+u+"_Order").val(1)}var j=$("#extrCstmrDtColsRow"+u+"_TblColsNum").val();if(j.trim()===""){if(s==="Tabular"){$("#extrCstmrDtColsRow"+u+"_TblColsNum").val(1)}else{$("#extrCstmrDtColsRow"+u+"_TblColsNum").val(0)}}var l=$("#extrCstmrDtColsRow"+u+"_TblrColNms").val();if(l.trim()===""&&s==="Tabular"){a=false;d+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Tabular Column Names for Column No. '+h+" cannot be empty!</span></p>";$("#extrCstmrDtColsRow"+u+"_TblrColNms").addClass("rho-error")}else{$("#extrCstmrDtColsRow"+u+"_TblrColNms").removeClass("rho-error")}}}if(a===false){}else{var o=typeof $("input[name='extrCstmrDtColsRow"+u+"_IsRqrd']:checked").val()==="undefined"?"NO":"YES";c=c+$("#extrCstmrDtColsRow"+u+"_ColNum").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_ExtrDtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_FieldLbl").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_LovNm").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_DtTyp").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_Ctgry").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_DtLen").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_DspTyp").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_TblColsNum").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_Order").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#extrCstmrDtColsRow"+u+"_TblrColNms").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|"}}}});if(rhotrim(d,"; ")!==""){bootbox.alert({title:"System Alert!",message:d});return false}var b=bootbox.alert({title:"Save Fields/Columns",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving Fields/Columns...Please Wait...</p>',callback:function(){openATab(g,f+"&srcType="+e)}});b.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.6,q:"UPDATE",actyp:1,slctdExtrDataCols:c,srcType:e},success:function(h){setTimeout(function(){b.find(".bootbox-body").html(h)},500)},error:function(h,k,j){console.warn(h.responseText)}})})})}function delCstmrExtrDataCol(e){var b=e.split("_")[1];var d=-1;var a="";if(typeof $("#extrCstmrDtColsRow"+b+"_ExtrDtID").val()==="undefined"){}else{d=$("#extrCstmrDtColsRow"+b+"_ExtrDtID").val();a=$("#extrCstmrDtColsRow"+b+"_ColNum").val()}var c=bootbox.confirm({title:"Remove Field/Column?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this Field/Column?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Remove Field/Column?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing Field/Column...Please Wait...</p>'});g.init(function(){if(d>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,q:"DELETE",subPgNo:1.6,actyp:1,colNum:a,extrdataID:d},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h);if(h.indexOf("Success")!==-1){$("#"+e).remove()}},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){$("#"+e).remove();g.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function getLoanRqstRvrslForm(j,k,b,g,n,m,c,e,f,h,d){var l=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(m);$("#"+k).html(a.responseText);$("#"+j).off("hidden.bs.modal");$("#"+j).one("hidden.bs.modal",function(o){$("#"+b).html("");$("#"+k).html("");$(o.currentTarget).unbind()});$("#"+j).on("show.bs.modal",function(o){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+j).modal({backdrop:"static",keyboard:false});$(document).ready(function(){$("#"+g).submit(function(o){o.preventDefault();return false})})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+h+"&loanRqstID="+l)}function deleteLoanRqstGuarantor(c,b){var d;var a;var e;e=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Guarantor?",callback:function(f){if(f){if(!(b=="Incomplete"||b=="Rejected"||b=="Withdrawn")){e.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Guarantors for Loan Applications with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});d.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j)/2;return l+"px"}});var h=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();var g;if(window.XMLHttpRequest){g=new XMLHttpRequest()}else{g=new ActiveXObject("Microsoft.XMLHTTP")}g.onreadystatechange=function(){if(g.readyState===4&&g.status===200){var j=g.responseText;d.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:j,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k-150)/2;return m+"px"}});getLoanRqstForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Loan Request",15,4.1,0,"EDIT",h,"indCustTable","indCustTableRow1")}};g.open("POST","index.php",true);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send("grp=17&typ=1&pg=15&subPgNo=4.1&q=DELETE&actyp=1&PKeyID="+c)}}});e.find(".modal-content").css({"margin-top":function(){var g=$(window).height();var f=$(".modal-dialog").height();var j=(g-f-150)/2;return j+"px"}})}function validateDateTimePicker(a){var c=$("#"+a).val();var b=false;try{$.datepicker.parseDate("d-M-yy",c);b=true}catch(d){}return b}function validateApplctnFormLoanCalculator(e,a,c,j,k,m,f,n,h,b,d,p,o,g,l){if(c==""||c<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanAmount").css("border-color","red");$("#loanAmount").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Loan amount must be greater than Zero!",callback:function(){}});return false}else{if(a>0&&(parseFloat(c)>parseFloat(j))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanAmount").css("border-color","red");$("#loanAmount").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Maximum applicable loan amount is "+formatAsMoney(j)+" for loan product <span style='color:red;font-weitht:bold !important;'><i>"+e+"</i></span>",callback:function(){}});return false}else{if(a>0&&(parseFloat(c)<parseFloat(k))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanAmount").css("border-color","red");$("#loanAmount").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Mimimum applicable loan amount is "+formatAsMoney(k)+" for loan product <span style='color:red;font-weitht:bold !important;'><i>"+e+"</i></span>",callback:function(){}});return false}else{if(m==""||Number(m)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Loan Tenor must be greater than Zero!",callback:function(){}});return false}else{if(a>0&&((f=="Month(s)"||f=="Year(s)")&&(n==f)&&(Number(m)>Number(h)))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Maximum Loan Tenor is "+h+" "+f+" for loan product <span style='color:red;font-weitht:bold !important;'><i>"+e+"</i></span>",callback:function(){}});return false}else{if(a>0&&(f=="Year(s)"&&n=="Month(s)"&&(Number(m)>(Number(h)*12)))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Maximum Loan Tenor is "+(Number(h)*12)+" Month(s) for loan product <span style='color:red;font-weitht:bold !important;'><i>"+e+"</i></span>",callback:function(){}});return false}else{if(a>0&&(f=="Month(s)"&&n=="Year(s)"&&((Number(m)*12)>Number(h)))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Maximum Loan Tenor is "+(Number(h)/12)+" Year(s) for loan product <span style='color:red;font-weitht:bold !important;'><i>"+e+"</i></span>",callback:function(){}});return false}else{if(a>0&&((b=="Month(s)"||b=="Year(s)")&&(n==b))&&(Number(m)<Number(d))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Minimum Loan Tenor is "+d+" "+b+" for loan product <span style='color:red;font-weitht:bold !important;'><i>"+e+"</i></span>",callback:function(){}});return false}else{if(a>0&&(b=="Year(s)"&&n=="Month(s)"&&(Number(m)<(Number(d)*12)))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Mimimum Loan Tenor is "+(Number(d)*12)+" Month(s) for loan product <span style='color:red;font-weitht:bold !important;'><i>"+e+"</i></span>",callback:function(){}});return false}else{if(a>0&&(b=="Month(s)"&&n=="Year(s)"&&((Number(m)*12)<Number(d)))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Minimum Loan Tenor is "+(Number(d)/12)+" Year(s) for loan product <span style='color:red;font-weitht:bold !important;'><i>"+e+"</i></span>",callback:function(){}});return false}else{if(p==""||p<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#interestRate").css("border-color","red");$("#interestRate").css("border-width","2px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Interest Rate must be greater than Zero (0)</b>",callback:function(){}});return false}else{if(a>0&&(p==""||p<=0||(parseFloat(p)<parseFloat(o)))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#interestRate").css("border-color","red");$("#interestRate").css("border-width","2px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Interest Rate must be greater than the Base Rate of <b>"+o+"% Per Anum</b> for loan product <span style='color:red;font-weitht:bold !important;'><i>"+e+"</i></span>",callback:function(){}});return false}else{if(g==""||g<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#gracePeriodNo").css("border-color","red");$("#gracePeriodNo").css("border-width","2px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Grace Period must be greater than Zero(0) Month/Year</b>",callback:function(){}});return false}else{if(l==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#dsbmntDate").css("border-color","red");$("#dsbmntDate").css("border-width","2px");$("#gracePeriodNo").css("border-color","#ccc");$("#gracePeriodNo").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide valid Disbursement Date</b>",callback:function(){}});return false}else{if(l!=""&&(validateDateTimePicker("dsbmntDate")==false)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#dsbmntDate").css("border-color","red");$("#dsbmntDate").css("border-width","2px");$("#gracePeriodNo").css("border-color","#ccc");$("#gracePeriodNo").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Disbursement Date</b>",callback:function(){}});return false}else{$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");$("#gracePeriodNo").css("border-color","#ccc");$("#gracePeriodNo").css("border-width","1px");$("#dsbmntDate").css("border-color","#ccc");$("#dsbmntDate").css("border-width","1px");return true}}}}}}}}}}}}}}}}function calcLoanAmortization(a,d,c){var e;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var p;var n=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();var x=typeof $("#prdtType").val()==="undefined"?-1:$("#prdtType").val();var m=typeof $("#crdtType").val()==="undefined"?"":$("#crdtType").val();if(m=="Not Applicable"){m="Loan"}var r=typeof $("#crncyIsoCode").text()==="undefined"?"":$("#crncyIsoCode").text();var k=typeof $("#loanAmount").val()==="undefined"?-1:$("#loanAmount").val().trim().length===0?0:$("#loanAmount").val();var v=typeof $("#loanTenor").val()==="undefined"?-1:$("#loanTenor").val().trim().length===0?0:$("#loanTenor").val();var f=typeof $("#loanTenorType").val()==="undefined"?"":$("#loanTenorType").val();var D=typeof $("#interestRate").val()==="undefined"?-1:$("#interestRate").val();var u=typeof $("#intRateType").val()==="undefined"?"":$("#intRateType").val();var z=typeof $("#compound").val()==="undefined"?"":$("#compound").val();var j=typeof $("#payBack").val()==="undefined"?"":$("#payBack").val();var o=typeof $("#gracePeriodNo").val()==="undefined"?-1:$("#gracePeriodNo").val().trim().length===0?0:$("#gracePeriodNo").val();var t=typeof $("#gracePeriodType").val()==="undefined"?"":$("#gracePeriodType").val();var B=typeof $("#loanMaxAmount").val()==="undefined"?-1:$("#loanMaxAmount").val();var s=typeof $("#loanMinAmount").val()==="undefined"?-1:$("#loanMinAmount").val();var y=typeof $("#maxLoanTenor").val()==="undefined"?-1:$("#maxLoanTenor").val();var g=typeof $("#maxLoanTenorType").val()==="undefined"?-1:$("#maxLoanTenorType").val();var h=typeof $("#minLoanTenor").val()==="undefined"?-1:$("#minLoanTenor").val();var q=typeof $("#minLoanTenorType").val()==="undefined"?-1:$("#minLoanTenorType").val();var C=typeof $("#baseIntRate").val()==="undefined"?-1:$("#baseIntRate").val();var l=typeof $("#dsbmntDate").val()==="undefined"?"":$("#dsbmntDate").val();var A=validateApplctnFormLoanCalculator(x,n,k,B,s,v,g,f,y,q,h,D,C,o,l);if(!A){return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Generating Results. Please Wait...</span></div>'});e.find(".modal-content").css({"margin-top":function(){var F=$(window).height();var E=$(".modal-dialog").height();var G=F/2;return G+"px"}});var w=new FormData();w.append("grp",17);w.append("typ",1);w.append("pg",a);w.append("subPgNo",d);w.append("vtyp",c);w.append("actyp",1);w.append("loanAmount",k);w.append("loanTenor",v);w.append("loanTenorType",f);w.append("interestRate",D);w.append("intRateType",u);w.append("compound",z);w.append("payBack",j);w.append("gracePeriodNo",o);w.append("gracePeriodType",t);w.append("dsbmntDate",l);w.append("crdtType",m);w.append("crncyIsoCode",r);$.ajax({url:"index.php",type:"POST",data:w,async:true,success:function(E){e.modal("hide");$("#amrtiztnSchdlDiv").html(E);b=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Results Generated Successfully",callback:function(){}})},cache:false,contentType:false,processData:false})})}function getLoanPrdtDetsForApplctnLoanCalc(a,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var e;var g=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();var d=typeof $("#crdtType").val()==="undefined"?"":$("#crdtType").val();var c=typeof $("#rpmntSrcType").val()==="undefined"?"":$("#rpmntSrcType").val();var f=new FormData();f.append("grp",17);f.append("typ",1);f.append("pg",a);f.append("subPgNo",b);f.append("vtyp",4);f.append("PKeyID",g);$.ajax({url:"index.php",type:"POST",data:f,async:true,success:function(h){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");if(/^[\],:{}\s]*$/.test(h.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=$.parseJSON(h);$("#isAccountRqrd").val(e.loanPrdtDetArry.isAccountRqrd);$("#loanMaxAmount").val(e.loanPrdtDetArry.loanMaxAmount);$("#loanMinAmount").val(e.loanPrdtDetArry.loanMinAmount);$("#maxLoanTenor").val(e.loanPrdtDetArry.maxLoanTenor);$("#maxLoanTenorType").val(e.loanPrdtDetArry.maxLoanTenorType);$("#guarantorRequired").val(e.loanPrdtDetArry.guarantorRequired);$("#guarantorNo").val(e.loanPrdtDetArry.guarantorNo);$("#productType").val(e.loanPrdtDetArry.productType);$("#custTypeCustgrp").val(e.loanPrdtDetArry.custTypeCustgrp);$("#custTypeCorp").val(e.loanPrdtDetArry.custTypeCorp);$("#custTypeInd").val(e.loanPrdtDetArry.custTypeInd);$("#cashCollateralRqrd").val(e.loanPrdtDetArry.cashCollateralRqrd);$("#valueFlatCashColt").val(e.loanPrdtDetArry.valueFlatCashColt);$("#valuePrcntCashColt").val(e.loanPrdtDetArry.valuePrcntCashColt);$("#prptyCollateralRqrd").val(e.loanPrdtDetArry.prptyCollateralRqrd);$("#valueFlatPrptyColt").val(e.loanPrdtDetArry.valueFlatPrptyColt);$("#valuePrcntPrptyColt").val(e.loanPrdtDetArry.valuePrcntPrptyColt);$("#invstmntCollateralRqrd").val(e.loanPrdtDetArry.invstmntCollateralRqrd);$("#valueInvstmntCashColt").val(e.loanPrdtDetArry.valueInvstmntCashColt);$("#valueInvstmntPrcntColt").val(e.loanPrdtDetArry.valueInvstmntPrcntColt);$("#minLoanTenor").val(e.loanPrdtDetArry.minLoanTenor);$("#minLoanTenorType").val(e.loanPrdtDetArry.minLoanTenorType);$("#baseIntRate").val(e.loanPrdtDetArry.baseIntRate);$("#interestRate").val(e.loanPrdtDetArry.baseIntRate);$("#crncyIsoCode").text(e.loanPrdtDetArry.crncyIsoCode);$("#crncyIsoCode2").text(e.loanPrdtDetArry.crncyIsoCode);$("#crncyIsoCode3").text(e.loanPrdtDetArry.crncyIsoCode);$("#crncyIsoCode4").text(e.loanPrdtDetArry.crncyIsoCode);$("#intRateType").val(e.loanPrdtDetArry.intRateType);$("#compound").val(e.loanPrdtDetArry.prdtCompound);$("#payBack").val(e.loanPrdtDetArry.prdtPayBack);$("#gracePeriodNo").val(e.loanPrdtDetArry.gracePeriodNo);$("#gracePeriodType").val(e.loanPrdtDetArry.gracePeriodType)}else{alert(h+"hiii")}},cache:false,contentType:false,processData:false})})}function onClickProductLoanCalc(a,b){var c=$("#custType option:selected").val();var d="MCF Loan Products - Individual";if(c==="Corporate"){d="MCF Loan Products - Corporate";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",d,"gnrlOrgID","custTypeYes","crdtType","radio",true,"","prdtTypeID","prdtType","clear",1,"",function(){getLoanPrdtDetsForApplctnLoanCalc(a,b)})}else{if(c==="Group"){d="MCF Loan Products - Group";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",d,"gnrlOrgID","custTypeYes","crdtType","radio",true,"","prdtTypeID","prdtType","clear",1,"",function(){getLoanPrdtDetsForApplctnLoanCalc(a,b)})}else{if(c==="Individual"){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",d,"gnrlOrgID","custTypeYes","crdtType","radio",true,"","prdtTypeID","prdtType","clear",1,"",function(){getLoanPrdtDetsForApplctnLoanCalc(a,b)})}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Select Customer Type first!",callback:function(){}});return false}}}}function dsplyLoanCalculator(b,a){doAjaxWthCallBck(a,"myFormsModaly",b,"Loans Calculator","myFormsModalyTitle","myFormsModalyBody",function(){loadScript("app/mcf/mcf.js?v="+jsFilesVrsn,function(){$(document).ready(function(){$("#myFormsModaly").off("hidden.bs.modal")})})})}function rejectLoanApplication(c,a,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var f=typeof $("#apprvdLoanAmount").val()==="undefined"?0:$("#apprvdLoanAmount").val();var e=typeof $("#apprvdLoanTenor").val()==="undefined"?0:$("#apprvdLoanTenor").val();var d=typeof $("#apprvdLoanTenorType").val()==="undefined"?"":$("#apprvdLoanTenorType").val();var h=typeof $("#apprvdInterestRate").val()==="undefined"?0:$("#apprvdInterestRate").val();var j=typeof $("#apprvlCmnts").val()==="undefined"?"":$("#apprvlCmnts").val();$body=$("body");if(f==""||f<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Approved Amount must be greater than zero",callback:function(){}});return false}else{if(e==""||Number(e)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Approved Tenure must be greater than zero",callback:function(){}});return false}else{if(h==""||h<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Approved Interest Rate must be a positive value",callback:function(){}});return false}}}var g=new FormData();g.append("grp",17);g.append("typ",1);g.append("pg",1040);g.append("q","WORKFLOW");g.append("actyp",40);g.append("srcDocID",b);g.append("RoutingID",c);g.append("actiontyp",a);g.append("apprvdLoanAmount",f);g.append("apprvdLoanTenor",e);g.append("apprvdLoanTenorType",d);g.append("apprvdInterestRate",h);g.append("apprvlCmnts",j);$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.confirm({title:"APPROVE LOAN APPLICATION?",message:"Are you sure you want to Reject this Loan Application?",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(k){if(k){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:g,async:true,success:function(l){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#myFormsModalLx").modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){$("#myFormsModalLg").modal("hide");getMyInbx("","#myinbox","grp=40&typ=2&pg=0&vtyp=0")}})},cache:false,contentType:false,processData:false})}}})})}function approveLoanApplication(c,a,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var f=typeof $("#apprvdLoanAmount").val()==="undefined"?0:$("#apprvdLoanAmount").val();var g=typeof $("#apprvdLoanTenor").val()==="undefined"?0:$("#apprvdLoanTenor").val();var l=typeof $("#apprvdLoanTenorType").val()==="undefined"?"":$("#apprvdLoanTenorType").val();var k=typeof $("#apprvdInterestRate").val()==="undefined"?0:$("#apprvdInterestRate").val();var e=typeof $("#apprvlCmnts").val()==="undefined"?"":$("#apprvlCmnts").val();var m=typeof $("#custGrpID").val()==="undefined"?-1:$("#custGrpID").val();var j="";var n=0;var d=0;$body=$("body");if(f==""||f<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Approved Amount must be greater than zero",callback:function(){}});return false}else{if(g==""||Number(g)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Approved Tenure must be greater than zero",callback:function(){}});return false}else{if(k==""||k<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Approved Interest Rate must be a positive value",callback:function(){}});return false}}}if(parseInt(m)>0){$("#grpMembersDetTable").find("tr").each(function(p,r){if(p>0){if(typeof $(r).attr("id")==="undefined"){}else{var o=$(r).attr("id").split("_")[1];if(typeof $("#grpMembersDetRow"+o+"_CustID").val()==="undefined"){}else{if($("#grpMembersDetRow"+o+"_CustID").val()==""||$("#grpMembersDetRow"+o+"_CustID").val()==-1){$("#grpMembersDetRow"+o+"_CustNm").css("border-color","red");$("#grpMembersDetRow"+o+"_CustNm").css("border-width","2px");n=n+1}else{$("#grpMembersDetRow"+o+"_CustNm").css("border-color","#ccc");$("#grpMembersDetRow"+o+"_CustNm").css("border-width","1px")}if($("#grpMembersDetRow"+o+"_AprvdAmount").val()==""||$("#grpMembersDetRow"+o+"_AprvdAmount").val()==0){$("#grpMembersDetRow"+o+"_AprvdAmount").css("border-color","red");$("#grpMembersDetRow"+o+"_AprvdAmount").css("border-width","2px");n=n+1}else{$("#grpMembersDetRow"+o+"_AprvdAmount").css("border-color","#ccc");$("#grpMembersDetRow"+o+"_AprvdAmount").css("border-width","1px")}if($("#grpMembersDetRow"+o+"_RpmntAcctID").val()==""||$("#grpMembersDetRow"+o+"_RpmntAcctID").val()==-1){$("#grpMembersDetRow"+o+"_RpmntAcctNm").css("border-color","red");$("#grpMembersDetRow"+o+"_RpmntAcctNm").css("border-width","2px");n=n+1}else{$("#grpMembersDetRow"+o+"_RpmntAcctNm").css("border-color","#ccc");$("#grpMembersDetRow"+o+"_RpmntAcctNm").css("border-width","1px")}if(n<=0){j=j+$("#grpMembersDetRow"+o+"_PkeyID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+o+"_CustID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+o+"_AprvdAmount").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+o+"_RpmntAcctID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+o+"_CashColtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+o+"_InvtmntColtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+o+"_PrptyColtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";d=d+1}var q=q+1}}}});if(n>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please complete all highlighted fields</i></b></span>",callback:function(){}});return false}}var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("pg",1040);h.append("q","WORKFLOW");h.append("actyp",40);h.append("srcDocID",b);h.append("RoutingID",c);h.append("actiontyp",a);h.append("apprvdLoanAmount",f);h.append("apprvdLoanTenor",g);h.append("apprvdLoanTenorType",l);h.append("apprvdInterestRate",k);h.append("apprvlCmnts",e);if(d>0){h.append("slctdGrpMembers",j)}$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.confirm({title:"APPROVE LOAN APPLICATION?",message:"Are you sure you want to Approve this Loan Application?",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(o){if(o){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(p){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#myFormsModalLx").modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:p,callback:function(){$("#myFormsModalLg").modal("hide");getMyInbx("","#myinbox","grp=40&typ=2&pg=0&vtyp=0")}})},cache:false,contentType:false,processData:false})}}})})}function getTblRowsCount(b){var a=0;$("#"+b).find("tr").each(function(c,d){if(c>0){if(typeof $(d).attr("id")==="undefined"){}else{a=a+1}}});return a}function onDsbmntBnkBranchChange(){var a=getTblRowsCount("disbmntDetTblAdd");if(a<=0){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","Sites/Locations New","gnrlOrgID","","","radio",true,"","bnkBranchID","bnkBranch","clear",1,"")}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'>To change Branch, delete all the disbursement detail records first!</span>",callback:function(){}});return false}}function onDsbmntCrncyChange(){var a=getTblRowsCount("disbmntDetTblAdd");if(a<=0){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","Bank Currencies (LOV)","gnrlOrgID","","","radio",true,"","crncyID","crncy","clear",1,"")}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'>To change Currency, delete all the disbursement detail records first!</span>",callback:function(){}});return false}}function dspCustGrpOnDisbForm(){var a=$("#custType option:selected").val();if(a==="Group Members"){$("#custGrpDiv").css("display","block");$("#custGrpID").val(-1);$("#custGrp").val("")}else{$("#custGrpDiv").css("display","none");$("#custGrpID").val(-1);$("#custGrp").val("")}}function saveCashDenominationForm_LoanRepay(g,o){var n=0;var r=0;var f;var x;var h;var k;var b;var c;var e=false;var v=$("#mcfPymtCrncyNm").val();var j="";$("#cashBreakdownTblEDT").find("tr").each(function(z,A){if(z>0){if(typeof $(A).attr("id")==="undefined"){}else{var y=$(A).attr("id").split("_")[1];h=$("#cashBreakdownRow_"+y+" .cbQty").val();k=$("#cashBreakdownRow_"+y+" .cbExchngRate").val().replace(/,/g,"");b=$("#cashBreakdownRow_"+y+" .lnTrnsType").val();f=$("#cashBreakdownRow_"+y).find("td");x=$.trim(f.eq(5).text());if(b=="Refund"){n=n-(Number(h)*Number(x));r=r-(Number(h)*Number(x)*Number(k))}else{n=n+(Number(h)*Number(x));r=r+(Number(h)*Number(x)*Number(k))}if(isInt(Number(h))===false){j+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Denomination Qty(Pieces) for Row No. '+z+" cannot be empty!</span></p>";$("#cashBreakdownRow_"+y+" .cbQty").addClass("rho-error");$("#cashBreakdownRow_"+y+" .cbTTlAmnt").addClass("rho-error")}else{$("#cashBreakdownRow_"+y+" .cbQty").removeClass("rho-error");$("#cashBreakdownRow_"+y+" .cbTTlAmnt").removeClass("rho-error")}}}});if(rhotrim(j,"; ")!==""){bootbox.alert({title:"System Alert!",message:j});return false}$("#cashBreakdownLgnd").text(v+" "+addCommas(n.toFixed(2)));$("#mcfCptrdCbValsTtlBtn").text(addCommas(n.toFixed(2)));$("#cashDenominationsTtlRaw").val(n.toFixed(2));$("#cashDenominationsTtlRaw1").val(r.toFixed(2));$("#cashDenominationsTtlFmtd").val(addCommas(n.toFixed(2)));var q;var p=typeof $("#acctTrnsId").val()==="undefined"?-1:$("#acctTrnsId").val();var m=typeof $("#bnkPymtDfltVltID").val()==="undefined"?-1:$("#bnkPymtDfltVltID").val();var d=typeof $("#bnkPymtDfltCageID").val()==="undefined"?-1:$("#bnkPymtDfltCageID").val();var t=typeof $("#bnkPymtDfltItemState").val()==="undefined"?"":$("#bnkPymtDfltItemState").val();var a="";var v=$("#acctCrncy").val();$("#cashBreakdownTblEDT").find("tr").each(function(z,A){if(z>0){if(typeof $(A).attr("id")==="undefined"){}else{var y=$(A).attr("id").split("_")[1];if(typeof $("#cashBreakdownRow_"+y).val()==="undefined"){}else{a=a+$("#cashBreakdownRow"+y+"_denomID").text().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"~"+$("#cashBreakdownRow"+y+"_denomQty").val().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"~"+$("#cashBreakdownRow"+y+"_value").text().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"~"+$("#cashBreakdownRow"+y+"_cashAnalysisID").text().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"~"+$("#cashBreakdownRow"+y+"_ExchngRate").val().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"~"+$("#cashBreakdownRow"+y+"_lnTrnsType").val().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"|"}}}});$("#trnsAmount").val($("#cashDenominationsTtlFmtd").val());$("#trnsAmntRaw").val($("#cashDenominationsTtlRaw").val());var l=Number($("#cashDenominationsTtlRaw1").val().replace(/,/g,""));var w=0;$("#trnsAmntRaw1").val(l);$("#tllrTrnsAmntTtlFld").html(v+" "+addCommas((l+w).toFixed(2)));$("#ttlDocAmntVal").val(l+w);var s="Cash Breakdown";var u=bootbox.alert({title:"Save "+s,size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving '+s+"...Please Wait...</p>",callback:function(){$("#"+g).modal("hide")}});u.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");var y=new FormData();y.append("grp",17);y.append("typ",1);y.append("pg",15);y.append("q","UPDATE");y.append("subPgNo",o);y.append("vtyp",2);y.append("cashBrkdwns",a);y.append("PKeyID",p);y.append("bnkPymtDfltVltID",m);y.append("bnkPymtDfltCageID",d);y.append("bnkPymtDfltItemState",t);$.ajax({url:"index.php",method:"POST",data:y,async:true,cache:false,contentType:false,processData:false,success:function(z){setTimeout(function(){var B="";var A=-1;if(/^[\],:{}\s]*$/.test(z.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){q=$.parseJSON(z);A=q.rowID;B="Json Data"}else{B=z}$body.removeClass("mdlloadingDiag");u.find(".bootbox-body").html(B);setTimeout(function(){u.modal("hide");$("#"+g).modal("hide")},100)},50)},error:function(z,B,A){console.warn(z.responseText)}})})})}function calcCashBreadownRowVal_LoanRepay(f,d){var a=0;var g;var c;var e;var b;if(d=="cbQty"){g=$("#"+f+" .cbQty").val();c=$("#"+f).find("td");e=$.trim(c.eq(5).text());a=(Number(g)*Number(e));if($.trim(c.eq(0).text())=="Coin"){$("#"+f).find("td:eq(3) input[type='text']").val(addCommas(a.toFixed(2)))}else{$("#"+f).find("td:eq(3) input[type='text']").val(addCommas(a))}b=$("#cashDenominationsTtl").val()}else{if(d=="cbTTlAmnt"){c=$("#"+f).find("td");a=Number($("#"+f+" .cbTTlAmnt").val().replace(/,/g,""));$("#"+f+" .cbTTlAmnt").val(addCommas(a.toFixed(2)));e=$.trim(c.eq(5).text());g=(Number(a)/Number(e));$("#"+f).find("td:eq(2) input[type='number']").val(g);b=$("#cashDenominationsTtl").val()}else{if(d=="cbExchngRate"){$("#"+f+" .cbExchngRate").val(Number($("#"+f+" .cbExchngRate").val().replace(/,/g,"")).toFixed(4));b=$("#cashDenominationsTtl").val()}else{b=$("#cashDenominationsTtl").val()}}}calcAllMcfCbTtl_LoanRepay()}function calcAllMcfCbTtl_LoanRepay(){var f=0;var c=0;var a;var b;var d;var h;var e;var g=$("#mcfPymtCrncyNm").val();var j=$("#mcfTlrTrnsType").val();$("#cashBreakdownTblEDT").find("tr").each(function(m,n){if(m>0){if(typeof $(n).attr("id")==="undefined"){}else{var l=$(n).attr("id").split("_")[1];d=$("#cashBreakdownRow_"+l+" .cbQty").val();h=$("#cashBreakdownRow_"+l+" .cbExchngRate").val().replace(/,/g,"");e=$("#cashBreakdownRow_"+l+" .lnTrnsType").val();a=$("#cashBreakdownRow_"+l).find("td");b=$.trim(a.eq(5).text());if(e=="Refund"){f=f-(Number(d)*Number(b));c=c-(Number(d)*Number(b)*Number(h))}else{f=f+(Number(d)*Number(b));c=c+(Number(d)*Number(b)*Number(h))}var p=$.trim(a.eq(6).text());var o=typeof $("#cashBreakdownDenom_"+p+"").val()==="undefined"?"0":$("#cashBreakdownDenom_"+p+"").val();if(j.trim()=="DEPOSIT"||j.trim()=="LOAN_REPAY"){var k=0;if(e=="Refund"){k=Number(o.replace(/[^-?0-9\.]/g,""))-(Number(d)*Number(b))}else{k=Number(o.replace(/[^-?0-9\.]/g,""))+(Number(d)*Number(b))}$("#cashBreakdownRow"+m+"_RnngBal").val(addCommas(k.toFixed(2)))}else{var k=Number(o.replace(/[^-?0-9\.]/g,""))-(Number(d)*Number(b));$("#cashBreakdownRow"+m+"_RnngBal").val(addCommas(k.toFixed(2)))}}}});$("#cashBreakdownLgnd").text(g+" "+addCommas(f.toFixed(2)));$("#mcfCptrdCbValsTtlBtn").text(addCommas(f.toFixed(2)));$("#cashDenominationsTtlRaw").val(f.toFixed(2));$("#cashDenominationsTtlRaw1").val(c.toFixed(2));$("#cashDenominationsTtlFmtd").val(addCommas(f.toFixed(2)))}function finalzeMCFTrnsRqst_LoanPymnt(d,e,c){var b=typeof $("#acctTrnsId").val()==="undefined"?-1:$("#acctTrnsId").val();var a=bootbox.confirm({title:"Finalize Request?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">FINALIZE</span> this Request?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Finalize Request?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Finalizing Request...Please Wait...</p>',callback:function(){if(b>0){getCoreBankingForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg",d,15,c,0,"ADD",b)}}});g.init(function(){if(b>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:1041,q:"FINALIZE",mcfTrnsHdrID:b},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h)},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){g.find(".bootbox-body").html('<span style="color:red;">Nothing to Withdraw!</span>')},500)}})}}})}function onClickManualPymntLoans(a,c){var b=$("#disbmntHdrID").val();if(b=="-1"){$("#disbmntHdrNo").css("border-color","red");$("#disbmntHdrID").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red !important;'>Please Select Disbursement Header No. first!</span>",callback:function(){}});return false}else{$("#disbmntHdrNo").css("border-color","#ccc");$("#disbmntHdrID").css("border-width","1px");getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","MCF Disbursed Loans for Manual Payments","gnrlOrgID","disbmntHdrID","","radio",true,"","disbmntDetID","disbmntDetNo","clear",1,"",function(){getDisbursedLoanDetsForPymnts(a,c)})}}function getDisbursedLoanDetsForPymnts(a,d){var b=$("#disbmntDetID").val();$body=$("body");$body.addClass("mdlloadingDiag");var c;if(window.XMLHttpRequest){c=new XMLHttpRequest()}else{c=new ActiveXObject("Microsoft.XMLHTTP")}c.onreadystatechange=function(){if(c.readyState===4&&c.status===200){var l="";var k=c.responseText;if(/^[\],:{}\s]*$/.test(k.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){json=$.parseJSON(k);var f=json.accountDetails.disbrsdLoanAmnt;$("#disbrsdLoanAmnt").val(json.accountDetails.disbrsdLoanAmnt);$("#trnsAmntRaw").val(json.accountDetails.disbrsdLoanAmnt);$("#trnsAmntRaw1").val(json.accountDetails.disbrsdLoanAmnt);$("#trnsAmount").val(addCommas(Number(f.replace(/[^-?0-9\.]/g,"")).toFixed(2)));$("#mandate").val("Only to sign");var e=json.signatories.length;var h="";var g=0;var j=0;for(g=0;g<e;g++){j++;h=h+'<tr id="acctSignatoriesTblAddRow_'+j+'"><td class="lovtd">'+j+'</td><td  class="lovtd" id="acctSignatoriesTblAddRow'+j+'_name">'+json.signatories[g].name+'</td><td class="lovtd" style="text-align: center !important;"><input type="checkbox" class="form-check-input"></td><td class="lovtd"><button type="button" class="btn btn-info btn-sm" onclick="viewSignatoryForm(\'myLovModal\', \'myLovModalBody\', \'myLovModalTitle\', \'acctSignatoryForm\', \'\', \'Signatory\', 13, 2.1, 5, \'VIEW\','+json.signatories[g].id+',\'LOANPYMNT\');" style="padding:2px !important;">View Signatory</button></td><td class="lovtd">'+json.signatories[g].bioData+'</td><td  class="lovtd" style="display:none;" id="acctSignatoriesTblAddRow'+j+'_ID">'+json.signatories[g].id+'</td><td style="display:none;" id="acctSignatoriesTblAddRow'+j+'_MndtrySign">'+json.signatories[g].toSignMndtry+"</td></tr>"}$("#acctSignatoriesTblTbody").children("tr").remove();$("#acctSignatoriesTblAdd").append(h)}else{l=k;if(l=="INVALID ID"){$("#disbrsdLoanAmnt").val("");$("#trnsAmntRaw").val("");$("#trnsAmntRaw1").val("");$("#trnsAmount").val("");$("#trnsPersonName").val("");$("#acctSignatoriesTblTbody").children("tr").remove();bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}})}else{alert("HelloOOO "+k)}}$body.removeClass("mdlloadingDiag")}};c.open("POST","index.php",true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send("grp=17&typ=1&pg="+a+"&subPgNo="+d+"&vtyp=0&vtypActn=LOANPYMNT&disbmntDetID="+b)}function wthdrwMCFTrnsRqst_CrdtMgmnt(d,e,c){var b=typeof $("#acctTrnsId").val()==="undefined"?-1:$("#acctTrnsId").val();var a=bootbox.confirm({title:"Withdraw Request?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">WITHDRAW</span> this Request?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Withdraw Request?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Withdrawing Request...Please Wait...</p>',callback:function(){if(b>0){getCoreBankingForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg",d,15,c,0,"ADD",b)}}});g.init(function(){if(b>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:1040,q:"DELETE",mcfTrnsHdrID:b},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h)},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){g.find(".bootbox-body").html('<span style="color:red;">Nothing to Withdraw!</span>')},500)}})}}})}function authrzeMCFTrnsRqst_CrdtMgmnt(d,e,c){var b=typeof $("#acctTrnsId").val()==="undefined"?-1:$("#acctTrnsId").val();var a=bootbox.confirm({title:"Authorize Request?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">AUTHORIZE</span> this Request?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Authorize Request?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Authorizing Request...Please Wait...</p>',callback:function(){if(b>0){getCoreBankingForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg",d,15,c,0,"ADD",b)}}});g.init(function(){if(b>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:1040,q:"FINALIZE",mcfTrnsHdrID:b},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h)},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){g.find(".bootbox-body").html('<span style="color:red;">Nothing to Withdraw!</span>')},500)}})}}})}function finalzeMCFTrnsRqst_CrdtMgmnt(d,f,c){var e=2041;if(d=="LOAN_PYMNT"){e=1041}var b=typeof $("#acctTrnsId").val()==="undefined"?-1:$("#acctTrnsId").val();var a=bootbox.confirm({title:"Finalize Request?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">FINALIZE</span> this Request?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(g){if(g===true){var h=bootbox.alert({title:"Finalize Request?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Finalizing Request...Please Wait...</p>',callback:function(){if(b>0){getCoreBankingForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg",d,15,c,0,"ADD",b)}}});h.init(function(){if(b>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:e,q:"FINALIZE",mcfTrnsHdrID:b},success:function(j){setTimeout(function(){h.find(".bootbox-body").html(j)},500)},error:function(l,j,k){h.find(".bootbox-body").html(k)}})})}else{setTimeout(function(){h.find(".bootbox-body").html('<span style="color:red;">Nothing to Withdraw!</span>')},500)}})}}})}function delMCFTrnsHdr_LoanRpmnt(e){var g="Banking Transaction";var b=e.split("_")[1];var d=-1;var a="";if(typeof $("#allMcfTrnsHdrsRow"+b+"_HdrID").val()==="undefined"){}else{d=$("#allMcfTrnsHdrsRow"+b+"_HdrID").val();var f=$("#"+e).find("td");a=$.trim(f.eq(3).text())}var c=bootbox.confirm({title:"Delete "+g+"?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">DELETE</span> this '+g+"?<br/>Action cannot be Undone!</p>",buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(h){if(h===true){var j=bootbox.alert({title:"Delete "+g+"?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Deleting '+g+"...Please Wait...</p>",callback:function(){$("body").css("padding","0px 0px 0px 0px")}});j.init(function(){if(d>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.3,q:"DELETE",actyp:1,trnsHdrID:d,trnsNum:a},success:function(k){setTimeout(function(){j.find(".bootbox-body").html(k);if(k.indexOf("Success")!==-1){$("#"+e).remove()}},500)},error:function(m,k,l){j.find(".bootbox-body").html(l)}})})}else{setTimeout(function(){$("#"+e).remove();j.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function saveCashDenominationFormLR(f,n){var m=0;var q=0;var e;var w;var g;var j;var b;var d=false;var u=$("#mcfPymtCrncyNm").val();var h="";$("#cashBreakdownTblEDT").find("tr").each(function(y,z){if(y>0){if(typeof $(z).attr("id")==="undefined"){}else{var x=$(z).attr("id").split("_")[1];g=$("#cashBreakdownRow_"+x+" .cbQty").val();j=$("#cashBreakdownRow_"+x+" .cbExchngRate").val().replace(/,/g,"");e=$("#cashBreakdownRow_"+x).find("td");w=$.trim(e.eq(5).text());m=m+(Number(g)*Number(w));q=q+(Number(g)*Number(w)*Number(j));if(isInt(Number(g))===false){h+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Denomination Qty(Pieces) for Row No. '+y+" cannot be empty!</span></p>";$("#cashBreakdownRow_"+x+" .cbQty").addClass("rho-error");$("#cashBreakdownRow_"+x+" .cbTTlAmnt").addClass("rho-error")}else{$("#cashBreakdownRow_"+x+" .cbQty").removeClass("rho-error");$("#cashBreakdownRow_"+x+" .cbTTlAmnt").removeClass("rho-error")}}}});if(rhotrim(h,"; ")!==""){bootbox.alert({title:"System Alert!",message:h});return false}$("#cashBreakdownLgnd").text(u+" "+addCommas(m.toFixed(2)));$("#mcfCptrdCbValsTtlBtn").text(addCommas(m.toFixed(2)));$("#cashDenominationsTtlRaw").val(m.toFixed(2));$("#cashDenominationsTtlRaw1").val(q.toFixed(2));$("#cashDenominationsTtlFmtd").val(addCommas(m.toFixed(2)));var p;var o=typeof $("#acctTrnsId").val()==="undefined"?-1:$("#acctTrnsId").val();var l=typeof $("#bnkPymtDfltVltID").val()==="undefined"?-1:$("#bnkPymtDfltVltID").val();var c=typeof $("#bnkPymtDfltCageID").val()==="undefined"?-1:$("#bnkPymtDfltCageID").val();var s=typeof $("#bnkPymtDfltItemState").val()==="undefined"?"":$("#bnkPymtDfltItemState").val();var a="";var u=$("#acctCrncy").val();$("#cashBreakdownTblEDT").find("tr").each(function(y,z){if(y>0){if(typeof $(z).attr("id")==="undefined"){}else{var x=$(z).attr("id").split("_")[1];if(typeof $("#cashBreakdownRow_"+x).val()==="undefined"){}else{a=a+$("#cashBreakdownRow"+x+"_denomID").text().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"~"+$("#cashBreakdownRow"+x+"_denomQty").val().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"~"+$("#cashBreakdownRow"+x+"_value").text().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"~"+$("#cashBreakdownRow"+x+"_cashAnalysisID").text().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"~"+$("#cashBreakdownRow"+x+"_ExchngRate").val().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"|"}}}});$("#trnsAmount").val($("#cashDenominationsTtlFmtd").val());$("#trnsAmntRaw").val($("#cashDenominationsTtlRaw").val());var k=Number($("#cashDenominationsTtlRaw1").val().replace(/,/g,""));var v=0;$("#trnsAmntRaw1").val(k);$("#tllrTrnsAmntTtlFld").html(u+" "+addCommas((k+v).toFixed(2)));$("#ttlDocAmntVal").val(k+v);var r="Cash Breakdown";var t=bootbox.alert({title:"Save "+r,size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving '+r+"...Please Wait...</p>",callback:function(){$("#"+f).modal("hide")}});t.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");var x=new FormData();x.append("grp",17);x.append("typ",1);x.append("pg",15);x.append("q","UPDATE");x.append("subPgNo",n);x.append("vtyp",2);x.append("cashBrkdwns",a);x.append("PKeyID",o);x.append("bnkPymtDfltVltID",l);x.append("bnkPymtDfltCageID",c);x.append("bnkPymtDfltItemState",s);$.ajax({url:"index.php",method:"POST",data:x,async:true,cache:false,contentType:false,processData:false,success:function(y){setTimeout(function(){var A="";var z=-1;if(/^[\],:{}\s]*$/.test(y.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){p=$.parseJSON(y);z=p.rowID;A="Json Data"}else{A=y}$body.removeClass("mdlloadingDiag");t.find(".bootbox-body").html(A)},50)},error:function(y,A,z){console.warn(y.responseText)}})})})}function deleteLoanDisbursement(c,b){var d;var a;var e;e=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Disbursement?",callback:function(f){if(f){if(!(b=="Incomplete"||b=="Rejected"||b=="Withdrawn")){e.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Disbursements with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});d.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j)/2;return l+"px"}});var g;if(window.XMLHttpRequest){g=new XMLHttpRequest()}else{g=new ActiveXObject("Microsoft.XMLHTTP")}g.onreadystatechange=function(){if(g.readyState===4&&g.status===200){var h=g.responseText;d.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:h,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.2")}};g.open("POST","index.php",true);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send("grp=17&typ=1&pg=15&subPgNo=4.2&q=DELETE&PKeyID="+c)}}});e.find(".modal-content").css({"margin-top":function(){var g=$(window).height();var f=$(".modal-dialog").height();var j=(g-f-150)/2;return j+"px"}})}function deleteLoanDisbursementDet(b,c){var d;var a;var e;e=bootbox.confirm({size:"small",message:"Are you sure you want to remove this loan from the Disbursement List?",callback:function(f){if(f){d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});d.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j)/2;return l+"px"}});var g;if(window.XMLHttpRequest){g=new XMLHttpRequest()}else{g=new ActiveXObject("Microsoft.XMLHTTP")}g.onreadystatechange=function(){if(g.readyState===4&&g.status===200){var h=g.responseText;d.modal("hide");getDisbursementForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Disbursement",15,4.2,0,"EDIT",c,"indCustTable","indCustTableRow1",function(){a=bootbox.alert({size:"small",title:"Rhomicom Message",message:h,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})})}};g.open("POST","index.php",true);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send("grp=17&typ=1&pg=15&subPgNo=4.2&q=DELETE&actyp=1&PKeyID="+b)}}});e.find(".modal-content").css({"margin-top":function(){var g=$(window).height();var f=$(".modal-dialog").height();var j=(g-f-150)/2;return j+"px"}})}function deleteLoanApplication(e,b){var c;var a;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this product?",callback:function(f){if(f){if(!(b=="Incomplete"||b=="Rejected"||b=="Withdrawn")){d.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only Loan Applications with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j)/2;return l+"px"}});var g;if(window.XMLHttpRequest){g=new XMLHttpRequest()}else{g=new ActiveXObject("Microsoft.XMLHTTP")}g.onreadystatechange=function(){if(g.readyState===4&&g.status===200){var h=g.responseText;c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:h,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.1")}};g.open("POST","index.php",true);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send("grp=17&typ=1&pg=15&subPgNo=4.1&q=DELETE&PKeyID="+e)}}});d.find(".modal-content").css({"margin-top":function(){var g=$(window).height();var f=$(".modal-dialog").height();var j=(g-f-150)/2;return j+"px"}})}function onChangeCrdtType(){var a=typeof $("#crdtType").val()==="undefined"?"":$("#crdtType").val();var b=typeof $("#isAccountRqrd").val()==="undefined"?"":$("#isAccountRqrd").val();$("#prdtTypeID").val(-1);$("#prdtType").val("");if(b=="Yes"){if(a=="Overdraft"){$("#rpmntSrcAcctDiv").css("display","table-cell");$("#rpmntSrcType").val("Account Deductions");$("#rpmntSrcType").attr("disabled",true)}}else{if(a=="Overdraft"){$("#rpmntSrcAcctDiv").css("display","table-cell");$("#rpmntSrcType").val("Account Deductions");$("#rpmntSrcType").attr("disabled",true)}else{$("#rpmntSrcType").attr("disabled",false)}}}function onChangeRpymntType(){var a=typeof $("#rpmntSrcType").val()==="undefined"?"":$("#rpmntSrcType").val();if(a=="Manual Payments"){$("#rpmntSrcAcctDiv").css("display","none");$("#rpmntSrcAcctID").val(-1);$("#rpmntSrcAcct").val("")}else{$("#rpmntSrcAcctDiv").css("display","table-cell")}}function getLoanPrdtDetsForApplctn(a,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var e;var g=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();var d=typeof $("#crdtType").val()==="undefined"?"":$("#crdtType").val();var c=typeof $("#rpmntSrcType").val()==="undefined"?"":$("#rpmntSrcType").val();var f=new FormData();f.append("grp",17);f.append("typ",1);f.append("pg",a);f.append("subPgNo",b);f.append("vtyp",4);f.append("PKeyID",g);$.ajax({url:"index.php",type:"POST",data:f,async:true,success:function(h){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");if(/^[\],:{}\s]*$/.test(h.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=$.parseJSON(h);$("#isAccountRqrd").val(e.loanPrdtDetArry.isAccountRqrd);$("#loanMaxAmount").val(e.loanPrdtDetArry.loanMaxAmount);$("#loanMinAmount").val(e.loanPrdtDetArry.loanMinAmount);$("#maxLoanTenor").val(e.loanPrdtDetArry.maxLoanTenor);$("#maxLoanTenorType").val(e.loanPrdtDetArry.maxLoanTenorType);$("#guarantorRequired").val(e.loanPrdtDetArry.guarantorRequired);$("#guarantorNo").val(e.loanPrdtDetArry.guarantorNo);$("#productType").val(e.loanPrdtDetArry.productType);$("#custTypeCustgrp").val(e.loanPrdtDetArry.custTypeCustgrp);$("#custTypeCorp").val(e.loanPrdtDetArry.custTypeCorp);$("#custTypeInd").val(e.loanPrdtDetArry.custTypeInd);$("#cashCollateralRqrd").val(e.loanPrdtDetArry.cashCollateralRqrd);$("#valueFlatCashColt").val(e.loanPrdtDetArry.valueFlatCashColt);$("#valuePrcntCashColt").val(e.loanPrdtDetArry.valuePrcntCashColt);$("#prptyCollateralRqrd").val(e.loanPrdtDetArry.prptyCollateralRqrd);$("#valueFlatPrptyColt").val(e.loanPrdtDetArry.valueFlatPrptyColt);$("#valuePrcntPrptyColt").val(e.loanPrdtDetArry.valuePrcntPrptyColt);$("#invstmntCollateralRqrd").val(e.loanPrdtDetArry.invstmntCollateralRqrd);$("#valueInvstmntCashColt").val(e.loanPrdtDetArry.valueInvstmntCashColt);$("#valueInvstmntPrcntColt").val(e.loanPrdtDetArry.valueInvstmntPrcntColt);$("#minLoanTenor").val(e.loanPrdtDetArry.minLoanTenor);$("#minLoanTenorType").val(e.loanPrdtDetArry.minLoanTenorType);$("#baseIntRate").val(e.loanPrdtDetArry.baseIntRate);$("#interestRate").val(e.loanPrdtDetArry.baseIntRate);$("#crncyIsoCode").text(e.loanPrdtDetArry.crncyIsoCode);if(e.loanPrdtDetArry.isAccountRqrd=="Yes"){$("#rpmntSrcAcctDiv").css("display","table-cell");$("#rpmntSrcType").val("Account Deductions");$("#rpmntSrcType").attr("disabled",true)}else{$("#rpmntSrcType").attr("disabled",false)}if(d=="Overdraft"){$("#rpmntSrcAcctDiv").css("display","table-cell");$("#rpmntSrcType").val("Account Deductions");$("#rpmntSrcAcctID").val(-1);$("#rpmntSrcAcct").val("");$("#rpmntSrcType").attr("disabled",true)}else{if(c=="Account Deductions"){$("#rpmntSrcAcctDiv").css("display","table-cell");$("#rpmntSrcAcctID").val(-1);$("#rpmntSrcAcct").val("")}else{$("#rpmntSrcAcctID").val(-1);$("#rpmntSrcAcct").val("")}}if(e.loanPrdtDetArry.cashCollateralRqrd=="Yes"){$("#cashColtDiv").css("display","table-cell")}else{$("#cashColtDiv").css("display","none");$("#cashCollateralID").val(-1);$("#cashCollateral").val("")}if(e.loanPrdtDetArry.invstmntCollateralRqrd=="Yes"){$("#investmentColtDiv").css("display","table-cell")}else{$("#investmentColtDiv").css("display","none");$("#invstmntCollateralID").val(-1);$("#invstmntCollateral").val("")}if(e.loanPrdtDetArry.prptyCollateralRqrd=="Yes"){$("#propertyColtDiv").css("display","table-cell")}else{$("#propertyColtDiv").css("display","none");$("#prptyCollateralID").val(-1);$("#prptyCollateral").val("")}}else{alert(h+"hiii")}},cache:false,contentType:false,processData:false})})}function clearROLovField(b,a){$("#"+b).val("");$("#"+a).val(-1)}function validateApplctnForm(g,B,a,u,I,E,y,k,j,n,f,C,r,w,c,b,x,p,e,v,m,H,D,t,G,s){var F;var h;var o;var d;var z=new Date();var q=z.getDate();var A=z.getMonth()+1;var l=z.getFullYear();if(g!=""){F=new Date(g);h=F.getDate();o=F.getMonth()+1;d=F.getFullYear()}if(g==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#applctnDate").css("border-color","red");$("#applctnDate").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide the Loan Application Date!",callback:function(){}});return false}else{if(g!=""&&(l+"-"+A+"-"+q<d+"-"+o+"-"+h)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#applctnDate").css("border-color","red");$("#applctnDate").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a valid Loan Application Date which is not greater than today!",callback:function(){}});return false}else{if(B==""||B==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#bnkBranch").css("border-color","red");$("#bnkBranch").css("border-width","2px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select your Branch!",callback:function(){}});return false}else{if(a==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prpsOfLoan").css("border-color","red");$("#prpsOfLoan").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide the Purpose of Loan!",callback:function(){}});return false}else{if((u==""||u==-1)&&(t==="Manual Payments")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#rcvryOfficer").css("border-color","red");$("#rcvryOfficer").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Recovery Officer;</br><b>Recovery Officer is required for Manual Loan Repayments!</b>",callback:function(){}});return false}else{if(I==""||I=="--Please Select--"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#custType").css("border-color","red");$("#custType").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select Customer Type!",callback:function(){}});return false}else{if(I=="Group"&&E==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#custGrp").css("border-color","red");$("#custGrp").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Group's Name!",callback:function(){}});return false}else{if(y==""||y==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#bnkCustomer").css("border-color","red");$("#bnkCustomer").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Provide Applicant Name!",callback:function(){}});return false}else{if(k==""||k==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prdtType").css("border-color","red");$("#prdtType").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"No Product selected!",callback:function(){}});return false}else{if(j!="New Request"&&n==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#refLoanrqst").css("border-color","red");$("#refLoanrqst").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a reference Loan Request No. for Loan/Overdraft Top-Up/Reschedule!",callback:function(){}});return false}else{if(f==""||f<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanAmount").css("border-color","red");$("#loanAmount").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Loan amount must be greater than Zero!",callback:function(){}});return false}else{if(parseFloat(f)>parseFloat(C)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanAmount").css("border-color","red");$("#loanAmount").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Maximum applicable loan amount is "+formatAsMoney(C),callback:function(){}});return false}else{if(parseFloat(f)<parseFloat(r)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanAmount").css("border-color","red");$("#loanAmount").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Mimimum applicable loan amount is "+formatAsMoney(r),callback:function(){}});return false}else{if(w==""||Number(w)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Loan Tenor must be greater than Zero!",callback:function(){}});return false}else{if((c=="Month(s)"||c=="Year(s)")&&(b==c)&&(Number(w)>Number(x))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Maximum Loan Tenor is "+x+" "+c,callback:function(){}});return false}else{if(c=="Year(s)"&&b=="Month(s)"&&(Number(w)>(Number(x)*12))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Maximum Loan Tenor is "+(Number(x)*12)+" Month(s)",callback:function(){}});return false}else{if(c=="Month(s)"&&b=="Year(s)"&&((Number(w)*12)>Number(x))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Maximum Loan Tenor is "+(Number(x)/12)+" Year(s)",callback:function(){}});return false}else{if((p=="Month(s)"||p=="Year(s)")&&(b==p)&&(Number(w)<Number(e))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Minimum Loan Tenor is "+e+" "+p,callback:function(){}});return false}else{if(p=="Year(s)"&&b=="Month(s)"&&(Number(w)<(Number(e)*12))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Mimimum Loan Tenor is "+(Number(e)*12)+" Month(s)",callback:function(){}});return false}else{if(p=="Month(s)"&&b=="Year(s)"&&((Number(w)*12)<Number(e))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loanTenor").css("border-color","red");$("#loanTenor").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Minimum Loan Tenor is "+(Number(e)/12)+" Year(s)",callback:function(){}});return false}else{if(H==""||H<=0||(parseFloat(H)<parseFloat(D))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#interestRate").css("border-color","red");$("#interestRate").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Interest Rate must be greater than the Base Rate of <b>"+D+"% Per Anum</b>",callback:function(){}});return false}else{if((v==="Yes"||t==="Account Deductions")&&(m==-1||m=="")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#rpmntSrcAcct").css("border-color","red");$("#rpmntSrcAcct").css("border-width","2px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide an Account for Loan deduction!",callback:function(){}});return false}else{if(G.trim()==""||G=="-1"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#sctrMjr").css("border-color","red");$("#sctrMjr").css("border-width","2px");$("#rpmntSrcAcct").css("border-color","#ccc");$("#rpmntSrcAcct").css("border-width","1px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a Major Sector!",callback:function(){}});return false}else{if(s==""||s=="-1"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#sctrMnr").css("border-color","red");$("#sctrMnr").css("border-width","2px");$("#sctrMjr").css("border-color","#ccc");$("#sctrMjr").css("border-width","1px");$("#rpmntSrcAcct").css("border-color","#ccc");$("#rpmntSrcAcct").css("border-width","1px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a Minor Sector!",callback:function(){}});return false}else{$("#sctrMnr").css("border-color","#ccc");$("#sctrMnr").css("border-width","1px");$("#sctrMjr").css("border-color","#ccc");$("#sctrMjr").css("border-width","1px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#prpsOfLoan").css("border-color","#ccc");$("#prpsOfLoan").css("border-width","1px");$("#rcvryOfficer").css("border-color","#ccc");$("#rcvryOfficer").css("border-width","1px");$("#custType").css("border-color","#ccc");$("#custType").css("border-width","1px");$("#custGrp").css("border-color","#ccc");$("#custGrp").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#refLoanrqst").css("border-color","#ccc");$("#refLoanrqst").css("border-width","1px");$("#loanAmount").css("border-color","#ccc");$("#loanAmount").css("border-width","1px");$("#loanTenor").css("border-color","#ccc");$("#loanTenor").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");$("#rpmntSrcAcct").css("border-color","#ccc");$("#rpmntSrcAcct").css("border-width","1px");return true}}}}}}}}}}}}}}}}}}}}}}}}}function saveLoanApplication(a,d,c){var e;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var k;var q=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();var R=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var D=typeof $("#custType").val()==="undefined"?"":$("#custType").val();var P=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val().trim().length===0?-1:$("#acctID").val();var aa=typeof $("#acctNumber").val()==="undefined"?"":$("#acctNumber").val();var W=typeof $("#rcvryOfficerID").val()==="undefined"?-1:$("#rcvryOfficerID").val();var ac=typeof $("#bnkCustomerID").val()==="undefined"?-1:$("#bnkCustomerID").val();var ad=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();var o=typeof $("#loanAmount").val()==="undefined"?-1:$("#loanAmount").val().trim().length===0?0:$("#loanAmount").val();var h=typeof $("#loanTenor").val()==="undefined"?-1:$("#loanTenor").val().trim().length===0?0:$("#loanTenor").val();var N=typeof $("#loanTenorType").val()==="undefined"?"":$("#loanTenorType").val();var J=typeof $("#applctnDate").val()==="undefined"?"":$("#applctnDate").val();var s=typeof $("#prpsOfLoan").val()==="undefined"?"":$("#prpsOfLoan").val();var n=typeof $("#rpmntSrcAcctID").val()==="undefined"?-1:$("#rpmntSrcAcctID").val();var Z=typeof $("#cashCollateralID").val()==="undefined"?-1:$("#cashCollateralID").val();var A=typeof $("#invstmntCollateralID").val()==="undefined"?-1:$("#invstmntCollateralID").val();var v=typeof $("#prptyCollateralID").val()==="undefined"?-1:$("#prptyCollateralID").val();var H=typeof $("#custGrpID").val()==="undefined"?-1:$("#custGrpID").val();var M=typeof $("#status").val()==="undefined"?"":$("#status").val();var g=typeof $("#interestRate").val()==="undefined"?-1:$("#interestRate").val();var Q=typeof $("#rqstType").val()==="undefined"?"":$("#rqstType").val();var af=typeof $("#refLoanrqstID").val()==="undefined"?-1:$("#refLoanrqstID").val();var V=typeof $("#crdtType").val()==="undefined"?"":$("#crdtType").val();var U=typeof $("#rpmntSrcType").val()==="undefined"?"":$("#rpmntSrcType").val();var x=typeof $("#currencyId").val()==="undefined"?-1:$("#currencyId").val();var ag=typeof $("#isAccountRqrd").val()==="undefined"?-1:$("#isAccountRqrd").val();var j=typeof $("#loanMaxAmount").val()==="undefined"?-1:$("#loanMaxAmount").val();var O=typeof $("#loanMinAmount").val()==="undefined"?-1:$("#loanMinAmount").val();var z=typeof $("#maxLoanTenor").val()==="undefined"?-1:$("#maxLoanTenor").val();var X=typeof $("#maxLoanTenorType").val()==="undefined"?-1:$("#maxLoanTenorType").val();var C=typeof $("#guarantorRequired").val()==="undefined"?-1:$("#guarantorRequired").val();var F=typeof $("#guarantorNo").val()==="undefined"?-1:$("#guarantorNo").val();var E=typeof $("#cashCollateralRqrd").val()==="undefined"?-1:$("#cashCollateralRqrd").val();var B=typeof $("#valueFlatCashColt").val()==="undefined"?-1:$("#valueFlatCashColt").val();var T=typeof $("#valuePrcntCashColt").val()==="undefined"?-1:$("#valuePrcntCashColt").val();var ae=typeof $("#prptyCollateralRqrd").val()==="undefined"?-1:$("#prptyCollateralRqrd").val();var m=typeof $("#valueFlatPrptyColt").val()==="undefined"?-1:$("#valueFlatPrptyColt").val();var ab=typeof $("#valuePrcntPrptyColt").val()==="undefined"?-1:$("#valuePrcntPrptyColt").val();var I=typeof $("#invstmntCollateralRqrd").val()==="undefined"?-1:$("#invstmntCollateralRqrd").val();var w=typeof $("#valueInvstmntCashColt").val()==="undefined"?-1:$("#valueInvstmntCashColt").val();var S=typeof $("#valueInvstmntPrcntColt").val()==="undefined"?-1:$("#valueInvstmntPrcntColt").val();var Y=typeof $("#minLoanTenor").val()==="undefined"?-1:$("#minLoanTenor").val();var y=typeof $("#minLoanTenorType").val()==="undefined"?-1:$("#minLoanTenorType").val();var G=typeof $("#baseIntRate").val()==="undefined"?-1:$("#baseIntRate").val();var L=typeof $("#sctrMjrID").val()==="undefined"?-1:$("#sctrMjrID").val();var p=typeof $("#sctrMnrID").val()==="undefined"?-1:$("#sctrMnrID").val();var r=typeof $("#grpApplicantType").val()==="undefined"?"":$("#grpApplicantType").val();var u="";var K=0;var t=0;var f=validateApplctnForm(J,R,s,W,D,H,ac,ad,Q,af,o,j,O,h,X,N,z,y,Y,ag,n,g,G,U,L,p);if(!f){return false}if(parseInt(H)>0){$("#grpMembersDetTable").find("tr").each(function(ai,ak){if(ai>0){if(typeof $(ak).attr("id")==="undefined"){}else{var ah=$(ak).attr("id").split("_")[1];if(typeof $("#grpMembersDetRow"+ah+"_CustID").val()==="undefined"){}else{if($("#grpMembersDetRow"+ah+"_CustID").val()==""||$("#grpMembersDetRow"+ah+"_CustID").val()==-1){$("#grpMembersDetRow"+ah+"_CustNm").css("border-color","red");$("#grpMembersDetRow"+ah+"_CustNm").css("border-width","2px");K=K+1}else{$("#grpMembersDetRow"+ah+"_CustNm").css("border-color","#ccc");$("#grpMembersDetRow"+ah+"_CustNm").css("border-width","1px")}if($("#grpMembersDetRow"+ah+"_RqstdAmount").val()==""||$("#grpMembersDetRow"+ah+"_RqstdAmount").val()==0){$("#grpMembersDetRow"+ah+"_RqstdAmount").css("border-color","red");$("#grpMembersDetRow"+ah+"_RqstdAmount").css("border-width","2px");K=K+1}else{$("#grpMembersDetRow"+ah+"_RqstdAmount").css("border-color","#ccc");$("#grpMembersDetRow"+ah+"_RqstdAmount").css("border-width","1px")}if($("#grpMembersDetRow"+ah+"_RpmntAcctID").val()==""||$("#grpMembersDetRow"+ah+"_RpmntAcctID").val()==-1){$("#grpMembersDetRow"+ah+"_RpmntAcctNm").css("border-color","red");$("#grpMembersDetRow"+ah+"_RpmntAcctNm").css("border-width","2px");K=K+1}else{$("#grpMembersDetRow"+ah+"_RpmntAcctNm").css("border-color","#ccc");$("#grpMembersDetRow"+ah+"_RpmntAcctNm").css("border-width","1px")}if(K<=0){u=u+$("#grpMembersDetRow"+ah+"_PkeyID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+ah+"_CustID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+ah+"_RqstdAmount").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+ah+"_RpmntAcctID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+ah+"_CashColtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+ah+"_InvtmntColtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+ah+"_PrptyColtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";t=t+1}var aj=aj+1}}}});if(K>0){b=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please complete all highlighted fields</i></b></span>",callback:function(){}});return false}}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});e.find(".modal-content").css({"margin-top":function(){var ai=$(window).height();var ah=$(".modal-dialog").height();var aj=ai/2;return aj+"px"}});var l=new FormData();l.append("grp",17);l.append("typ",1);l.append("q","UPDATE");l.append("pg",a);l.append("subPgNo",d);l.append("vtyp",c);l.append("actyp",1);l.append("loanRqstID",q);l.append("bnkBranchID",R);l.append("custType",D);l.append("acctID",P);l.append("acctNumber",aa);l.append("rcvryOfficerID",W);l.append("bnkCustomerID",ac);l.append("prdtTypeID",ad);l.append("loanAmount",o);l.append("loanTenor",h);l.append("loanTenorType",N);l.append("applctnDate",J);l.append("prpsOfLoan",s);l.append("rpmntSrcAcctID",n);l.append("cashCollateralID",Z);l.append("invstmntCollateralID",A);l.append("prptyCollateralID",v);l.append("grpCustId",H);l.append("status",M);l.append("rqstType",Q);l.append("refLoanrqstID",af);l.append("crdtType",V);l.append("interestRate",g);l.append("rpmntSrcType",U);l.append("sctrMjrID",L);l.append("sctrMnrID",p);l.append("grpApplicantType",r);if(t>0){l.append("slctdGrpMembers",u)}$.ajax({url:"index.php",type:"POST",data:l,async:true,success:function(ah){var ai="";if(/^[\],:{}\s]*$/.test(ah.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){k=$.parseJSON(ah);$("#loanRqstID").val(k.loanRqstID);$("#lnRqstID").val(k.loanRqstID);$("#rqsNumber").val(k.trnsctnID);e.modal("hide");getLoanRqstForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Loan Request",15,d,0,"EDIT",k.loanRqstID,"indCustTable","indCustTableRow1",function(){$("#standardEvtns").css("display","block");ai="Loan Application Successfully Saved!";b=bootbox.alert({size:"small",title:"Rhomicom Message",message:ai,callback:function(){}})})}else{ai=ah;e.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:ai,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function getLoanGrntaForm(k,l,b,g,p,o,c,e,f,j,d){var n=$("#loanRqstID").val();var q=$("#custType").val();var h=d;var m=typeof $("#srcType").val()==="undefined"?"":$("#srcType").val();if(n==="undefined"||n===""||n===-1){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please save Account first!",callback:function(){}});return false}else{$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(o);$("#"+l).html(a.responseText);$("#"+k).off("hidden.bs.modal");$("#"+k).one("hidden.bs.modal",function(s){$("#"+b).html("");$("#"+l).html("");$(s.currentTarget).unbind()});$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(f===5&&j==="EDIT"){var r=$("#"+p).find("td");$("#lowRange").val($.trim(r.eq(2).text()));$("#highRange").val($.trim(r.eq(3).text()));$("#amountFlat").val($.trim(r.eq(4).text()));$("#amountPrcnt").val($.trim(r.eq(5).text()));$("#remarks").val($.trim(r.eq(6).text()));$("#tblRowElementID").val(p)}$("#"+k).on("show.bs.modal",function(s){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+k).modal({backdrop:"static",keyboard:false});$(document).ready(function(){$("#"+g).submit(function(s){s.preventDefault();return false});if(q=="Corporate"||q=="Individual"){$("#srcTypeDiv").css("display","block")}else{$("#srcTypeDiv").css("display","none")}})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+j+"&loanRqstID="+n+"&rowID="+h)}}function getLoanGuarantors(){var e=$("#custType").val();var d=$("#srcType").val();var a="Bank Individual Customers";var b=" AND 1 = 1";var c="custTypeIndividual";switch(e){case"Corporate":if(d==="Other Persons"){a="Bank Other Persons - Guarantors";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"gnrlOrgID","","","radio",true,"","guarantorID","guarantor","clear",1,b)}else{getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"gnrlOrgID",c,"","radio",true,"","guarantorID","guarantor","clear",1,b)}break;case"Individual":if(d==="Other Persons"){a="Bank Other Persons - Guarantors";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"gnrlOrgID","","","radio",true,"","guarantorID","guarantor","clear",1,b)}else{getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"gnrlOrgID",c,"","radio",true,"","guarantorID","guarantor","clear",1,b)}break;case"Group":a="MCF Customer Group Members";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"gnrlOrgID","custGrpID","","radio",true,"","guarantorID","guarantor","clear",1,b);break}}function saveLoanGuarantorForm(a,e){var g;$body=$("body");$body.addClass("mdlloadingDiag");var h=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();var d=typeof $("#srcType").val()==="undefined"?"":$("#srcType").val();var c=typeof $("#guarantorID").val()==="undefined"?-1:$("#guarantorID").val();var f=typeof $("#guarantor").val()==="undefined"?-1:$("#guarantor").val();var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){var m="";var l=b.responseText;var j=-1;var k="";$("#"+a).modal("hide");getLoanRqstForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Loan Request",15,4.1,0,"EDIT",h,"indCustTable","indCustTableRow1",function(){$body.removeClass("mdlloadingDiag")})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg=15&subPgNo=4.1&vtyp=5&q=UPDATE&srcType="+d+"&guarantorID="+c+"&rowID="+e+"&loanRqstID="+h)}function newLoanRequestOpenATab1(b,a){openATab(b,a+"&lnprflFctrId="+$("#lnprflFctrId").val()+"&lnRqstID="+$("#lnRqstID").val()+"&optn="+$("#optn").val()+"&status="+$("#status").val()+"&assmntCmnts="+$("#assmntCmnts").val())}function getCreditAssessmentQstn(b,e,d,a,c,f){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var m;var j=typeof $("#lnRqstID").val()==="undefined"?-1:$("#lnRqstID").val();var o=typeof $("#lnprflFctrId").val()==="undefined"?-1:$("#lnprflFctrId").val();var k=typeof $("input[name='assmntID']:checked").val()==="undefined"?"":$("input[name='assmntID']:checked").val();var g=typeof $("#qstnNoId").text()==="undefined"?-1:$("#qstnNoId").text();var n=typeof $("#qstnTtlNoId").text()==="undefined"?-1:$("#qstnTtlNoId").text();var h=typeof $("#status").text()==="undefined"?"Incomplete":$("#status").text();if(h=="Initiated"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"To proceed, WITHDRAW request first!",callback:function(){}});return false}if(f==0){if(typeof $("input[name='assmntID']:checked").val()==="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"No Option Selected</br>Please select an option first!",callback:function(){}});return false}}else{c="ADD"}if((a=="NEXT"||a=="LAST")&&(g==n)&&(g!="0")){c="SMRYPAGE"}var l=new FormData();l.append("grp",17);l.append("typ",1);l.append("pg",b);l.append("subPgNo",e);l.append("vtyp",d);l.append("lnRqstID",j);l.append("lnprflFctrId",o);l.append("chkedAssmntID",k);l.append("optn",a);l.append("vtypActn",c);l.append("qstnNo",g);l.append("qstnTtlNo",n);l.append("statusTitle",h);$.ajax({url:"index.php",type:"POST",data:l,async:true,success:function(p){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var q="";if(/^[\],:{}\s]*$/.test(p.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(p);$("#svngsAccntnEvntId").val(m.svngsAccntnEvntId);$("#standardEvtns").css("display","block");$("#customEvnts").css("display","block");q="Savings Product Event Accounting Successfully Saved!"}else{$("#prflCMDataEDT").html(p)}},cache:false,contentType:false,processData:false})})}function submitWithdrawLoanRqstActn(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var g;var t=typeof $("#lnRqstID").val()==="undefined"?-1:$("#lnRqstID").val();$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var O=typeof $("#assmntScoreCmnts").val()==="undefined"?-1:$("#assmntScoreCmnts").val();var Q=typeof $("#ttlScoreId").text()==="undefined"?-1:$("#ttlScoreId").text();var J=typeof $("#crncyIsoCode").text()==="undefined"?-1:$("#crncyIsoCode").text();var y=typeof $("#rvrslCmnts").val()==="undefined"?"":$("#rvrslCmnts").val();var M=-1;var f=0;var q=-1;var L=0;var v=-1;var H=0;var m=typeof $("#grpApplicantType").val()==="undefined"?"":$("#grpApplicantType").val();var C=typeof $("#custGrpID").val()==="undefined"?-1:$("#custGrpID").val();var p="";var E=0;var o=0;var r;var s="Are you sure you want to submit loan for Approval?";if(d=="SUBMIT"){r=2;var z=typeof $("#guarantorRequired").val()==="undefined"?-1:$("#guarantorRequired").val();var B=typeof $("#guarantorNo").val()==="undefined"?-1:$("#guarantorNo").val();var l=typeof $("#loanAmount").val()==="undefined"?0:$("#loanAmount").val();M=typeof $("#cashCollateralID").val()==="undefined"?-1:$("#cashCollateralID").val();var A=typeof $("#cashCollateralRqrd").val()==="undefined"?"No":$("#cashCollateralRqrd").val();var w=typeof $("#valueFlatCashColt").val()==="undefined"?0:$("#valueFlatCashColt").val();var I=typeof $("#valuePrcntCashColt").val()==="undefined"?0:$("#valuePrcntCashColt").val();f=parseFloat(w)+((parseFloat(I/100)*parseFloat(l)));var n=typeof $("#cashCollateralValue").val()==="undefined"?0:$("#cashCollateralValue").val();var R=typeof $("#cashColHasLien").val()==="undefined"?"No":$("#cashColHasLien").val();q=typeof $("#prptyCollateralID").val()==="undefined"?-1:$("#prptyCollateralID").val();var S=typeof $("#prptyCollateralRqrd").val()==="undefined"?"No":$("#prptyCollateralRqrd").val();var j=typeof $("#valueFlatPrptyColt").val()==="undefined"?0:$("#valueFlatPrptyColt").val();var P=typeof $("#valuePrcntPrptyColt").val()==="undefined"?0:$("#valuePrcntPrptyColt").val();L=parseFloat(j)+((parseFloat(P/100)*parseFloat(l)));var x=typeof $("#prptyCollateralValue").val()==="undefined"?0:$("#prptyCollateralValue").val();var N=typeof $("#prptyColHasLien").val()==="undefined"?"No":$("#prptyColHasLien").val();v=typeof $("#invstmntCollateralID").val()==="undefined"?-1:$("#invstmntCollateralID").val();var D=typeof $("#invstmntCollateralRqrd").val()==="undefined"?"No":$("#invstmntCollateralRqrd").val();var u=typeof $("#valueInvstmntCashColt").val()==="undefined"?0:$("#valueInvstmntCashColt").val();var G=typeof $("#valueInvstmntPrcntColt").val()==="undefined"?0:$("#valueInvstmntPrcntColt").val();H=parseFloat(u)+((parseFloat(G/100)*parseFloat(l)));var k=typeof $("#invstmntCollateralValue").val()==="undefined"?0:$("#invstmntCollateralValue").val();var F=typeof $("#invstmntColHasLien").val()==="undefined"?"No":$("#invstmntColHasLien").val();var K="";var e=0;if(z=="Yes"&&(Number($("table#loanGuarantorsTblAdd tbody tr:last").index()+1)<Number(B))){$("#guarantorsLgnd").css("color","red");e=e+1;K=K+"Please provide at least "+B+" Guarantor before submitting this application!</br>"}else{$("#guarantorsLgnd").css("color","#333")}if(Number($("table#grpMembersDetTable tbody tr:last").index()+1)<=0){if(A=="Yes"){if(M==""||M==-1){$("#cashCollateral").css("border-color","red");e=e+1;K=K+"Please provide a CASH COLLATERAL for this application!</br>"}else{if(parseFloat(n)<parseFloat(f)){$("#cashCollateral").css("border-color","red");e=e+1;K=K+"Please provide a CASH COLLATERAL with an available balance of <b>"+J+""+formatAsMoney(f.toFixed(2))+"</b>!</br>"}else{$("#cashCollateral").css("border-color","#ccc")}}}if(S=="Yes"){if(q==""||q==-1){$("#prptyCollateral").css("border-color","red");e=e+1;K=K+"Please provide a PROPERTY COLLATERAL for this application!</br>"}else{if(parseFloat(x)<parseFloat(L)){$("#prptyCollateral").css("border-color","red");e=e+1;K=K+"Please provide a PROPERTY COLLATERAL with a net value of <b>"+J+""+formatAsMoney(L.toFixed(2))+"</b></br>"}else{$("#prptyCollateral").css("border-color","#ccc")}}}if(D=="Yes"){if(v==""||v==-1){$("#invstmntCollateral").css("border-color","red");e=e+1;K=K+"Please provide an INVESTMENT COLLATERAL for this application!</br>"}else{if(parseFloat(k)<parseFloat(H)){$("#invstmntCollateral").css("border-color","red");e=e+1;K=K+"Please provide an INVESTMENT COLLATERAL with a net value of <b>"+J+""+formatAsMoney(H.toFixed(2))+"</b></br>"}else{$("#invstmntCollateral").css("border-color","#ccc")}}}if(e>0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important!'><i>"+K+"</i></span>",callback:function(){}});return false}}if(parseInt(C)>0){$("#grpMembersDetTable").find("tr").each(function(U,W){if(U>0){if(typeof $(W).attr("id")==="undefined"){}else{var T=$(W).attr("id").split("_")[1];if(typeof $("#grpMembersDetRow"+T+"_CustID").val()==="undefined"){}else{if($("#grpMembersDetRow"+T+"_CustID").val()==""||$("#grpMembersDetRow"+T+"_CustID").val()==-1){$("#grpMembersDetRow"+T+"_CustNm").css("border-color","red");$("#grpMembersDetRow"+T+"_CustNm").css("border-width","2px");E=E+1}else{$("#grpMembersDetRow"+T+"_CustNm").css("border-color","#ccc");$("#grpMembersDetRow"+T+"_CustNm").css("border-width","1px")}if($("#grpMembersDetRow"+T+"_RqstdAmount").val()==""||$("#grpMembersDetRow"+T+"_RqstdAmount").val()==0){$("#grpMembersDetRow"+T+"_RqstdAmount").css("border-color","red");$("#grpMembersDetRow"+T+"_RqstdAmount").css("border-width","2px");E=E+1}else{$("#grpMembersDetRow"+T+"_RqstdAmount").css("border-color","#ccc");$("#grpMembersDetRow"+T+"_RqstdAmount").css("border-width","1px")}if($("#grpMembersDetRow"+T+"_RpmntAcctID").val()==""||$("#grpMembersDetRow"+T+"_RpmntAcctID").val()==-1){$("#grpMembersDetRow"+T+"_RpmntAcctNm").css("border-color","red");$("#grpMembersDetRow"+T+"_RpmntAcctNm").css("border-width","2px");E=E+1}else{$("#grpMembersDetRow"+T+"_RpmntAcctNm").css("border-color","#ccc");$("#grpMembersDetRow"+T+"_RpmntAcctNm").css("border-width","1px")}if(A=="Yes"){if($("#grpMembersDetRow"+T+"_CashColtID").val()==""||$("#grpMembersDetRow"+T+"_CashColtID").val()==-1){$("#grpMembersDetRow"+T+"_CashColtNm").css("border-color","yellow");$("#grpMembersDetRow"+T+"_CashColtNm").css("border-width","2px");E=E+1}else{$("#grpMembersDetRow"+T+"_CashColtNm").css("border-color","#ccc");$("#grpMembersDetRow"+T+"_CashColtNm").css("border-width","1px")}}if(S=="Yes"){if($("#grpMembersDetRow"+T+"_PrptyColtID").val()==""||$("#grpMembersDetRow"+T+"_PrptyColtID").val()==-1){$("#grpMembersDetRow"+T+"_PrptyColtNm").css("border-color","yellow");$("#grpMembersDetRow"+T+"_PrptyColtNm").css("border-width","2px");E=E+1}else{$("#grpMembersDetRow"+T+"_PrptyColtNm").css("border-color","#ccc");$("#grpMembersDetRow"+T+"_PrptyColtNm").css("border-width","1px")}}if(D=="Yes"){if($("#grpMembersDetRow"+T+"_InvtmntColtID").val()==""||$("#grpMembersDetRow"+T+"_InvtmntColtID").val()==-1){$("#grpMembersDetRow"+T+"_InvtmntColtNm").css("border-color","yellow");$("#grpMembersDetRow"+T+"_InvtmntColtNm").css("border-width","2px");E=E+1}else{$("#grpMembersDetRow"+T+"_InvtmntColtNm").css("border-color","#ccc");$("#grpMembersDetRow"+T+"_InvtmntColtNm").css("border-width","1px")}}if(E<=0){p=p+$("#grpMembersDetRow"+T+"_PkeyID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+T+"_CustID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+T+"_RqstdAmount").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+T+"_RpmntAcctID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+T+"_CashColtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+T+"_InvtmntColtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#grpMembersDetRow"+T+"_PrptyColtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";o=o+1}var V=V+1}}}});if(E>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please complete all red-highlighted fields and provide appropriate Collaterals for yellow-highlighted fields</i></b></span>",callback:function(){}});return false}}}else{if(d=="WITHDRAW"){r=3;s="Are you sure you want to withdraw Loan Request from Approval?"}else{if(y.trim()==""||y.trim()==undefined){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important!'><i>Provide a reason for reversing this Loan Request Approval.</i></span>",callback:function(){}});return false}r=4;s="Are you sure you want to REVERSE this Loan Request Approval?"}}var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("pg",a);h.append("subPgNo",c);h.append("q","UPDATE");h.append("vtyp",b);h.append("actyp",r);h.append("lnRqstID",t);h.append("assmntScoreCmnts",O);h.append("ttlScore",Q);h.append("cashCollateralAcctID",M);h.append("xptdCashColtValue",f);h.append("prptyCollateralAcctID",q);h.append("xptdPrptyColtValue",L);h.append("invstmntCollateralAcctID",v);h.append("xptdInvstmntColtValue",H);h.append("rvrslCmnts",y);if(o>0){h.append("slctdGrpMembers",p)}bootbox.confirm({title:"Rhomicom Message",message:s,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(T){if(T){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(V){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var W="";if(/^[\],:{}\s]*$/.test(V.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var U=$.parseJSON(V);bootbox.alert({size:"small",title:"Rhomicom Message",message:'<div><span style="color:red; font-weight:bold !important;">Please complete ALL <b>'+U.TTL_COUNT+"</b> ASSESSMENT QUESTIONS before proceeding!<br/></span></div>",callback:function(){}});return false}else{if(d=="SUBMIT"){$("#assmntScoreCmnts").attr("readonly",true);$("#withdrawLoanRqst").css("display","inline-block");$("#withdrawLoanRqst1").css("display","inline-block");$("#submitLoanRqst").css("display","none");$("#submitLoanRqst1").css("display","none");$("#withdrawLoanRqstMn").css("display","inline-block");$("#saveLoanRqstMn").css("display","none");$("#statusTitle").html("Initiated");$("#status").val("Initiated")}else{if(d=="WITHDRAW"||d=="REVERSE"){$("#assmntScoreCmnts").attr("readonly",false);$("#withdrawLoanRqst").css("display","none");$("#withdrawLoanRqst1").css("display","none");$("#submitLoanRqst").css("display","inline-block");$("#submitLoanRqst1").css("display","inline-block");$("#withdrawLoanRqstMn").css("display","none");$("#saveLoanRqstMn").css("display","inline-block");$("#statusTitle").html("Withdrawn");$("#status").val("Withdrawn")}}getLoanRqstForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Loan Request",15,c,0,"EDIT",t,"indCustTable","indCustTableRow1",function(){if(r==4){$("#myFormsModaly").modal("hide")}bootbox.alert({size:"small",title:"Rhomicom Message",message:V,callback:function(){}})})}},cache:false,contentType:false,processData:false})}}})})}function saveDisbursementHdr(a,c,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var j;var e=typeof $("#disbmntHdrID").val()==="undefined"?-1:$("#disbmntHdrID").val();var g=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var f=typeof $("#description").val()==="undefined"?"":$("#description").val();var d=typeof $("#crncyID").val()==="undefined"?-1:$("#crncyID").val();if(g==""||g==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"No Branch selected!",callback:function(){}});return false}else{if(d==""||d==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select Currency First!",callback:function(){}});return false}else{if(f==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a Naration for the Disbursement!",callback:function(){}});return false}}}var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("q","UPDATE");h.append("pg",a);h.append("subPgNo",c);h.append("vtyp",b);h.append("disbmntHdrID",e);h.append("bnkBranchID",g);h.append("crncyID",d);h.append("description",f);$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(k){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var l="";if(/^[\],:{}\s]*$/.test(k.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=$.parseJSON(k);$("#batchNo").val(j.batchNo);$("#disbmntHdrID").val(j.disbmntHdrID);$("#status").val(j.status);$("#disbmntDate").val(j.disbmntDate);$("#standardEvtns").css("display","block");l="Disbursement Header Successfully Saved!"}else{l=k}bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}})},cache:false,contentType:false,processData:false})})}function autoLoadApprovedLoans(a,d,f){var e=typeof $("#disbmntHdrID").val()==="undefined"?-1:$("#disbmntHdrID").val();var g=typeof $("#disbmntDetId").val()==="undefined"?-1:$("#disbmntDetId").val();var k=typeof $("#custType option:selected").val()==="undefined"?"":$("#custType option:selected").val();var c=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var b=typeof $("#crncyID").val()==="undefined"?-1:$("#crncyID").val();var h=typeof $("#custGrpID").val()==="undefined"?-1:$("#custGrpID").val();var j=typeof $("#description").val()==="undefined"?"":$("#description").val();if(c==""||c==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Branch First!",callback:function(){}});return false}else{if(e==""||e==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please save Header First!",callback:function(){}});return false}else{if(k==="--Please Select--"){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select Customer Type First!",callback:function(){}});return false}else{if(k==="Group Members"&&h==-1){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select Customer Group First!",callback:function(){}});return false}}}}bootbox.confirm({title:"Rhomicom Message",message:"Are you sure you want to auto-load all approved but undisbursed loans?",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(l){if(l){$body=$("body");$body.addClass("mdlloadingDiag");var m;if(window.XMLHttpRequest){m=new XMLHttpRequest()}else{m=new ActiveXObject("Microsoft.XMLHTTP")}m.onreadystatechange=function(){if(m.readyState===4&&m.status===200){var s="";var r=m.responseText;if(/^[\],:{}\s]*$/.test(r.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){json=$.parseJSON(r);getDisbursementForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Disbursement",15,d,0,"EDIT",e,"indCustTable","indCustTableRow1",function(){$("#myFormsModaly").modal("hide");$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Approved Loans Successfully Loaded!",callback:function(){}})});if(1==2){var o=json.disbDetArray.length;var q="";var p=0;var n=0;for(p=0;p<o;p++){n++;q=q+'<tr id="disbmntDetTblAddRow_'+json.disbDetArray[p].disbmntDetId+"\"><td><button type=\"button\" title=\"View Loan Request\" class=\"btn btn-default btn-sm\" onclick=\"getSvngsWtdwlForm('myLovModal', 'myLovModalBody', 'myLovModalTitle', 'loanDisbmntDetForm', 'disbmntDetTblAddRow"+json.disbDetArray[p].disbmntDetId+"', 'Edit Withdrawal Commission', 15,4.2, 5, 'EDIT',"+json.disbDetArray[p].disbmntDetId+');" style="padding:2px !important;"><img src="cmn_images/kghostview.png" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td><td>'+n+"</td><td>"+json.disbDetArray[p].customer+"</td><td>"+json.disbDetArray[p].custType+"</td><td>"+json.disbDetArray[p].trnsctnId+'</td><td style="color:blue !important;font-weight: bold; font-size: 14px !important;">'+formatAsMoney(json.disbDetArray[p].approvedAmount)+"</td><td>"+json.disbDetArray[p].tenorDisp+"</td><td>"+formatAsMoney(json.disbDetArray[p].interestRate)+"</td><td>"+json.disbDetArray[p].loanType+'</td><td>...</td><td><button type="button" title="Clear Loan Request" class="btn btn-default btn-sm" onclick="deleteLoanDisbursementDet('+json.disbDetArray[p].disbmntDetId+","+e+');" style="padding:2px !important;"><img src="cmn_images/delete_img.gif" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td><td style="display:none;">'+json.disbDetArray[p].loanRqstId+'</td><td style="display:none;">'+json.disbDetArray[p].chargeInterest+'</td><td style="display:none;">'+json.disbDetArray[p].loanTenor+'</td><td style="display:none;">'+json.disbDetArray[p].loanTenorType+'</td><td style="display:none;">'+json.disbDetArray[p].loanRepaymentType+'</td><td style="display:none;">'+json.disbDetArray[p].compoundingPeriod+'</td><td style="display:none;">'+json.disbDetArray[p].gracePeriodNo+'</td><td style="display:none;">'+json.disbDetArray[p].gracePeriodType+'</td><td style="display:none;">'+json.disbDetArray[p].disbmntDetId+"</td></tr>"}$("#disbmntDetTblTbody").children("tr").remove();$("#disbmntDetTblAdd").append(q)}}else{s=r;$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:s,callback:function(){}})}}};m.open("POST","index.php",true);m.setRequestHeader("Content-type","application/x-www-form-urlencoded");m.send("grp=17&typ=1&pg="+a+"&subPgNo="+d+"&vtyp=1&q=UPDATE&disbmntHdrID="+e+"&disbmntDetId="+g+"&bnkBranchID="+c+"&custGrpID="+h+"&custType="+k+"&crncyID="+b+"&description="+j)}}})}function disburseApprovedLoans(b,h,c){var j=typeof $("#disbmntHdrID").val()==="undefined"?-1:$("#disbmntHdrID").val();var e=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var a=0;var k;var m;var d;var l="Disbursing";var g="Disbursed";var f="Are you sure you want to DISBURSE all these Loans?";if(c==1){l="Voiding";g="Voided";f="Are you sure you want to VOID this disbursement?"}if(j==""||j==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please save Header First!",callback:function(){}});return false}else{if(e==""||e==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Select Branch First!",callback:function(){}});return false}}d=bootbox.confirm({title:"Rhomicom Message",message:f,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(n){if(n){k=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> '+l+" Selected Loans. Please Wait...</div>"});k.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=(q-p)/2;return r+"px"}});var o;if(window.XMLHttpRequest){o=new XMLHttpRequest()}else{o=new ActiveXObject("Microsoft.XMLHTTP")}o.onreadystatechange=function(){if(o.readyState===4&&o.status===200){var v="";var u=o.responseText;if(/^[\],:{}\s]*$/.test(u.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var t=$.parseJSON(u);v="Loans Successfully "+g;k.modal("hide");getDisbursementForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Disbursement",15,4.2,0,"EDIT",j,"indCustTable","indCustTableRow1",function(){m=bootbox.alert({size:"small",title:"Rhomicom Message",message:v,callback:function(){}});m.find(".modal-content").css({"margin-top":function(){var y=$(window).height();var x=$(".modal-dialog").height();var z=(y-x-150)/2;return z+"px"}})});if(1==2){var q=t.disbDetArray.length;var s="";var r=0;var p=0;for(r=0;r<q;r++){p++;s=s+'<tr id="disbmntDetTblAddRow_'+p+"\"><td><button type=\"button\" title=\"View Loan Request\" class=\"btn btn-default btn-sm\" onclick=\"getSvngsWtdwlForm('myLovModal', 'myLovModalBody', 'myLovModalTitle', 'loanDisbmntDetForm', 'disbmntDetTblAddRow"+t.disbDetArray[r].disbmntDetId+"', 'Edit Withdrawal Commission', 15,4.2, 5, 'EDIT',"+t.disbDetArray[r].disbmntDetId+');" style="padding:2px !important;"><img src="cmn_images/kghostview.png" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td><td>'+p+"</td><td>"+t.disbDetArray[r].customer+"</td><td>"+t.disbDetArray[r].custType+"</td><td>"+t.disbDetArray[r].trnsctnId+'</td><td style="color:blue !important;font-weight: bold; font-size: 14px !important;">'+formatAsMoney(t.disbDetArray[r].approvedAmount)+"</td><td>"+t.disbDetArray[r].tenorDisp+"</td><td>"+formatAsMoney(t.disbDetArray[r].interestRate)+"</td><td>"+t.disbDetArray[r].loanType+'</td><td><button type="button" title="View Schedule" class="btn btn-default btn-sm" onclick="showAmo('+t.disbDetArray[r].newPrincipalBal+","+t.disbDetArray[r].interestRatePerPeriod+", "+t.disbDetArray[r].ttlLoanTermTimes+", "+t.disbDetArray[r].scheduledPrdcPaymntAmnt+", '"+t.disbDetArray[r].loanRepaymentType+"', '"+t.disbDetArray[r].repayStartDate+"', '"+t.disbDetArray[r].repayEndDate+"','myFormsModalBodyLgz',"+t.disbDetArray[r].disbmntDetId+",'"+t.disbDetArray[r].interestRateType+"', '"+t.disbDetArray[r].crdtType+'\')"; style="padding:2px !important;"><img src="cmn_images/kghostview.png" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td><td><button type="button" title="Clear Loan Request" class="btn btn-default btn-sm" onclick="getSvngsWtdwlForm(\'myLovModal\', \'myLovModalBody\', \'myLovModalTitle\', \'svngsWtdwlCmsnForm\', \'disbmntDetTblAddRow'+t.disbDetArray[r].disbmntDetId+"', 'Edit Withdrawal Commission', 12,7.1, 5, 'EDIT',"+t.disbDetArray[r].disbmntDetId+');" style="padding:2px !important;"><img src="cmn_images/delete_img.gif" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td><td style="display:none;">'+t.disbDetArray[r].loanRqstId+'</td><td style="display:none;">'+t.disbDetArray[r].chargeInterest+'</td><td style="display:none;">'+t.disbDetArray[r].loanTenor+'</td><td style="display:none;">'+t.disbDetArray[r].loanTenorType+'</td><td style="display:none;">'+t.disbDetArray[r].loanRepaymentType+'</td><td style="display:none;">'+t.disbDetArray[r].compoundingPeriod+'</td><td style="display:none;">'+t.disbDetArray[r].gracePeriodNo+'</td><td style="display:none;">'+t.disbDetArray[r].gracePeriodType+'</td><td style="display:none;">'+t.disbDetArray[r].disbmntDetId+'</td><td style="display:none;">'+t.disbDetArray[r].interestRatePerPeriod+'</td><td style="display:none;">'+t.disbDetArray[r].ttlLoanTermTimes+'</td><td style="display:none;">'+t.disbDetArray[r].scheduledPrdcPaymntAmnt+'</td><td style="display:none;">'+t.disbDetArray[r].interestRateType+"</td></tr>"}$("#disbmntDetTblTbody").children("tr").remove();$("#disbmntDetTblAdd").append(s)}}else{v=u;k.modal("hide");m=bootbox.alert({size:"small",title:"Rhomicom Message",message:v,callback:function(){}});m.find(".modal-content").css({"margin-top":function(){var y=$(window).height();var x=$(".modal-dialog").height();var z=(y-x-150)/2;return z+"px"}})}}};o.open("POST","index.php",true);o.setRequestHeader("Content-type","application/x-www-form-urlencoded");o.send("grp=17&typ=1&pg="+b+"&subPgNo="+h+"&vtyp=2&q=UPDATE&disbmntHdrID="+j+"&optn="+c+"&bnkBranchID="+e)}}});d.find(".modal-content").css({"margin-top":function(){var o=$(window).height();var n=$(".modal-dialog").height();var p=(o-n-150)/2;return p+"px"}})}function getLoanApplicant(){var c=$("#custType").val();if(c===""||c===undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select Customer Type First!",callback:function(){}});return false}var a="";var b=" AND 1 = 1";switch(c){case"Individual":a="MCF Corporate/Individual Loans TBD";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"bnkBranchID","crncyID","custType","radio",true,"","loanRqstId","loanRqst","clear",1,b);break;case"Corporate":a="MCF Corporate/Individual Loans TBD";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"bnkBranchID","crncyID","custType","radio",true,"","loanRqstId","loanRqst","clear",1,b);break;case"Individual and Corporate":a="MCF Corporate N Individual Loans TBD";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"gnrlOrgID","bnkBranchID","crncyID","radio",true,"","loanRqstId","loanRqst","clear",1,b);break;case"Group Members":a="MCF Group Members Loans TBD";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",a,"bnkBranchID","crncyID","custGrpID","radio",true,"","loanRqstId","loanRqst","clear",1,b);break}}function getAddLoanLinesForm(n,o,b,k,q,p,c,h,j,m,g){var f=typeof $("#disbmntHdrID").val()==="undefined"?-1:$("#disbmntHdrID").val();var e=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var d=typeof $("#crncyID").val()==="undefined"?-1:$("#crncyID").val();var l=g;if(f==="undefined"||f===""||f===-1){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please save Disbursement first!",callback:function(){}});return false}else{if(parseInt(d)===-1||d===undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select Disbursement Currency First!",callback:function(){}});return false}else{$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(p);$("#"+o).html(a.responseText);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(j===5&&m==="EDIT"){var r=$("#"+q).find("td");$("#lowRange").val($.trim(r.eq(2).text()));$("#highRange").val($.trim(r.eq(3).text()));$("#amountFlat").val($.trim(r.eq(4).text()));$("#amountPrcnt").val($.trim(r.eq(5).text()));$("#remarks").val($.trim(r.eq(6).text()));$("#tblRowElementID").val(q)}$("#"+n).on("show.bs.modal",function(s){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+n).modal({backdrop:"static",keyboard:false});$("#"+n).off("hidden.bs.modal");$("#"+n).one("hidden.bs.modal",function(s){$("#"+b).html("");$("#"+o).html("");$(s.currentTarget).unbind()});$(document).ready(function(){$("#"+k).submit(function(s){s.preventDefault();return false});if(custType=="Corporate"||custType=="Individual"){$("#srcTypeDiv").css("display","block")}else{$("#srcTypeDiv").css("display","none")}})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+h+"&vtyp="+j+"&vtypActn="+m+"&disbmntHdrID="+f+"&bnkBranchID="+e+"&rowID="+l+"&crncyID="+d)}}}function saveLoanRqstForm(b,e){$body=$("body");$body.addClass("mdlloadingDiag");var f=typeof $("#disbmntHdrID").val()==="undefined"?-1:$("#disbmntHdrID").val();var g=typeof $("#disbmntDetId").val()==="undefined"?-1:$("#disbmntDetId").val();var l=typeof $("#custType option:selected").val()==="undefined"?"":$("#custType option:selected").val();var h=typeof $("#loanRqstId").val()==="undefined"?-1:$("#loanRqstId").val();var d=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var c=typeof $("#crncyID").val()==="undefined"?-1:$("#crncyID").val();var j=typeof $("#custGrpID").val()==="undefined"?-1:$("#custGrpID").val();var k=typeof $("#description").val()==="undefined"?"":$("#description").val();if(d==""||d==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Branch First!",callback:function(){}});return false}else{if(f==""||f==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please save Header First!",callback:function(){}});return false}else{if(l=="--Please Select--"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select Customer Type first!",callback:function(){}});return false}else{if(l==="Group Members"&&j==-1){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select Customer Group First!",callback:function(){}});return false}}}}var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){var r="";var q=a.responseText;if(/^[\],:{}\s]*$/.test(q.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){json=$.parseJSON(q);getDisbursementForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Disbursement",15,e,0,"EDIT",f,"indCustTable","indCustTableRow1",function(){$("#myFormsModaly").modal("hide");$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Approved Loan Successfully Loaded!",callback:function(){}})});if(1==2){var n=json.disbDetArray.length;var p="";var o=0;var m=0;for(o=0;o<n;o++){m++;p=p+'<tr id="disbmntDetTblAddRow_'+m+"\"><td><button type=\"button\" title=\"View Loan Request\" class=\"btn btn-default btn-sm\" onclick=\"getSvngsWtdwlForm('myLovModal', 'myLovModalBody', 'myLovModalTitle', 'loanDisbmntDetForm', 'disbmntDetTblAddRow"+json.disbDetArray[o].disbmntDetId+"', 'Edit Withdrawal Commission', 15,4.2, 5, 'EDIT',"+json.disbDetArray[o].disbmntDetId+');" style="padding:2px !important;"><img src="cmn_images/kghostview.png" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td><td>'+m+"</td><td>"+json.disbDetArray[o].customer+"</td><td>"+json.disbDetArray[o].custType+"</td><td>"+json.disbDetArray[o].trnsctnId+"</td><td>"+json.disbDetArray[o].approvedAmount+"</td><td>"+json.disbDetArray[o].tenorDisp+"</td><td>"+json.disbDetArray[o].interestRate+"</td><td>"+json.disbDetArray[o].applicationDate+"</td><td>...</td><td><button type=\"button\" title=\"Clear Loan Request\" class=\"btn btn-default btn-sm\" onclick=\"getSvngsWtdwlForm('myLovModal', 'myLovModalBody', 'myLovModalTitle', 'svngsWtdwlCmsnForm', 'disbmntDetTblAddRow"+json.disbDetArray[o].disbmntDetId+"', 'Edit Withdrawal Commission', 12,7.1, 5, 'EDIT',"+json.disbDetArray[o].disbmntDetId+');" style="padding:2px !important;"><img src="cmn_images/delete_img.gif" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td><td style="display:none;">'+json.disbDetArray[o].loanRqstId+'</td><td style="display:none;">'+json.disbDetArray[o].chargeInterest+'</td><td style="display:none;">'+json.disbDetArray[o].loanTenor+'</td><td style="display:none;">'+json.disbDetArray[o].loanTenorType+'</td><td style="display:none;">'+json.disbDetArray[o].loanRepaymentType+'</td><td style="display:none;">'+json.disbDetArray[o].compoundingPeriod+'</td><td style="display:none;">'+json.disbDetArray[o].gracePeriodNo+'</td><td style="display:none;">'+json.disbDetArray[o].gracePeriodType+'</td><td style="display:none;">'+json.disbDetArray[o].disbmntDetId+"</td></tr>"}$("#disbmntDetTblTbody").children("tr").remove();$("#disbmntDetTblAdd").append(p)}}else{r=q;$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:r,callback:function(){}})}}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+b+"&subPgNo="+e+"&vtyp=1&q=UPDATE&disbmntHdrID="+f+"&disbmntDetId="+g+"&bnkBranchID="+d+"&custGrpID="+j+"&loanRqstId="+h+"&custType="+l+"&crncyID="+c+"&description="+k)}function saveLoanSchedule(a,f,d){$body=$("body");$body.addClass("mdlloadingDiag");var c="";var b=typeof $("#schdlEndDte").text()==="undefined"?"":$("#schdlEndDte").text();$("#amrtztnSchedule").find("tr").each(function(h,j){if(h>0){if(typeof $(j).attr("id")==="undefined"){}else{var g=$(j).attr("id").split("_")[1];var k=$(j).attr("id").split("_")[0];if(k==="headers"){}else{if(typeof $("#lines_"+g).val()==="undefined"){}else{c=c+$("#lines"+g+"_pDate").text()+"~"+fmtAsNumberLcl($("#lines"+g+"_begBal").text())+"~"+fmtAsNumberLcl($("#lines"+g+"_intrst").text())+"~"+fmtAsNumberLcl($("#lines"+g+"_prncpl").text())+"~"+fmtAsNumberLcl($("#lines"+g+"_endnBal").text())+"|"}}}}});var e;if(window.XMLHttpRequest){e=new XMLHttpRequest()}else{e=new ActiveXObject("Microsoft.XMLHTTP")}e.onreadystatechange=function(){if(e.readyState===4&&e.status===200){var h="";var g=e.responseText;if(/^[\],:{}\s]*$/.test(g.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){json=$.parseJSON(g);h="Loans Schedule Saved!";$("#myFormsModalTitleLgz").modal("hide")}else{h=g}$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:h,callback:function(){}})}};e.open("POST","index.php",true);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.send("grp=17&typ=1&pg="+a+"&subPgNo="+f+"&vtyp=3&q=UPDATE&loanSchedule="+c+"&disbmntDetId="+d+"&scheduleEndDte="+b)}function saveLoanSchedule1(){$body=$("body");$body.addClass("mdlloadingDiag");var a="";$("#amrtztnSchedule").find("tr").each(function(c,d){if(c>0){if(typeof $(d).attr("id")==="undefined"){}else{var b=$(d).attr("id").split("_")[1];var e=$(d).attr("id").split("_")[0];if(e==="headers"){}else{if(typeof $("#lines_"+b).val()==="undefined"){}else{a=a+$("#lines"+b+"_pDate").text()+ +fmtAsNumberLcl($("#lines"+b+"_begBal").text())+ +fmtAsNumberLcl($("#lines"+b+"_intrst").text())+ +fmtAsNumberLcl($("#lines"+b+"_prncpl").text())+ +fmtAsNumberLcl($("#lines"+b+"_endnBal").text())+"|"}}}}});$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading")}function onChangeOfCustType(){var a=typeof $("#custType").val()==="undefined"?"":$("#custType").val();resetLoanRqstDetls();if(a=="Group"){$("#custGrpDiv").css("display","block")}else{$("#custGrpDiv").css("display","none");$("#custGrpID").val(-1);$("#custGrp").val("");$("#bnkCustomerLbl").css("display","")}}function onChangeOfRqstType(){var a=$("#rqstType option:selected").val();$("#refLoanrqstID").val(-1);$("#refLoanrqst").val("");if(a==="Top-Up Request"){$("#rqstIdForTopupDiv").css("display","block");$("#loanAmount").attr("disabled",false);$("#loanTenor").attr("disabled",true);$("#loanTenor").val("");$("#loanTenorType").attr("disabled",true)}else{if(a==="Reschedule Request"){$("#rqstIdForTopupDiv").css("display","block");$("#loanAmount").attr("disabled",true);$("#loanAmount").val("");$("#loanTenor").attr("disabled",false);$("#loanTenorType").attr("disabled",false)}else{$("#rqstIdForTopupDiv").css("display","none");$("#refLoanrqstID").val(-1);$("#refLoanrqst").val("");$("#loanAmount").attr("disabled",false);$("#loanTenor").attr("disabled",false);$("#loanTenorType").attr("disabled",false)}}}function onClickrefLoanrqst1(){var a=$("#custType option:selected").val();var b="All Bank Customers";if(a==="Group"){if(nm==0){b="MCF Corporate/Group Customers";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",b,"gnrlOrgID","custType","","radio",true,"","custGrpID","custGrp","clear",1,"")}else{b="MCF Customer Group Members";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",b,"gnrlOrgID","custGrpID","","radio",true,"","bnkCustomerID","bnkCustomer","clear",1,"")}}else{getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",b,"gnrlOrgID","custType","","radio",true,"","bnkCustomerID","bnkCustomer","clear",1,"")}}function resetLoanRqstDetls(){$("#custGrpID").val(-1);$("#custGrp").val("");$("#bnkCustomerID").val(-1);$("#bnkCustomer").val("");$("#prdtTypeID").val(-1);$("#prdtType").val("");$("#loanAmount").val("");$("#loanTenor").val("");$("#rpmntSrcAcctID").val(-1);$("#rpmntSrcAcct").val("");$("#cashCollateralID").val(-1);$("#cashCollateral").val("");$("#invstmntCollateralID").val(-1);$("#invstmntCollateral").val("");$("#prptyCollateralID").val(-1);$("#prptyCollateral").val("");$("#rqstType").val("New Request");$("#refLoanrqstID").val(-1);$("#refLoanrqst").val("");$("#crdtType").val("Loan")}function resetLoanTopUpRschddlRqstDetls(){$("#rpmntSrcAcctID").val(-1);$("#rpmntSrcAcct").val("");$("#cashCollateralID").val(-1);$("#cashCollateral").val("");$("#invstmntCollateralID").val(-1);$("#invstmntCollateral").val("");$("#prptyCollateralID").val(-1);$("#prptyCollateral").val("");$("#refLoanrqstID").val(-1);$("#refLoanrqst").val("");$("#loanAmount").val("");$("#loanTenor").val("");$("#crdtType").val("Loan")}function onClickGroupNmOrCust(a){var d=$("#custType option:selected").val();var c=$("#grpApplicantType option:selected").val();var e="All Bank Customers - Account Holders";var b=$("#rqstType option:selected").val();if(b=="Top-Up Request"||b=="Reschedule Request"){resetLoanTopUpRschddlRqstDetls()}if(d==="Group"){if(a==0){e="MCF Corporate/Group Customers";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",e,"gnrlOrgID","custType","bnkBranchID","radio",true,"","custGrpID","custGrp","clear",1,"")}else{if(c==="Individual"){e="MCF Customer Group Members";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",e,"gnrlOrgID","custGrpID","bnkBranchID","radio",true,"","bnkCustomerID","bnkCustomer","clear",1,"")}}}else{getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",e,"gnrlOrgID","custType","bnkBranchID","radio",true,"","bnkCustomerID","bnkCustomer","clear",1,"")}}function onClickProduct(a,b){var c=$("#custType option:selected").val();var d="MCF Loan Products - Individual";if(c==="Corporate"){d="MCF Loan Products - Corporate";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",d,"gnrlOrgID","custTypeYes","crdtType","radio",true,"","prdtTypeID","prdtType","clear",1,"",function(){getLoanPrdtDetsForApplctn(a,b)})}else{if(c==="Group"){d="MCF Loan Products - Group";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",d,"gnrlOrgID","custTypeYes","crdtType","radio",true,"","prdtTypeID","prdtType","clear",1,"",function(){getLoanPrdtDetsForApplctn(a,b)})}else{if(c==="Individual"){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",d,"gnrlOrgID","custTypeYes","crdtType","radio",true,"","prdtTypeID","prdtType","clear",1,"",function(){getLoanPrdtDetsForApplctn(a,b)})}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Select Customer Type first!",callback:function(){}});return false}}}}function onClickCollateral(b,c,a){if(a===1){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","All Bank Accounts (For Loan Repayment)","gnrlOrgID","bnkCustomerID","","radio",true,"","cashCollateralID","cashCollateral","clear",1,"",function(){getCollateralValue(b,c,a)})}else{if(a===2){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","Investment Collaterals","bnkBranchID","custType","bnkCustomerID","radio",true,"","invstmntCollateralID","invstmntCollateral","clear",1,"",function(){getCollateralValue(b,c,a)})}else{if(a===3){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","Property Collaterals","gnrlOrgID","custType","bnkCustomerID","radio",true,"","prptyCollateralID","prptyCollateral","clear",1,"",function(){getCollateralValue(b,c,a)})}}}}function getCollateralValue(b,c,a){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var f;var g=typeof $("#cashCollateralID").val()==="undefined"?-1:$("#cashCollateralID").val();var h=typeof $("#invstmntCollateralID").val()==="undefined"?-1:$("#invstmntCollateralID").val();var e=typeof $("#prptyCollateralID").val()==="undefined"?-1:$("#prptyCollateralID").val();var d=typeof $("#refLoanrqstID").val()==="undefined"?-1:$("#refLoanrqstID").val();var j=new FormData();j.append("grp",17);j.append("typ",1);j.append("pg",b);j.append("subPgNo",c);j.append("vtyp",8);if(a==1){j.append("cashCollateralAcctID",g)}else{if(a==2){j.append("invstmntCollateralID",h)}else{if(a==3){j.append("prptyCollateralID",e)}}}j.append("coltTypeOptn",a);j.append("refLoanrqstID",d);$.ajax({url:"index.php",type:"POST",data:j,async:true,success:function(k){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");if(/^[\],:{}\s]*$/.test(k.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){f=$.parseJSON(k);if(a==1){$("#cashCollateralValue").val(f.coltValue);$("#cashColHasLien").val(f.hasColtLien)}else{if(a==2){$("#invstmntCollateralValue").val(f.coltValue);$("#invstmntColHasLien").val(f.hasColtLien)}else{if(a==3){$("#prptyCollateralValue").val(f.coltValue);$("#prptyColHasLien").val(f.hasColtLien)}}}}else{bootbox.alert({size:"small",title:"ERROR!",message:"Error: "+k,callback:function(){}});return false}},cache:false,contentType:false,processData:false})})}function onClickRefLoanRqst(a,b){var c=$("#rqstType option:selected").val();getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","MCF Approved Customer Loans Per Product","gnrlOrgID","prdtTypeID","bnkCustomerID","radio",true,"","refLoanrqstID","refLoanrqst","clear",1,"",function(){getRefLoanRqstDetsForApplctn(a,b)})}function getRefLoanRqstDetsForApplctn(a,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var e;var c=typeof $("#refLoanrqstID").val()==="undefined"?-1:$("#refLoanrqstID").val();var f=typeof $("#baseIntRate").val()==="undefined"?-1:$("#baseIntRate").val();var d=typeof $("#rqstType").val()==="undefined"?"":$("#rqstType").val();var g=new FormData();g.append("grp",17);g.append("typ",1);g.append("pg",a);g.append("subPgNo",b);g.append("vtyp",6);g.append("refLoanrqstID",c);g.append("rqstType",d);$.ajax({url:"index.php",type:"POST",data:g,async:true,success:function(h){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");if(/^[\],:{}\s]*$/.test(h.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=$.parseJSON(h);if(d==="Reschedule Request"){$("#loanAmount").val(e.refLoanRqstDetArry.principalAmountBal);$("#loanTenorType").val(e.refLoanRqstDetArry.loanRepaymentType);$("#loanTenor").val(e.refLoanRqstDetArry.ttlTenorBal)}else{$("#loanAmount").val("0.00");$("#loanTenorType").val(e.refLoanRqstDetArry.apprvdLoanTenorType);$("#loanTenor").val(e.refLoanRqstDetArry.apprvdLoanTenor)}$("#interestRate").val(f)}else{alert(h+" Error!")}},cache:false,contentType:false,processData:false})})}function getLoanRqstForm(l,m,c,o,d,f,g,h,e,a,j,n){if(typeof n==="undefined"||n===null){n=function(){var p=1}}if(!$.fn.DataTable.isDataTable("#"+a)){var k=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{k.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{k.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+m).html(b.responseText);var p=$("#status").val();$("#"+c).html(o);if(p=="Initiated"){$("#saveLoanRqstMn").css("display","none");$("#withdrawLoanRqstMn").css("display","inline-block")}else{$("#saveLoanRqstMn").css("display","inline-block");$("#withdrawLoanRqstMn").css("display","none")}$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+l).on("show.bs.modal",function(q){$(this).find(".modal-body").css({"max-height":"100%"})});$("#myFormsModalLg").off("hidden.bs.modal");$("#myFormsModalLg").one("hidden.bs.modal",function(q){if(h!=="VIEW"){getCustData("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.1");$("#"+m).html("");$(q.currentTarget).unbind()}});$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){n()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+h+"&PKeyID="+e)}function getDisbursementForm(m,n,c,p,d,f,g,j,e,a,k,o){if(typeof o==="undefined"||o===null){o=function(){var q=1}}if(!$.fn.DataTable.isDataTable("#"+a)){var l=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{l.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{l.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}var h="Incomplete";if(j=="EDIT"){}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+c).html(p);$("#"+n).html(b.responseText);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+m).on("show.bs.modal",function(q){$(this).find(".modal-body").css({"max-height":"100%"})});$("#myFormsModalLg").off("hidden.bs.modal");$("#myFormsModalLg").one("hidden.bs.modal",function(q){$("#"+n).html("");getCustData("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.2");$(q.currentTarget).unbind()});$body.removeClass("mdlloadingDiag");$("#"+m).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){o()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+j+"&PKeyID="+e)}function getCustProfileForm(h,j,c,f,k,a,e,d,g){$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+c).html(k);$("#"+j).html(b.responseText);if(d==1){var l=$("#nationalIDTblRO").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#nationalIDTblRO").wrap('<div class="dataTables_scroll" />');$('[data-toggle="tabajxprflro"]').click(function(p){var o=$(this);var n=o.attr("href");var m=o.attr("data-rhodata");var q="grp=8&typ=1"+m;return openATab(n,q)})}else{if(d==2){var l=$("#nationalIDTblEDT").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#nationalIDTblEDT").wrap('<div class="dataTables_scroll" />');$('[data-toggle="tabajxprfledt"]').click(function(p){var o=$(this);var n=o.attr("href");var m=o.attr("data-rhodata");var q="grp=8&typ=1"+m;return openATab(n,q)})}}$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+h).on("show.bs.modal",function(m){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+h).modal({backdrop:"static",keyboard:false});$(document).ready(function(){$("#"+f).submit(function(m){m.preventDefault();return false})})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&vtyp="+e+"&custID="+a+"&addOrEdit="+g)}function getPersonsForm(g,h,b,e,k,j,d,f,c){$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(j);$("#"+h).html(a.responseText);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(f==="EDIT"){var l=$("#"+k).find("td");$("#ntnlIDCardsCountry").val($.trim(l.eq(1).text()));$("#ntnlIDCardsIDTyp").val($.trim(l.eq(2).text()));$("#ntnlIDCardsIDNo").val($.trim(l.eq(3).text()));$("#ntnlIDCardsDateIssd").val($.trim(l.eq(4).text()));$("#ntnlIDCardsExpDate").val($.trim(l.eq(5).text()));$("#ntnlIDCardsOtherInfo").val($.trim(l.eq(6).text()))}$("#"+g).on("show.bs.modal",function(m){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+g).modal({backdrop:"static",keyboard:false});$(document).ready(function(){$("#"+e).submit(function(m){m.preventDefault();return false})})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg=10&vtyp="+d+"&ntnlIDpKey="+c)}function getAddtnlDataForm(j,l,b,f,n,m,e,g,d,h,k,c){$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(m);$("#"+l).html(a.responseText);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});if(g==="EDIT"){var r=h.split("|");var p=$("#"+n).find("td");for(var o=0;o<r.length;o++){var q=r[o].replace(/^\s*/,"").replace(/\s*$/,"");$("#"+q).val($.trim(p.eq(o+1).text()))}}$("#"+j).on("show.bs.modal",function(s){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+j).modal({backdrop:"static",keyboard:false});$(document).ready(function(){$("#"+f).submit(function(s){s.preventDefault();return false})})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg=2&vtyp="+e+"&addtnlPrsPkey="+d+"&extDtColNum="+k+"&pipeSprtdFieldIDs="+h+"&tableElmntID="+c+"&tRowElementID="+n+"&addOrEdit="+g)}function saveAddtnlDataForm(b,l,p,d,k,q,j){$body=$("body");$body.addClass("mdlloadingDiag");var o=p.split("|");var g=p.split("|");var h="";var c="";var e=$("#"+q).find("td");var f=Math.floor((Math.random()*99999)+parseInt(d));for(var n=0;n<o.length;n++){var m=o[n].replace(/^\s*/,"").replace(/\s*$/,"");o[n]=m;g[n]=typeof $("#"+m).val()==="undefined"?"%":$("#"+m).val();h=h+"&"+m+"="+g[n];if(j==="EDIT"){e.eq(n+1).html(g[n])}else{c=c+"<td>"+g[n]+"</td>"}}if(j==="ADD"){var r="<td><button type=\"button\" class=\"btn btn-default btn-sm\" onclick=\"getAddtnlDataForm('myFormsModal', 'myFormsModalBody', 'myFormsModalTitle', 'addtnlPrsnTblrDataForm','prsExtrTblrDtCol_"+d+"_Row"+f+"', 'Add/Edit Data', 12, 'EDIT', "+l+", '"+p+"', "+d+", 'extDataTblCol_"+d+'\');"><img src="cmn_images/edit32.png" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td>';$("#"+k).append('<tr id="prsExtrTblrDtCol_'+d+"_Row"+f+'">'+r+c+"</tr>")}var a="";$("#"+k).find("tr").each(function(u,v){var t=$(this).find("td");for(var u=0;u<o.length;u++){if(u==o.length-1){a=a+t.eq(u+1).text()}else{a=a+t.eq(u+1).text()+"~"}}a=a+"|"});var s;if(window.XMLHttpRequest){s=new XMLHttpRequest()}else{s=new ActiveXObject("Microsoft.XMLHTTP")}s.onreadystatechange=function(){if(s.readyState===4&&s.status===200){$body.removeClass("mdlloadingDiag");$("#"+b).html(s.responseText)}};s.open("POST","index.php",true);s.setRequestHeader("Content-type","application/x-www-form-urlencoded");s.send("grp=17&typ=1&pg=2&q=UPDATE&actyp=3&addtnlPrsPkey="+l+"&extDtColNum="+d+"&tableElmntID="+k+"&allTblValues="+a)}function getMonthMon(a){var b;switch(a){case 1:b="Jan";break;case 2:b="Feb";break;case 3:b="Mar";break;case 4:b="Apr";break;case 5:b="May";break;case 6:b="Jun";break;case 7:b="Jul";break;case 8:b="Aug";break;case 9:b="Sep";break;case 10:b="Oct";break;case 11:b="Nov";break;case 12:b="Dec";break}return b}function getDayDsp(a){var b;switch(a){case 0:b="SUNDAY";break;case 1:b="MONDAY";break;case 2:b="TUESDAY";break;case 3:b="WEDNESDAY";break;case 4:b="THURSDAY";break;case 5:b="FRIDAY";break;case 6:b="SATURDAY";break}return b}function showAmo_OLD(r,k,h,q,f,j,p,c){var l=[];l.push("<table border=0 cellpadding=3 width='100%'>");l.push("<tr align=right bgcolor='#E0F0FE'><td>&nbsp;</td><td><b>Beginning Balance</b></td><td><b>Interest</b></td><td><b>Principal</b></td><td><b>Ending Balance</b></td></tr>");var m=r;var b=Math.floor(h);var d=h-b;for(i=0;i<b;i++){var o=m*k;var a=q-o;var g=m-a;if((i%2)==1){l.push("<tr align=right><td>"+(i+1))}else{l.push("<tr align=right bgcolor='#dddddd'><td>"+(i+1))}if(f=="halfyear"){var n=Math.floor((i+2)/2);l.push(". Year #"+n)}l.push("</td><td>"+formatAsMoney(m));l.push("</td><td>"+formatAsMoney(o));l.push("</td><td>"+formatAsMoney(a));l.push("</td><td>"+formatAsMoney(g)+"</td></tr>");m=g;if(i>0){if(f=="halfmonth"){if(((i+1)%24)==0){var n=Math.floor((i+1)/24);l.push("<tr align=center bgcolor='#E0F0FE'><td colspan='5'><b>Year #"+n+" End</b></td></tr>")}}else{if(f=="month"){if(((i+1)%12)==0){var n=Math.floor((i+1)/12);l.push("<tr align=center bgcolor='#E0F0FE'><td colspan='5'><b>Year #"+n+" End</b></td></tr>")}}else{if(f=="quarter"){if(((i+1)%4)==0){var n=Math.floor((i+1)/4);l.push("<tr align=center bgcolor='#E0F0FE'><td colspan='5'><b>Year #"+n+" End</b></td></tr>")}}}}}}if(d>0.0001){var o=m*k;l.push("<tr align=right bgcolor='#E0F0FE'><td>"+(b+1));l.push(" (Partial)</td><td>"+formatAsMoney(m)+"</td><td>"+formatAsMoney(o)+"</td><td>"+formatAsMoney(m)+"</td><td>"+formatAsMoney(0)+"</td></tr>")}l.push("</table>");var e=l.join("");$("#"+c).html("<br><table><tr><td><span style='font-size:25px !important;margin-right:100px !important;'>Periodic Payment: "+formatAsMoney(q)+"</span></td><td><span style='font-size:20px !important;margin-right:30px !important; text-align:right;'>Start Date: "+j+"</span></td><td><span style='font-size:20px !important; text-align:rignt;'>End Date: "+p+'</span></td></tr></table><div style="text-align:right;margin-top:-10px;"><a href="#" onClick="gObj(\''+c+'\').innerHTML=\'\';return false;"><img src="cmn_images/lovButton.png" width="18" height="18" border="0"></a></div>'+e);$("#myFormsModalTitleLgz").html("Amortization Schedule");$("#myFormsModalLgz").modal("show");return false}function showAmo(d,g,k,z,C,j,m,w,A,L,G,u,B,a){isSchdlSvdBtnDsply=" display:block !important;";if(a=="YES"){isSchdlSvdBtnDsply=" display:none !important;"}var J=0;$("#trnsNtAllwdDysSlt1 option").each(function(){trnsNtAllwdDys[J]=$(this).val();J=J+1});var I=0;$("#trnsNtAllwdDtsSlt1 option").each(function(){trnsNtAllwdDts[I]=$(this).val();I=I+1});if(G==="Overdraft"){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<b>Start Date: "+j+"</b></br><b>End Date: "+m+"</b></br><b><span style='color:red !important;'>No Repayment Schedule for Overdraft Facilities</span></b>",callback:function(){}});return false}var b=[];b.push("<table id='amrtztnSchedule' border=0 cellpadding=3 width='100%'>");b.push("<tr id='headers_0' align=right bgcolor='#E0F0FE'><td>&nbsp;</td><td><b>Payment Date</b></td><td><b>Beginning Balance</b></td><td><b>Interest</b></td><td><b>Principal</b></td><td><b>Ending Balance</b></td></tr>");var e=new Date(j);var y="";var K="";var x="";var l;var s=C;var h=d;var E=Math.floor(k);var D=k-E;var F="";var v="";var H="";for(var M=0;M<E;M++){y=e.getDate();K=e.getMonth()+1;x=e.getFullYear();l=getMonthMon(K);var o;var t;var r;var N;if(L==="Flat Rate"||u==="simple"){o=d*g;t=d/k;N=h-t}else{o=h*g;t=z-o;N=h-t}if(D>0.0001){}else{if(parseInt(M)===(parseInt(E)-1)&&parseFloat(N)!==0){if(parseFloat(h)<parseFloat(t)){t=h;if(parseFloat(N)<0){o=o+(-1*N)}else{o=o+N}}else{o=o+N}N=0}}if((M%2)==1){b.push("<tr id='lines_"+(M+1)+"' align=right><td>"+(M+1))}else{b.push("<tr id='lines_"+(M+1)+"' align=right bgcolor='#dddddd'><td>"+(M+1))}if(C=="halfyear"){var c=Math.floor((M+2)/2);b.push(". Year #"+c)}b.push("</td><td id='lines"+(M+1)+"_pDate'>"+y+"-"+l+"-"+x);b.push("</td><td id='lines"+(M+1)+"_begBal'>"+formatAsMoney(h));b.push("</td><td id='lines"+(M+1)+"_intrst'>"+formatAsMoney(o));b.push("</td><td id='lines"+(M+1)+"_prncpl'>"+formatAsMoney(t));b.push("</td><td id='lines"+(M+1)+"_endnBal'>"+formatAsMoney(N)+"</td></tr>");h=N;if(M>0){if(C=="halfmonth"){if(((M+1)%24)==0){var c=Math.floor((M+1)/24);b.push("<tr id='headers_"+(M+1)+"' align=center bgcolor='#E0F0FE'><td colspan='5'><b>Year #"+c+" End</b></td></tr>")}}else{if(C=="month"){if(((M+1)%12)==0){var c=Math.floor((M+1)/12);b.push("<tr id='headers_"+(M+1)+"' align=center bgcolor='#E0F0FE'><td colspan='6'><b>Year #"+c+" End</b></td></tr>")}}else{if(C=="quarter"){if(((M+1)%4)==0){var c=Math.floor((M+1)/4);b.push("<tr id='headers_"+(M+1)+"' align=center bgcolor='#E0F0FE'><td colspan='6'><b>Year #"+c+" End</b></td></tr>")}}}}}if(s=="daily"){e.setDate(y+1);y=e.getDate();K=e.getMonth()+1;x=e.getFullYear()}else{if(s=="weekly"){e.setDate(y+7);y=e.getDate();K=e.getMonth()+1;x=e.getFullYear()}else{if(s=="biweekly"){e.setDate(y+14);y=e.getDate();K=e.getMonth()+1;x=e.getFullYear()}else{if(s=="halfmonth"){e.setDate(y+15);y=e.getDate();K=e.getMonth()+1;x=e.getFullYear()}else{if(s=="month"){e.setMonth(e.getMonth()+1);y=e.getDate();K=e.getMonth()+1;x=e.getFullYear()}else{if(s=="quarter"){e.setMonth(e.getMonth()+3);y=e.getDate();K=e.getMonth()+1;x=e.getFullYear()}else{if(s=="halfyear"){e.setMonth(e.getMonth()+6);y=e.getDate();K=e.getMonth()+1;x=e.getFullYear()}else{if(s=="year"){e.setFullYear(x+1);y=e.getDate();K=e.getMonth()+1;x=e.getFullYear()}}}}}}}}H=getMonthMon(K);if(y<10){v="0"+y}else{v=y}F=excludeHolidaysFromDate(v+"-"+H+"-"+x);e=new Date(F)}if(D>0.0001){var o;if(L!=="Flat Rate"){o=h*g}b.push("<tr id='lines_"+(E+1)+"' align=right bgcolor='#E0F0FE'><td>"+(E+1));b.push(" (Partial)</td><td id='lines"+(E+1)+"_pDate'>"+F+"</td><td id='lines"+(E+1)+"_begBal'>"+formatAsMoney(h)+"</td><td id='lines"+(E+1)+"_intrst'>"+formatAsMoney(o)+"</td><td id='lines"+(E+1)+"_prncpl'>"+formatAsMoney(h)+"</td><td id='lines"+(E+1)+"_endnBal'>"+formatAsMoney(0)+"</td></tr>")}b.push("</table>");var n=b.join("");var f="<button type='button' title='Save Loan Schedule' class='btn btn-default btn-sm' onclick='saveLoanSchedule(15, 4.2,"+A+");' style='padding:2px !important;'><img src='cmn_images/FloppyDisk.png' style='height:20px; width:auto; position: relative; vertical-align: middle;'>SAVE SCHEDULE</button>";if(A<=0){f=""}$("#"+w).html("<br><div style='margin-bottom:10px !important;'>\n        <table style='width:100% !important;'><tr><td><span style='font-size:25px !important;margin-right:70px !important;'>Periodic Payment: "+formatAsMoney(z)+"</span></td><td><span style='font-size:20px !important;margin-right:30px !important; text-align:right;'>Start Date: "+j+"</span></td><td><span style='font-size:20px !important; text-align:rignt;'>End Date: <span id='schdlEndDte'>"+F+"</span></span></td><td style='text-align: right;"+isSchdlSvdBtnDsply+"'>"+f+"</td></tr>\n        </table></div>"+n);$("#myFormsModalTitleLgz").html("Amortization Schedule");$("#myFormsModalLgz").modal("show");$("#myFormsModalLgz").off("hidden.bs.modal");$("#myFormsModalLgz").one("hidden.bs.modal",function(p){if(B>0){getDisbursementForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Disbursement",15,4.2,0,"EDIT",B,"indCustTable","indCustTableRow1")}$("#myFormsModalTitleLgz").html("");$("#myFormsModalBodyLgz").html("")});return false}function showSch(n,h,g,e,b){h=h-1;var j=[];j.push("<table border=0 cellpadding=3 width='100%'>");j.push("<tr align=right bgcolor='#E0F0FE'><td>&nbsp;</td><td><b>Beginning Balance</b></td><td><b>Interest</b></td><td><b>Ending Balance</b></td></tr>");var k=n;var a=Math.floor(g);var c=g-a;if(c>0.9999){a=a+1;c=0}for(i=0;i<a;i++){var m=k*h;var f=k+m;if((i%2)==1){j.push("<tr align=right><td>"+(i+1))}else{j.push("<tr align=right bgcolor='#dddddd'><td>"+(i+1))}j.push("</td><td>"+formatAsMoney(k));j.push("</td><td>"+formatAsMoney(m));j.push("</td><td>"+formatAsMoney(f)+"</td></tr>");k=f;if(i>0){if(e=="month"){if(((i+1)%12)==0){var l=Math.floor((i+1)/12);j.push("<tr align=center bgcolor='#E0F0FE'><td colspan='5'><b>Year #"+l+" End</b></td></tr>")}}}}if(c>0.0001){var m=Math.pow((h+1),c)*k-k;j.push("<tr align=right bgcolor='#E0F0FE'><td>"+(a+1));j.push(" (Partial)</td><td>"+formatAsMoney(k)+"</td><td>"+formatAsMoney(m)+"</td><td>"+formatAsMoney(m+k)+"</td></tr>")}j.push("</table>");h2value="";menuvalue="";if(e=="year"){h2value="Annual Schedule";h=Math.pow((h+1),1/12);menuvalue="<div id='topmenu'><ul><li id='menuon'><a href='#' onclick='return false;'>Annual Schedule</a></li> <li><a href='#' onclick=\"return showSch("+n+", "+h+", "+(g*12)+", 'month', '"+b+"');\">Monthly Schedule</a></li></ul></div>"}else{h2value="Monthly Schedule";h=Math.pow((1+h),12);menuvalue="<div id='topmenu'><ul><li><a href='#' onclick=\"return showSch("+n+", "+h+", "+(g/12)+", 'year', '"+b+"');\">Annual Schedule</a></li> <li id='menuon'><a href='#' onclick='return false;'>Monthly Schedule</a></li></ul></div>"}var d=j.join("");gObj(b).innerHTML="<br><h2>"+h2value+'</h2><div style="text-align:right;margin-top:-10px;"><a href="#" onClick="gObj(\''+b+'\').innerHTML=\'\';return false;"><img src="cmn_images/lovButton.png" width="18" height="18" border="0"></a></div>'+menuvalue+d;return false}function excludeHolidaysFromDate(n){var a=new Date(n);var m="";var q="";var r="";var b="";var d="";var o="";var h=0;var f=1;var e=1;var c=0;var l="";var g="";var p=0;do{m=a.getDate();q=a.getMonth()+1;r=a.getFullYear();b=getMonthMon(q);if(m<10){d="0"+m}o=d+"-"+b+"-"+r;while(f>0){if(trnsNtAllwdDts.indexOf(o.toUpperCase())>-1){a.setDate(m+1);m=a.getDate();q=a.getMonth()+1;r=a.getFullYear();b=getMonthMon(q);if(m<10){d="0"+m}else{d=m}o=d+"-"+b+"-"+r;f=1;h=1}else{f=0;p=0;e=1}}var c=0;while(e>0){c=c+1;l=a.getDay();g=getDayDsp(l);if(trnsNtAllwdDys.indexOf(g.toUpperCase())>-1){a.setDate(m+1);e=0;h=1;p=1}else{if(trnsNtAllwdDys.length<=0||c==trnsNtAllwdDys.length){e=0;p=0}else{e=1}}}if((p)==0){h=0}else{f=1}}while(h>0);m=a.getDate();q=a.getMonth()+1;r=a.getFullYear();b=getMonthMon(q);if(m<10){d="0"+m}else{d=m}nextDteDsply=d+"-"+b+"-"+r;return nextDteDsply}function formatAsMoney(a){a=a.toString().replace(/\$|\,/g,"");if(isNaN(a)){a="0"}sign=(a==(a=Math.abs(a)));a=Math.floor(a*100+0.50000000001);cents=a%100;a=Math.floor(a/100).toString();if(cents<10){cents="0"+cents}for(var b=0;b<Math.floor((a.length-(1+b))/3);b++){a=a.substring(0,a.length-(4*b+3))+","+a.substring(a.length-(4*b+3))}return(((sign)?"":"-")+a+"."+cents)}function fmtAsNumberLcl(a){return Number(a.replace(/[^-?0-9\.]/g,""))}function deleteCustPerson(e,h,c){var b="Customers";var g="Edit Customer Profile";if(c==1.1){g="EDIT CORPORATE CUSTOMER PROFILE"}else{if(c==1.2){g="EDIT CORPORATE CUSTOMER PROFILE"}else{if(c==1.3){g="EDIT CUSTOMER GROUP PROFILE"}else{if(c==1.4){b="Persons";g="Edit Person Profile"}}}}var d;var a;var f;f=bootbox.confirm({size:"small",message:"Are you sure you want to delete this record?",callback:function(j){if(j){if(!(h=="Incomplete"||h=="Rejected"||h=="Withdrawn")){f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only "+b+" with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});d.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l)/2;return n+"px"}});var k;if(window.XMLHttpRequest){k=new XMLHttpRequest()}else{k=new ActiveXObject("Microsoft.XMLHTTP")}k.onreadystatechange=function(){if(k.readyState===4&&k.status===200){var l=k.responseText;d.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var n=$(window).height();var m=$(".modal-dialog").height();var o=(n-m-150)/2;return o+"px"}});if(c==1.1&&(!(l=="Failed to Delete Customer"||l=="SORRY! CUSTOMER DELETION FAILED"))){getCustData("clear","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.1","mcfIndCstmr")}else{if(c==1.2&&(!(l=="Failed to Delete Customer"||l=="SORRY! CUSTOMER DELETION FAILED"))){getCustData("clear","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.2","mcfCorpCstmr")}else{if(c==1.3&&(!(l=="Failed to Delete Customer"||l=="SORRY! CUSTOMER DELETION FAILED"))){getCustData("clear","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.3","mcfGrpCstmr")}else{if(c==1.4&&(!(l=="Failed to Delete Person"||l=="SORRY! PERSON DELETION FAILED"))){getCustData("clear","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.4","mcfOthPCstmr")}}}}}};k.open("POST","index.php",true);k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.send("grp=17&typ=1&pg=11&subPgNo="+c+"&q=DELETE&actyp=2&PKeyID="+e+"&custStatus="+h)}}});f.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function deleteNationalID(c,a,e,k){var j=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var g=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var b="Customers";var l="Edit Customer Profile";if(e==1.4){b="Persons";j=typeof $("#personID").val()==="undefined"?-1:$("#personID").val();l="Edit Person Profile"}var f;var h;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this record?",callback:function(m){if(m){if(!(a=="Incomplete"||a=="Rejected"||a=="Withdrawn")){d.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only National IDs for "+b+" with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});f.find(".modal-content").css({"margin-top":function(){var p=$(window).height();var o=$(".modal-dialog").height();var q=(p-o)/2;return q+"px"}});var n;if(window.XMLHttpRequest){n=new XMLHttpRequest()}else{n=new ActiveXObject("Microsoft.XMLHTTP")}n.onreadystatechange=function(){if(n.readyState===4&&n.status===200){var o=n.responseText;f.modal("hide");h=bootbox.alert({size:"small",title:"Rhomicom Message",message:o,callback:function(){}});h.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=(q-p-150)/2;return r+"px"}});getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg",l,11,e,0,"EDIT",j,"EDIT","indCustTableRow1",-1,function(){})}};n.open("POST","index.php",true);n.setRequestHeader("Content-type","application/x-www-form-urlencoded");n.send("grp=17&typ=1&pg=11&subPgNo="+e+"&q=DELETE&actyp=1&PKeyID="+c+"&custStatus="+a+"&custPrsnID="+j+"&rvsnTtl="+g+"&isApproved="+k)}}});d.find(".modal-content").css({"margin-top":function(){var n=$(window).height();var m=$(".modal-dialog").height();var o=(n-m-150)/2;return o+"px"}})}function wthdrwRjctAutrzCustDataRqst(d,c,e,g){var f;var h;var j=1;var a="Withdrawing.";var b="Are you sure you want to "+d+" this Change Request?";if(d=="REJECT"){a="Rejecting.";j=2}else{if(d=="AUTHORIZE"){a="Authorizing.";j=3}}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var m;var l=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var k=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();bootbox.confirm({title:"Rhomicom Message",message:b,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(n){if(n){f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">'+a+". Please Wait...</span></div>"});f.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=q/2;return r+"px"}});var o=new FormData();o.append("grp",17);o.append("typ",1);o.append("q","UPDATE");o.append("pg",c);o.append("subPgNo",e);o.append("vtyp",g);o.append("custID",l);o.append("actyp",j);o.append("rvsnTtl",k);$.ajax({url:"index.php",type:"POST",data:o,async:true,success:function(p){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var q="";if(/^[\],:{}\s]*$/.test(p.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(p);if(d=="REJECT"){q="Change Request Successfully REJECTED!"}else{if(d=="AUTHORIZE"){q="Change Request Successfully AUTHORIZED!"}else{q="Change Request successfully WITHDRAWN"}}getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Customer Profile",11,e,0,"EDIT",l,"","indCustTableRow1",-1,function(){f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})})}else{q=p;f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function modifyAutrzCustDataRqst(a,c,b){var d;var e="Are you sure you want MODIFY this AUTHORIZED DATA?";getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var g;var f=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();bootbox.confirm({title:"Rhomicom Message",message:e,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(h){if(h){d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">Preparing Data. Please Wait...</span></div>'});d.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=l/2;return m+"px"}});var j=new FormData();j.append("grp",17);j.append("typ",1);j.append("q","UPDATE");j.append("pg",a);j.append("subPgNo",c);j.append("vtyp",b);j.append("custID",f);j.append("actyp",4);$.ajax({url:"index.php",type:"POST",data:j,async:true,success:function(k){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var l="";if(/^[\],:{}\s]*$/.test(k.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){g=$.parseJSON(k);getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Customer Profile",11,c,0,"EDIT",f,"","indCustTableRow1",-1,function(){d.modal("hide")})}else{l=k;d.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function dsplyAuthrzdData(a){bootbox.alert({size:"small",title:"Authorized Data",message:"<span style='color:red; font-weight:bold !important;text-align:centre;'>"+a+"</span>",callback:function(){}});return false}function getRiskFactorForm(m,n,c,p,d,f,k,g,h,e,a,j,o){if(typeof o==="undefined"||o===null){o=function(){var q=1}}if(!$.fn.DataTable.isDataTable("#"+a)){var l=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{l.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{l.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+n).html(b.responseText);$("#"+m).off("hidden.bs.modal");$("#"+m).one("hidden.bs.modal",function(q){getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=2","riskFactors");$("#"+n).html("");$("#"+c).html("");$(q.currentTarget).unbind()});$("#"+c).html(p);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+m).on("show.bs.modal",function(q){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+m).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){o()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&subVwtyp="+k+"&vtyp="+g+"&vtypActn="+h+"&PKeyID="+e)}function deleteRiskFactor(c){var b;var a;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Risk Factor?",callback:function(e){if(e){b=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});b.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;if(g=="SORRY"){$msg="SORRY! Can't Delete an Risk Factor that is in active Use.";b.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}else{b.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=2","riskFactors")}}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=15&subPgNo=4.6&subVwtyp=2&q=DELETE&PKeyID="+c)}}});d.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function saveRiskFactor(a,d,e,c){var f;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var l;var j=typeof $("#riskFactorId").val()==="undefined"?-1:$("#riskFactorId").val();var m=typeof $("#riskFactorCode").val()==="undefined"?"":$("#riskFactorCode").val();var g=typeof $("#riskFactorDesc").val()==="undefined"?"":$("#riskFactorDesc").val();var h=typeof $("#isEnabled").val()==="undefined"?"No":$("#isEnabled").val();if(m.trim()==""||m==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Risk Factor",callback:function(){}});return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});f.find(".modal-content").css({"margin-top":function(){var o=$(window).height();var n=$(".modal-dialog").height();var p=o/2;return p+"px"}});var k=new FormData();k.append("grp",17);k.append("typ",1);k.append("q","UPDATE");k.append("pg",a);k.append("subPgNo",d);k.append("subVwtyp",e);k.append("vtyp",c);k.append("riskFactorId",j);k.append("riskFactorCode",m);k.append("riskFactorDesc",g);k.append("isEnabled",h);$.ajax({url:"index.php",type:"POST",data:k,async:true,success:function(n){var o="";if(/^[\],:{}\s]*$/.test(n.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=$.parseJSON(n);$("#riskFactorId").val(l.riskFactorId);f.modal("hide");getRiskFactorForm("myFormsModalx","myFormsModalxBody","myFormsModalxTitle","Edit Risk Factor",15,d,e,0,"EDIT",l.riskFactorId,"indCustTable","indCustTableRow1",function(){o="Risk Factor Successfully Saved!";b=bootbox.alert({size:"small",title:"Rhomicom Message",message:o,callback:function(){}})})}else{o=n;f.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:o,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function deleteRiskProfile(b){var c;var a;var d;d=bootbox.confirm({size:"small",title:"Delete Risk Profile?",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">DELETE</span> this Risk Profile?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(e){if(e){c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;if(g=="SORRY"){$msg="SORRY! Can't Delete an Risk Profile that is in active Use.";c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}else{c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getAllRiskProfiles("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3")}}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=15&subPgNo=4.6&subVwtyp=3&q=DELETE&PKeyID="+b)}}});d.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function saveRiskProfile(a,d,e,c){var f;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var n;var l=typeof $("#oneRiskProfileDetID").val()==="undefined"?"-1":$("#oneRiskProfileDetID").val();var j=typeof $("#oneRiskProfileDetName").val()==="undefined"?"":$("#oneRiskProfileDetName").val();var g=typeof $("#oneRiskProfileDetDesc").val()==="undefined"?"":$("#oneRiskProfileDetDesc").val();var h=typeof $("#oneRiskProfileDetIsEnbld").val()==="undefined"?"Yes":$("#oneRiskProfileDetIsEnbld").val();var k=typeof $("#oneRiskProfileDetTtlScore").val()==="undefined"?0:$("#oneRiskProfileDetTtlScore").val().trim().length===0?0:$("#oneRiskProfileDetTtlScore").val();if(j.trim()==""||j==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Risk Profile Name",callback:function(){}});return false}else{if(k==""||parseFloat(k)<0||k==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Total Profile Score must be zero or greater",callback:function(){}});return false}}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});f.find(".modal-content").css({"margin-top":function(){var p=$(window).height();var o=$(".modal-dialog").height();var q=p/2;return q+"px"}});var m=new FormData();m.append("grp",17);m.append("typ",1);m.append("q","UPDATE");m.append("pg",15);m.append("subPgNo",d);m.append("subVwtyp",e);m.append("vtyp",c);m.append("riskProfileId",l);m.append("profileName",j);m.append("profileDesc",g);m.append("isEnabled",h);m.append("ttlScore",k);$.ajax({url:"index.php",type:"POST",data:m,async:true,success:function(o){var p="";if(/^[\],:{}\s]*$/.test(o.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){n=$.parseJSON(o);f.modal("hide");getAllRiskProfiles("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Risk Profile Saved Successfully",callback:function(){}})}else{p=o;f.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:p,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function getOneRiskProfileDetail(b,c){var a="grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3.1&vtyp=0&sbmtdRiskProfileID="+b;doAjaxWthCallBck(a,"allRiskProfilesDetailInfo","PasteDirect","","","",function(){$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip();var d=$("#allRiskProfileFctrsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allRiskProfileFctrsTable").wrap('<div class="dataTables_scroll"/>')})})}function getAllRiskProfiles(d,a,j){var c=typeof $("#allRiskProfilesSrchFor").val()==="undefined"?"%":$("#allRiskProfilesSrchFor").val();var h=typeof $("#allRiskProfilesSrchIn").val()==="undefined"?"Both":$("#allRiskProfilesSrchIn").val();var b=typeof $("#allRiskProfilesPageNo").val()==="undefined"?1:$("#allRiskProfilesPageNo").val();var f=typeof $("#allRiskProfilesDsplySze").val()==="undefined"?10:$("#allRiskProfilesDsplySze").val();var g=typeof $("#allRiskProfilesSortBy").val()==="undefined"?"":$("#allRiskProfilesSortBy").val();var e=typeof $("#allRiskProfilesIsEnabled").val()==="undefined"?"":$("#allRiskProfilesIsEnabled").val();if(d=="clear"){c="%";b=1}else{if(d=="next"){b=parseInt(b)+1}else{if(d=="previous"){b=parseInt(b)-1}}}j=j+"&searchfor="+c+"&searchin="+h+"&pageNo="+b+"&limitSze="+f+"&sortBy="+g+"&isEnabled="+e;openATab(a,j)}function enterKeyFuncAllRiskProfiles(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllRiskProfiles(b,f,d)}}function getAllRiskProfileFctrs(d,h,e){var c=typeof $("#allRiskProfileFctrsSrchFor").val()==="undefined"?"%":$("#allRiskProfileFctrsSrchFor").val();var b=typeof $("#allRiskProfileFctrsSrchIn").val()==="undefined"?"Both":$("#allRiskProfileFctrsSrchIn").val();var a=typeof $("#allRiskProfileFctrsPageNo").val()==="undefined"?1:$("#allRiskProfileFctrsPageNo").val();var g=typeof $("#allRiskProfileFctrsDsplySze").val()==="undefined"?10:$("#allRiskProfileFctrsDsplySze").val();var f=typeof $("#allRiskProfileFctrsSortBy").val()==="undefined"?"":$("#allRiskProfileFctrsSortBy").val();if(d=="clear"){c="%";a=1}else{if(d=="next"){a=parseInt(a)+1}else{if(d=="previous"){a=parseInt(a)-1}}}e=e+"&searchfor="+c+"&searchin="+b+"&pageNo="+a+"&limitSze="+g+"&sortBy="+f;openATab(h,e)}function enterKeyFuncAllRiskProfileFctrs(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllRiskProfileFctrs(b,f,d)}}function getOneRiskProfileForm(b,c){var a="grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3.1&vtyp="+c+"&sbmtdRiskProfileID="+b;doAjaxWthCallBck(a,"allRiskProfilesDetailInfo","PasteDirect","","","",function(){var d=$("#allRiskProfileFctrsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allRiskProfileFctrsTable").wrap('<div class="dataTables_scroll"/>')});$("#allRiskProfilesForm").submit(function(d){d.preventDefault();return false})}function saveRiskProfileFctr(){var e=typeof $("#sbmtdRiskProfileID").val()==="undefined"?"-1":$("#sbmtdRiskProfileID").val();var c="";var f=0;var d=0;var a=typeof $("#oneRiskProfileDetTtlScore").val()==="undefined"?0:$("#oneRiskProfileDetTtlScore").val().trim().length===0?0:$("#oneRiskProfileDetTtlScore").val();var g=0;$("#allRiskProfileFctrsTable").find("tr").each(function(j,k){if(j>0){if(typeof $(k).attr("id")==="undefined"){}else{var h=$(k).attr("id").split("_")[1];if(typeof $("#allRiskProfileFctrsRow"+h+"_RiskFactorID").val()==="undefined"){}else{if($("#allRiskProfileFctrsRow"+h+"_RiskFactorID").val()==""||$("#allRiskProfileFctrsRow"+h+"_RiskFactorID").val()==-1){$("#allRiskProfileFctrsRow"+h+"_RiskFactorNm").css("border-color","red");$("#allRiskProfileFctrsRow"+h+"_RiskFactorNm").css("border-width","2px");f=f+1}else{$("#allRiskProfileFctrsRow"+h+"_RiskFactorNm").css("border-color","#ccc");$("#allRiskProfileFctrsRow"+h+"_RiskFactorNm").css("border-width","1px")}if($("#allRiskProfileFctrsRow"+h+"_Score").val()==""||parseFloat($("#allRiskProfileFctrsRow"+h+"_Score").val())<0){$("#allRiskProfileFctrsRow"+h+"_Score").css("border-color","red");$("#allRiskProfileFctrsRow"+h+"_Score").css("border-width","2px");f=f+1}else{$("#allRiskProfileFctrsRow"+h+"_Score").css("border-color","#ccc");$("#allRiskProfileFctrsRow"+h+"_Score").css("border-width","1px")}if($("#allRiskProfileFctrsRow"+h+"_SortOrder").val()==""||parseFloat($("#allRiskProfileFctrsRow"+h+"_SortOrder").val())<0){$("#allRiskProfileFctrsRow"+h+"_SortOrder").css("border-color","red");$("#allRiskProfileFctrsRow"+h+"_SortOrder").css("border-width","2px");f=f+1}else{$("#allRiskProfileFctrsRow"+h+"_SortOrder").css("border-color","#ccc");$("#allRiskProfileFctrsRow"+h+"_SortOrder").css("border-width","1px")}if(f<=0){c=c+$("#allRiskProfileFctrsRow"+h+"_RiskProfileFactorID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrsRow"+h+"_RiskFactorID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrsRow"+h+"_Score").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrsRow"+h+"_SortOrder").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";g=g+parseFloat($("#allRiskProfileFctrsRow"+h+"_Score").val());d=d+1}}}}});if(f>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted Risk Profile Factor record</i></b></span>",callback:function(){}});return false}else{if(d<=0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please provide at lease One Risk Profile Factor record</i></b></span>",callback:function(){}});return false}else{if(d>0&&(parseFloat(g)>parseFloat(a))){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Total PROFILE SCORE "+a+" must be EQUAL to the sum of the PROFILE FACTOR SCORES "+g+"</i></b></span>",callback:function(){}});return false}}}var b=bootbox.alert({title:"Save Risk Profile Factors?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving Profile Factors...Please Wait...</p>',callback:function(){getAllRiskProfiles("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3")}});b.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"UPDATE",subPgNo:4.6,subVwtyp:3,actyp:1,sbmtdRiskProfileID:e,slctdRiskProfileFctrs:c},success:function(h){setTimeout(function(){b.find(".bootbox-body").html(h)},500)},error:function(h,k,j){console.warn(h.responseText)}})})})}function validateRiskProfileFctr(){var f="";var n=typeof $("#sbmtdRiskProfileID").val()==="undefined"?"-1":$("#sbmtdRiskProfileID").val();var p="";var q=0;var e=0;var j=1;var a=0;var h=typeof $("#oneRiskProfileDetTtlScore").val()==="undefined"?0:$("#oneRiskProfileDetTtlScore").val().trim().length===0?0:$("#oneRiskProfileDetTtlScore").val();var d=typeof $("#oneRiskProfileDetValidity").text()==="undefined"?"Invalid":$("#oneRiskProfileDetValidity").text();var c=0;var o=typeof $("#oneRiskProfileDetID").val()==="undefined"?"-1":$("#oneRiskProfileDetID").val();var b=typeof $("#oneRiskProfileDetName").val()==="undefined"?"":$("#oneRiskProfileDetName").val();var k=typeof $("#oneRiskProfileDetDesc").val()==="undefined"?"":$("#oneRiskProfileDetDesc").val();var m=typeof $("#oneRiskProfileDetIsEnbld").val()==="undefined"?"Yes":$("#oneRiskProfileDetIsEnbld").val();var g=typeof $("#oneRiskProfileDetTtlScore").val()==="undefined"?0:$("#oneRiskProfileDetTtlScore").val().trim().length===0?0:$("#oneRiskProfileDetTtlScore").val();$("#allRiskProfileFctrsTable").find("tr").each(function(u,v){if(u>0){if(typeof $(v).attr("id")==="undefined"){}else{var s=$(v).attr("id").split("_")[1];if(typeof $("#allRiskProfileFctrsRow"+s+"_RiskFactorID").val()==="undefined"){}else{if($("#allRiskProfileFctrsRow"+s+"_RiskFactorID").val()==""||$("#allRiskProfileFctrsRow"+s+"_RiskFactorID").val()==-1){$("#allRiskProfileFctrsRow"+s+"_RiskFactorNm").css("border-color","red");$("#allRiskProfileFctrsRow"+s+"_RiskFactorNm").css("border-width","2px");q=q+1}else{$("#allRiskProfileFctrsRow"+s+"_RiskFactorNm").css("border-color","#ccc");$("#allRiskProfileFctrsRow"+s+"_RiskFactorNm").css("border-width","1px")}if($("#allRiskProfileFctrsRow"+s+"_Score").val()==""||parseFloat($("#allRiskProfileFctrsRow"+s+"_Score").val())<0){$("#allRiskProfileFctrsRow"+s+"_Score").css("border-color","red");$("#allRiskProfileFctrsRow"+s+"_Score").css("border-width","2px");q=q+1}else{$("#allRiskProfileFctrsRow"+s+"_Score").css("border-color","#ccc");$("#allRiskProfileFctrsRow"+s+"_Score").css("border-width","1px")}if($("#allRiskProfileFctrsRow"+s+"_SortOrder").val()==""||parseFloat($("#allRiskProfileFctrsRow"+s+"_SortOrder").val())<0){$("#allRiskProfileFctrsRow"+s+"_SortOrder").css("border-color","red");$("#allRiskProfileFctrsRow"+s+"_SortOrder").css("border-width","2px");q=q+1}else{$("#allRiskProfileFctrsRow"+s+"_SortOrder").css("border-color","#ccc");$("#allRiskProfileFctrsRow"+s+"_SortOrder").css("border-width","1px")}if(q<=0){p=p+$("#allRiskProfileFctrsRow"+s+"_RiskProfileFactorID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrsRow"+s+"_RiskFactorID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrsRow"+s+"_Score").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrsRow"+s+"_SortOrder").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrsRow"+s+"_TtlOptnsScore").text().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrsRow"+s+"_RiskFactorNm").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";c=c+parseFloat($("#allRiskProfileFctrsRow"+s+"_Score").val());e=e+1;var t=$("#allRiskProfileFctrsRow"+s+"_Score").val();var r=$("#allRiskProfileFctrsRow"+s+"_TtlOptnsScore").text();if(parseFloat(t)!=parseFloat(r)){a=a+1;f=f+"<tr><td><span style='color:red;'><b>Row "+j+" - "+$("#allRiskProfileFctrsRow"+s+"_RiskFactorNm").val()+'</b></span></td><td style="text-align:center !important;"><b>'+t+'</b></td><td style="text-align:center !important;"><b>'+r+"</b></td></tr>"}}j=j+1}}}});if(o.trim()==""||o==-1||o==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please save Risk Profile First</i></b></span>",callback:function(){}});return false}else{if(b.trim()==""||b==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please provide Risk Profile Name</i></b></span>",callback:function(){}});return false}else{if(g==""||parseFloat(g)<0||g==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Total Profile Score must be zero or greater</i></b></span>",callback:function(){}});return false}else{if(q>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted Risk Profile Factor record</i></b></span>",callback:function(){}});return false}else{if(e<=0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please provide at lease One Risk Profile Factor record</i></b></span>",callback:function(){}});return false}else{if(e>0&&d=="Valid"){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Risk Profile is already VALID</i></b></span>",callback:function(){}});return false}else{if(e>0&&d=="Invalid"&&(parseFloat(c)!=parseFloat(h))){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Total PROFILE SCORE "+h+" must be EQUAL to the sum of the PROFILE FACTOR SCORES "+c+"</i></b></span>",callback:function(){}});return false}else{if(a>0){box2=bootbox.alert({size:"medium",title:"Rhomicom Message",message:'<span style="color:blue !important;"><b>Please ensure that the following SCORES agree before proceeding:</b></span></br><table border="1" style="border-collapse:none !important;"><tr><th>RISK FACTOR</th><th>RISK FACTOR SCORE</th><th>OPTIONS MAX SCORE</th></tr>'+f+"</table>",callback:function(){}});return false}}}}}}}}var l=bootbox.alert({title:"Validate Risk Profile?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Validating Risk Profile...Please Wait...</p>',callback:function(){getAllRiskProfiles("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3")}});l.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"UPDATE",subPgNo:4.6,subVwtyp:3,actyp:3,sbmtdRiskProfileID:n,slctdRiskProfileFctrs:p,riskProfileId:o,profileName:b,profileDesc:k,isEnabled:m,ttlScore:g,validity:d,rngPrflFctrScoreTtl:c},success:function(r){setTimeout(function(){l.find(".bootbox-body").html(r)},500)},error:function(r,t,s){console.warn(r.responseText)}})})})}function delRiskProfileFctr(d){var a=d.split("_")[1];var c=-1;var e="";if(typeof $("#allRiskProfileFctrsRow"+a+"_RiskFactorID").val()==="undefined"){}else{c=$("#allRiskProfileFctrsRow"+a+"_RiskProfileFactorID").val();e=$("#allRiskProfileFctrsRow"+a+"_RiskFactorID").val()}var b=bootbox.confirm({title:"Remove Person?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this Profile Factor?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Remove Person?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing Profile Factor...Please Wait...</p>',callback:function(){getAllRiskProfiles("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3")}});g.init(function(){if(c>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"DELETE",subPgNo:4.6,subVwtyp:3,actyp:1,RiskFactorID:e,PKeyID:c},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h);if(h.indexOf("Success")!==-1){$("#"+d).remove()}},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){$("#"+d).remove();g.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function getRiskProfileFctrOptnsForm(e,g){var a=e.split("_")[1];var c=-1;var f="";var d=typeof $("#oneRiskProfileDetName").val()==="undefined"?"":$("#oneRiskProfileDetName").val();if(typeof $("#allRiskProfileFctrsRow"+a+"_RiskFactorID").val()==="undefined"){}else{c=$("#allRiskProfileFctrsRow"+a+"_RiskProfileFactorID").val();f=$("#allRiskProfileFctrsRow"+a+"_RiskFactorNm").val()}var b="grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3.3&vtyp="+g+"&sbmtdRiskProfileFctrID="+c;doAjaxWthCallBck(b,"myFormsModalNrml","ShowDialog","Options for PROFILE: "+d+" & RISK: "+f,"myFormsModalNrmlTitle","myFormsModalNrmlBody",function(){var h=$("#allRiskProfileFctrOptnsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allRiskProfileFctrOptnsTable").wrap('<div class="dataTables_scroll"/>');$("#allOtherInputData99").val(0);$("#myFormsModalNrml").one("hidden.bs.modal",function(j){getAllRiskProfiles("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3")})});$("#allRiskProfileFctrOptnsForm").submit(function(h){h.preventDefault();return false})}function saveRiskProfileFctrOptn(){var d=typeof $("#oneRiskProfileDetID").val()==="undefined"?"-1":$("#oneRiskProfileDetID").val();var a=typeof $("#sbmtdRiskProfileFctrID").val()==="undefined"?"-1":$("#sbmtdRiskProfileFctrID").val();var b="";var f=0;var e=0;$("#allRiskProfileFctrOptnsTable").find("tr").each(function(h,j){if(h>0){if(typeof $(j).attr("id")==="undefined"){}else{var g=$(j).attr("id").split("_")[1];if(typeof $("#allRiskProfileFctrOptnsRow"+g+"_RiskProfileFctrID").val()==="undefined"){}else{if($("#allRiskProfileFctrOptnsRow"+g+"_OptnDesc").val().trim()==""||$("#allRiskProfileFctrOptnsRow"+g+"_OptnDesc").val()==undefined){$("#allRiskProfileFctrOptnsRow"+g+"_OptnDesc").css("border-color","red");$("#allRiskProfileFctrOptnsRow"+g+"_OptnDesc").css("border-width","2px");f=f+1}else{$("#allRiskProfileFctrOptnsRow"+g+"_OptnDesc").css("border-color","#ccc");$("#allRiskProfileFctrOptnsRow"+g+"_OptnDesc").css("border-width","1px")}if($("#allRiskProfileFctrOptnsRow"+g+"_Score").val()==""||parseFloat($("#allRiskProfileFctrOptnsRow"+g+"_Score").val())<0){$("#allRiskProfileFctrOptnsRow"+g+"_Score").css("border-color","red");$("#allRiskProfileFctrOptnsRow"+g+"_Score").css("border-width","2px");f=f+1}else{$("#allRiskProfileFctrOptnsRow"+g+"_Score").css("border-color","#ccc");$("#allRiskProfileFctrOptnsRow"+g+"_Score").css("border-width","1px")}if($("#allRiskProfileFctrOptnsRow"+g+"_SortOrder").val()==""||parseFloat($("#allRiskProfileFctrOptnsRow"+g+"_SortOrder").val())<0){$("#allRiskProfileFctrOptnsRow"+g+"_SortOrder").css("border-color","red");$("#allRiskProfileFctrOptnsRow"+g+"_SortOrder").css("border-width","2px");f=f+1}else{$("#allRiskProfileFctrOptnsRow"+g+"_SortOrder").css("border-color","#ccc");$("#allRiskProfileFctrOptnsRow"+g+"_SortOrder").css("border-width","1px")}if(f<=0){b=b+$("#allRiskProfileFctrOptnsRow"+g+"_RiskProfileFactorOptnID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrOptnsRow"+g+"_OptnDesc").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrOptnsRow"+g+"_Score").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allRiskProfileFctrOptnsRow"+g+"_SortOrder").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";e=e+1}}}}});if(f>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted Risk Factor Option records</i></b></span>",callback:function(){}});return false}else{if(e<=0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please provide at lease One Risk Factor Option records</i></b></span>",callback:function(){}});return false}}var c=bootbox.alert({title:"Save Risk Factor Options?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving Risk Factor Options...Please Wait...</p>',callback:function(){getAllRiskProfileFctrOptns("","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=3.3&sbmtdRiskProfileFctrID="+a)}});c.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"UPDATE",subPgNo:4.6,subVwtyp:3,actyp:2,sbmtdRiskProfileFctrID:a,riskProfileID:d,slctdRiskProfileFctrOptns:b},success:function(g){setTimeout(function(){c.find(".bootbox-body").html(g)},500)},error:function(g,j,h){console.warn(g.responseText)}})})})}function delRiskProfileFctrOptn(e){var d=typeof $("#oneRiskProfileDetID").val()==="undefined"?"-1":$("#oneRiskProfileDetID").val();var a=e.split("_")[1];var c=-1;if(typeof $("#allRiskProfileFctrOptnsRow"+a+"_RiskProfileFctrID").val()==="undefined"){}else{c=$("#allRiskProfileFctrOptnsRow"+a+"_RiskProfileFactorOptnID").val()}var b=bootbox.confirm({title:"Remove Risk Factor Option?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this Risk Factor Option?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Remove Risk Factor Option?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing Risk Factor Option...Please Wait...</p>',callback:function(){}});g.init(function(){if(c>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"DELETE",subPgNo:4.6,subVwtyp:3,actyp:2,riskProfileID:d,PKeyID:c},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h);if(h.indexOf("Success")!==-1){$("#"+e).remove()}},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){$("#"+e).remove();g.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function enterKeyFuncAllRiskProfileFctrOptns(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllRiskProfileFctrOptns(b,d)}}function getAllRiskProfileFctrOptns(d,f){var c=typeof $("#allRiskProfileFctrOptnsSrchFor").val()==="undefined"?"%":$("#allRiskProfileFctrOptnsSrchFor").val();var b=typeof $("#allRiskProfileFctrOptnsSrchIn").val()==="undefined"?"Both":$("#allRiskProfileFctrOptnsSrchIn").val();var a=typeof $("#allRiskProfileFctrOptnsPageNo").val()==="undefined"?1:$("#allRiskProfileFctrOptnsPageNo").val();var h=typeof $("#allRiskProfileFctrOptnsDsplySze").val()==="undefined"?10:$("#allRiskProfileFctrOptnsDsplySze").val();var g=typeof $("#allRiskProfileFctrOptnsSortBy").val()==="undefined"?"":$("#allRiskProfileFctrOptnsSortBy").val();var e="";if(d=="clear"){c="%";a=1}else{if(d=="next"){a=parseInt(a)+1}else{if(d=="previous"){a=parseInt(a)-1}}}f=f+"&searchfor="+c+"&searchin="+b+"&pageNo="+a+"&limitSze="+h+"&sortBy="+g;doAjaxWthCallBck(f,"myFormsModalNrml","ReloadDialog","Options for PROFILE RISK: "+e,"myFormsModalNrmlTitle","myFormsModalNrmlBody",function(){var j=$("#allRiskProfileFctrOptnsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allRiskProfileFctrOptnsTable").wrap('<div class="dataTables_scroll"/>');$("#allOtherInputData99").val(0)});$("#allRiskProfileFctrOptnsForm").submit(function(j){j.preventDefault();return false})}function deleteAssessmentSet(a){var c;var b;var d;d=bootbox.confirm({size:"small",title:"Delete Assessment Set?",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">DELETE</span> this Assessment Set?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(e){if(e){c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;if(g=="SORRY"){$msg="SORRY! Can't Delete an Assessment Set that is in active Use.";c.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});b.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}else{c.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});b.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getAllAssessmentSets("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=4")}}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=15&subPgNo=4.6&subVwtyp=4&q=DELETE&PKeyID="+a)}}});d.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function saveAssessmentSet(a,d,e,c){var f;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var m;var g=typeof $("#oneAssessmentSetDetID").val()==="undefined"?"-1":$("#oneAssessmentSetDetID").val();var n=typeof $("#oneAssessmentSetDetName").val()==="undefined"?"":$("#oneAssessmentSetDetName").val();var j=typeof $("#oneAssessmentSetDetDesc").val()==="undefined"?"":$("#oneAssessmentSetDetDesc").val();var h=typeof $("#oneAssessmentSetDetIsEnbld").val()==="undefined"?"Yes":$("#oneAssessmentSetDetIsEnbld").val();var k=typeof $("#oneAssessmentSetDetTtlScore").val()==="undefined"?0:$("#oneAssessmentSetDetTtlScore").val().trim().length===0?0:$("#oneAssessmentSetDetTtlScore").val();if(n.trim()==""||n==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Assessment Set Name",callback:function(){}});return false}else{if(k==""||parseFloat(k)<0||k==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Pass Score must be zero or greater",callback:function(){}});return false}}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});f.find(".modal-content").css({"margin-top":function(){var p=$(window).height();var o=$(".modal-dialog").height();var q=p/2;return q+"px"}});var l=new FormData();l.append("grp",17);l.append("typ",1);l.append("q","UPDATE");l.append("pg",15);l.append("subPgNo",d);l.append("subVwtyp",e);l.append("vtyp",c);l.append("assessmentSetId",g);l.append("assessmentSetName",n);l.append("assessmentSetDesc",j);l.append("isEnabled",h);l.append("ttlScore",k);$.ajax({url:"index.php",type:"POST",data:l,async:true,success:function(o){var p="";if(/^[\],:{}\s]*$/.test(o.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(o);f.modal("hide");getAllAssessmentSets("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=4");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Assessment Set Saved Successfully",callback:function(){}})}else{p=o;f.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:p,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function getOneAssessmentSetDetail(b,c){var a="grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=4.1&vtyp=0&sbmtdAssessmentSetID="+b;doAjaxWthCallBck(a,"allAssessmentSetsDetailInfo","PasteDirect","","","",function(){$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip();var d=$("#allAssessmentSetPrflsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allAssessmentSetPrflsTable").wrap('<div class="dataTables_scroll"/>')})})}function getAllAssessmentSets(d,a,j){var c=typeof $("#allAssessmentSetsSrchFor").val()==="undefined"?"%":$("#allAssessmentSetsSrchFor").val();var h=typeof $("#allAssessmentSetsSrchIn").val()==="undefined"?"Both":$("#allAssessmentSetsSrchIn").val();var b=typeof $("#allAssessmentSetsPageNo").val()==="undefined"?1:$("#allAssessmentSetsPageNo").val();var f=typeof $("#allAssessmentSetsDsplySze").val()==="undefined"?10:$("#allAssessmentSetsDsplySze").val();var g=typeof $("#allAssessmentSetsSortBy").val()==="undefined"?"":$("#allAssessmentSetsSortBy").val();var e=typeof $("#allAssessmentSetsIsEnabled").val()==="undefined"?"":$("#allAssessmentSetsIsEnabled").val();if(d=="clear"){c="%";b=1}else{if(d=="next"){b=parseInt(b)+1}else{if(d=="previous"){b=parseInt(b)-1}}}j=j+"&searchfor="+c+"&searchin="+h+"&pageNo="+b+"&limitSze="+f+"&sortBy="+g+"&isEnabled="+e;openATab(a,j)}function enterKeyFuncAllAssessmentSets(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllAssessmentSets(b,f,d)}}function getAllAssessmentSetPrfls(d,h,e){var c=typeof $("#allAssessmentSetPrflsSrchFor").val()==="undefined"?"%":$("#allAssessmentSetPrflsSrchFor").val();var b=typeof $("#allAssessmentSetPrflsSrchIn").val()==="undefined"?"Both":$("#allAssessmentSetPrflsSrchIn").val();var a=typeof $("#allAssessmentSetPrflsPageNo").val()==="undefined"?1:$("#allAssessmentSetPrflsPageNo").val();var g=typeof $("#allAssessmentSetPrflsDsplySze").val()==="undefined"?10:$("#allAssessmentSetPrflsDsplySze").val();var f=typeof $("#allAssessmentSetPrflsSortBy").val()==="undefined"?"":$("#allAssessmentSetPrflsSortBy").val();if(d=="clear"){c="%";a=1}else{if(d=="next"){a=parseInt(a)+1}else{if(d=="previous"){a=parseInt(a)-1}}}e=e+"&searchfor="+c+"&searchin="+b+"&pageNo="+a+"&limitSze="+g+"&sortBy="+f;openATab(h,e)}function enterKeyFuncAllAssessmentSetPrfls(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllAssessmentSetPrfls(b,f,d)}}function getOneAssessmentSetForm(b,c){var a="grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=4.1&vtyp="+c+"&sbmtdAssessmentSetID="+b;doAjaxWthCallBck(a,"allAssessmentSetsDetailInfo","PasteDirect","","","",function(){var d=$("#allAssessmentSetPrflsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allAssessmentSetPrflsTable").wrap('<div class="dataTables_scroll"/>')});$("#allAssessmentSetsForm").submit(function(d){d.preventDefault();return false})}function saveAssessmentSetPrfl(){var d=typeof $("#sbmtdAssessmentSetID").val()==="undefined"?"-1":$("#sbmtdAssessmentSetID").val();var b="";var f=0;var e=0;var a=typeof $("#oneAssessmentSetDetTtlScore").val()==="undefined"?0:$("#oneAssessmentSetDetTtlScore").val().trim().length===0?0:$("#oneAssessmentSetDetTtlScore").val();var g=0;$("#allAssessmentSetPrflsTable").find("tr").each(function(j,k){if(j>0){if(typeof $(k).attr("id")==="undefined"){}else{var h=$(k).attr("id").split("_")[1];if(typeof $("#allAssessmentSetPrflsRow"+h+"_AssessmentPrflID").val()==="undefined"){}else{if($("#allAssessmentSetPrflsRow"+h+"_AssessmentPrflID").val()==""||$("#allAssessmentSetPrflsRow"+h+"_AssessmentPrflID").val()==-1){$("#allAssessmentSetPrflsRow"+h+"_AssessmentPrflNm").css("border-color","red");$("#allAssessmentSetPrflsRow"+h+"_AssessmentPrflNm").css("border-width","2px");f=f+1}else{$("#allAssessmentSetPrflsRow"+h+"_AssessmentPrflNm").css("border-color","#ccc");$("#allAssessmentSetPrflsRow"+h+"_AssessmentPrflNm").css("border-width","1px")}if($("#allAssessmentSetPrflsRow"+h+"_SortOrder").val()==""||parseFloat($("#allAssessmentSetPrflsRow"+h+"_SortOrder").val())<0){$("#allAssessmentSetPrflsRow"+h+"_SortOrder").css("border-color","red");$("#allAssessmentSetPrflsRow"+h+"_SortOrder").css("border-width","2px");f=f+1}else{$("#allAssessmentSetPrflsRow"+h+"_SortOrder").css("border-color","#ccc");$("#allAssessmentSetPrflsRow"+h+"_SortOrder").css("border-width","1px")}if(f<=0){b=b+$("#allAssessmentSetPrflsRow"+h+"_AssessmentSetPrflID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allAssessmentSetPrflsRow"+h+"_AssessmentPrflID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allAssessmentSetPrflsRow"+h+"_Score").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allAssessmentSetPrflsRow"+h+"_SortOrder").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";g=g+parseFloat($("#allAssessmentSetPrflsRow"+h+"_Score").val());e=e+1}}}}});if(f>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted Assessment Set Factor record</i></b></span>",callback:function(){}});return false}else{if(e<=0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please provide at lease One Assessment Set Factor record</i></b></span>",callback:function(){}});return false}else{if(e>0&&(parseFloat(g)<parseFloat(a))){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Total PROFILE SCORE "+a+" must be EQUAL to the sum of the PROFILE FACTOR SCORES "+g+"</i></b></span>",callback:function(){}});return false}}}var c=bootbox.alert({title:"Save Assessment Set Factors?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving Profile Factors...Please Wait...</p>',callback:function(){getAllAssessmentSets("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=4")}});c.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"UPDATE",subPgNo:4.6,subVwtyp:4,actyp:1,sbmtdAssessmentSetID:d,slctdAssessmentSetPrfls:b},success:function(h){setTimeout(function(){c.find(".bootbox-body").html(h)},500)},error:function(h,k,j){console.warn(h.responseText)}})})})}function validateAssessmentSetPrfl(){var f="";var m=typeof $("#sbmtdAssessmentSetID").val()==="undefined"?"-1":$("#sbmtdAssessmentSetID").val();var d="";var q=0;var e=0;var k=1;var a=0;var j=typeof $("#oneAssessmentSetDetTtlScore").val()==="undefined"?0:$("#oneAssessmentSetDetTtlScore").val().trim().length===0?0:$("#oneAssessmentSetDetTtlScore").val();var p=typeof $("#oneAssessmentSetDetValidity").text()==="undefined"?"Invalid":$("#oneAssessmentSetDetValidity").text();var b=0;var c=typeof $("#oneAssessmentSetDetID").val()==="undefined"?"-1":$("#oneAssessmentSetDetID").val();var g=typeof $("#oneAssessmentSetDetName").val()==="undefined"?"":$("#oneAssessmentSetDetName").val();var n=typeof $("#oneAssessmentSetDetDesc").val()==="undefined"?"":$("#oneAssessmentSetDetDesc").val();var o=typeof $("#oneAssessmentSetDetIsEnbld").val()==="undefined"?"Yes":$("#oneAssessmentSetDetIsEnbld").val();var h=typeof $("#oneAssessmentSetDetTtlScore").val()==="undefined"?0:$("#oneAssessmentSetDetTtlScore").val().trim().length===0?0:$("#oneAssessmentSetDetTtlScore").val();$("#allAssessmentSetPrflsTable").find("tr").each(function(s,t){if(s>0){if(typeof $(t).attr("id")==="undefined"){}else{var r=$(t).attr("id").split("_")[1];if(typeof $("#allAssessmentSetPrflsRow"+r+"_AssessmentPrflID").val()==="undefined"){}else{if($("#allAssessmentSetPrflsRow"+r+"_AssessmentPrflID").val()==""||$("#allAssessmentSetPrflsRow"+r+"_AssessmentPrflID").val()==-1){$("#allAssessmentSetPrflsRow"+r+"_AssessmentPrflNm").css("border-color","red");$("#allAssessmentSetPrflsRow"+r+"_AssessmentPrflNm").css("border-width","2px");q=q+1}else{$("#allAssessmentSetPrflsRow"+r+"_AssessmentPrflNm").css("border-color","#ccc");$("#allAssessmentSetPrflsRow"+r+"_AssessmentPrflNm").css("border-width","1px")}if($("#allAssessmentSetPrflsRow"+r+"_SortOrder").val()==""||parseFloat($("#allAssessmentSetPrflsRow"+r+"_SortOrder").val())<0){$("#allAssessmentSetPrflsRow"+r+"_SortOrder").css("border-color","red");$("#allAssessmentSetPrflsRow"+r+"_SortOrder").css("border-width","2px");q=q+1}else{$("#allAssessmentSetPrflsRow"+r+"_SortOrder").css("border-color","#ccc");$("#allAssessmentSetPrflsRow"+r+"_SortOrder").css("border-width","1px")}if(q<=0){d=d+$("#allAssessmentSetPrflsRow"+r+"_AssessmentSetPrflID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allAssessmentSetPrflsRow"+r+"_AssessmentPrflID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allAssessmentSetPrflsRow"+r+"_Score").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allAssessmentSetPrflsRow"+r+"_SortOrder").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allAssessmentSetPrflsRow"+r+"_TtlOptnsScore").text().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allAssessmentSetPrflsRow"+r+"_AssessmentPrflNm").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";b=b+parseFloat($("#allAssessmentSetPrflsRow"+r+"_Score").val());e=e+1}k=k+1}}}});if(c.trim()==""||c==-1||c==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please save Assessment Set First</i></b></span>",callback:function(){}});return false}else{if(g.trim()==""||g==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please provide Assessment Set Name</i></b></span>",callback:function(){}});return false}else{if(h==""||parseFloat(h)<0||h==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Pass Score must be zero or greater</i></b></span>",callback:function(){}});return false}else{if(q>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted Assessment Set Factor record</i></b></span>",callback:function(){}});return false}else{if(e<=0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please provide at lease One Assessment Set Factor record</i></b></span>",callback:function(){}});return false}else{if(e>0&&p=="Valid"){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Assessment Set is already VALID</i></b></span>",callback:function(){}});return false}else{if(e>0&&p=="Invalid"&&(parseFloat(b)<parseFloat(j))){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>ASSESSMENT SET PASS SCORE "+j+" must be LESS THAN OR EQUAL to the sum of the PROFILE SCORES "+b+"</i></b></span>",callback:function(){}});return false}}}}}}}var l=bootbox.alert({title:"Validate Assessment Set?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Validating Assessment Set...Please Wait...</p>',callback:function(){getAllAssessmentSets("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=4")}});l.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"UPDATE",subPgNo:4.6,subVwtyp:4,actyp:3,sbmtdAssessmentSetID:m,slctdAssessmentSetPrfls:d,assessmentSetId:c,assessmentSetName:g,assessmentSetDesc:n,isEnabled:o,ttlScore:h,validity:p,rngPrflFctrScoreTtl:b},success:function(r){setTimeout(function(){l.find(".bootbox-body").html(r)},500)},error:function(r,t,s){console.warn(r.responseText)}})})})}function delAssessmentSetPrfl(d){var a=d.split("_")[1];var c=-1;var e="";if(typeof $("#allAssessmentSetPrflsRow"+a+"_AssessmentPrflID").val()==="undefined"){}else{c=$("#allAssessmentSetPrflsRow"+a+"_AssessmentSetPrflID").val();e=$("#allAssessmentSetPrflsRow"+a+"_AssessmentPrflID").val()}var b=bootbox.confirm({title:"Remove Person?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this Profile Factor?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Remove Person?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing Profile Factor...Please Wait...</p>',callback:function(){getAllAssessmentSets("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.6&subVwtyp=4")}});g.init(function(){if(c>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"DELETE",subPgNo:4.6,subVwtyp:4,actyp:1,AssessmentSetID:e,PKeyID:c},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h);if(h.indexOf("Success")!==-1){$("#"+d).remove()}},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){$("#"+d).remove();g.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function getProductsForm(n,o,b,r,c,e,f,h,d,q,j,m,p){$("#allOtherInputData99").val(0);if(typeof p==="undefined"||p===null){p=function(){var s=1}}var g=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var k="";if(e==1.1){k="mcfIndCstmr"}else{if(e==1.2){k="mcfCorpCstmr"}else{if(e==1.3){k="mcfGrpCstmr"}else{if(e==1.4){k="mcfOthPCstmr"}}}}if(typeof m==="undefined"||m===null){m=-1}$("#tblRowID").val(j);if(!$.fn.DataTable.isDataTable("#indCustTable")){var l=$("#indCustTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#indCustTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{l.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#indCustTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{l.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){if(m<=0){}$("#"+b).html(r);$("#"+o).html(a.responseText);$("#"+n).off("hidden.bs.modal");$("#"+n).one("hidden.bs.modal",function(s){if(h!=="VIEW"){getCustData("","#allmodules","grp=17&typ=1&pg=7&subPgNo="+e)}$("#"+b).html("");$("#"+o).html("");$(s.currentTarget).unbind()});$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+n).off("show.bs.modal");$("#"+n).on("show.bs.modal",function(s){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");if(m=1){$("#"+n).modal({backdrop:"static",keyboard:false})}$body=$("body");$(document).ready(function(){$("#meetingDays").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"335px"});$("#relationTyp").multiselect({includeSelectAllOption:true,enableFiltering:true,buttonWidth:"205px"});p()})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+h+"&prdtID="+d)}function saveCreditProduct(O){var h=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var H="";var F=typeof $("#sbmtdPrdtID").val()==="undefined"?"-1":$("#sbmtdPrdtID").val();var Y="";var B="";var N=0;var u=0;var Z=1;var v=0;var T=0;var al=1;var ao=0;var f=typeof $("#prdtName").val()==="undefined"?"":$("#prdtName").val();var g=typeof $("#pdtCode").val()==="undefined"?0:$("#pdtCode").val().trim().length===0?0:$("#pdtCode").val();var K=typeof $("#prdtDesc").val()==="undefined"?"":$("#prdtDesc").val();var ap=typeof $("#prdtCrncy").val()==="undefined"?"":$("#prdtCrncy").val();var ad=typeof $("#prdtType").val()==="undefined"?"":$("#prdtType").val();var s=typeof $("#minAmnt").val()==="undefined"?0:$("#minAmnt").val().trim().length===0?0:$("#minAmnt").val();var D=typeof $("#maxAmnt").val()==="undefined"?0:$("#maxAmnt").val().trim().length===0?0:$("#maxAmnt").val();var E=typeof $("#rpmntType").val()==="undefined"?"":$("#rpmntType").val();var J=typeof $("#gracePeriodNo").val()==="undefined"?0:$("#gracePeriodNo").val().trim().length===0?0:$("#gracePeriodNo").val();var n=typeof $("#gracePeriodType").val()==="undefined"?"":$("#gracePeriodType").val();var ah=typeof $("#minLoanTenor").val()==="undefined"?0:$("#minLoanTenor").val().trim().length===0?0:$("#minLoanTenor").val();var y=typeof $("#minLoanTenorType").val()==="undefined"?"":$("#minLoanTenorType").val();var A=typeof $("#maxLoanTenor").val()==="undefined"?0:$("#maxLoanTenor").val().trim().length===0?0:$("#maxLoanTenor").val();var af=typeof $("#maxLoanTenorType").val()==="undefined"?"":$("#maxLoanTenorType").val();var x=typeof $("input[name='cashCltrlRqrd']:checked").val()==="undefined"?"No":$("input[name='cashCltrlRqrd']:checked").val();var o=typeof $("#valueFlatCashCltrl").val()==="undefined"?0:$("#valueFlatCashCltrl").val().trim().length===0?0:$("#valueFlatCashCltrl").val();var ar=typeof $("#valuePrcntCashCltrl").val()==="undefined"?0:$("#valuePrcntCashCltrl").val().trim().length===0?0:$("#valuePrcntCashCltrl").val();var Q=typeof $("input[name='prptyCltrlRqrd']:checked").val()==="undefined"?"No":$("input[name='prptyCltrlRqrd']:checked").val();var I=typeof $("#valueFlatPrptyCltrl").val()==="undefined"?0:$("#valueFlatPrptyCltrl").val().trim().length===0?0:$("#valueFlatPrptyCltrl").val();var ab=typeof $("#valuePrcntPrptyCltrl").val()==="undefined"?0:$("#valuePrcntPrptyCltrl").val().trim().length===0?0:$("#valuePrcntPrptyCltrl").val();var L=typeof $("input[name='invstmntCltrlRqrd']:checked").val()==="undefined"?"No":$("input[name='invstmntCltrlRqrd']:checked").val();var ai=typeof $("#valueFlatInvstmntCltrl").val()==="undefined"?0:$("#valueFlatInvstmntCltrl").val().trim().length===0?0:$("#valueFlatInvstmntCltrl").val();var c=typeof $("#valuePrcntInvstmntCltrl").val()==="undefined"?0:$("#valuePrcntInvstmntCltrl").val().trim().length===0?0:$("#valuePrcntInvstmntCltrl").val();var an=typeof $("input[name='chrgInterest']:checked").val()==="undefined"?"NO":$("input[name='chrgInterest']:checked").val();var ak=typeof $("#intRateType").val()==="undefined"?"":$("#intRateType").val();var b=typeof $("#interestRate").val()==="undefined"?0:$("#interestRate").val().trim().length===0?0:$("#interestRate").val();var U=typeof $("#compound").val()==="undefined"?"":$("#compound").val();var P=typeof $("#pstnFrqncy").val()==="undefined"?"":$("#pstnFrqncy").val();var X=typeof $("input[name='grntaRqrd']:checked").val()==="undefined"?"No":$("input[name='grntaRqrd']:checked").val();var ac=typeof $("#grntaNo").val()==="undefined"?0:$("#grntaNo").val().trim().length===0?0:$("#grntaNo").val();var S=typeof $("#prncplRcvblDbtAccID").val()==="undefined"?-1:$("#prncplRcvblDbtAccID").val();var at=typeof $("#loansPybleCrdtAccID").val()==="undefined"?-1:$("#loansPybleCrdtAccID").val();var W=typeof $("#intrstRcvblDbtAccID").val()==="undefined"?-1:$("#intrstRcvblDbtAccID").val();var R=typeof $("#dfrdIntrstCrdtAccID").val()==="undefined"?-1:$("#dfrdIntrstCrdtAccID").val();var p=typeof $("#intrstRvnueCrdtAccID").val()==="undefined"?-1:$("#intrstRvnueCrdtAccID").val();var ag=typeof $("#maxPrncplRcvbl").val()==="undefined"?0:$("#maxPrncplRcvbl").val().trim().length===0?0:$("#maxPrncplRcvbl").val();var ae=typeof $("input[name='isAcctRqrd']:checked").val()==="undefined"?"No":$("input[name='isAcctRqrd']:checked").val();var j=typeof $("input[name='crdtOfficerRqrd']:checked").val()==="undefined"?"No":$("input[name='crdtOfficerRqrd']:checked").val();var V=typeof $("#assmntSetID").val()==="undefined"?-1:$("#assmntSetID").val();var M=typeof $("#sctrMjrID").val()==="undefined"?-1:$("#sctrMjrID").val();var q=typeof $("#sctrMnrID").val()==="undefined"?-1:$("#sctrMnrID").val();var m=typeof $("#startDate").val()==="undefined"?"":$("#startDate").val();var C=typeof $("#endDate").val()==="undefined"?"31-Dec-4000":$("#endDate").val();var aj=typeof $("input[name='indCust']:checked").val()==="undefined"?"NO":"YES";var z=typeof $("input[name='corpCust']:checked").val()==="undefined"?"NO":"YES";var l=typeof $("input[name='custGrp']:checked").val()==="undefined"?"NO":"YES";var h=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var G=typeof $("#codeLnght").val()==="undefined"?10:$("#codeLnght").val();var k=typeof $("#badDebtExpnsAccID").val()==="undefined"?-1:$("#badDebtExpnsAccID").val();var e=typeof $("#prvsnExpnsAccID").val()==="undefined"?-1:$("#prvsnExpnsAccID").val();var aa=typeof $("#prvsnContraAccID").val()==="undefined"?-1:$("#prvsnContraAccID").val();var t=typeof $("#grpType").val()==="undefined"?"Everyone":$("#grpType").val();var r=typeof $("#groupID").val()==="undefined"?-1:$("#groupID").val();var w=typeof $("#isStaffLoanProduct").val()==="undefined"?"No":$("#isStaffLoanProduct").val();$("#allPrcsnFeesTable").find("tr").each(function(av,aw){if(av>0){if(typeof $(aw).attr("id")==="undefined"){}else{var au=$(aw).attr("id").split("_")[1];if(typeof $("#allPrcsnFeesRow"+au+"_FeeNm").val()==="undefined"){}else{if($("#allPrcsnFeesRow"+au+"_FeeNm").val()==""||$("#allPrcsnFeesRow"+au+"_FeeNm").val()==-1){$("#allPrcsnFeesRow"+au+"_FeeNm").css("border-color","red");$("#allPrcsnFeesRow"+au+"_FeeNm").css("border-width","2px");N=N+1}else{$("#allPrcsnFeesRow"+au+"_FeeNm").css("border-color","#ccc");$("#allPrcsnFeesRow"+au+"_FeeNm").css("border-width","1px")}if($("#allPrcsnFeesRow"+au+"_FeeTypeID").val()==""||$("#allPrcsnFeesRow"+au+"_FeeTypeID").val()==-1){$("#allPrcsnFeesRow"+au+"_FeeType").css("border-color","red");$("#allPrcsnFeesRow"+au+"_FeeType").css("border-width","2px");N=N+1}else{$("#allPrcsnFeesRow"+au+"_FeeType").css("border-color","#ccc");$("#allPrcsnFeesRow"+au+"_FeeType").css("border-width","1px")}if($("#allPrcsnFeesRow"+au+"_AmntFlat").val()==""||parseFloat($("#allPrcsnFeesRow"+au+"_AmntFlat").val())<0){$("#allPrcsnFeesRow"+au+"_AmntFlat").css("border-color","red");$("#allPrcsnFeesRow"+au+"_AmntFlat").css("border-width","2px");N=N+1}else{$("#allPrcsnFeesRow"+au+"_AmntFlat").css("border-color","#ccc");$("#allPrcsnFeesRow"+au+"_AmntFlat").css("border-width","1px")}if($("#allPrcsnFeesRow"+au+"_AmntPrcnt").val()==""||parseFloat($("#allPrcsnFeesRow"+au+"_AmntPrcnt").val())<0){$("#allPrcsnFeesRow"+au+"_AmntPrcnt").css("border-color","red");$("#allPrcsnFeesRow"+au+"_AmntPrcnt").css("border-width","2px");N=N+1}else{$("#allPrcsnFeesRow"+au+"_AmntPrcnt").css("border-color","#ccc");$("#allPrcsnFeesRow"+au+"_AmntPrcnt").css("border-width","1px")}if($("#allPrcsnFeesRow"+au+"_RvnAcctID").val()==""||$("#allPrcsnFeesRow"+au+"_RvnAcctID").val()==-1){$("#allPrcsnFeesRow"+au+"_RvnAcct").css("border-color","red");$("#allPrcsnFeesRow"+au+"_RvnAcct").css("border-width","2px");N=N+1}else{$("#allPrcsnFeesRow"+au+"_RvnAcct").css("border-color","#ccc");$("#allPrcsnFeesRow"+au+"_RvnAcct").css("border-width","1px")}if(N<=0){Y=Y+$("#allPrcsnFeesRow"+au+"_LoanprdtPrcssnFeeID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allPrcsnFeesRow"+au+"_LoanPrdtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allPrcsnFeesRow"+au+"_FeeNm").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allPrcsnFeesRow"+au+"_FeeTypeID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allPrcsnFeesRow"+au+"_AmntFlat").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allPrcsnFeesRow"+au+"_AmntPrcnt").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allPrcsnFeesRow"+au+"_RvnAcctID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allPrcsnFeesRow"+au+"_Rmrks").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";u=u+1}Z=Z+1}}}});$("#allLatePymntFeesTable").find("tr").each(function(av,aw){if(av>0){if(typeof $(aw).attr("id")==="undefined"){}else{var au=$(aw).attr("id").split("_")[1];if(typeof $("#allLatePymntFeesRow"+au+"_FeeNm").val()==="undefined"){}else{if($("#allLatePymntFeesRow"+au+"_FeeNm").val()==""||$("#allLatePymntFeesRow"+au+"_FeeNm").val()==-1){$("#allLatePymntFeesRow"+au+"_FeeNm").css("border-color","red");$("#allLatePymntFeesRow"+au+"_FeeNm").css("border-width","2px");v=v+1}else{$("#allLatePymntFeesRow"+au+"_FeeNm").css("border-color","#ccc");$("#allLatePymntFeesRow"+au+"_FeeNm").css("border-width","1px")}if($("#allLatePymntFeesRow"+au+"_TargetID").val()==""||$("#allLatePymntFeesRow"+au+"_TargetID").val()==-1){$("#allLatePymntFeesRow"+au+"_Target").css("border-color","red");$("#allLatePymntFeesRow"+au+"_Target").css("border-width","2px");v=v+1}else{$("#allLatePymntFeesRow"+au+"_Target").css("border-color","#ccc");$("#allLatePymntFeesRow"+au+"_Target").css("border-width","1px")}if($("#allLatePymntFeesRow"+au+"_AmntFlat").val()==""||parseFloat($("#allLatePymntFeesRow"+au+"_AmntFlat").val())<0){$("#allLatePymntFeesRow"+au+"_AmntFlat").css("border-color","red");$("#allLatePymntFeesRow"+au+"_AmntFlat").css("border-width","2px");v=v+1}else{$("#allLatePymntFeesRow"+au+"_AmntFlat").css("border-color","#ccc");$("#allLatePymntFeesRow"+au+"_AmntFlat").css("border-width","1px")}if($("#allLatePymntFeesRow"+au+"_AmntPrcnt").val()==""||parseFloat($("#allLatePymntFeesRow"+au+"_AmntPrcnt").val())<0){$("#allLatePymntFeesRow"+au+"_AmntPrcnt").css("border-color","red");$("#allLatePymntFeesRow"+au+"_AmntPrcnt").css("border-width","2px");v=v+1}else{$("#allLatePymntFeesRow"+au+"_AmntPrcnt").css("border-color","#ccc");$("#allLatePymntFeesRow"+au+"_AmntPrcnt").css("border-width","1px")}if($("#allLatePymntFeesRow"+au+"_CrdtAcctID").val()==""||$("#allLatePymntFeesRow"+au+"_CrdtAcctID").val()==-1){$("#allLatePymntFeesRow"+au+"_CrdtAcct").css("border-color","red");$("#allLatePymntFeesRow"+au+"_CrdtAcct").css("border-width","2px");v=v+1}else{$("#allLatePymntFeesRow"+au+"_CrdtAcct").css("border-color","#ccc");$("#allLatePymntFeesRow"+au+"_CrdtAcct").css("border-width","1px")}if(O==100){if($("#allLatePymntFeesRow"+au+"_Frqncy").text()!="Repayment Period"&&$("#allLatePymntFeesRow"+au+"_FrqncyNo").text()==""||parseFloat($("#allLatePymntFeesRow"+au+"_FrqncyNo").text())<=0){$("#allLatePymntFeesRow"+au+"_FeeNm").css("border-color","red");$("#allLatePymntFeesRow"+au+"_FeeNm").css("border-width","2px");T=T+1}else{$("#allLatePymntFeesRow"+au+"_FeeNm").css("border-color","#ccc");$("#allLatePymntFeesRow"+au+"_FeeNm").css("border-width","1px")}}if(v<=0){B=B+$("#allLatePymntFeesRow"+au+"_LoanprdtLateFeeID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLatePymntFeesRow"+au+"_LoanPrdtID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLatePymntFeesRow"+au+"_FeeNm").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLatePymntFeesRow"+au+"_TargetID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLatePymntFeesRow"+au+"_AmntFlat").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLatePymntFeesRow"+au+"_AmntPrcnt").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLatePymntFeesRow"+au+"_CrdtAcctID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|"}al=al+1}}}});var a=validateCreditPrdtForm(O,g,f,s,D,J,ah,A,x,o,ar,Q,I,ab,L,ai,c,an,b,P,X,ac,S,at,W,R,p,ag,M,q,m,k,e,aa,ad,G);if(!a){return false}if(N>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted Processing Fees record</i></b></span>",callback:function(){}});return false}else{if(v>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted Late Fees record cells</i></b></span>",callback:function(){}});return false}else{if(T>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please complete the Late Fees penalty freqency details</i></b></span>",callback:function(){}});return false}}}var H="Saving Credit Product...Please Wait...";var aq="Save Credit Product?";var d="Credit Product Saved";if(O==1){H="Submitting Credit Product...Please Wait...";aq="Submit Credit Product?";d="Credit Product Submitted for Authorization"}var am=bootbox.alert({title:aq,size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> '+H+"</p>",callback:function(){F=typeof $("#sbmtdPrdtID").val()==="undefined"?"-1":$("#sbmtdPrdtID").val();recCnt=typeof $("#recCnt").val()==="undefined"?0:$("#recCnt").val();if(parseInt(recCnt)>0){getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Credit Product",12,7.2,0,"EDIT",F,"","indCustTableRow1")}}});am.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:12,q:"UPDATE",subPgNo:7.2,actyp:100,optn:O,sbmtdPrdtID:F,prdtName:f,pdtCode:g,prdtDesc:K,prdtCrncy:ap,prdtType:ad,minAmnt:s,maxAmnt:D,rpmntType:E,gracePeriodNo:J,gracePeriodType:n,minLoanTenor:ah,minLoanTenorType:y,maxLoanTenor:A,maxLoanTenorType:af,cashCltrlRqrd:x,valueFlatCashCltrl:o,valuePrcntCashCltrl:ar,prptyCltrlRqrd:Q,valueFlatPrptyCltrl:I,valuePrcntPrptyCltrl:ab,invstmntCltrlRqrd:L,valueFlatInvstmntCltrl:ai,valuePrcntInvstmntCltrl:c,chrgInterest:an,intRateType:ak,interestRate:b,compound:U,pstnFrqncy:P,grntaRqrd:X,grntaNo:ac,prncplRcvblDbtAccID:S,loansPybleCrdtAccID:at,intrstRcvblDbtAccID:W,dfrdIntrstCrdtAccID:R,intrstRvnueCrdtAccID:p,maxPrncplRcvbl:ag,isAcctRqrd:ae,crdtOfficerRqrd:j,assmntSetID:V,sctrMjrID:M,sctrMnrID:q,startDate:m,endDate:C,indCust:aj,corpCust:z,custGrp:l,slctdPrcsnFees:Y,slctdLatePymntFees:B,rvsnTtl:h,badDebtExpnsAccID:k,prvsnExpnsAccID:e,prvsnContraAccID:aa,isStaffLoanProduct:w,grpType:t,groupID:r},success:function(au){var av=au;setTimeout(function(){if(/^[\],:{}\s]*$/.test(av.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var aw=$.parseJSON(av);$("#sbmtdPrdtID").val(aw.sbmtdPrdtID);$("#recCnt").val(parseInt(aw.recCntInst)+parseInt(aw.recCntUpdt)+parseInt(aw.rsltCrtCnt)+parseInt(aw.rsltUpdtCnt));var ax="<span style='color:green;font-weight:bold !important;'>"+d+"</br><i>"+aw.recCntInst+" Fee record(s) inserted</br>"+aw.recCntUpdt+" Fee record(s) updated</i></span>";am.find(".bootbox-body").html(ax)}else{am.find(".bootbox-body").html(av)}},500)},error:function(au,aw,av){console.warn(au.responseText)}})})})}function validateCreditPrdtForm(w,g,e,n,q,t,J,p,o,j,M,y,s,F,u,K,b,L,a,x,D,G,z,N,B,A,l,I,v,m,k,h,d,E,H,r){var c=0;var f="";var C="<span style='font-weight: bold !important;'>The following is/are required:</span></br>";if(parseFloat(g.length)!=parseFloat(r)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#codeLnght").css("border-color","red");$("#codeLnght").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'>Product Code Length must be "+r+"</span>",callback:function(){}});return false}else{$("#codeLnght").css("border-color","#ccc");$("#codeLnght").css("border-width","1px")}if(g==""||g=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#pdtCode").css("border-color","red");$("#pdtCode").css("border-width","2px");f=f+"<b>Product Code,</b></br>";c=c+1}else{$("#pdtCode").css("border-color","#ccc");$("#pdtCode").css("border-width","1px")}if(e.trim()==""||e=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prdtName").css("border-color","red");$("#prdtName").css("border-width","2px");f=f+"<b>Product Name,</b></br>";c=c+1}else{$("#prdtName").css("border-color","#ccc");$("#prdtName").css("border-width","1px")}if(n==""||parseFloat(n)<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#minAmnt").css("border-color","red");$("#minAmnt").css("border-width","2px");f=f+"<b>Minimum Amount must be greater than zero,</b></br>";c=c+1}else{$("#minAmnt").css("border-color","#ccc");$("#minAmnt").css("border-width","1px")}if(q==""||parseFloat(q)<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#maxAmnt").css("border-color","red");$("#maxAmnt").css("border-width","2px");f=f+"<b>Maximum Amount must be greater than zero,</b></br>";c=c+1}else{$("#maxAmnt").css("border-color","#ccc");$("#maxAmnt").css("border-width","1px")}if(t==""||parseFloat(t)<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#gracePeriodNo").css("border-color","red");$("#gracePeriodNo").css("border-width","2px");f=f+"<b>Grace Period must be greater than zero,</b></br>";c=c+1}else{$("#gracePeriodNo").css("border-color","#ccc");$("#gracePeriodNo").css("border-width","1px")}if(J==""||parseFloat(J)<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#minLoanTenor").css("border-color","red");$("#minLoanTenor").css("border-width","2px");f=f+"Minimum Loan Tenor must be greater than zero,</b></br>";c=c+1}else{$("#minLoanTenor").css("border-color","#ccc");$("#minLoanTenor").css("border-width","1px")}if(p==""||parseFloat(p)<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#maxLoanTenor").css("border-color","red");$("#maxLoanTenor").css("border-width","2px");f=f+"<b>Maximum Loan Tenor must be greater than zero,</b></br>";c=c+1}else{$("#maxLoanTenor").css("border-color","#ccc");$("#maxLoanTenor").css("border-width","1px")}if(parseFloat(J)>0&&parseFloat(p)>0&&(parseFloat(J)>parseFloat(p))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#minLoanTenor").css("border-color","red");$("#minLoanTenor").css("border-width","2px");f=f+"<b>Minimum Loan Tenor must be less than Maximum Loan Tenor,</b></br>";c=c+1}else{$("#minLoanTenor").css("border-color","#ccc");$("#minLoanTenor").css("border-width","1px")}if(o=="Yes"&&(j==""||parseFloat(j)<0)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#valueFlatCashCltrl").css("border-color","red");$("#valueFlatCashCltrl").css("border-width","2px");f=f+"<b>Cash Collateral Amount,</b></br>";c=c+1}else{$("#valueFlatCashCltrl").css("border-color","#ccc");$("#valueFlatCashCltrl").css("border-width","1px")}if(o=="Yes"&&(M==""||parseFloat(M)<0)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#valuePrcntCashCltrl").css("border-color","red");$("#valuePrcntCashCltrl").css("border-width","2px");f=f+"<b>Cash Collateral Amount,</b></br>";c=c+1}else{$("#valuePrcntCashCltrl").css("border-color","#ccc");$("#valuePrcntCashCltrl").css("border-width","1px")}if(y=="Yes"&&((s==""||parseFloat(s)<0)||(F==""||parseFloat(F)<0))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#valueFlatPrptyCltrl").css("border-color","red");$("#valueFlatPrptyCltrl").css("border-width","2px");$("#valuePrcntPrptyCltrl").css("border-color","red");$("#valuePrcntPrptyCltrl").css("border-width","2px");f=f+"<b>Property Collateral Value,</b></br>";c=c+1}else{$("#valueFlatPrptyCltrl").css("border-color","#ccc");$("#valueFlatPrptyCltrl").css("border-width","1px");$("#valuePrcntPrptyCltrl").css("border-color","#ccc");$("#valuePrcntPrptyCltrl").css("border-width","1px")}if(u=="Yes"&&((K==""||parseFloat(K)<0)&&(b==""||parseFloat(b)<0))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#valueFlatInvstmntCltrl").css("border-color","red");$("#valueFlatInvstmntCltrl").css("border-width","2px");$("#valuePrcntInvstmntCltrl").css("border-color","red");$("#valuePrcntInvstmntCltrl").css("border-width","2px");f=f+"<b>Investment Collateral Amount,</b></br>";c=c+1}else{$("#valueFlatInvstmntCltrl").css("border-color","#ccc");$("#valueFlatInvstmntCltrl").css("border-width","1px");$("#valuePrcntInvstmntCltrl").css("border-color","#ccc");$("#valuePrcntInvstmntCltrl").css("border-width","1px")}if(L=="YES"&&(a==""||parseFloat(a)<0)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#interestRate").css("border-color","red");$("#interestRate").css("border-width","2px");f=f+"<b>Interest Rate,</b></br>";c=c+1}else{$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px")}if(D=="Yes"&&(G==""||parseFloat(G)<=0)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#grntaNo").css("border-color","red");$("#grntaNo").css("border-width","2px");f=f+"<b>Guarantor Quantity,</b></br>";c=c+1}else{$("#grntaNo").css("border-color","#ccc");$("#grntaNo").css("border-width","1px")}if(H=="Loan"&&(z.trim()==""||z=="-1")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prncplRcvblDbtAcc").css("border-color","red");$("#prncplRcvblDbtAcc").css("border-width","2px");f=f+"<b>Principal Receivable Account,</b></br>";c=c+1}else{$("#prncplRcvblDbtAcc").css("border-color","#ccc");$("#prncplRcvblDbtAcc").css("border-width","1px")}if(H=="Loan"&&(N.trim()==""||N=="-1")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#loansPybleCrdtAcc").css("border-color","red");$("#loansPybleCrdtAcc").css("border-width","2px");f=f+"<b>Loans Payable Liability Account,</b></br>";c=c+1}else{$("#loansPybleCrdtAcc").css("border-color","#ccc");$("#loansPybleCrdtAcc").css("border-width","1px")}if(H=="Loan"&&(B.trim()==""||B=="-1")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#intrstRcvblDbtAcc").css("border-color","red");$("#intrstRcvblDbtAcc").css("border-width","2px");f=f+"<b>Interest Receivable Asset Account,</b></br>";c=c+1}else{$("#intrstRcvblDbtAcc").css("border-color","#ccc");$("#intrstRcvblDbtAcc").css("border-width","1px")}if(H=="Loan"&&(A==""||A=="-1")){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#dfrdIntrstCrdtAcc").css("border-color","red");$("#dfrdIntrstCrdtAcc").css("border-width","2px");f=f+"<b>Deferred Interest Liability Account,</b></br>";c=c+1}else{$("#dfrdIntrstCrdtAcc").css("border-color","#ccc");$("#dfrdIntrstCrdtAcc").css("border-width","1px")}if(l==""||l=="-1"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#intrstRvnueCrdtAcc").css("border-color","red");$("#intrstRvnueCrdtAcc").css("border-width","2px");f=f+"<b>Interest Revenue Account,</b></br>";c=c+1}else{$("#intrstRvnueCrdtAcc").css("border-color","#ccc");$("#intrstRvnueCrdtAcc").css("border-width","1px")}if(h==""||h=="-1"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#badDebtExpnsAcc").css("border-color","red");$("#badDebtExpnsAcc").css("border-width","2px");f=f+"<b>Bad Debt Expense Account,</b></br>";c=c+1}else{$("#badDebtExpnsAcc").css("border-color","#ccc");$("#badDebtExpnsAcc").css("border-width","1px")}if(d==""||d=="-1"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prvsnExpnsAcc").css("border-color","red");$("#prvsnExpnsAcc").css("border-width","2px");f=f+"<b>Provision Expense Account,</b></br>";c=c+1}else{$("#prvsnExpnsAcc").css("border-color","#ccc");$("#prvsnExpnsAcc").css("border-width","1px")}if(E==""||E=="-1"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prvsnContraAcc").css("border-color","red");$("#prvsnContraAcc").css("border-width","2px");f=f+"<b>Provision Contra Receivable Account,</b></br>";c=c+1}else{$("#prvsnContraAcc").css("border-color","#ccc");$("#prvsnContraAcc").css("border-width","1px")}if(I==""||parseFloat(I)<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#maxPrncplRcvbl").css("border-color","red");$("#maxPrncplRcvbl").css("border-width","2px");f=f+"<b>Principal Receivable Balance must be greater than zero</b></br>";c=c+1}else{$("#maxPrncplRcvbl").css("border-color","#ccc");$("#maxPrncplRcvbl").css("border-width","1px")}if(v.trim()==""||v=="-1"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#sctrMjr").css("border-color","red");$("#sctrMjr").css("border-width","2px");f=f+"<b>Loan Sector Major,</b></br>";c=c+1}else{$("#sctrMjr").css("border-color","#ccc");$("#sctrMjr").css("border-width","1px")}if(m==""||m=="-1"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#sctrMnr").css("border-color","red");$("#sctrMnr").css("border-width","2px");f=f+"<b>Loan Sector Minor,</b></br>";c=c+1}else{$("#sctrMnr").css("border-color","#ccc");$("#sctrMnr").css("border-width","1px")}if(k==""||k=="undefined"){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#startDate").css("border-color","red");$("#startDate").css("border-width","2px");f=f+"<b>Product Start Date</b></br>";c=c+1}else{$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px")}if(c>0){bootbox.alert({size:"small",title:"Validation Errors",message:C+"<span style='color:red; font-weight:bold !important;'>"+f+"</span>",callback:function(){}});return false}else{$("#pdtCode").css("border-color","#ccc");$("#pdtCode").css("border-width","1px");$("#prdtName").css("border-color","#ccc");$("#prdtName").css("border-width","1px");$("#minAmnt").css("border-color","#ccc");$("#minAmnt").css("border-width","1px");$("#maxAmnt").css("border-color","#ccc");$("#maxAmnt").css("border-width","1px");$("#gracePeriodNo").css("border-color","#ccc");$("#gracePeriodNo").css("border-width","1px");$("#minLoanTenor").css("border-color","#ccc");$("#minLoanTenor").css("border-width","1px");$("#maxLoanTenor").css("border-color","#ccc");$("#maxLoanTenor").css("border-width","1px");$("#cashCltrlRqrd").css("border-color","#ccc");$("#cashCltrlRqrd").css("border-width","1px");$("#valueFlatCashCltrl").css("border-color","#ccc");$("#valueFlatCashCltrl").css("border-width","1px");$("#valuePrcntCashCltrl").css("border-color","#ccc");$("#valuePrcntCashCltrl").css("border-width","1px");$("#prptyCltrlRqrd").css("border-color","#ccc");$("#prptyCltrlRqrd").css("border-width","1px");$("#valueFlatPrptyCltrl").css("border-color","#ccc");$("#valueFlatPrptyCltrl").css("border-width","1px");$("#valuePrcntPrptyCltrl").css("border-color","#ccc");$("#valuePrcntPrptyCltrl").css("border-width","1px");$("#invstmntCltrlRqrd").css("border-color","#ccc");$("#invstmntCltrlRqrd").css("border-width","1px");$("#valueFlatInvstmntCltrl").css("border-color","#ccc");$("#valueFlatInvstmntCltrl").css("border-width","1px");$("#valuePrcntInvstmntCltrl").css("border-color","#ccc");$("#valuePrcntInvstmntCltrl").css("border-width","1px");$("#chrgInterest").css("border-color","#ccc");$("#chrgInterest").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");$("#pstnFrqncy").css("border-color","#ccc");$("#pstnFrqncy").css("border-width","1px");$("#grntaRqrd").css("border-color","#ccc");$("#grntaRqrd").css("border-width","1px");$("#grntaNo").css("border-color","#ccc");$("#grntaNo").css("border-width","1px");$("#prncplRcvblDbtAccID").css("border-color","#ccc");$("#prncplRcvblDbtAccID").css("border-width","1px");$("#loansPybleCrdtAccID").css("border-color","#ccc");$("#loansPybleCrdtAccID").css("border-width","1px");$("#intrstRcvblDbtAccID").css("border-color","#ccc");$("#intrstRcvblDbtAccID").css("border-width","1px");$("#dfrdIntrstCrdtAccID").css("border-color","#ccc");$("#dfrdIntrstCrdtAccID").css("border-width","1px");$("#intrstRvnueCrdtAccID").css("border-color","#ccc");$("#intrstRvnueCrdtAccID").css("border-width","1px");$("#badDebtExpnsAccID").css("border-color","#ccc");$("#badDebtExpnsAccID").css("border-width","1px");$("#prvsnExpnsAccID").css("border-color","#ccc");$("#prvsnExpnsAccID").css("border-width","1px");$("#prvsnContraAccID").css("border-color","#ccc");$("#prvsnContraAccID").css("border-width","1px");$("#maxPrncplRcvbl").css("border-color","#ccc");$("#maxPrncplRcvbl").css("border-width","1px");$("#sctrMjrID").css("border-color","#ccc");$("#sctrMjrID").css("border-width","1px");$("#sctrMnrID").css("border-color","#ccc");$("#sctrMnrID").css("border-width","1px");$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px");return true}}function onClickSectorMinor(){var a=typeof $("#sctrMjrID").val()==="undefined"?-1:$("#sctrMjrID").val();if(parseFloat(a)<=0){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'>Select Major Sector first</span>",callback:function(){}});return false}getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","MCF Loan Sectors - Minor","sctrMjrID","","","radio",true,"","sctrMnrID","sctrMnr","clear",1,"")}function getCrdtPrdtLateFeesFrqncyNRmksForm(e,g){var b=e.split("_")[1];var d=-1;var a="";if(typeof $("#allLatePymntFeesRow"+b+"_LoanPrdtID").val()==="undefined"){}else{d=$("#allLatePymntFeesRow"+b+"_LoanprdtLateFeeID").val();a=$("#allLatePymntFeesRow"+b+"_FeeNm").val()}var f=typeof $("#sbmtdPrdtID").val()==="undefined"?"-1":$("#sbmtdPrdtID").val();var c="grp=17&typ=1&pg=12&subPgNo=7.2&vtyp=1&vtypActn="+g+"&sbmtdLoanprdtLateFeeID="+d+"&sbmtdPrdtID="+f;doAjaxWthCallBck(c,"myFormsModalx","ShowDialog","LATE FEE: "+a,"myFormsModalxTitle","myFormsModalxBody",function(){var h=$("#allLatePymntFeesTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allLatePymntFeesTable").wrap('<div class="dataTables_scroll"/>');$("#allOtherInputData99").val(0);$("#myFormsModalx").one("hidden.bs.modal",function(k){var j=typeof $("#sbmtdPrdtID").val()==="undefined"?"-1":$("#sbmtdPrdtID").val();getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Credit Product",12,7.2,0,"EDIT",j,"","indCustTableRow1")})});$("#allLatePymntFeesFrqncyNRmksForm").submit(function(h){h.preventDefault();return false})}function saveCrdtPrdtFrqncyNRemarks(l,j){var e;var f;var k;$body=$("body");$body.addClass("mdlloadingDiag");var a=typeof $("#sbmtdPrdtID").val()==="undefined"?"-1":$("#sbmtdPrdtID").val();var d=typeof $("#frqncyNo").val()==="undefined"?-1:$("#frqncyNo").val();var c=typeof $("#frqncy").val()==="undefined"?"Repayment Period":$("#frqncy").val();var h=typeof $("#remarks").val()==="undefined"?-1:$("#remarks").val();var g=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();if(c!="Repayment Date"&&(d==""||parseFloat(d)<=0)){$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter Number of "+c+"(s) late",callback:function(){}});return false}var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var n="";var m=b.responseText;if(/^[\],:{}\s]*$/.test(m.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=$.parseJSON(m);bootbox.alert({size:"small",title:"Rhomicom Message",message:"Saving Successful",callback:function(){}})}else{$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:m,callback:function(){}});return false}}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg=12&subPgNo=7.2&vtyp=1&q=UPDATE&sbmtdPrdtID="+a+"&rowID="+j+"&frqncyNo="+d+"&frqncy="+c+"&remarks="+h+"&rvsnTtl="+g)}function onChqLateFeeFrqncy(){var a=$("#frqncy option:selected").val();if(a=="Repayment Date"){$("#frqncyNo").val(0);$("#frqncyNoDiv").css("display","none");$("#frqncyDiv").attr("class","col-md-12")}else{$("#frqncyNo").css("display","block");$("#frqncyNo").val("");$("#frqncyDiv").attr("class","col-md-8");$("#frqncyNoDiv").attr("class","col-md-4");$("#frqncyNoDiv").css("display","block")}}function getAllPrcsnFees(d,a,j){var c=typeof $("#allPrcsnFeesSrchFor").val()==="undefined"?"%":$("#allPrcsnFeesSrchFor").val();var h=typeof $("#allPrcsnFeesSrchIn").val()==="undefined"?"Both":$("#allPrcsnFeesSrchIn").val();var b=typeof $("#allPrcsnFeesPageNo").val()==="undefined"?1:$("#allPrcsnFeesPageNo").val();var f=typeof $("#allPrcsnFeesDsplySze").val()==="undefined"?10:$("#allPrcsnFeesDsplySze").val();var g=typeof $("#allPrcsnFeesSortBy").val()==="undefined"?"":$("#allPrcsnFeesSortBy").val();var e=typeof $("#allPrcsnFeesIsEnabled").val()==="undefined"?"":$("#allPrcsnFeesIsEnabled").val();if(d=="clear"){c="%";b=1}else{if(d=="next"){b=parseInt(b)+1}else{if(d=="previous"){b=parseInt(b)-1}}}j=j+"&searchfor="+c+"&searchin="+h+"&pageNo="+b+"&limitSze="+f+"&sortBy="+g+"&isEnabled="+e;openATab(a,j)}function enterKeyFuncAllPrcsnFees(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllPrcsnFees(b,f,d)}}function getAllLatePymntFees(d,a,j){var c=typeof $("#allLatePymntFeesSrchFor").val()==="undefined"?"%":$("#allLatePymntFeesSrchFor").val();var h=typeof $("#allLatePymntFeesSrchIn").val()==="undefined"?"Both":$("#allLatePymntFeesSrchIn").val();var b=typeof $("#allLatePymntFeesPageNo").val()==="undefined"?1:$("#allLatePymntFeesPageNo").val();var f=typeof $("#allLatePymntFeesDsplySze").val()==="undefined"?10:$("#allLatePymntFeesDsplySze").val();var g=typeof $("#allLatePymntFeesSortBy").val()==="undefined"?"":$("#allLatePymntFeesSortBy").val();var e=typeof $("#allLatePymntFeesIsEnabled").val()==="undefined"?"":$("#allLatePymntFeesIsEnabled").val();if(d=="clear"){c="%";b=1}else{if(d=="next"){b=parseInt(b)+1}else{if(d=="previous"){b=parseInt(b)-1}}}j=j+"&searchfor="+c+"&searchin="+h+"&pageNo="+b+"&limitSze="+f+"&sortBy="+g+"&isEnabled="+e;openATab(a,j)}function enterKeyFuncAllLatePymntFees(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllLatePymntFees(b,f,d)}}function deleteCrdtPrdt(d){var b;var a;var c;c=bootbox.confirm({size:"small",message:"Are you sure you want to delete this product?",callback:function(e){if(e){b=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});b.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;b.modal("hide");if(g=="SORRY"){a=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Failed to Delete Credit Product.</br>Credit Product is in Use.",callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});return false}else{if(g=="SORRY1"){a=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Failed to Delete Credit Product.</br>Only Credit Products with statuses 'Incomplete','Rejected' or 'Withdrawn' can be deleted.",callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});return false}}a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getSvngsPrdtData("","#allmodules","grp=17&typ=1&pg=7&subPgNo=7.2")}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=12&subPgNo=7.2&q=DELETE&prdtID="+d)}}});c.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function delPrcsnFee(g,f){var c=g.split("_")[1];var e=-1;var b="";var h=typeof $("#sbmtdPrdtID").val()==="undefined"?"-1":$("#sbmtdPrdtID").val();var a=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();if(typeof $("#allPrcsnFeesRow"+c+"_LoanPrdtID").val()==="undefined"){}else{e=$("#allPrcsnFeesRow"+c+"_LoanprdtPrcssnFeeID").val();b=$("#allPrcsnFeesRow"+c+"_FeeNm").val()}var d=bootbox.confirm({title:"Remove Person?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this Processing Fee?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(j){if(j===true){var k=bootbox.alert({title:"Remove Processing Fee?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing Processing Fee...Please Wait...</p>',callback:function(){getAllPrcsnFees("","#allPrcsnFeesDetailInfo","grp=17&typ=1&pg=12&subPgNo=7.21&vtypActn=EDIT&prdtID="+h+"&rvsnTtl="+a)}});k.init(function(){if(e>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:12,q:"DELETE",subPgNo:7.2,actyp:1,FeeNm:b,PKeyID:e,sbmtdPrdtID:h,rvsnTtl:a,isApproved:f},success:function(l){setTimeout(function(){if(l=="SORRY"){l="Failed to Delete Processing Fee record.</br>Processing Fee Record is in Use."}else{if(l=="SORRY1"){l="Failed to Delete Processing Fee record.</br>Only Processing Fees for Credit Products with statuses 'Incomplete','Rejected' or 'Withdrawn' can be deleted."}}k.find(".bootbox-body").html(l);if(l.indexOf("Success")!==-1){$("#"+g).remove()}},500)},error:function(n,l,m){k.find(".bootbox-body").html(m)}})})}else{setTimeout(function(){$("#"+g).remove();k.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function delLatePymntFee(g,f){var c=g.split("_")[1];var e=-1;var b="";var h=typeof $("#sbmtdPrdtID").val()==="undefined"?"-1":$("#sbmtdPrdtID").val();var a=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();if(typeof $("#allLatePymntFeesRow"+c+"_LoanPrdtID").val()==="undefined"){}else{e=$("#allLatePymntFeesRow"+c+"_LoanprdtLateFeeID").val();b=$("#allLatePymntFeesRow"+c+"_FeeNm").val()}var d=bootbox.confirm({title:"Remove Person?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this Late Payment Fee?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(j){if(j===true){var k=bootbox.alert({title:"Remove Late Payment Fee?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing Late Payment Fee...Please Wait...</p>',callback:function(){getAllPrcsnFees("","#allLatePymntFeesDetailInfo","grp=17&typ=1&pg=12&subPgNo=7.22&vtypActn=EDIT&prdtID="+h+"&rvsnTtl="+a)}});k.init(function(){if(e>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:12,q:"DELETE",subPgNo:7.2,actyp:2,FeeNm:b,PKeyID:e,sbmtdPrdtID:h,rvsnTtl:a,isApproved:f},success:function(l){setTimeout(function(){if(l=="SORRY"){l="Failed to Delete Late Payment Fee record.</br>Late Payment Fee Record is in Use."}else{if(l=="SORRY1"){l="Failed to Delete Late Payment Fee record.</br>Only Late Payment Fees for Credit Products with statuses 'Incomplete','Rejected' or 'Withdrawn' can be deleted."}}k.find(".bootbox-body").html(l);if(l.indexOf("Success")!==-1){$("#"+g).remove()}},500)},error:function(n,l,m){k.find(".bootbox-body").html(m)}})})}else{setTimeout(function(){$("#"+g).remove();k.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function getInvestmentsForm(k,l,b,n,c,e,f,g,d,h,m){$("#allOtherInputData99").val(0);if(typeof m==="undefined"||m===null){m=function(){var o=1}}$("#tblRowID").val(h);if(!$.fn.DataTable.isDataTable("#indCustTable")){var j=$("#indCustTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#indCustTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{j.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#indCustTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{j.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(n);$("#"+l).html(a.responseText);$("#"+k).off("hidden.bs.modal");$("#"+k).one("hidden.bs.modal",function(o){if(g!=="VIEW"){getCustData("","#allmodules","grp=17&typ=1&pg=5&subPgNo="+e,"invstmnts");$("#"+b).html("");$("#"+l).html("")}$(o.currentTarget).unbind()});$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+k).off("show.bs.modal");$("#"+k).on("show.bs.modal",function(o){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+k).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){m()})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+g+"&invstmntID="+d)}function onClickInvstmntProduct(a,b){var c=$("#invstmntType option:selected").val();var d="MCF Investment Products";if(c!==""){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",d,"gnrlOrgID","invstmntType","","radio",true,"","prdtTypeID","prdtType","clear",1,"",function(){getInvstmntPrdtDetsForApplctn(a,b)})}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Select Investment Type first!",callback:function(){}});return false}}function getInvstmntPrdtDetsForApplctn(a,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var c;var e=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();var d=new FormData();d.append("grp",17);d.append("typ",1);d.append("pg",a);d.append("subPgNo",b);d.append("vtyp",4);d.append("PKeyID",e);$.ajax({url:"index.php",type:"POST",data:d,async:true,success:function(f){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");if(/^[\],:{}\s]*$/.test(f.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){c=$.parseJSON(f);$("#crncyIsoCode").text(c.invstmntPrdtDetArry.crncyIsoCode);$("#currencyId").val(c.invstmntPrdtDetArry.currencyId);$("#intRate").val(c.invstmntPrdtDetArry.interestRate);$("#invstmntTenor").val(c.invstmntPrdtDetArry.invstmntDurationNo);$("#invstmntTenorType").val(c.invstmntPrdtDetArry.invstmntDurationType);$("#dscntRate").val(c.invstmntPrdtDetArry.discountRate);$("#invstmntMaxAmount").val(c.invstmntPrdtDetArry.invstmntMaxAmount);$("#invstmntMinAmount").val(c.invstmntPrdtDetArry.invstmntMinAmount);if(c.invstmntPrdtDetArry.invstmntType=="Treasury Bill"){$("#rateType").val("Discount");$("#interestRate").val(c.invstmntPrdtDetArry.discountRate);$("#startDate").val(getNextMondayTbill());$("#mtrtyDate").val(getMaturityDate(getNextMondayTbill(),parseFloat(c.invstmntPrdtDetArry.invstmntDurationNo)));$("#invstmntTenorType").attr("disabled",true);$("#invstmntTenor").attr("readonly","readonly");$("#rateType").attr("disabled",false)}else{$("#rateType").val("Interest");$("#interestRate").val(c.invstmntPrdtDetArry.interestRate);$("#startDate").val(getNextWkDayFxdDpst());$("#mtrtyDate").val(getMaturityDate(getNextWkDayFxdDpst(),parseFloat(c.invstmntPrdtDetArry.invstmntDurationNo)));$("#invstmntTenorType").attr("disabled",true);$("#rateType").attr("disabled",true)}}else{alert(f)}},cache:false,contentType:false,processData:false})})}function getInvstmntMaturityDate(){var b=typeof $("#invstmntType").val()==="undefined"?"Treasury Bill":$("#invstmntType").val();var a=typeof $("#invstmntTenor").val()==="undefined"?0:$("#invstmntTenor").val();if(b=="Treasury Bill"){$("#mtrtyDate").val(getMaturityDate(getNextMondayTbill($("#startDate").val()),parseFloat(a)))}else{$("#mtrtyDate").val(getMaturityDate(getNextWkDayFxdDpst($("#startDate").val()),parseFloat(a)))}}function onClickInvstmntPrdtCust(a){var b=$("#custType option:selected").val();var c="All Bank Customers - Investment";if(b==="Group"){c="MCF Corporate/Group Customers";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",c,"gnrlOrgID","custType","","radio",true,"","bnkCustomerID","bnkCustomer","clear",1,"")}else{getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",c,"gnrlOrgID","custType","","radio",true,"","bnkCustomerID","bnkCustomer","clear",1,"")}}function onChangeShdRollover(){var a=typeof $("#shdRollover").val()==="undefined"?"":$("#shdRollover").val();if(a=="No"){$("#rolloverType").attr("disabled",true);$("#rolloverType").val("")}else{$("#rolloverType").attr("disabled",false);$("#rolloverType").val("Principal Only")}}function onChangePymntMtd(){var a=$("#pymntMthod option:selected").val();if(a=="Debit Account"){$("#rpmntSrcAcctDiv").css("display","none");$("#pymntMtdSrcID").val(-1);$("#pymntMtdSrc").val("");$("#src_id").text("Account No.:")}else{$("#rpmntSrcAcctDiv").css("display","table-cell");$("#pymntMtdSrcID").val(-1);$("#pymntMtdSrc").val("");$("#src_id").text("Document No.:")}}function onClickPymntMtdSrc(){var a=$("#pymntMthod option:selected").val();var b="MCF Investment Account Deposits";if(a==="Debit Account"){b="MCF Customer Bank Accounts - (For Investment)";getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",b,"gnrlOrgID","bnkCustomerID","","radio",true,"","pymntMtdSrcID","pymntMtdSrc","clear",1,"")}else{getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",b,"gnrlOrgID","bnkCustomerID","","radio",true,"","pymntMtdSrcID","pymntMtdSrc","clear",1,"")}}function onChangeBckPayMtd(){var a=$("#payBckMthod option:selected").val();if(a=="Credit Account"){$("#paybackAcctID").val(-1);$("#paybackAcct").val("");$("#crdtAcctChqNoDiv").css("display","none");$("#crdtAcctNoDiv").css("display","block")}else{$("#paybackAcctID").val(-1);$("#paybackAcct").val("");$("#crdtAcctChqNoDiv").css("display","block");$("#crdtAcctNoDiv").css("display","none")}}function saveInvstmntApplication(a){if(a==1){var c=processInvstmnt();if(!c){return false}}var e;var b;var f="Saving";var d="Saved";if(a==1){f="Submitting for Authorization";d="Submitted"}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var A;var u=typeof $("#invstmntID").val()==="undefined"?-1:$("#invstmntID").val();var p=typeof $("#applctnDate").val()==="undefined"?"":$("#applctnDate").val();var J=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var o=typeof $("#invstmntOfficerID").val()==="undefined"?-1:$("#invstmntOfficerID").val();var M=typeof $("#custType").val()==="undefined"?"":$("#custType").val();var G=typeof $("#bnkCustomerID").val()==="undefined"?-1:$("#bnkCustomerID").val();var k=typeof $("#invstmntType").val()==="undefined"?"":$("#invstmntType").val();var w=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();var h=typeof $("#invstmntAmount").val()==="undefined"?-1:$("#invstmntAmount").val().trim().length===0?0:$("#invstmntAmount").val();var j=typeof $("#invstmntTenor").val()==="undefined"?-1:$("#invstmntTenor").val().trim().length===0?0:$("#invstmntTenor").val();var K=typeof $("#invstmntTenorType").val()==="undefined"?"":$("#invstmntTenorType").val();var N=typeof $("#interestRate").val()==="undefined"?-1:$("#interestRate").val();var m=typeof $("#startDate").val()==="undefined"?"":$("#startDate").val();var z=typeof $("#mtrtyDate").val()==="undefined"?"":$("#mtrtyDate").val();var n=typeof $("#mtrtyValue").val()==="undefined"?"":$("#mtrtyValue").val();var D=typeof $("#shdRollover").val()==="undefined"?"No":$("#shdRollover").val();var v=typeof $("#rolloverType").val()==="undefined"?"":$("#rolloverType").val();var B=typeof $("#pymntMthod").val()==="undefined"?"":$("#pymntMthod").val();var H=typeof $("#pymntMtdSrcID").val()==="undefined"?-1:$("#pymntMtdSrcID").val();var C=typeof $("#benfName").val()==="undefined"?"":$("#benfName").val();var g=typeof $("#benfCntct").val()==="undefined"?"":$("#benfCntct").val();var y=typeof $("#payBckMthod").val()==="undefined"?"":$("#payBckMthod").val();var E=typeof $("#paybackAcctID").val()==="undefined"?-1:$("#paybackAcctID").val();var r=typeof $("#chqNo").val()==="undefined"?"":$("#chqNo").val();var x=typeof $("#currencyId").val()==="undefined"?-1:$("#currencyId").val();var L=typeof $("#invstmntMinAmount").val()==="undefined"?0:$("#invstmntMinAmount").val();var t=typeof $("#invstmntMaxAmount").val()==="undefined"?0:$("#invstmntMaxAmount").val();var s=typeof $("#src_id").text()==="undefined"?"":$("#src_id").text();var q=typeof $("#acctNumber").val()==="undefined"?"":$("#acctNumber").val();var l=typeof $("#rateType").val()==="undefined"?"":$("#rateType").val();var I=validateInvstmntApplctnForm(a,p,J,o,M,G,k,w,h,t,L,j,K,N,m,z,n,D,v,B,H,s,y,E,q);if(!I){return false}if(a==1&&k=="Fixed Deposit"&&B=="Cash/Cheque Payment"&&parseInt(H)<=0){$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;font-weight:bold !important;'>Failed to submit Investment for Authorization</br>Please capture a Cash/Cheque payment document first!<br/></span>",callback:function(){}});return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> '+f+".... Please Wait...</span></div>"});e.find(".modal-content").css({"margin-top":function(){var P=$(window).height();var O=$(".modal-dialog").height();var Q=P/2;return Q+"px"}});var F=new FormData();F.append("grp",17);F.append("typ",1);F.append("q","UPDATE");F.append("pg",25);F.append("subPgNo",5.2);F.append("vtyp",0);F.append("actyp",1);F.append("invstmntID",u);F.append("applctnDate",p);F.append("bnkBranchID",J);F.append("invstmntOfficerID",o);F.append("custType",M);F.append("bnkCustomerID",G);F.append("invstmntType",k);F.append("mtrtyValue",n.replace(/[^-?0-9\.]/g,""));F.append("prdtTypeID",w);F.append("invstmntAmount",h);F.append("invstmntTenor",j);F.append("invstmntTenorType",K);F.append("interestRate",N);F.append("startDate",m);F.append("mtrtyDate",z);F.append("shdRollover",D);F.append("rolloverType",v);F.append("pymntMthod",B);F.append("pymntMtdSrcID",H);F.append("benfName",C);F.append("benfCntct",g);F.append("payBckMthod",y);F.append("paybackAcctID",E);F.append("chqNo",r);F.append("currencyId",x);F.append("optn",a);F.append("rateType",l);$.ajax({url:"index.php",type:"POST",data:F,async:true,success:function(O){var P="";if(/^[\],:{}\s]*$/.test(O.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){A=$.parseJSON(O);$("#invstmntID").val(A.invstmntID);e.modal("hide");getInvestmentsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Investment",25,5.2,0,"EDIT",A.invstmntID,"indCustTableRow1",function(){P="Investment Successfully "+d+"!";b=bootbox.alert({size:"small",title:"Rhomicom Message",message:P,callback:function(){}})})}else{P=O;e.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:P,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function validateInvstmntApplctnForm(y,x,D,q,u,J,p,K,v,a,z,C,A,b,h,o,l,c,f,F,w,H,t,r,G){var d=0;var k;var j;var s;var B;var m=new Date();var I=m.getDate();var g=m.getMonth()+1;var n=m.getFullYear();var e="";var E="<span style='font-weight: bold !important;'>The following is/are required:</span></br>";if(x!=""){k=new Date(x);j=k.getDate();s=k.getMonth()+1;B=k.getFullYear()}if(x==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#applctnDate").css("border-color","red");$("#applctnDate").css("border-width","2px");e=e+"<b>Application Date</b></br>";d=d+1}else{if(n+"-"+g+"-"+I<B+"-"+s+"-"+j){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#applctnDate").css("border-color","red");$("#applctnDate").css("border-width","2px");e=e+"<b>Application Date must be a valid Date which is not greater than today</b></br>";d=d+1}else{$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px")}}if(D==""||D==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#bnkBranch").css("border-color","red");$("#bnkBranch").css("border-width","2px");e=e+"<b>Branch</b></br>";d=d+1}else{$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px")}if(q==""||q==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntOfficer").css("border-color","red");$("#invstmntOfficer").css("border-width","2px");e=e+"<b>Investment Officer</b></br>";d=d+1}else{$("#invstmntOfficer").css("border-color","#ccc");$("#invstmntOfficer").css("border-width","1px")}if(J==""||J==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#bnkCustomer").css("border-color","red");$("#bnkCustomer").css("border-width","2px");e=e+"<b>Customer Name</b></br>";d=d+1}else{$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px")}if(K==""||K==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prdtType").css("border-color","red");$("#prdtType").css("border-width","2px");e=e+"<b>Investment Product</b></br>";d=d+1}else{$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px")}if(v==""||v<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntAmount").css("border-color","red");$("#invstmntAmount").css("border-width","2px");e=e+"<b>Investment Amount must be greater than zero</b></br>";d=d+1}else{if(parseFloat(v)>parseFloat(a)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntAmount").css("border-color","red");$("#invstmntAmount").css("border-width","2px");e=e+"<b>Maximum applicable Investment Amount is "+formatAsMoney(a)+"</b></br>";d=d+1}else{if(parseFloat(v)<parseFloat(z)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntAmount").css("border-color","red");$("#invstmntAmount").css("border-width","2px");e=e+"<b>Mimimum applicable loan amount is "+formatAsMoney(z)+"</b></br>";d=d+1}else{$("#invstmntAmount").css("border-color","#ccc");$("#invstmntAmount").css("border-width","1px")}}}if(C==""||Number(C)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntTenor").css("border-color","red");$("#invstmntTenor").css("border-width","2px");e=e+"<b>Investment Tenure must be greater than zero</b></br>";d=d+1}else{$("#invstmntTenor").css("border-color","#ccc");$("#invstmntTenor").css("border-width","1px")}if(b==""||b<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#interestRate").css("border-color","red");$("#interestRate").css("border-width","2px");e=e+"<b>Interest Rate must be greater than zero</b></br>";d=d+1}else{$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px")}if(h==""||h==undefined){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#startDate").css("border-color","red");$("#startDate").css("border-width","2px");e=e+"<b>Start Date</b></br>";d=d+1}else{$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px")}if(o==""||o==undefined){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#mtrtyDate").css("border-color","red");$("#mtrtyDate").css("border-width","2px");e=e+"<b>Maturity Date</b></br>";d=d+1}else{$("#mtrtyDate").css("border-color","#ccc");$("#mtrtyDate").css("border-width","1px")}if(l==""||l==undefined){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#mtrtyValue").css("border-color","red");$("#mtrtyValue").css("border-width","2px");e=e+"<b>Maturity Value</b></br>";d=d+1}else{$("#mtrtyValue").css("border-color","#ccc");$("#mtrtyValue").css("border-width","1px")}if(c=="Yes"&&(f==""||f==undefined)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#rolloverType").css("border-color","red");$("#rolloverType").css("border-width","2px");e=e+"<b>Rollover Type</b></br>";d=d+1}else{$("#rolloverType").css("border-color","#ccc");$("#rolloverType").css("border-width","1px")}if((y==1&&(w==""||w==-1))||(F=="Debit Account"&&(w==""||w==-1))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#pymntMtdSrc").css("border-color","red");$("#pymntMtdSrc").css("border-width","2px");e=e+"<b>"+H+"</b></br>";d=d+1}else{$("#pymntMtdSrc").css("border-color","#ccc");$("#pymntMtdSrc").css("border-width","1px")}if(y==1&&(G==""||G==undefined)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#acctNumber").css("border-color","red");$("#acctNumber").css("border-width","2px");e=e+"<b>Investment Account No.</b></br>";d=d+1}else{$("#acctNumber").css("border-color","#ccc");$("#acctNumber").css("border-width","1px")}if(t=="Credit Account"&&(r==""||r<=0)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#paybackAcct").css("border-color","red");$("#paybackAcct").css("border-width","2px");e=e+"<b>Credit Account Number</b></br>";d=d+1}else{$("#paybackAcct").css("border-color","#ccc");$("#paybackAcct").css("border-width","1px")}if(d>0){bootbox.alert({size:"small",title:"Validation Errors",message:E+"<span style='color:red; font-weight:bold !important;'>"+e+"</span>",callback:function(){}});return false}else{$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#invstmntOfficer").css("border-color","#ccc");$("#invstmntOfficer").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#invstmntAmount").css("border-color","#ccc");$("#invstmntAmount").css("border-width","1px");$("#invstmntTenor").css("border-color","#ccc");$("#invstmntTenor").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px");$("#mtrtyDate").css("border-color","#ccc");$("#mtrtyDate").css("border-width","1px");$("#rolloverType").css("border-color","#ccc");$("#rolloverType").css("border-width","1px");$("#pymntMtdSrc").css("border-color","#ccc");$("#pymntMtdSrc").css("border-width","1px");$("#payBckMthod").css("border-color","#ccc");$("#payBckMthod").css("border-width","1px");return true}}function onChangeRateType(){var a=typeof $("#rateType").val()==="undefined"?"":$("#rateType").val();if(a=="Interest"){$("#interestRate").val($("#intRate").val())}else{$("#interestRate").val($("#dscntRate").val())}calcMaturityValue()}function onChangeInvstmntType(){var a=typeof $("#invstmntType").val()==="undefined"?"":$("#invstmntType").val();if(a=="Treasury Bill"){$("#rateType").val("Discount");$("#interestRate").val("");$("#prdtType").val("");$("#prdtTypeID").val(-1);$("#invstmntTenor").val("");$("#invstmntTenorType").val("Day");$("#startDate").val("");$("#mtrtyDate").val("");$("#mtrtyValue").val("");$("#pymntMthod").val("Debit Account");$("#pymntMthod").attr("disabled",true);$("#rateType").attr("disabled",false)}else{$("#rateType").val("Interest");$("#interestRate").val("");$("#prdtType").val("");$("#prdtTypeID").val(-1);$("#invstmntTenor").val("");$("#invstmntTenorType").val("Day");$("#startDate").val("");$("#mtrtyDate").val("");$("#mtrtyValue").val("");$("#pymntMthod").attr("disabled",false);$("#rateType").attr("disabled",true)}}function getNextMondayTbill(h){var b=new Date(h);if(h==""||h==undefined){b=new Date()}var e="";var g=new Array(12);g[0]="Jan";g[1]="Feb";g[2]="Mar";g[3]="Apr";g[4]="May";g[5]="Jun";g[6]="Jul";g[7]="Aug";g[8]="Sep";g[9]="Oct";g[10]="Nov";g[11]="Dec";var f=b.getDate()+(1+7-b.getDay())%7;b.setDate(f);var a=b.getDate();var c=b.getMonth()+1;var d=b.getFullYear();for(i=0;i<12;i++){if(c==i+1){e=g[i];break}}return a+"-"+e+"-"+d}function getNextWkDayFxdDpst(c){var b="";var d=new Array(12);d[0]="Jan";d[1]="Feb";d[2]="Mar";d[3]="Apr";d[4]="May";d[5]="Jun";d[6]="Jul";d[7]="Aug";d[8]="Sep";d[9]="Oct";d[10]="Nov";d[11]="Dec";var e=new Date(c);if(c==""||c==undefined){e=new Date()}var f=e.getDay(),j=0;if(f===6){j=2}else{if(f===7){j=1}}e.setDate(e.getDate()+j);var h=e.getDate();var a=e.getMonth()+1;var g=e.getFullYear();for(i=0;i<12;i++){if(a==i+1){b=d[i];break}}return h+"-"+b+"-"+g}function getMaturityDate(b,f){var d=new Date(b);var c="";var e=new Array(12);e[0]="Jan";e[1]="Feb";e[2]="Mar";e[3]="Apr";e[4]="May";e[5]="Jun";e[6]="Jul";e[7]="Aug";e[8]="Sep";e[9]="Oct";e[10]="Nov";e[11]="Dec";var g=d.getDate()+f;d.setDate(g);var j=d.getDate();var a=d.getMonth()+1;var h=d.getFullYear();for(i=0;i<12;i++){if(a==(i+1)){c=e[i];break}}return j+"-"+c+"-"+h}function computeMaturity(pCost,pRate,pTime){var cost2=pCost;var rate2=pRate;var time2=pTime;if(isNumber(cost2)==false){alert("Maturity Value must be a Valid Number!");return false}if(isNumber(rate2)==false){alert("Rate must be a Valid Number!");return false}if(isNumber(time2)==false){alert("Time must be a Valid Number!");return false}rate2=rate2/100;var mv2=cost2/(1-((rate2*time2)/364));return eval(parseFloat(mv2*100)*0.01)}function computeCost(pMaturity,pRate,pTime){var maturity=pMaturity;var rate=pRate;var time=pTime;if(isNumber(maturity)==false){alert("Maturity Value must be a Valid Number!");return false}if(isNumber(rate)==false){alert("Rate must be a Valid Number!");return false}if(isNumber(time)==false){alert("Time must be a Valid Number!");return false}rate=rate/100;var cost=maturity*(1-((rate*time)/364));return eval(parseFloat(cost*100)*0.01)}function isNumber(a){return !isNaN(parseFloat(a))&&isFinite(a)}function calcMaturityValue(){var d=typeof $("#invstmntAmount").val()==="undefined"?0:$("#invstmntAmount").val().trim().length===0?0:$("#invstmntAmount").val();var a=typeof $("#interestRate").val()==="undefined"?0:$("#interestRate").val().trim().length===0?0:$("#interestRate").val();var b=typeof $("#invstmntTenor").val()==="undefined"?0:$("#invstmntTenor").val().trim().length===0?0:$("#invstmntTenor").val();if(isNumber(d)==false){bootbox.alert({size:"small",title:"Investment Amount",message:"Amount must be a Valid Number",callback:function(){}});return false}if(isNumber(a)==false){bootbox.alert({size:"small",title:"Rate",message:"Rate must be a Valid Number",callback:function(){}});return false}if(isNumber(b)==false){bootbox.alert({size:"small",title:"Tenure",message:"Time must be a Valid Number",callback:function(){}});return false}var c=computeMaturity(d,a,b);$("#mtrtyValue").val(formatAsMoney(c));$("#ttlInterest").val(formatAsMoney(c-d));return true}function processInvstmnt(){if($("#invstmntAmount").val()==""||$("#invstmntAmount").val()==undefined){bootbox.alert({size:"small",title:"Investment Amount",message:"Amount must be a Valid Number",callback:function(){}});return false}if($("#interestRate").val()==""||$("#interestRate").val()==undefined){bootbox.alert({size:"small",title:"Rate",message:"Rate must be a Valid Number",callback:function(){}});return false}if($("#invstmntTenor").val()==""||$("#invstmntTenor").val()==undefined){bootbox.alert({size:"small",title:"Tenure",message:"Tenure must be a Valid Number",callback:function(){}});return false}var a=calcMaturityValue();if(a){getInvstmntMaturityDate()}return true}function withdrawRejectApproveVoidActn(a){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var d;var f;var b=typeof $("#invstmntID").val()==="undefined"?-1:$("#invstmntID").val();$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var e="Are you sure you want to APPROVE this Investment?";f="Investment APPROVED Successfully";if(a==0){e="Are you sure you want to WITHDRAW this Investment?";f="Investment WITHDRAWN Successfully"}else{if(a==1){e="Are you sure you want to REJECT this Investment?";f="Investment REJECTED Successfully"}else{if(a==2){e="Are you sure you want to VOID this Investment?";f="Investment VOIDED Successfully"}}}var c=new FormData();c.append("grp",17);c.append("typ",1);c.append("q","UPDATE");c.append("pg",25);c.append("subPgNo",5.2);c.append("vtyp",0);c.append("actyp",2);c.append("invstmntID",b);c.append("optn",a);bootbox.confirm({title:"Rhomicom Message",message:e,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(g){if(g){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:c,async:true,success:function(j){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var k="";if(/^[\],:{}\s]*$/.test(j.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var h=$.parseJSON(j);getInvestmentsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Investment",25,5.2,0,"EDIT",b,"indCustTableRow1",function(){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:k,callback:function(){}})})}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:j,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function deleteInvestment(b){var c;var a;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Investment?",callback:function(e){if(e){c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;c.modal("hide");if(g=="SORRY"){a=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Failed to Delete Investment.</br>Only Investments with statuses 'Incomplete','Rejected' or 'Withdrawn' can be deleted.",callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});return false}a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("clear","#allmodules","grp=17&typ=1&pg=5&subPgNo=5.2","invstmnts")}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=25&subPgNo=5.2&q=DELETE&invstmntID="+b)}}});d.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function getAccountCrncy(a,b){getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.addClass("mdlloadingDiag");var d;var c=typeof $("#"+a).val()==="undefined"?-1:$("#"+a).val();var e=new FormData();e.append("grp",17);e.append("typ",1);e.append("pg",13);e.append("subPgNo",2.1);e.append("vtyp",8);e.append("acctID",c);$.ajax({url:"index.php",type:"POST",data:e,async:true,success:function(f){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");if(/^[\],:{}\s]*$/.test(f.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){d=$.parseJSON(f);$("#allBranchPymntAcctsRow"+b+"_CurrencyID").val(d.currencyID);$("#allBranchPymntAcctsRow"+b+"_CurrencyNm").val(d.currencyNm)}else{alert(f)}},cache:false,contentType:false,processData:false})})}function saveBranchPymntAcct(){var d="";var c=0;var b=0;$("#allBranchPymntAcctsTable").find("tr").each(function(f,g){if(f>0){if(typeof $(g).attr("id")==="undefined"){}else{var e=$(g).attr("id").split("_")[1];if(typeof $("#allBranchPymntAcctsRow"+e+"_BranchID").val()==="undefined"){}else{if($("#allBranchPymntAcctsRow"+e+"_BranchID").val()==""||$("#allBranchPymntAcctsRow"+e+"_BranchID").val()==-1){$("#allBranchPymntAcctsRow"+e+"_BranchNm").css("border-color","red");$("#allBranchPymntAcctsRow"+e+"_BranchNm").css("border-width","2px");c=c+1}else{$("#allBranchPymntAcctsRow"+e+"_BranchNm").css("border-color","#ccc");$("#allBranchPymntAcctsRow"+e+"_BranchNm").css("border-width","1px")}if($("#allBranchPymntAcctsRow"+e+"_AccountID").val()==""||parseFloat($("#allBranchPymntAcctsRow"+e+"_AccountID").val())<0){$("#allBranchPymntAcctsRow"+e+"_AccountNm").css("border-color","red");$("#allBranchPymntAcctsRow"+e+"_AccountNm").css("border-width","2px");c=c+1}else{$("#allBranchPymntAcctsRow"+e+"_AccountNm").css("border-color","#ccc");$("#allBranchPymntAcctsRow"+e+"_AccountNm").css("border-width","1px")}if($("#allBranchPymntAcctsRow"+e+"_CurrencyID").val()==""||parseFloat($("#allBranchPymntAcctsRow"+e+"_CurrencyID").val())<0){$("#allBranchPymntAcctsRow"+e+"_CurrencyNm").css("border-color","red");$("#allBranchPymntAcctsRow"+e+"_CurrencyNm").css("border-width","2px");c=c+1}else{$("#allBranchPymntAcctsRow"+e+"_CurrencyNm").css("border-color","#ccc");$("#allBranchPymntAcctsRow"+e+"_CurrencyNm").css("border-width","1px")}if(c<=0){d=d+$("#allBranchPymntAcctsRow"+e+"_BrnchAcctRowID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allBranchPymntAcctsRow"+e+"_BranchID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allBranchPymntAcctsRow"+e+"_AccountID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allBranchPymntAcctsRow"+e+"_CurrencyID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allBranchPymntAcctsRow"+e+"_ProductType").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allBranchPymntAcctsRow"+e+"_IsEnabled").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";b=b+1}}}}});if(c>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted records</i></b></span>",callback:function(){}});return false}else{if(b<=0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please provide at lease One record</i></b></span>",callback:function(){}});return false}}var a=bootbox.alert({title:"Save Records?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving...Please Wait...</p>',callback:function(){getCustAcctsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Branch Payment Accounts",13,2.1,7,"ADD",-1)}});a.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:13,q:"UPDATE",subPgNo:2.1,vtyp:7,actyp:1,slctdBranchPymntAccts:d},success:function(e){setTimeout(function(){a.find(".bootbox-body").html(e)},500)},error:function(e,g,f){console.warn(e.responseText)}})})})}function getAllBranchPymntAccts(d,a,j){var c=typeof $("#allBranchPymntAcctsSrchFor").val()==="undefined"?"%":$("#allBranchPymntAcctsSrchFor").val();var h=typeof $("#allBranchPymntAcctsSrchIn").val()==="undefined"?"Both":$("#allBranchPymntAcctsSrchIn").val();var b=typeof $("#allBranchPymntAcctsPageNo").val()==="undefined"?1:$("#allBranchPymntAcctsPageNo").val();var f=typeof $("#allBranchPymntAcctsDsplySze").val()==="undefined"?10:$("#allBranchPymntAcctsDsplySze").val();var g=typeof $("#allBranchPymntAcctsSortBy").val()==="undefined"?"":$("#allBranchPymntAcctsSortBy").val();var e=$("#allBranchPymntAcctsIsEnabled:checked").length>0;if(d=="clear"){c="%";b=1;f=10}else{if(d=="next"){b=parseInt(b)+1}else{if(d=="previous"){b=parseInt(b)-1}}}j=j+"&searchfor="+c+"&searchin="+h+"&pageNo="+b+"&limitSze="+f+"&sortBy="+g+"&pg=13&subPgNo=2.1&vtyp=7&isEnabled="+e;doAjax(j,"myFormsModalLg","ReloadDialog","Branch Payment Accountsss","myFormsModalTitleLg","myFormsModalBodyLg")}function enterKeyFuncAllBranchPymntAccts(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllBranchPymntAccts(b,f,d)}}function delBranchPymntAcct(d){var a=d.split("_")[1];var c=-1;var e="";if(typeof $("#allBranchPymntAcctsRow"+a+"_BranchID").val()==="undefined"){}else{c=$("#allBranchPymntAcctsRow"+a+"_BrnchAcctRowID").val();e=$("#allBranchPymntAcctsRow"+a+"_AccountID").val()}var b=bootbox.confirm({title:"Remove Person?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this record?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Remove Record?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing record...Please Wait...</p>',callback:function(){getCustAcctsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Branch Payment Accounts",13,2.1,7,"ADD",-1)}});g.init(function(){if(c>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:13,q:"DELETE",subPgNo:2.1,vtyp:7,actyp:1,AccountID:e,PKeyID:c},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h);if(h.indexOf("Success")!==-1){$("#"+d).remove()}},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){$("#"+d).remove();g.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function onSetCustLiabilityAcct(c,b){var a=$("#"+c).val();var d=$("#"+b).val();getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","All Accounts","gnrlOrgID","","","radio",true,"",b,c,"clear",1,"",function(){$("#cashDepositCrdtAcc").val(a);$("#cashDepositCrdtAccID").val(d);$("#cashWtdwlDbtAcc").val(a);$("#cashWtdwlDbtAccID").val(d);$("#wtdwlPnltyFlatDbtAcc").val(a);$("#wtdwlPnltyFlatDbtAccID").val(d);$("#interesExpenseCrdtAcc").val(a);$("#interesExpenseCrdtAccID").val(d)})}var prgstimerid2;function imprtPrsnlCstmrs(){var c="";var a=true;var b=bootbox.confirm({title:"Import Customers?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:green;font-weight:bold;font-style:italic;">IMPORT CUSTOMERS</span> to overwrite existing ones?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(d){if(d===true){if(isReaderAPIAvlbl()){$("#allOtherFileInput6").val("");$("#allOtherFileInput6").off("change");$("#allOtherFileInput6").change(function(){var j=$(this).val();var g=document.getElementById("allOtherFileInput6");var h=g.files[0];var f="";f+='<span style="font-weight:bold;">'+escape(h.name)+"</span><br />\n";f+=" - FileType: "+(h.type||"n/a")+"<br />\n";f+=" - FileSize: "+h.size+" bytes<br />\n";f+=" - LastModified: "+(h.lastModifiedDate?h.lastModifiedDate.toLocaleDateString():"n/a")+"<br />\n";var e=new FileReader();BootstrapDialog.show({size:BootstrapDialog.SIZE_LARGE,type:BootstrapDialog.TYPE_DEFAULT,title:"Validating Selected File",message:'<div id="myProgress"><div id="myBar"></div></div><div id="myInformation"><i class="fa fa-spin fa-spinner"></i> Validating Selected File...Please Wait...</div><br/><div id="fileInformation">'+f+"</div>",animate:true,closable:true,closeByBackdrop:false,closeByKeyboard:false,onshow:function(k){setTimeout(function(){var l=k.getButton("btn-srvr-prcs");l.disable();e.onerror=function(m){switch(m.target.error.code){case m.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case m.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case m.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};e.onprogress=function(n){if(n.lengthComputable){var m=Math.round((n.loaded/n.total)*100);var o=document.getElementById("myBar");o.style.width=m+"%";if(m<100){$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>'+m+"% Validating Selected File...Please Wait...</span>")}else{$("#myInformation").html('<span style="color:green;"><i class="fa fa-check"></i>'+m+"% Validating Selected File Completed!</span>");var p=k.getButton("btn-srvr-prcs");if(a==true){p.enable()}else{p.disable()}}}};e.onabort=function(m){alert("File read cancelled")};e.onloadstart=function(n){var m=document.getElementById("myBar");m.style.width="1%";$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>1% Started Importing Customers...Please Wait...</span>')};e.onload=function(W){try{var L=W.target.result;var T=$.csv.toArrays(L);var V=0;var J=0;var x=0;var X="";var P="";var E="";var K="";var F="";var u="";var R="";var D="";var p="";var M="";var w="";var I="";var Q="";var U="";var s="";var A="";var C="";var H="";var v="";var n="";var r="";var z="";var q="";var y="";var m="";var o="";var G="";var S="";for(var t in T){for(var B in T[t]){J++;switch(J){case 1:X=T[t][B];break;case 2:P=T[t][B];break;case 3:E=T[t][B];break;case 4:K=T[t][B];break;case 5:F=T[t][B];break;case 6:u=T[t][B];break;case 7:R=T[t][B];break;case 8:D=T[t][B];break;case 9:p=T[t][B];break;case 10:M=T[t][B];break;case 11:w=T[t][B];break;case 12:I=T[t][B];break;case 13:Q=T[t][B];break;case 14:U=T[t][B];break;case 15:s=T[t][B];break;case 16:A=T[t][B];break;case 17:C=T[t][B];break;case 18:H=T[t][B];break;case 19:v=T[t][B];break;case 20:n=T[t][B];break;case 21:r=T[t][B];break;case 22:z=T[t][B];break;case 23:q=T[t][B];break;case 24:y=T[t][B];break;case 25:m=T[t][B];break;case 26:o=T[t][B];break;case 27:G=T[t][B];break;case 28:S=T[t][B];break;default:var N=bootbox.alert({title:"Error-Validating Selected File",size:"small",message:'<span style="color:red;font-weight:bold:">An error occurred reading this file.Invalid Column in File!</span>',callback:function(){a=false;e.abort()}})}}if(V===0){if(X.toUpperCase()==="NO."&&P.toUpperCase()==="CUSTOMER ID**"&&E.toUpperCase()==="TITLE**"){}else{var N=bootbox.alert({title:"Error-Import Customers",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){a=false;e.abort()}})}}if(1==1){c=c+X.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+P.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+E.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+K.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+F.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+u.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+R.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+D.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+p.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+M.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+w.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+I.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+Q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+U.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+s.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+A.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+C.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+H.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+v.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+n.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+r.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+z.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+y.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+m.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+G.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+S.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";x++}J=0;V++}f+='<br/><span style="color:blue;font-weight:bold;">No. of Valid Rows:'+x;f+="<br/>Total No. of Rows:"+V+"</span>";$("#fileInformation").html(f)}catch(O){var N=bootbox.alert({title:"Error-Import Customers",size:"small",message:"Error:"+O.message,callback:function(){a=false;e.abort()}})}};e.readAsText(h)},500)},buttons:[{label:"Cancel",icon:"glyphicon glyphicon-menu-left",cssClass:"btn-default",action:function(k){a=false;e.abort();k.close()}},{id:"btn-srvr-prcs",label:"Start Server Processing",icon:"glyphicon glyphicon-menu-right",cssClass:"btn-primary",action:function(l){if(a==true){l.close();savePrsnlCstmrs(c)}else{var k=bootbox.alert({title:"Error-Import Customers",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){}})}}}]})});performFileClick("allOtherFileInput6")}}}})}function savePrsnlCstmrs(b){if(b.trim()===""){bootbox.alert({title:"System Alert!",size:"small",message:'<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;">No Data to Send!</span></p>'});return false}var a=bootbox.alert({title:"Importing Customers/Processes",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Importing Customers/Processes...Please Wait...</div>',callback:function(){clearInterval(prgstimerid2);getCustData("clear","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.1","mcfIndCstmr")}});a.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.1,q:"UPDATE",actyp:5,dataToSend:b}});prgstimerid2=window.setInterval(rfrshSavePrsnlCstmrs,1000)})})}function rfrshSavePrsnlCstmrs(){$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.1,q:"UPDATE",actyp:6},success:function(b){var a=document.getElementById("myBar1");a.style.width=b.percent+"%";$("#myInformation1").html(b.message);if(b.percent>=100){window.clearInterval(prgstimerid2)}},error:function(a,c,b){console.log(c+" "+b);console.warn(a.responseText)}})}function imprtCorpGrpCstmrs(c){var b=c;var e="";var a=true;var d=bootbox.confirm({title:"Import "+c,size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:green;font-weight:bold;font-style:italic;">IMPORT '+c.toUpperCase()+"</span> to overwrite existing ones?<br/>Action cannot be Undone!</p>",buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){if(isReaderAPIAvlbl()){$("#allOtherFileInput6").val("");$("#allOtherFileInput6").off("change");$("#allOtherFileInput6").change(function(){var l=$(this).val();var j=document.getElementById("allOtherFileInput6");var k=j.files[0];var h="";h+='<span style="font-weight:bold;">'+escape(k.name)+"</span><br />\n";h+=" - FileType: "+(k.type||"n/a")+"<br />\n";h+=" - FileSize: "+k.size+" bytes<br />\n";h+=" - LastModified: "+(k.lastModifiedDate?k.lastModifiedDate.toLocaleDateString():"n/a")+"<br />\n";var g=new FileReader();BootstrapDialog.show({size:BootstrapDialog.SIZE_LARGE,type:BootstrapDialog.TYPE_DEFAULT,title:"Validating Selected File",message:'<div id="myProgress"><div id="myBar"></div></div><div id="myInformation"><i class="fa fa-spin fa-spinner"></i> Validating Selected File...Please Wait...</div><br/><div id="fileInformation">'+h+"</div>",animate:true,closable:true,closeByBackdrop:false,closeByKeyboard:false,onshow:function(m){setTimeout(function(){var n=m.getButton("btn-srvr-prcs");n.disable();g.onerror=function(o){switch(o.target.error.code){case o.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case o.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case o.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};g.onprogress=function(p){if(p.lengthComputable){var o=Math.round((p.loaded/p.total)*100);var q=document.getElementById("myBar");q.style.width=o+"%";if(o<100){$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>'+o+"% Validating Selected File...Please Wait...</span>")}else{$("#myInformation").html('<span style="color:green;"><i class="fa fa-check"></i>'+o+"% Validating Selected File Completed!</span>");var r=m.getButton("btn-srvr-prcs");if(a==true){r.enable()}else{r.disable()}}}};g.onabort=function(o){alert("File read cancelled")};g.onloadstart=function(p){var o=document.getElementById("myBar");o.style.width="1%";$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>1% Started Importing '+c+"...Please Wait...</span>")};g.onload=function(W){try{var K=W.target.result;var U=$.csv.toArrays(K);var V=0;var H=0;var x=0;var X="";var R="";var N="";var S="";var M="";var C="";var L="";var I="";var J="";var o="";var B="";var Y="";var q="";var p=0;var P="";var A="";var z="";var v="";var D="";var w="";var E="";var T="";var t="";var y="";var r="";var s="";var G="";for(var u in U){for(var F in U[u]){H++;switch(H){case 1:X=U[u][F];break;case 2:R=U[u][F];break;case 3:N=U[u][F];break;case 4:S=U[u][F];break;case 5:M=U[u][F];break;case 6:C=U[u][F];break;case 7:L=U[u][F];break;case 8:I=U[u][F];break;case 9:J=U[u][F];break;case 10:o=U[u][F];break;case 11:B=U[u][F];break;case 12:Y=U[u][F];break;case 13:q=U[u][F];break;case 14:p=U[u][F];break;case 15:P=U[u][F];break;case 16:A=U[u][F];break;case 17:z=U[u][F];break;case 18:v=U[u][F];break;case 19:D=U[u][F];break;case 20:w=U[u][F];break;case 21:E=U[u][F];break;case 22:T=U[u][F];break;case 23:t=U[u][F];break;case 24:y=U[u][F];break;case 25:r=U[u][F];break;case 26:s=U[u][F];break;case 27:G=U[u][F];break;default:var O=bootbox.alert({title:"Error-Validating Selected File",size:"small",message:'<span style="color:red;font-weight:bold:">An error occurred reading this file.Invalid Column in File!</span>',callback:function(){a=false;g.abort()}})}}if(V===0){if(X.toUpperCase()==="NO."&&N.toUpperCase()==="CUSTOMER NAME**"&&v.toUpperCase()==="NATURE OF BUSINESS**"){}else{var O=bootbox.alert({title:"Error-Import "+c,size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){a=false;g.abort()}})}}if(1==1){e=e+X.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+R.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+N.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+S.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+M.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+C.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+L.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+I.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+J.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+B.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+Y.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+p.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+P.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+A.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+z.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+v.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+D.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+w.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+E.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+T.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+t.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+y.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+r.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+s.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+G.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";x++}H=0;V++}h+='<br/><span style="color:blue;font-weight:bold;">No. of Valid Rows:'+x;h+="<br/>Total No. of Rows:"+V+"</span>";$("#fileInformation").html(h)}catch(Q){var O=bootbox.alert({title:"Error-Import Customers",size:"small",message:"Error:"+Q.message,callback:function(){a=false;g.abort()}})}};g.readAsText(k)},500)},buttons:[{label:"Cancel",icon:"glyphicon glyphicon-menu-left",cssClass:"btn-default",action:function(m){a=false;g.abort();m.close()}},{id:"btn-srvr-prcs",label:"Start Server Processing",icon:"glyphicon glyphicon-menu-right",cssClass:"btn-primary",action:function(n){if(a==true){n.close();saveCorpGrpCstmrs(e,c)}else{var m=bootbox.alert({title:"Error-Import Customers",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){}})}}}]})});performFileClick("allOtherFileInput6")}}}})}function saveCorpGrpCstmrs(e,b){if(e.trim()===""){bootbox.alert({title:"System Alert!",size:"small",message:'<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;">No Data to Send!</span></p>'});return false}var a=1.2;var c="mcfCorpCstmr";if(b=="Customer Groups"){a=1.3;c="mcfGrpCstmr"}var d=bootbox.alert({title:"Importing "+b,size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Importing '+b+"...Please Wait...</div>",callback:function(){clearInterval(prgstimerid2);getCustData("clear","#allmodules","grp=17&typ=1&pg=1&subPgNo="+a,c)}});d.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:a,q:"UPDATE",actyp:5,dataToSend:e}});prgstimerid2=window.setInterval(rfrshSaveCorpGrpCstmrs,1000)})})}function rfrshSaveCorpGrpCstmrs(){$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.2,q:"UPDATE",actyp:6},success:function(b){var a=document.getElementById("myBar1");a.style.width=b.percent+"%";$("#myInformation1").html(b.message);if(b.percent>=100){window.clearInterval(prgstimerid2)}},error:function(a,c,b){console.log(c+" "+b);console.warn(a.responseText)}})}function imprtCustAccnts(){var c="";var a=true;var b=bootbox.confirm({custNo:"Import Customer Accounts?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:green;font-weight:bold;font-style:italic;">IMPORT CUSTOMER ACCOUNTS</span> to overwrite existing ones?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(d){if(d===true){if(isReaderAPIAvlbl()){$("#allOtherFileInput6").val("");$("#allOtherFileInput6").off("change");$("#allOtherFileInput6").change(function(){var j=$(this).val();var g=document.getElementById("allOtherFileInput6");var h=g.files[0];var f="";f+='<span style="font-weight:bold;">'+escape(h.name)+"</span><br />\n";f+=" - FileType: "+(h.type||"n/a")+"<br />\n";f+=" - FileSize: "+h.size+" bytes<br />\n";f+=" - LastModified: "+(h.lastModifiedDate?h.lastModifiedDate.toLocaleDateString():"n/a")+"<br />\n";var e=new FileReader();BootstrapDialog.show({size:BootstrapDialog.SIZE_LARGE,type:BootstrapDialog.TYPE_DEFAULT,custNo:"Validating Selected File",message:'<div id="myProgress"><div id="myBar"></div></div><div id="myInformation"><i class="fa fa-spin fa-spinner"></i> Validating Selected File...Please Wait...</div><br/><div id="fileInformation">'+f+"</div>",animate:true,closable:true,closeByBackdrop:false,closeByKeyboard:false,onshow:function(k){setTimeout(function(){var l=k.getButton("btn-srvr-prcs");l.disable();e.onerror=function(m){switch(m.target.error.code){case m.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case m.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case m.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};e.onprogress=function(n){if(n.lengthComputable){var m=Math.round((n.loaded/n.total)*100);var o=document.getElementById("myBar");o.style.width=m+"%";if(m<100){$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>'+m+"% Validating Selected File...Please Wait...</span>")}else{$("#myInformation").html('<span style="color:green;"><i class="fa fa-check"></i>'+m+"% Validating Selected File Completed!</span>");var p=k.getButton("btn-srvr-prcs");if(a==true){p.enable()}else{p.disable()}}}};e.onabort=function(m){alert("File read cancelled")};e.onloadstart=function(n){var m=document.getElementById("myBar");m.style.width="1%";$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>1% Started Importing Customer Accounts...Please Wait...</span>')};e.onload=function(I){try{var B=I.target.result;var O=$.csv.toArrays(B);var y=0;var u=0;var R=0;var p="";var Q="";var J="";var v="";var r="";var F="";var L="";var q="";var G="";var z="";var o="";var w="";var A="";var P=999;var m=99999999;var n="";var D="";var N="";var H="";var s="";var E="";var C=0;for(var x in O){for(var M in O[x]){u++;switch(u){case 1:p=O[x][M];break;case 2:Q=O[x][M];break;case 3:J=O[x][M];break;case 4:v=O[x][M];break;case 5:r=O[x][M];break;case 6:F=O[x][M];break;case 7:L=O[x][M];break;case 8:q=O[x][M];break;case 9:G=O[x][M];break;case 10:z=O[x][M];break;case 11:o=O[x][M];break;case 12:w=O[x][M];break;case 13:A=O[x][M];break;case 14:P=O[x][M];break;case 15:m=O[x][M];break;case 16:n=O[x][M];break;case 17:D=O[x][M];break;case 18:N=O[x][M];break;case 19:H=O[x][M];break;case 20:s=O[x][M];break;case 21:E=O[x][M];break;case 22:C=O[x][M];break;default:var K=bootbox.alert({custNo:"Error-Validating Selected File",size:"small",message:'<span style="color:red;font-weight:bold:">An error occurred reading this file.Invalid Column in File!</span>',callback:function(){a=false;e.abort()}})}}if(y===0){if(p.toUpperCase()==="NO."&&Q.toUpperCase()==="CUSTOMER TYPE**"&&J.toUpperCase()==="CUSTOMER NO.**"){}else{var K=bootbox.alert({custNo:"Error-Import Customer Accounts",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){a=false;e.abort()}})}}if(1==1){c=c+p.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+Q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+J.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+v.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+r.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+F.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+L.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+G.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+z.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+w.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+A.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+P.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+m.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+n.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+D.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+N.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+H.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+s.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+E.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+C.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";R++}u=0;y++}f+='<br/><span style="color:blue;font-weight:bold;">No. of Valid Rows:'+R;f+="<br/>Total No. of Rows:"+y+"</span>";$("#fileInformation").html(f)}catch(t){var K=bootbox.alert({custNo:"Error-Import Customer Accounts",size:"small",message:"Error:"+t.message,callback:function(){a=false;e.abort()}})}};e.readAsText(h)},500)},buttons:[{label:"Cancel",icon:"glyphicon glyphicon-menu-left",cssClass:"btn-default",action:function(k){a=false;e.abort();k.close()}},{id:"btn-srvr-prcs",label:"Start Server Processing",icon:"glyphicon glyphicon-menu-right",cssClass:"btn-primary",action:function(l){if(a==true){l.close();saveCustAccnts(c)}else{var k=bootbox.alert({custNo:"Error-Import Customer Accounts",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){}})}}}]})});performFileClick("allOtherFileInput6")}}}})}function saveCustAccnts(b){if(b.trim()===""){bootbox.alert({custNo:"System Alert!",size:"small",message:'<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;">No Data to Send!</span></p>'});return false}var a=bootbox.alert({custNo:"Importing Customer Accounts",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Importing Customer Accounts...Please Wait...</div>',callback:function(){clearInterval(prgstimerid2);getCustData("clear","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.1")}});a.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:13,subPgNo:2.1,q:"UPDATE",actyp:5,dataToSend:b}});prgstimerid2=window.setInterval(rfrshSaveCustAccnts,1000)})})}function rfrshSaveCustAccnts(){$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:13,subPgNo:2.1,q:"UPDATE",actyp:6},success:function(b){var a=document.getElementById("myBar1");a.style.width=b.percent+"%";$("#myInformation1").html(b.message);if(b.percent>=100){window.clearInterval(prgstimerid2)}},error:function(a,c,b){console.log(c+" "+b);console.warn(a.responseText)}})}function modifyAutrzCustDataRqstNew(a,c,b){var e;var f="Are you sure you want MODIFY this AUTHORIZED DATA?";var d="EDIT CORPORATE CUSTOMER PROFILE";if(c==1.3){d="EDIT CUSTOMER GROUP"}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var h;var g=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();bootbox.confirm({title:"Rhomicom Message",message:f,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(j){if(j){e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">Preparing Data. Please Wait...</span></div>'});e.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=m/2;return n+"px"}});var k=new FormData();k.append("grp",17);k.append("typ",1);k.append("q","UPDATE");k.append("pg",a);k.append("subPgNo",c);k.append("vtyp",b);k.append("custID",g);k.append("actyp",4);$.ajax({url:"index.php",type:"POST",data:k,async:true,success:function(l){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var m="";if(/^[\],:{}\s]*$/.test(l.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){h=$.parseJSON(l);getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg",d,11,c,0,"EDIT",g,"","indCustTableRow1",-1,function(){e.modal("hide")})}else{m=l;e.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:m,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function wthdrwRjctAutrzCustDataRqstNew(e,c,f,h){var g;var j;var k=1;var a="Withdrawing.";var b="Are you sure you want to "+e+" this Change Request?";var d="EDIT CORPORATE CUSTOMER PROFILE";if(f==1.3){d="EDIT CUSTOMER GROUP"}if(e=="REJECT"){a="Rejecting.";k=2}else{if(e=="AUTHORIZE"){a="Authorizing.";k=3}}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var n;var m=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var l=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();bootbox.confirm({title:"Rhomicom Message",message:b,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(o){if(o){g=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">'+a+". Please Wait...</span></div>"});g.find(".modal-content").css({"margin-top":function(){var r=$(window).height();var q=$(".modal-dialog").height();var s=r/2;return s+"px"}});var p=new FormData();p.append("grp",17);p.append("typ",1);p.append("q","UPDATE");p.append("pg",c);p.append("subPgNo",f);p.append("vtyp",h);p.append("custID",m);p.append("actyp",k);p.append("rvsnTtl",l);$.ajax({url:"index.php",type:"POST",data:p,async:true,success:function(q){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var r="";if(/^[\],:{}\s]*$/.test(q.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){n=$.parseJSON(q);if(e=="REJECT"){r="Change Request Successfully REJECTED!"}else{if(e=="AUTHORIZE"){r="Change Request Successfully AUTHORIZED!"}else{r="Change Request successfully WITHDRAWN"}}getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg",d,11,f,0,"EDIT",m,"","indCustTableRow1",-1,function(){g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:r,callback:function(){}})})}else{r=q;g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:r,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function wthdrwRjctAutrzPrsnDataRqst(d,c,e,g){var f;var h;var j=1;var a="Withdrawing.";var b="Are you sure you want to "+d+" this Change Request?";if(d=="REJECT"){a="Rejecting.";j=2}else{if(d=="AUTHORIZE"){a="Authorizing.";j=3}}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var m;var l=typeof $("#personID").val()==="undefined"?-1:$("#personID").val();var k=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();bootbox.confirm({title:"Rhomicom Message",message:b,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(n){if(n){f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">'+a+". Please Wait...</span></div>"});f.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=q/2;return r+"px"}});var o=new FormData();o.append("grp",17);o.append("typ",1);o.append("q","UPDATE");o.append("pg",c);o.append("subPgNo",e);o.append("vtyp",g);o.append("personID",l);o.append("actyp",j);o.append("rvsnTtl",k);$.ajax({url:"index.php",type:"POST",data:o,async:true,success:function(p){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var q="";if(/^[\],:{}\s]*$/.test(p.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(p);if(d=="REJECT"){q="Change Request Successfully REJECTED!"}else{if(d=="AUTHORIZE"){q="Change Request Successfully AUTHORIZED!"}else{q="Change Request successfully WITHDRAWN"}}getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Customer Profile",11,e,0,"EDIT",l,"","indCustTableRow1",-1,function(){f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})})}else{q=p;f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function modifyAutrzPrsnDataRqst(a,c,b){var d;var e="Are you sure you want MODIFY this AUTHORIZED DATA?";getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var g;var f=typeof $("#personID").val()==="undefined"?-1:$("#personID").val();bootbox.confirm({title:"Rhomicom Message",message:e,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(h){if(h){d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">Preparing Data. Please Wait...</span></div>'});d.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=l/2;return m+"px"}});var j=new FormData();j.append("grp",17);j.append("typ",1);j.append("q","UPDATE");j.append("pg",a);j.append("subPgNo",c);j.append("vtyp",b);j.append("personID",f);j.append("actyp",4);$.ajax({url:"index.php",type:"POST",data:j,async:true,success:function(k){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var l="";if(/^[\],:{}\s]*$/.test(k.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){g=$.parseJSON(k);getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Customer Profile",11,c,0,"EDIT",f,"","indCustTableRow1",-1,function(){d.modal("hide")})}else{l=k;d.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function openATabAddPrsnDta(d,c){$("#allOtherInputData99").val(0);$body=$("body");var b=$(d+"tab");var a=d;$("body").css("padding","0px 0px 0px 0px");if($.trim($(a).text())!==""&&(d.match("^#prfl")||d.match("^#profile"))){b.tab("show");$body.removeClass("mdlloading")}else{getMsgAsync("grp=1&typ=11&q=Check Session",function(){$body=$("body");var g=$(d+"tab");var f=d;var e;if(window.XMLHttpRequest){e=new XMLHttpRequest()}else{e=new ActiveXObject("Microsoft.XMLHTTP")}e.onreadystatechange=function(){if(e.readyState===4&&e.status===200){if(c.indexOf("grp=17&typ=1")!==-1){loadScript("app/mcf/mcf2.js?v="+jsFilesVrsn,function(){});loadScript("app/mcf/mcf.js?v="+jsFilesVrsn,function(){g.tab("show");prepareMcf(c,$body,f,e.responseText)})}}};e.open("POST","index.php",true);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.send(c.trim())})}}function modifyAutrzCustAcctRqst(a,c,b){var d;var e="Are you sure you want MODIFY this AUTHORIZED DATA?";getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var g;var f=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();bootbox.confirm({title:"Rhomicom Message",message:e,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(h){if(h){d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">Preparing Data. Please Wait...</span></div>'});d.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=l/2;return m+"px"}});var j=new FormData();j.append("grp",17);j.append("typ",1);j.append("q","UPDATE");j.append("pg",a);j.append("subPgNo",c);j.append("vtyp",b);j.append("acctID",f);j.append("actyp",7);$.ajax({url:"index.php",type:"POST",data:j,async:true,success:function(k){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var l="";if(/^[\],:{}\s]*$/.test(k.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){g=$.parseJSON(k);getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",f,"custAcctTable","indCustTableRow1",-1,function(){d.modal("hide")})}else{l=k;d.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function showHideSvngsInvstmntElmnts(){var a=$("#prdtType").val();if(a==="Investment"){$("#PrdtDiv").attr("class","col-md-6");$("#InvstmntDiv").attr("style","display:block !important");$(".svngsDiv").attr("style","display:none !important");$("#intRate1").addClass("rqrdFld");$("#chrgInterest2").prop("checked",true);$("#chrgCOT2").prop("checked",true);$("#wtdwlLimitType2").prop("checked",true);$("#ovdrftAllowed2").prop("checked",true);$("#intRate").attr("readonly",true);$("#accrualFrqncy").attr("disabled",true);$("#calcMethod").attr("disabled",true);$("#crdtnFrqncy").attr("disabled",true);$("#crdtnType").attr("disabled",true);$("#intRate").removeClass("rqrdFld");$("#intRate").val("0");$("#accrualFrqncy").val("--Please Select--");$("#calcMethod").val("--Please Select--");$("#crdtnFrqncy").val("--Please Select--");$("#intRate").val("--Please Select--");$("#addCmsnBtn").attr("style","display:none !important");$("#cotFreeWtdwlNo").attr("readonly",true);$("#cotFreeWtdwlNo").val("0");$("#wtdwlLimitNo").attr("readonly",true);$("#wtdwlLimitAmt").attr("readonly",true);$("#wtdwlLimitNo").val("0");$("#wtdwlLimitAmt").val("0.00");$("#wtdwlPnltyFlat").attr("readonly",true);$("#wtdwlPnltyPercent").attr("readonly",true);$("#wtdwlPnltyFlat").val("0.00");$("#wtdwlPnltyPercent").val("0.00");$("#indCust").prop("checked",false);$("#corpCust").prop("checked",false);$("#custGrp").prop("checked",false)}else{$("#PrdtDiv").attr("class","col-md-4");$("#InvstmntDiv").attr("style","display:none !important");$(".svngsDiv").attr("style","display:block !important");$("#intRate1").addClass("rqrdFld");$("#invstmntType").val("--Please Select--");$("#drtnNo").val("0");$("#intRate1").val("0.00");$("#dscntRate").val("0.00");$("#minAmount").val("0.00");$("#maxAmount").val("0.00")}}function onChangePayInterest(){var a=typeof $("input[name='chrgInterest']:checked").val()==="undefined"?"NO":$("input[name='chrgInterest']:checked").val();if(a==="YES"){$("#intRate").attr("readonly",false);$("#accrualFrqncy").attr("disabled",false);$("#calcMethod").attr("disabled",false);$("#crdtnFrqncy").attr("disabled",false);$("#crdtnType").attr("disabled",false);$("#intRate").addClass("rqrdFld")}else{$("#intRate").attr("readonly",true);$("#accrualFrqncy").attr("disabled",true);$("#calcMethod").attr("disabled",true);$("#crdtnFrqncy").attr("disabled",true);$("#crdtnType").attr("disabled",true);$("#intRate").removeClass("rqrdFld");$("#intRate").val("0");$("#accrualFrqncy").val("--Please Select--");$("#calcMethod").val("--Please Select--");$("#crdtnFrqncy").val("--Please Select--");$("#intRate").val("--Please Select--")}}function onChangeChargeCOT(){var a=typeof $("input[name='chrgCOT']:checked").val()==="undefined"?"NO":$("input[name='chrgCOT']:checked").val();if(a==="YES"){$("#addCmsnBtn").attr("style","display:inline-block !important");$("#cotFreeWtdwlNo").attr("readonly",false)}else{$("#addCmsnBtn").attr("style","display:none !important");$("#cotFreeWtdwlNo").attr("readonly",true);$("#cotFreeWtdwlNo").val("0")}}function onChangeWdwlLmtType(){var a=typeof $("input[name='wtdwlLimitType']:checked").val()==="undefined"?"NO":$("input[name='wtdwlLimitType']:checked").val();if(a==="DAILY"){$("#wtdwlLimitNo").attr("readonly",false);$("#wtdwlLimitAmt").attr("readonly",false)}else{$("#wtdwlLimitNo").attr("readonly",true);$("#wtdwlLimitAmt").attr("readonly",true);$("#wtdwlLimitNo").val("0");$("#wtdwlLimitAmt").val("0.00")}}function onChangeAllwOvdrft(){var a=typeof $("input[name='ovdrftAllowed']:checked").val()==="undefined"?"NO":$("input[name='ovdrftAllowed']:checked").val();if(a==="YES"){$("#wtdwlPnltyFlat").attr("readonly",false);$("#wtdwlPnltyPercent").attr("readonly",false)}else{$("#wtdwlPnltyFlat").attr("readonly",true);$("#wtdwlPnltyPercent").attr("readonly",true);$("#wtdwlPnltyFlat").val("0.00");$("#wtdwlPnltyPercent").val("0.00")}}function validateSvngsPrdtForm(w,o,z,u,r,h,v,t,p,s,g,x,q,c,A,d,D,b,k,F){var a=0;var E;var f;var m;var e;var y=new Date();var n=y.getDate();var B=y.getMonth()+1;var l=y.getFullYear();var j="";var C="<span style='font-weight: bold !important;'>The following is/are required:</span></br>";if(applctnDate!=""){E=new Date(applctnDate);f=E.getDate();m=E.getMonth()+1;e=E.getFullYear()}if(applctnDate==""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#applctnDate").css("border-color","red");$("#applctnDate").css("border-width","2px");j=j+"<b>Application Date</b></br>";a=a+1}else{if(l+"-"+B+"-"+n<e+"-"+m+"-"+f){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#applctnDate").css("border-color","red");$("#applctnDate").css("border-width","2px");j=j+"<b>Application Date must be a valid Date which is not greater than today</b></br>";a=a+1}else{$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px")}}if(bnkBranchID==""||bnkBranchID==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#bnkBranch").css("border-color","red");$("#bnkBranch").css("border-width","2px");j=j+"<b>Branch</b></br>";a=a+1}else{$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px")}if(invstmntOfficerID==""||invstmntOfficerID==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntOfficer").css("border-color","red");$("#invstmntOfficer").css("border-width","2px");j=j+"<b>Investment Officer</b></br>";a=a+1}else{$("#invstmntOfficer").css("border-color","#ccc");$("#invstmntOfficer").css("border-width","1px")}if(bnkCustomerID==""||bnkCustomerID==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#bnkCustomer").css("border-color","red");$("#bnkCustomer").css("border-width","2px");j=j+"<b>Customer Name</b></br>";a=a+1}else{$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px")}if(prdtTypeID==""||prdtTypeID==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#prdtType").css("border-color","red");$("#prdtType").css("border-width","2px");j=j+"<b>Investment Product</b></br>";a=a+1}else{$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px")}if(invstmntAmount==""||invstmntAmount<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntAmount").css("border-color","red");$("#invstmntAmount").css("border-width","2px");j=j+"<b>Investment Amount must be greater than zero</b></br>";a=a+1}else{if(parseFloat(invstmntAmount)>parseFloat(invstmntMaxAmount)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntAmount").css("border-color","red");$("#invstmntAmount").css("border-width","2px");j=j+"<b>Maximum applicable Investment Amount is "+formatAsMoney(invstmntMaxAmount)+"</b></br>";a=a+1}else{if(parseFloat(invstmntAmount)<parseFloat(invstmntMinAmount)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntAmount").css("border-color","red");$("#invstmntAmount").css("border-width","2px");j=j+"<b>Mimimum applicable loan amount is "+formatAsMoney(invstmntMinAmount)+"</b></br>";a=a+1}else{$("#invstmntAmount").css("border-color","#ccc");$("#invstmntAmount").css("border-width","1px")}}}if(invstmntTenor==""||Number(invstmntTenor)<=0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#invstmntTenor").css("border-color","red");$("#invstmntTenor").css("border-width","2px");j=j+"<b>Investment Tenure must be greater than zero</b></br>";a=a+1}else{$("#invstmntTenor").css("border-color","#ccc");$("#invstmntTenor").css("border-width","1px")}if(interestRate==""||interestRate<0){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#interestRate").css("border-color","red");$("#interestRate").css("border-width","2px");j=j+"<b>Interest Rate must be greater than zero</b></br>";a=a+1}else{$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px")}if(startDate==""||startDate==undefined){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#startDate").css("border-color","red");$("#startDate").css("border-width","2px");j=j+"<b>Start Date</b></br>";a=a+1}else{$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px")}if(mtrtyDate==""||mtrtyDate==undefined){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#mtrtyDate").css("border-color","red");$("#mtrtyDate").css("border-width","2px");j=j+"<b>Maturity Date</b></br>";a=a+1}else{$("#mtrtyDate").css("border-color","#ccc");$("#mtrtyDate").css("border-width","1px")}if(mtrtyValue==""||mtrtyValue==undefined){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#mtrtyValue").css("border-color","red");$("#mtrtyValue").css("border-width","2px");j=j+"<b>Maturity Value</b></br>";a=a+1}else{$("#mtrtyValue").css("border-color","#ccc");$("#mtrtyValue").css("border-width","1px")}if(shdRollover=="Yes"&&(rolloverType==""||rolloverType==undefined)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#rolloverType").css("border-color","red");$("#rolloverType").css("border-width","2px");j=j+"<b>Rollover Type</b></br>";a=a+1}else{$("#rolloverType").css("border-color","#ccc");$("#rolloverType").css("border-width","1px")}if((optn==1&&(pymntMtdSrcID==""||pymntMtdSrcID==-1))||(pymntMthod=="Debit Account"&&(pymntMtdSrcID==""||pymntMtdSrcID==-1))){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#pymntMtdSrc").css("border-color","red");$("#pymntMtdSrc").css("border-width","2px");j=j+"<b>"+srcLbl+"</b></br>";a=a+1}else{$("#pymntMtdSrc").css("border-color","#ccc");$("#pymntMtdSrc").css("border-width","1px")}if(optn==1&&(acctNumber==""||acctNumber==undefined)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#acctNumber").css("border-color","red");$("#acctNumber").css("border-width","2px");j=j+"<b>Investment Account No.</b></br>";a=a+1}else{$("#acctNumber").css("border-color","#ccc");$("#acctNumber").css("border-width","1px")}if(payBckMthod=="Credit Account"&&(paybackAcctID==""||paybackAcctID<=0)){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#paybackAcct").css("border-color","red");$("#paybackAcct").css("border-width","2px");j=j+"<b>Credit Account Number</b></br>";a=a+1}else{$("#paybackAcct").css("border-color","#ccc");$("#paybackAcct").css("border-width","1px")}if(a>0){bootbox.alert({size:"small",title:"Validation Errors",message:C+"<span style='color:red; font-weight:bold !important;'>"+j+"</span>",callback:function(){}});return false}else{$("#applctnDate").css("border-color","#ccc");$("#applctnDate").css("border-width","1px");$("#bnkBranch").css("border-color","#ccc");$("#bnkBranch").css("border-width","1px");$("#invstmntOfficer").css("border-color","#ccc");$("#invstmntOfficer").css("border-width","1px");$("#bnkCustomer").css("border-color","#ccc");$("#bnkCustomer").css("border-width","1px");$("#prdtType").css("border-color","#ccc");$("#prdtType").css("border-width","1px");$("#invstmntAmount").css("border-color","#ccc");$("#invstmntAmount").css("border-width","1px");$("#invstmntTenor").css("border-color","#ccc");$("#invstmntTenor").css("border-width","1px");$("#interestRate").css("border-color","#ccc");$("#interestRate").css("border-width","1px");$("#startDate").css("border-color","#ccc");$("#startDate").css("border-width","1px");$("#mtrtyDate").css("border-color","#ccc");$("#mtrtyDate").css("border-width","1px");$("#rolloverType").css("border-color","#ccc");$("#rolloverType").css("border-width","1px");$("#pymntMtdSrc").css("border-color","#ccc");$("#pymntMtdSrc").css("border-width","1px");$("#payBckMthod").css("border-color","#ccc");$("#payBckMthod").css("border-width","1px");return true}}function modifyAutrzSvngsPrdtRqst(a,c,b){var d;var e="Are you sure you want MODIFY this AUTHORIZED DATA?";getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var g;var f=typeof $("#prdtID").val()==="undefined"?-1:$("#prdtID").val();bootbox.confirm({title:"Rhomicom Message",message:e,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(h){if(h){d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">Preparing Data. Please Wait...</span></div>'});d.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=l/2;return m+"px"}});var j=new FormData();j.append("grp",17);j.append("typ",1);j.append("q","UPDATE");j.append("pg",a);j.append("subPgNo",c);j.append("vtyp",b);j.append("prdtID",f);j.append("actyp",4);$.ajax({url:"index.php",type:"POST",data:j,async:true,success:function(k){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var l="";if(/^[\],:{}\s]*$/.test(k.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){g=$.parseJSON(k);getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Savings and Investment Product",12,7.1,0,"EDIT",f,"","indCustTableRow1",-1,function(){d.modal("hide")})}else{l=k;d.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function wthdrwRjctAutrzSvngsPrdtDataRqst(d,c,e,g){var f;var h;var j=1;var a="Withdrawing.";var b="Are you sure you want to "+d+" this Change Request?";if(d=="REJECT"){a="Rejecting.";j=2}else{if(d=="AUTHORIZE"){a="Authorizing.";j=3}}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var m;var l=typeof $("#prdtID").val()==="undefined"?-1:$("#prdtID").val();var k=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();bootbox.confirm({title:"Rhomicom Message",message:b,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(n){if(n){f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">'+a+". Please Wait...</span></div>"});f.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=q/2;return r+"px"}});var o=new FormData();o.append("grp",17);o.append("typ",1);o.append("q","UPDATE");o.append("pg",c);o.append("subPgNo",e);o.append("vtyp",g);o.append("prdtID",l);o.append("actyp",j);o.append("rvsnTtl",k);$.ajax({url:"index.php",type:"POST",data:o,async:true,success:function(p){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var q="";if(/^[\],:{}\s]*$/.test(p.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(p);if(d=="REJECT"){q="Change Request Successfully REJECTED!"}else{if(d=="AUTHORIZE"){q="Change Request Successfully AUTHORIZED!"}else{q="Change Request successfully WITHDRAWN"}}getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Savings and Investment Product",12,7.1,0,"EDIT",l,"","indCustTableRow1",-1,function(){f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})})}else{q=p;f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function deleteSvngsWtdwlCmsn(f,g,c){var b=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var d;var a;var e;e=bootbox.confirm({size:"small",message:"Are you sure you want to delete this COT line?",callback:function(h){if(h){if(!($("#status").val()=="Incomplete"||$("#status").val()=="Rejected"||$("#status").val()=="Withdrawn")){e.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Sorry! Only COT Lines for Products with Status <b>Incomplete</b>, <b>Rejected</b> or <b>Withdrawn</b> can be deleted.",callback:function(){}});return false}d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});d.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k)/2;return m+"px"}});var j;if(window.XMLHttpRequest){j=new XMLHttpRequest()}else{j=new ActiveXObject("Microsoft.XMLHTTP")}j.onreadystatechange=function(){if(j.readyState===4&&j.status===200){var k=j.responseText;getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Savings and Investment Product",12,7.1,0,"EDIT",g,"","indCustTableRow1",-1,function(){d.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:k,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l-150)/2;return n+"px"}})})}};j.open("POST","index.php",true);j.setRequestHeader("Content-type","application/x-www-form-urlencoded");j.send("grp=17&typ=1&pg=12&subPgNo=7.1&q=DELETE&vtyp=5&PKeyID="+g+"&rowID="+f+"&rvsnTtl="+b+"&isApproved="+c)}}});e.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function modifyAutrzCrdtPrdtRqst(a,c,b){var d;var e="Are you sure you want MODIFY this AUTHORIZED DATA?";getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var g;var f=typeof $("#sbmtdPrdtID").val()==="undefined"?-1:$("#sbmtdPrdtID").val();bootbox.confirm({title:"Rhomicom Message",message:e,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(h){if(h){d=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">Preparing Data. Please Wait...</span></div>'});d.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=l/2;return m+"px"}});var j=new FormData();j.append("grp",17);j.append("typ",1);j.append("q","UPDATE");j.append("pg",a);j.append("subPgNo",c);j.append("vtyp",b);j.append("sbmtdPrdtID",f);j.append("actyp",4);$.ajax({url:"index.php",type:"POST",data:j,async:true,success:function(k){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var l="";if(/^[\],:{}\s]*$/.test(k.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){g=$.parseJSON(k);getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Credit Product",12,7.2,0,"EDIT",f,"","indCustTableRow1",-1,function(){d.modal("hide")})}else{l=k;d.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:l,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function wthdrwRjctAutrzCrdtPrdtDataRqst(d,c,e,g){var f;var h;var j=1;var a="Withdrawing.";var b="Are you sure you want to "+d+" this Change Request?";if(d=="REJECT"){a="Rejecting.";j=2}else{if(d=="AUTHORIZE"){a="Authorizing.";j=3}}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var m;var l=typeof $("#sbmtdPrdtID").val()==="undefined"?-1:$("#sbmtdPrdtID").val();var k=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();bootbox.confirm({title:"Rhomicom Message",message:b,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(n){if(n){f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">'+a+". Please Wait...</span></div>"});f.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=q/2;return r+"px"}});var o=new FormData();o.append("grp",17);o.append("typ",1);o.append("q","UPDATE");o.append("pg",c);o.append("subPgNo",e);o.append("vtyp",g);o.append("sbmtdPrdtID",l);o.append("actyp",j);o.append("rvsnTtl",k);$.ajax({url:"index.php",type:"POST",data:o,async:true,success:function(p){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var q="";if(/^[\],:{}\s]*$/.test(p.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(p);if(d=="REJECT"){q="Change Request Successfully REJECTED!"}else{if(d=="AUTHORIZE"){q="Change Request Successfully AUTHORIZED!"}else{q="Change Request successfully WITHDRAWN"}}getProductsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Savings and Investment Product",12,7.2,0,"EDIT",l,"","indCustTableRow1",-1,function(){f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})})}else{q=p;f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function saveAccountTrns_LoansMgmt(r,g,p,v,w){var y=typeof $("#trnsAmntRaw1").val()==="undefined"?0:$("#trnsAmntRaw1").val();y=Number(y.replace(/,/g,""));var L=0;var e=typeof $("#loanRpmntSrcAmnt").val()==="undefined"?0:$("#loanRpmntSrcAmnt").val();if(e==""){e=0}e=Number(e);var s;var D;var a=$("#mcfPymtCrncyNm").val();$("#oneVmsTrnsLnsTable").find("tr").each(function(P,Q){if(P>0){if(typeof $(Q).attr("id")==="undefined"){}else{var O=$(Q).attr("id").split("_")[1];s=$("#oneVmsTrnsRow_"+O+" .chqValCls").val().replace(/,/g,"");D=$("#oneVmsTrnsRow_"+O+" .chqRatesCls").val().replace(/,/g,"");L=L+(Number(s)*Number(D))}}});$("#tllrTrnsAmntTtlFld").text(a+" "+addCommas((L+y+e).toFixed(2)));$("#ttlDocAmntVal").val((L+y+e).toFixed(2));var d;$body=$("body");$body.addClass("mdlloadingDiag");var u=typeof $("#acctTrnsId").val()==="undefined"?-1:$("#acctTrnsId").val();var C=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();var m=typeof $("#docType").val()==="undefined"?"":$("#docType").val();var x=typeof $("#docNum").val()==="undefined"?"":$("#docNum").val();var z=typeof $("#trnsAmount").val()==="undefined"?0:$("#trnsAmount").val();var n=typeof $("#ttlDocAmntVal").val()==="undefined"?0:$("#ttlDocAmntVal").val();var q=typeof $("#mcfPymtCrncyNm").val()==="undefined"?"":$("#mcfPymtCrncyNm").val();var o=typeof $("#trnsDesc").val()==="undefined"?"":$("#trnsDesc").val();var F=typeof $("input[name='trnsPersonType']:checked").val()==="undefined"?"Others":$("input[name='trnsPersonType']:checked").val();var j=typeof $("#trnsPersonName").val()==="undefined"?"":$("#trnsPersonName").val();var c=typeof $("#trnsPersonTelNo").val()==="undefined"?"":$("#trnsPersonTelNo").val();var N=typeof $("#trnsPersonAddress").val()==="undefined"?"":$("#trnsPersonAddress").val();var H=typeof $("#trnsPersonIDType").val()==="undefined"?"":$("#trnsPersonIDType").val();var G=typeof $("#trnsPersonIDNumber").val()==="undefined"?"":$("#trnsPersonIDNumber").val();var A=typeof $("#loanRepayType").val()==="undefined"?"REPAYMENT":$("#loanRepayType").val();var f=typeof $("#loanRpmntSrcAcctID").val()==="undefined"?-1:$("#loanRpmntSrcAcctID").val();var B=typeof $("#disbmntHdrID").val()==="undefined"?-1:$("#disbmntHdrID").val();var K=typeof $("#disbmntDetID").val()==="undefined"?-1:$("#disbmntDetID").val();var k="";if(C==""||C==-1){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Please Provide Account First!</span></p>'}if(o==""){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Transaction Narration is required!</span></p>'}if((m=="Cheque"||m=="Voucher Slip")&&x.trim()==""){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Provide Document Number!</span></p>'}if(q.trim()==""){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Amount Currency cannot be blank!</span></p>'}if(x.trim()!=""&&m==""){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Select Document Type!</span></p>'}if(parseInt(f)<=0&&parseFloat(e)>0){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Select Cash Account Number for Loan '+A+"!</span></p>"}if(parseInt(f)>0&&(e==""||parseFloat(e)<=0)){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Enter non-zero '+A+" Amount!</span></p>"}if(v.trim()=="LOAN_PYMNT"){if(B==-1){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Select Disbursement No.!</span></p>'}if(K==-1){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Select Disbursed Loan Request!</span></p>'}}z=fmtAsNumber("trnsAmount").toFixed(2);n=fmtAsNumber("ttlDocAmntVal").toFixed(2);if(n==0){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Please provide a valid Non-Zero Value for the Total Amount Involved!</span></p>'}if(F==="Others"){if(j.trim()==""){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Person Name cannot be empty!</span></p>'}if(c.trim()==""){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Contact No. cannot be empty!</span></p>'}if(H.trim()==""){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">ID Type cannot be empty!</span></p>'}if(G.trim()==""){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">ID Number cannot be empty!</span></p>'}}var h="";var t=0;$("#acctSignatoriesTblAdd").find("tr").each(function(P,Q){if(P>0){if(typeof $(Q).attr("id")==="undefined"){}else{var O=$(Q).attr("id").split("_")[1];if(typeof $("#acctSignatoriesTblAddRow_"+O).val()==="undefined"){}else{if($("#acctSignatoriesTblAddRow_"+O).find('input[type="checkbox"]:checked').length=="1"){h=h+$("#acctSignatoriesTblAddRow"+O+"_ID").text().replace(/(~)+/g,"{-;-;}").replace(/(\|)+/g,"{:;:;}")+"|";t=t+1}}}}});if((h.trim()==""||t<=0)&&v.trim()=="WITHDRAWAL"){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Mandate for Withdrawal cannot be empty!</span></p>'}var I="";var b=0;var l=true;$("#oneVmsTrnsLnsTable").find("tr").each(function(U,P){if(U>0){if(typeof $(P).attr("id")==="undefined"){}else{var Z=$(P).attr("id").split("_")[1];if(typeof $("#oneVmsTrnsRow"+Z+"_chqNo").val()==="undefined"){}else{var Q=typeof $("#oneVmsTrnsRow"+Z+"_chqType").val()==="undefined"?"":$("#oneVmsTrnsRow"+Z+"_chqType").val();if(Q.trim()==""){l=false;$("#oneVmsTrnsRow"+Z+"_chqType").addClass("rho-error")}else{$("#oneVmsTrnsRow"+Z+"_chqType").removeClass("rho-error")}var Y=typeof $("#oneVmsTrnsRow"+Z+"_bnkID").val()==="undefined"?0:$("#oneVmsTrnsRow"+Z+"_bnkID").val();if(Y<=0){if(Q!="In-House"){l=false;$("#oneVmsTrnsRow"+Z+"_bnkID").addClass("rho-error")}}else{$("#oneVmsTrnsRow"+Z+"_bnkID").removeClass("rho-error")}var W=typeof $("#oneVmsTrnsRow"+Z+"_brnchID").val()==="undefined"?0:$("#oneVmsTrnsRow"+Z+"_brnchID").val();if(W<=0){if(Q!="In-House"){l=false;$("#oneVmsTrnsRow"+Z+"_brnchID").addClass("rho-error")}}else{$("#oneVmsTrnsRow"+Z+"_brnchID").removeClass("rho-error")}var O=typeof $("#oneVmsTrnsRow"+Z+"_chqNo").val()==="undefined"?0:$("#oneVmsTrnsRow"+Z+"_chqNo").val();if(O<=0){l=false;$("#oneVmsTrnsRow"+Z+"_chqNo").addClass("rho-error")}else{$("#oneVmsTrnsRow"+Z+"_chqNo").removeClass("rho-error")}var T=typeof $("#oneVmsTrnsRow"+Z+"_chqDte").val()==="undefined"?"":$("#oneVmsTrnsRow"+Z+"_chqDte").val();if(T==""){l=false;$("#oneVmsTrnsRow"+Z+"_chqDte").addClass("rho-error")}else{$("#oneVmsTrnsRow"+Z+"_chqDte").removeClass("rho-error")}var V=typeof $("#oneVmsTrnsRow"+Z+"_chqVal").val()==="undefined"?0:$("#oneVmsTrnsRow"+Z+"_chqVal").val();if(V<=0){l=false;$("#oneVmsTrnsRow"+Z+"_chqVal").addClass("rho-error")}else{$("#oneVmsTrnsRow"+Z+"_chqVal").removeClass("rho-error")}var R=typeof $("#oneVmsTrnsRow"+Z+"_chqValDte").val()==="undefined"?"":$("#oneVmsTrnsRow"+Z+"_chqValDte").val();if(R==""){l=false;$("#oneVmsTrnsRow"+Z+"_chqValDte").addClass("rho-error")}else{$("#oneVmsTrnsRow"+Z+"_chqValDte").removeClass("rho-error")}var X=typeof $("#oneVmsTrnsRow"+Z+"_exchngRate").val()==="undefined"?0:$("#oneVmsTrnsRow"+Z+"_exchngRate").val();if(X==0){l=false;$("#oneVmsTrnsRow"+Z+"_exchngRate").addClass("rho-error")}else{$("#oneVmsTrnsRow"+Z+"_exchngRate").removeClass("rho-error")}var S=typeof $("#oneVmsTrnsRow"+Z+"_chqCurNm").val()==="undefined"?"":$("#oneVmsTrnsRow"+Z+"_chqCurNm").val();if(S.trim()==""){l=false;$("#oneVmsTrnsRow"+Z+"_chqCurNm1").addClass("rho-error")}else{$("#oneVmsTrnsRow"+Z+"_chqCurNm1").removeClass("rho-error")}if(l===true){I=I+$("#oneVmsTrnsRow"+Z+"_TrnsLnID").val()+"~"+$("#oneVmsTrnsRow"+Z+"_chqType").val().replace(/(~)/g,"").replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#oneVmsTrnsRow"+Z+"_bnkID").val().replace(/[^-?0-9\.]/g,"").replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#oneVmsTrnsRow"+Z+"_brnchID").val().replace(/[^-?0-9\.]/g,"").replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#oneVmsTrnsRow"+Z+"_chqNo").val().replace(/[^-?0-9\.]/g,"").replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#oneVmsTrnsRow"+Z+"_chqDte").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#oneVmsTrnsRow"+Z+"_chqVal").val().replace(/[^-?0-9\.]/g,"").replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#oneVmsTrnsRow"+Z+"_chqValDte").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#oneVmsTrnsRow"+Z+"_chqCurNm").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#oneVmsTrnsRow"+Z+"_exchngRate").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";b=b+1}}}}});if(l===false&&(v.trim()=="DEPOSIT"||v.trim()=="LOAN_REPAY")){k+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Please fix all Cheque Details Errors!</span></p>'}if(rhotrim(k,"; ")!==""){$body.removeClass("mdlloadingDiag");bootbox.alert({title:"System Alert!",size:"small",message:k});return false}var M=validateAcctTrnsSignatories();if(M===false&&v.trim()=="WITHDRAWAL"){return false}$body.removeClass("mdlloadingDiag");var E="Banking Transaction";var J=bootbox.alert({title:"Save "+E,size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving '+E+"...Please Wait...</p>",callback:function(){u=typeof $("#acctTrnsId").val()==="undefined"?-1:$("#acctTrnsId").val();if(u>0){getCoreBankingForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg",v,r,g,0,"ADD",u)}}});J.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:r,q:"UPDATE",subPgNo:g,vtyp:p,acctID:C,docType:m,docNum:x,trnsAmnt:z,trnsDesc:o,acctSignatories:h,slctdTrnsChqLines:I,PKeyID:u,trnsType:v,isSelf:F,trnsPersonName:j,trnsPersonTelNo:c,trnsPersonAddress:N,trnsPersonIDType:H,trnsPersonIDNumber:G,shdSbmt:w,ttlDocAmntVal:n,mcfPymtCrncyNm:q,disbmntHdrID:B,disbmntDetID:K,loanRepayType:A,loanRpmntSrcAmnt:e,loanRpmntSrcAcctID:f},success:function(O){var R="";var Q=O;var P=-1;if(/^[\],:{}\s]*$/.test(Q.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){d=$.parseJSON(Q);P=d.acctTrnsId;R=d.sbmtMsg;if(P>0){$("#acctTrnsId").val(P)}if(R.trim()===""){R="Transaction Saved Successfully!"}}else{R=Q}setTimeout(function(){J.find(".bootbox-body").html(R)},500)},error:function(O,Q,P){console.warn(O.responseText)}})})})}function prepareMcf_del(d,f,c,e){$('[data-toggle="tooltip"]').tooltip();if(d.indexOf("&pg=1")!==-1||(d.indexOf("&pg=11")!==-1&&d.indexOf("&vtypActn=VIEW")!==-1)){prepareCustRO(d,f,c,e)}else{if(d.indexOf("&vtypActn=EDIT")!==-1){prepareCustEDT(d,f,c,e)}else{$(c).html(e);f.removeClass("mdlloading");if(d.indexOf("&pg=8&subPgNo=1.2")!==-1){var b=null;if(!$.fn.DataTable.isDataTable("#allCrncysTable")){b=$("#allCrncysTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allCrncysTable").wrap('<div class="dataTables_scroll"/>');$("#allCrncysForm").submit(function(g){g.preventDefault();return false});if(!$.fn.DataTable.isDataTable("#crncyDenomsTable")){var a=$("#crncyDenomsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#crncyDenomsTable").wrap('<div class="dataTables_scroll"/>')}$("#allCrncysTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{b.$("tr.selected").removeClass("selected");$(this).addClass("selected")}var g=$(this).attr("id").split("_")[1];var h=typeof $("#allCrncysRow"+g+"_CrncyID").val()==="undefined"?"%":$("#allCrncysRow"+g+"_CrncyID").val();getOneCrncyForm(h,1)});$("#allCrncysTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{b.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}}else{if(d.indexOf("&pg=8&subPgNo=1.3")!==-1){var b=null;if(!$.fn.DataTable.isDataTable("#allVmsCgsTable")){b=$("#allVmsCgsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allVmsCgsTable").wrap('<div class="dataTables_scroll"/>')}}else{if(d.indexOf("&pg=8&subPgNo=1.4")!==-1){var b=null;if(!$.fn.DataTable.isDataTable("#allExchRatesTable")){b=$("#allExchRatesTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allExchRatesTable").wrap('<div class="dataTables_scroll"/>');$(".mcfExRate").focus(function(){$(this).select()});$(".mcfExRate").change(function(){var g=$(this).val();$(this).val((Number(g.replace(/[^-?0-9\.]/g,"")).toFixed(15)))})}}else{if(d.indexOf("&pg=8&subPgNo=1.6")!==-1){var b=null;if(!$.fn.DataTable.isDataTable("#allBnksTable")){b=$("#allBnksTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allBnksTable").wrap('<div class="dataTables_scroll"/>');$("#allBnksForm").submit(function(g){g.preventDefault();return false});if(!$.fn.DataTable.isDataTable("#allBnkBrnchsTable")){var a=$("#allBnkBrnchsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allBnkBrnchsTable").wrap('<div class="dataTables_scroll"/>')}$("#allBnksTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{b.$("tr.selected").removeClass("selected");$(this).addClass("selected")}var g=$(this).attr("id").split("_")[1];var h=typeof $("#allBnksRow"+g+"_BankID").val()==="undefined"?"%":$("#allBnksRow"+g+"_BankID").val();getOneBankDetail(h,1)});$("#allBnksTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{b.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}}else{if(d.indexOf("&pg=4&subPgNo=4.6&subVwtyp=3")!==-1){var b=null;if(!$.fn.DataTable.isDataTable("#allRiskProfilesTable")){b=$("#allRiskProfilesTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allRiskProfilesTable").wrap('<div class="dataTables_scroll"/>')}$("#allRiskProfilesForm").submit(function(g){g.preventDefault();return false});if(!$.fn.DataTable.isDataTable("#allRiskProfileFctrsTable")){var a=$("#allRiskProfileFctrsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allRiskProfileFctrsTable").wrap('<div class="dataTables_scroll"/>')}$("#allRiskProfilesTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{b.$("tr.selected").removeClass("selected");$(this).addClass("selected")}var g=$(this).attr("id").split("_")[1];var h=typeof $("#allRiskProfilesRow"+g+"_RiskProfileID").val()==="undefined"?"%":$("#allRiskProfilesRow"+g+"_RiskProfileID").val();getOneRiskProfileDetail(h,1)});$("#allRiskProfilesTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{b.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}});$("#allOtherInputData99").val(0)}else{if(d.indexOf("&pg=4&subPgNo=4.6&subVwtyp=4")!==-1){var b=null;if(!$.fn.DataTable.isDataTable("#allAssessmentSetsTable")){b=$("#allAssessmentSetsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allAssessmentSetsTable").wrap('<div class="dataTables_scroll"/>')}$("#allAssessmentSetsForm").submit(function(g){g.preventDefault();return false});if(!$.fn.DataTable.isDataTable("#allAssessmentSetPrflsTable")){var a=$("#allAssessmentSetPrflsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allAssessmentSetPrflsTable").wrap('<div class="dataTables_scroll"/>')}$("#allAssessmentSetsTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{b.$("tr.selected").removeClass("selected");$(this).addClass("selected")}var g=$(this).attr("id").split("_")[1];var h=typeof $("#allAssessmentSetsRow"+g+"_AssessmentSetID").val()==="undefined"?"%":$("#allAssessmentSetsRow"+g+"_AssessmentSetID").val();getOneAssessmentSetDetail(h,1)});$("#allAssessmentSetsTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{b.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}});$("#allOtherInputData99").val(0)}}}}}}}}$(document).ready(function(){$("#mcfIndCstmrForm").submit(function(j){j.preventDefault();return false});$("#allVmsCgsForm").submit(function(j){j.preventDefault();return false});$("#mcfCorpCstmrForm").submit(function(j){j.preventDefault();return false});$("#mcfGrpCstmrForm").submit(function(j){j.preventDefault();return false});$("#mcfOthPCstmrForm").submit(function(j){j.preventDefault();return false});$("#mcfAcntTrnsForm").submit(function(j){j.preventDefault();return false});$("#mcfAcntOthPForm").submit(function(j){j.preventDefault();return false});$("#dataAdminForm").submit(function(j){j.preventDefault();return false});$(".form_date").datetimepicker({format:"dd-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true});var h=0;$("#trnsNtAllwdDysSlt option").each(function(){trnsNtAllwdDys[h]=$(this).val();h=h+1});var g=0;$("#trnsNtAllwdDtsSlt option").each(function(){trnsNtAllwdDys[g]=$(this).val();g=g+1})})}function getPrptyColtsForm(l,m,c,o,d,f,g,h,e,a,j,n){if(typeof n==="undefined"||n===null){n=function(){var p=1}}if(!$.fn.DataTable.isDataTable("#"+a)){var k=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{k.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{k.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+m).html(b.responseText);$("#"+l).off("hidden.bs.modal");$("#"+l).one("hidden.bs.modal",function(p){getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.7","prptyColts");$("#"+m).html("");$("#"+c).html("");$(p.currentTarget).unbind()});$("#"+c).html(o);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+l).on("show.bs.modal",function(p){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){n()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+h+"&PKeyID="+e)}function deletePrptyColt(b){var c;var a;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Property Collateral?",callback:function(e){if(e){c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;if(g=="SORRY"){$msg="SORRY! Can't Delete an Property Collateral that is in active Use.";c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}else{c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.7","prptyColts")}}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=15&subPgNo=4.7&q=DELETE&PKeyID="+b)}}});d.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function savePrptyColt(a,d,c){var e;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var h;var n=typeof $("#prptyColtId").val()==="undefined"?-1:$("#prptyColtId").val();var m=typeof $("#prptyColtNm").val()==="undefined"?"":$("#prptyColtNm").val();var j=typeof $("#prptyColtDesc").val()==="undefined"?"":$("#prptyColtDesc").val();var l=typeof $("#prptyColtType").val()==="undefined"?"":$("#prptyColtType").val();var f=typeof $("#prptyOwnerCustID").val()==="undefined"?-1:$("#prptyOwnerCustID").val();var p=typeof $("#prptyOwnerCustType").val()==="undefined"?"":$("#prptyOwnerCustType").val();var o=typeof $("#prptyValue").val()==="undefined"?0:$("#prptyValue").val().trim().length===0?0:$("#prptyValue").val();var k=typeof $("#prptyValuerSupID").val()==="undefined"?-1:$("#prptyValuerSupID").val();var q=typeof $("#prptyColtParentID").val()==="undefined"?-1:$("#prptyColtParentID").val();if(m.trim()==""||m==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Property Name/Title/Registration No.",callback:function(){}});return false}if(l.trim()==""||l==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Property Type",callback:function(){}});return false}if(f.trim()==""||f==undefined||f==-1){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Property Owner",callback:function(){}});return false}if(o.trim()==""||o==undefined||parseFloat(o)<0){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Property Value",callback:function(){}});return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});e.find(".modal-content").css({"margin-top":function(){var s=$(window).height();var r=$(".modal-dialog").height();var t=s/2;return t+"px"}});var g=new FormData();g.append("grp",17);g.append("typ",1);g.append("q","UPDATE");g.append("pg",a);g.append("subPgNo",d);g.append("vtyp",c);g.append("prptyColtId",n);g.append("prptyColtNm",m);g.append("prptyColtDesc",j);g.append("prptyColtType",l);g.append("prptyOwnerCustID",f);g.append("prptyOwnerCustType",p);g.append("prptyValue",o);g.append("prptyValuerSupID",k);g.append("prptyColtParentID",q);$.ajax({url:"index.php",type:"POST",data:g,async:true,success:function(r){var s="";if(/^[\],:{}\s]*$/.test(r.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){h=$.parseJSON(r);$("#prptyColtId").val(h.prptyColtId);e.modal("hide");getPrptyColtsForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Property Collateral",15,d,0,"EDIT",h.prptyColtId,"indCustTable","indCustTableRow1",function(){s="Property Collateral Successfully Saved!";b=bootbox.alert({size:"small",title:"Rhomicom Message",message:s,callback:function(){}})})}else{s=r;e.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:s,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function submitWithdrawPrptyColt(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var n;var m;var t;var k;var j="";var s="";$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var f=typeof $("#prptyColtId").val()==="undefined"?-1:$("#prptyColtId").val();var p=typeof $("#prptyColtNm").val()==="undefined"?"":$("#prptyColtNm").val();var h=typeof $("#prptyColtDesc").val()==="undefined"?"":$("#prptyColtDesc").val();var o=typeof $("#prptyColtType").val()==="undefined"?"":$("#prptyColtType").val();var w=typeof $("#prptyOwnerCustID").val()==="undefined"?-1:$("#prptyOwnerCustID").val();var v=typeof $("#prptyOwnerCustType").val()==="undefined"?"":$("#prptyOwnerCustType").val();var l=typeof $("#prptyValue").val()==="undefined"?0:$("#prptyValue").val().trim().length===0?0:$("#prptyValue").val();var r=typeof $("#prptyValuerSupID").val()==="undefined"?-1:$("#prptyValuerSupID").val();var g=typeof $("#prptyColtParentID").val()==="undefined"?-1:$("#prptyColtParentID").val();var e;var u="Are you sure you want to submit Property Collateral for Authorization?";if(d=="SUBMIT"){e=99;s="SUBMITTED for Authorization";j="Submitting...";if(p.trim()==""||p==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Property Name/Title/Registration No.",callback:function(){}});return false}if(o.trim()==""||o==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Property Type",callback:function(){}});return false}if(w.trim()==""||w==undefined||w==-1){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Property Owner",callback:function(){}});return false}if(l.trim()==""||l==undefined||parseFloat(l)<0){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Property Value",callback:function(){}});return false}}else{if(d=="WITHDRAW"){s="WITHDRAWN";j="Withdrawing...";e=3;u="Are you sure you want to Withdrawal Property Collateral?"}else{if(d=="REJECT"){s="REJECTED";j="Rejecting...";e=4;u="Are you sure you want to Reject Property Collateral?"}else{if(d=="AUTHORIZE"){s="AUTHORIZED";j="Authorizing...";e=5;u="Are you sure you want to Authorize Property Collateral?"}else{if(d=="REVERSE"){s="REVERSED";j="Reversing...";e=6;u="Are you sure you want to REVERSE this Property Collateral?";bootbox.alert({size:"small",title:"Rhomicom Message",message:"Constructing.......Please Wait",callback:function(){}});return false}}}}}var q=new FormData();q.append("grp",17);q.append("typ",1);q.append("pg",a);q.append("subPgNo",c);q.append("q","UPDATE");q.append("vtyp",b);q.append("actyp",e);q.append("prptyColtId",f);q.append("prptyColtNm",p);q.append("prptyColtDesc",h);q.append("prptyColtType",o);q.append("prptyOwnerCustID",w);q.append("prptyOwnerCustType",v);q.append("prptyValue",l);q.append("prptyValuerSupID",r);q.append("prptyColtParentID",g);k=bootbox.confirm({title:"Rhomicom Message",message:u,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(x){if(x){$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");m=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> '+j+" Please Wait...</div>"});m.find(".modal-content").css({"margin-top":function(){var z=$(window).height();var y=$(".modal-dialog").height();var A=(z-y)/2;return A+"px"}});$.ajax({url:"index.php",type:"POST",data:q,async:true,success:function(y){m.modal("hide");var z="";if(/^[\],:{}\s]*$/.test(y.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){getPrptyColtsForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Property Collateral",15,4.7,0,"EDIT",f,"indCustTable","indCustTableRow1",function(){t=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Property Collateral Successfully "+s,callback:function(){}})})}else{t=bootbox.alert({size:"small",title:"Rhomicom Message",message:y,callback:function(){}});return false}t.find(".modal-content").css({"margin-top":function(){var B=$(window).height();var A=$(".modal-dialog").height();var C=(B-A-150)/2;return C+"px"}})},cache:false,contentType:false,processData:false})}}})});mnBox.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function deleteSectorMajor(b){var c;var a;var d;d=bootbox.confirm({size:"small",title:"Delete Major Sector?",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">DELETE</span> this Major Sector?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(e){if(e){c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;if(g=="SORRY"){$msg="SORRY! Can't Delete an Major Sector that is in active Use.";c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}else{c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getAllSectorMajors("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.8")}}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=15&subPgNo=4.8&q=DELETE&PKeyID="+b)}}});d.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function saveSectorMajor(a,d,e,c){var f;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var m;var h=typeof $("#oneSectorMajorDetID").val()==="undefined"?"-1":$("#oneSectorMajorDetID").val();var g=typeof $("#oneSectorMajorDetName").val()==="undefined"?"":$("#oneSectorMajorDetName").val();var k=typeof $("#oneSectorMajorDetDesc").val()==="undefined"?"":$("#oneSectorMajorDetDesc").val();var j=typeof $("#oneSectorMajorDetIsEnbld").val()==="undefined"?"Yes":$("#oneSectorMajorDetIsEnbld").val();if(g.trim()==""||g==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Major Sector Name",callback:function(){}});return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});f.find(".modal-content").css({"margin-top":function(){var o=$(window).height();var n=$(".modal-dialog").height();var p=o/2;return p+"px"}});var l=new FormData();l.append("grp",17);l.append("typ",1);l.append("q","UPDATE");l.append("pg",15);l.append("subPgNo",d);l.append("vtyp",c);l.append("sectorMajorId",h);l.append("sectorName",g);l.append("sectorDesc",k);l.append("isEnabled",j);$.ajax({url:"index.php",type:"POST",data:l,async:true,success:function(n){var o="";if(/^[\],:{}\s]*$/.test(n.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(n);f.modal("hide");getAllSectorMajors("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.8");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Major Sector Saved Successfully",callback:function(){}})}else{o=n;f.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:o,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function getOneSectorMajorDetail(b,c){var a="grp=17&typ=1&pg=4&subPgNo=4.81&vtyp=0&sbmtdSectorMajorID="+b;doAjaxWthCallBck(a,"allSectorMajorsDetailInfo","PasteDirect","","","",function(){$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip();var d=$("#allSectorMinorTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allSectorMinorTable").wrap('<div class="dataTables_scroll"/>')})})}function getAllSectorMajors(d,a,j){var c=typeof $("#allSectorMajorsSrchFor").val()==="undefined"?"%":$("#allSectorMajorsSrchFor").val();var h=typeof $("#allSectorMajorsSrchIn").val()==="undefined"?"Both":$("#allSectorMajorsSrchIn").val();var b=typeof $("#allSectorMajorsPageNo").val()==="undefined"?1:$("#allSectorMajorsPageNo").val();var f=typeof $("#allSectorMajorsDsplySze").val()==="undefined"?10:$("#allSectorMajorsDsplySze").val();var g=typeof $("#allSectorMajorsSortBy").val()==="undefined"?"":$("#allSectorMajorsSortBy").val();var e=typeof $("#allSectorMajorsIsEnabled").val()==="undefined"?"":$("#allSectorMajorsIsEnabled").val();if(d=="clear"){c="%";b=1}else{if(d=="next"){b=parseInt(b)+1}else{if(d=="previous"){b=parseInt(b)-1}}}j=j+"&searchfor="+c+"&searchin="+h+"&pageNo="+b+"&limitSze="+f+"&sortBy="+g+"&isEnabled="+e;openATab(a,j)}function enterKeyFuncAllSectorMajors(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllSectorMajors(b,f,d)}}function getAllSectorMinor(d,h,e){var c=typeof $("#allSectorMinorSrchFor").val()==="undefined"?"%":$("#allSectorMinorSrchFor").val();var b=typeof $("#allSectorMinorSrchIn").val()==="undefined"?"Both":$("#allSectorMinorSrchIn").val();var a=typeof $("#allSectorMinorPageNo").val()==="undefined"?1:$("#allSectorMinorPageNo").val();var g=typeof $("#allSectorMinorDsplySze").val()==="undefined"?10:$("#allSectorMinorDsplySze").val();var f=typeof $("#allSectorMinorSortBy").val()==="undefined"?"":$("#allSectorMinorSortBy").val();if(d=="clear"){c="%";a=1}else{if(d=="next"){a=parseInt(a)+1}else{if(d=="previous"){a=parseInt(a)-1}}}e=e+"&searchfor="+c+"&searchin="+b+"&pageNo="+a+"&limitSze="+g+"&sortBy="+f;openATab(h,e)}function enterKeyFuncAllSectorMinor(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllSectorMinor(b,f,d)}}function getOneSectorMajorForm(b,c){var a="grp=17&typ=1&pg=4&subPgNo=4.81&vtyp="+c+"&sbmtdSectorMajorID="+b;doAjaxWthCallBck(a,"allSectorMajorsDetailInfo","PasteDirect","","","",function(){var d=$("#allSectorMinorTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allSectorMinorTable").wrap('<div class="dataTables_scroll"/>')});$("#allSectorMajorsForm").submit(function(d){d.preventDefault();return false})}function saveSectorMinor(){var c=typeof $("#sbmtdSectorMajorID").val()==="undefined"?"-1":$("#sbmtdSectorMajorID").val();var a="";var e=0;var d=0;var f=0;$("#allSectorMinorTable").find("tr").each(function(h,j){if(h>0){if(typeof $(j).attr("id")==="undefined"){}else{var g=$(j).attr("id").split("_")[1];if(typeof $("#allSectorMinorRow"+g+"_MinorSectorNm").val()==="undefined"){}else{if($("#allSectorMinorRow"+g+"_MinorSectorNm").val()==""){$("#allSectorMinorRow"+g+"_MinorSectorNm").css("border-color","red");$("#allSectorMinorRow"+g+"_MinorSectorNm").css("border-width","2px");e=e+1}else{$("#allSectorMinorRow"+g+"_MinorSectorNm").css("border-color","#ccc");$("#allSectorMinorRow"+g+"_MinorSectorNm").css("border-width","1px")}if($("#allSectorMinorRow"+g+"_MinorSectorDesc").val()==""){$("#allSectorMinorRow"+g+"_MinorSectorDesc").css("border-color","red");$("#allSectorMinorRow"+g+"_MinorSectorDesc").css("border-width","2px");e=e+1}else{$("#allSectorMinorRow"+g+"_MinorSectorDesc").css("border-color","#ccc");$("#allSectorMinorRow"+g+"_MinorSectorDesc").css("border-width","1px")}if(e<=0){a=a+$("#allSectorMinorRow"+g+"_MinorSectorID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allSectorMinorRow"+g+"_MinorSectorNm").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allSectorMinorRow"+g+"_MinorSectorDesc").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allSectorMinorRow"+g+"_isEnabledNm").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";d=d+1}}}}});if(e>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted Minor Sector record</i></b></span>",callback:function(){}});return false}else{if(d<=0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please provide at lease One Minor Sector record</i></b></span>",callback:function(){}});return false}}var b=bootbox.alert({title:"Save Minor Sectors?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving Minor Sector...Please Wait...</p>',callback:function(){getAllSectorMajors("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.8")}});b.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"UPDATE",subPgNo:4.8,actyp:1,sbmtdSectorMajorID:c,slctdSectorMinor:a},success:function(g){setTimeout(function(){b.find(".bootbox-body").html(g)},500)},error:function(g,j,h){console.warn(g.responseText)}})})})}function delSectorMinor(d){var a=d.split("_")[1];var c=-1;var e="";if(typeof $("#allSectorMinorRow"+a+"_MinorSectorID").val()==="undefined"){}else{c=$("#allSectorMinorRow"+a+"_MinorSectorID").val();e=$("#allSectorMinorRow"+a+"_MinorSectorID").val()}var b=bootbox.confirm({title:"Remove Minor Sector?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this Minor Sector?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Remove Minor Sector?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing Minor Sector...Please Wait...</p>',callback:function(){getAllSectorMajors("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.8")}});g.init(function(){if(c>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"DELETE",subPgNo:4.8,actyp:1,MinorSectorNm:e,PKeyID:c},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h);if(h.indexOf("Success")!==-1){$("#"+d).remove()}},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){$("#"+d).remove();g.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function getMnlSvngsIntrstPymntForm(l,m,c,o,d,f,g,h,e,a,j,n){if(typeof n==="undefined"||n===null){n=function(){var p=1}}if(!$.fn.DataTable.isDataTable("#"+a)){var k=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{k.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{k.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+m).html(b.responseText);$("#"+l).off("hidden.bs.modal");$("#"+l).one("hidden.bs.modal",function(p){getCustData("clear","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.2","mnlSvngsIntrstPymnt");$("#"+m).html("");$("#"+c).html("");$(p.currentTarget).unbind()});$("#"+c).html(o);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+l).on("show.bs.modal",function(p){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){n()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+h+"&PKeyID="+e)}function deleteMnlSvngsIntrstPymnt(e){var c=typeof $("#mnlpymntSvngsHdrStatus").val()==="undefined"?-1:$("#mnlpymntSvngsHdrStatus").val();if(c=="Unauthorized, Unprocessed"||c=="Authorized, Processed"){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red; font-weight:bold !important;'>Sorry! Cannot delete Batch with the following statuses:</br>i) Unauthorized, Unprocessed</br>ii) Authorized, Unprocessed</span>",callback:function(){}});return false}var b;var a;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Batch?",callback:function(f){if(f){b=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});b.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j)/2;return l+"px"}});var g;if(window.XMLHttpRequest){g=new XMLHttpRequest()}else{g=new ActiveXObject("Microsoft.XMLHTTP")}g.onreadystatechange=function(){if(g.readyState===4&&g.status===200){var h=g.responseText;if(h=="SORRY"){$msg="<span style='color:red; font-weight:bold !important;'>Sorry! Cannot delete Batch with the following statuses:</br>i) Unauthorized, Unprocessed</br>ii) Authorized, Unprocessed</span>";b.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}else{b.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:h,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.2","mnlSvngsIntrstPymnt")}}};g.open("POST","index.php",true);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send("grp=17&typ=1&pg=13&subPgNo=2.2&q=DELETE&PKeyID="+e)}}});d.find(".modal-content").css({"margin-top":function(){var g=$(window).height();var f=$(".modal-dialog").height();var j=(g-f-150)/2;return j+"px"}})}function saveMnlSvngsIntrstPymnt(a,d,c){var e;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var j;var l=typeof $("#mnlpymntSvngsHdrId").val()==="undefined"?-1:$("#mnlpymntSvngsHdrId").val();var k=typeof $("#mnlpymntSvngsHdrDesc").val()==="undefined"?"":$("#mnlpymntSvngsHdrDesc").val();var g=typeof $("#currencyNm").val()==="undefined"?-1:$("#currencyNm").val();var f=typeof $("#branchID").val()==="undefined"?-1:$("#branchID").val();if(k.trim()==""||k==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a Description",callback:function(){}});return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});e.find(".modal-content").css({"margin-top":function(){var n=$(window).height();var m=$(".modal-dialog").height();var o=n/2;return o+"px"}});var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("q","UPDATE");h.append("pg",a);h.append("subPgNo",d);h.append("vtyp",c);h.append("mnlpymntSvngsHdrId",l);h.append("mnlpymntSvngsHdrDesc",k);h.append("currencyNm",g);h.append("branchID",f);$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(m){var n="";if(/^[\],:{}\s]*$/.test(m.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=$.parseJSON(m);$("#mnlpymntSvngsHdrId").val(j.mnlpymntSvngsHdrId);e.modal("hide");getMnlSvngsIntrstPymntForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Batch",13,d,0,"EDIT",j.mnlpymntSvngsHdrId,"indCustTable","indCustTableRow1",function(){n="Batch Successfully Saved!";b=bootbox.alert({size:"small",title:"Rhomicom Message",message:n,callback:function(){}})})}else{n=m;e.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:n,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function processMnlSvngsIntrstPymnt(){var d=typeof $("#mnlpymntSvngsHdrStatus").val()==="undefined"?-1:$("#mnlpymntSvngsHdrStatus").val();var g=typeof $("#mnlpymntSvngsHdrId").val()==="undefined"?-1:$("#mnlpymntSvngsHdrId").val();var f=typeof $("#currencyNm").val()==="undefined"?-1:$("#currencyNm").val();var b=typeof $("#branchID").val()==="undefined"?-1:$("#branchID").val();var c;var a;var e;e=bootbox.confirm({size:"small",message:"Are you sure you want to process this Batch and Credit Interest?</br>Please Note: This action cannot be undone if you select 'Yes'",callback:function(h){if(h){c=bootbox.alert({title:"Processing.....",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Processesing...Please Wait...</div>',callback:function(){}});c.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k-150)/2;return m+"px"}});var j;if(window.XMLHttpRequest){j=new XMLHttpRequest()}else{j=new ActiveXObject("Microsoft.XMLHTTP")}j.onreadystatechange=function(){var k;if(j.readyState===4&&j.status===200){k=j.responseText;if(k!="SUCCESS"){$msg="<span style='color:red; font-weight:bold !important;'>Sorry! Failed to process Batch</br>"+k+"</span>";c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l-150)/2;return n+"px"}})}else{if(k=="SUCCESS"){getMnlSvngsIntrstPymntForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Batch",13,2.2,0,"EDIT",g,"indCustTable","indCustTableRow1",function(){c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Payment Batch Completed Successfully",callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l-150)/2;return n+"px"}})})}}}};j.open("POST","index.php",true);j.setRequestHeader("Content-type","application/x-www-form-urlencoded");j.send("grp=17&typ=1&pg=13&subPgNo=2.2&q=UPDATE&actyp=1&mnlpymntSvngsHdrId="+g+"&currencyNm="+f+"&branchID="+b)}}});e.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function submitWithdrawMnlSvngsIntrstPymnt(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var k;var l;var p;var j;var g="";var n="";$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var e=typeof $("#mnlpymntSvngsHdrId").val()==="undefined"?-1:$("#mnlpymntSvngsHdrId").val();var o=typeof $("#mnlpymntSvngsHdrDesc").val()==="undefined"?"":$("#mnlpymntSvngsHdrDesc").val();var q=typeof $("#currencyNm").val()==="undefined"?-1:$("#currencyNm").val();var r=typeof $("#branchID").val()==="undefined"?-1:$("#branchID").val();var m;var f="Are you sure you want to submit Interest Batch for Authorization?";if(d=="SUBMIT"){m=99;n="SUBMITTED for Authorization";g="Submitting...";if(o.trim()==""||o==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a Description",callback:function(){}});return false}}else{if(d=="WITHDRAW"){n="WITHDRAWN";g="Withdrawing...";m=3;f="Are you sure you want to Withdrawal Payment Batch?"}else{if(d=="REJECT"){n="REJECTED";g="Rejecting...";m=4;f="Are you sure you want to Reject Payment Batch?"}else{if(d=="AUTHORIZE"){n="AUTHORIZED";g="Authorizing...";m=5;f="Are you sure you want to Authorize Payment Batch?"}else{if(d=="REVERSE"){n="REVERSED";g="Reversing...";m=6;f="Are you sure you want to REVERSE this Payment Batch?";bootbox.alert({size:"small",title:"Rhomicom Message",message:"Constructing.......Please Wait",callback:function(){}});return false}}}}}var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("pg",a);h.append("subPgNo",c);h.append("q","UPDATE");h.append("vtyp",b);h.append("actyp",m);h.append("mnlpymntSvngsHdrId",e);h.append("mnlpymntSvngsHdrDesc",o);h.append("currencyNm",q);h.append("branchID",r);j=bootbox.confirm({title:"Rhomicom Message",message:f,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(s){if(s){$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");l=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> '+g+" Please Wait...</div>"});l.find(".modal-content").css({"margin-top":function(){var u=$(window).height();var t=$(".modal-dialog").height();var v=(u-t)/2;return v+"px"}});$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(t){l.modal("hide");var u="";if(/^[\],:{}\s]*$/.test(t.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){getMnlSvngsIntrstPymntForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Batch",13,2.2,0,"EDIT",e,"indCustTable","indCustTableRow1",function(){p=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Batch Successfully "+n,callback:function(){}})})}else{p=bootbox.alert({size:"small",title:"Rhomicom Message",message:t,callback:function(){}});return false}p.find(".modal-content").css({"margin-top":function(){var x=$(window).height();var v=$(".modal-dialog").height();var y=(x-v-150)/2;return y+"px"}})},cache:false,contentType:false,processData:false})}}})});mnBox.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function processMnlSvngsIntrstPymnt_WIP(){var d=typeof $("#mnlpymntSvngsHdrStatus").val()==="undefined"?-1:$("#mnlpymntSvngsHdrStatus").val();var g=typeof $("#mnlpymntSvngsHdrId").val()==="undefined"?-1:$("#mnlpymntSvngsHdrId").val();var f=typeof $("#currencyNm").val()==="undefined"?-1:$("#currencyNm").val();var b=typeof $("#branchID").val()==="undefined"?-1:$("#branchID").val();var c;var a;var e;e=bootbox.confirm({size:"small",message:"Are you sure you want to process this Batch and Credit Interest?</br>Please Note: This action cannot be undone if you select 'Yes'",callback:function(h){if(h){c=bootbox.alert({title:"Processing.....",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Processesing...Please Wait...</div>',callback:function(){}});c.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k-150)/2;return m+"px"}});var j;if(window.XMLHttpRequest){j=new XMLHttpRequest()}else{j=new ActiveXObject("Microsoft.XMLHTTP")}j.onreadystatechange=function(){var k;if(j.readyState===4&&j.status===200){k=j.responseText;if(k=="SORRY"){$msg="<span style='color:red; font-weight:bold !important;'>Sorry! Cannot delete Batch with the following statuses:</br>i) Unauthorized, Unprocessed</br>ii) Authorized, Unprocessed</span>";c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l-150)/2;return n+"px"}})}else{if(k>=91){c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:k,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l-150)/2;return n+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.2","mnlSvngsIntrstPymnt")}}}else{setTimeout("sendRequest()",500)}};j.open("POST","index.php",true);j.setRequestHeader("Content-type","application/x-www-form-urlencoded");j.send("grp=17&typ=1&pg=13&subPgNo=2.2&q=UPDATE&actyp=1&mnlpymntSvngsHdrId="+g+"&currencyNm="+f+"&branchID="+b)}}});e.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function unfreezeDialog(){var a=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Form Refresh Successfully!"})}function createRequestObject(){var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}return a}function sendRequest(){var a=createRequestObject();var b=typeof $("#prgrs").val()==="undefined"?0:$("#prgrs").val();a.open("POST","index.php",true);a.onreadystatechange=function(){handleResponse(a)};a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg=13&subPgNo=2.2&q=UPDATE&actyp=2&mnlpymntSvngsHdrId="+mnlpymntSvngsHdrId+"&currencyNm="+currencyNm+"&branchID="+branchID+"&prgrs="+b)}function handleResponse(b){var a;var e=typeof $("#mnlpymntSvngsHdrId").val()==="undefined"?-1:$("#mnlpymntSvngsHdrId").val();if(b.readyState<=4){a=b.responseText;var c=document.getElementById("myBar1");if(a<101){$("#prgrs").val(a);if(a==100){bootbox.hideAll();var d="Batch Successfully Processed!";box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:d,callback:function(){getMnlSvngsIntrstPymntForm("myFormsModalx","myFormsModalxBody","myFormsModalxTitle","Edit Batch",13,2.2,0,"EDIT",e,"indCustTable","indCustTableRow1")}})}else{c.style.width=a+"%";setTimeout("sendRequest()",500)}}}}function blockCloseReopenAccnts(a){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var g;var c=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();var b=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();var f=typeof $("#closeReason").val()==="undefined"?-1:$("#closeReason").val();$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var d="BLOCKED";var h="Are you sure you want to BLOCK this Account?";if(a==2){d="UNBLOCKED";h="Are you sure you want to UNBLOCK this Account?"}else{if(a==3){d="CLOSED";h="Are you sure you want to CLOSE this Account?"}else{if(a==4){d="RE-OPENED";h="Are you sure you want to RE-OPEN this Account?"}}}if(f.trim()===""){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#closeReason").css("border-color","red");$("#closeReason").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Provide a reason for this transaction in the Comments field",callback:function(){}});return false}$("#closeReason").css("border-color","#ccc");$("#closeReason").css("border-width","1px");var e=new FormData();e.append("grp",17);e.append("typ",1);e.append("pg",13);e.append("subPgNo",2.1);e.append("q","UPDATE");e.append("vtyp",a);e.append("acctID",c);e.append("closeReason",f);e.append("rvsnTtl",b);bootbox.confirm({title:"Rhomicom Message",message:h,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(j){if(j){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:e,async:true,success:function(k){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var l="";if(/^[\],:{}\s]*$/.test(k.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){g=$.parseJSON(k);c=g.acctID;getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","Edit Customer Account",13,2.1,0,"EDIT",c,"custAcctTable","indCustTableRow1",-1,function(){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Account has been "+d+"</br><b>Please submit for AUTHORIZATION</b>",callback:function(){}})})}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:k,callback:function(){}});return false}},cache:false,contentType:false,processData:false})}}})})}function dsplyPrdtForm(){var a=typeof $("#prdtTypeID").val()==="undefined"?-1:$("#prdtTypeID").val();if(parseInt(a)<=0){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Select a Product First",callback:function(){}});return false}getProductsForm("myFormsModalLgCA","myFormsModalBodyLgCA","myFormsModalTitleLgCA","Edit Savings and Investment Product",12,7.1,0,"VIEW",a,"","indCustTableRow1")}function dsplyAllBankCustsLov2(){var b=typeof $("#gnrlOrgID").val()==="undefined"?-1:$("#gnrlOrgID").val();var a=typeof $("#branchSrchIn").val()==="undefined"?"All Branhes":$("#branchSrchIn").val();if(a=="All Branches"){a=""}else{a="branchSrchIn"}getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","MCF All Customer Accounts","gnrlOrgID",a,"","radio",true,"","acctNoFindAccId","acctNoFindRawTxt","clear",1,"",function(){$("#acctNoFind").val($("#acctNoFindRawTxt").val().split(" [")[0]);getAccountStatement2("","#allmodules",2,2.3)})}function dsplyAllBankCustsLov(){var b=typeof $("#gnrlOrgID").val()==="undefined"?-1:$("#gnrlOrgID").val();var a=typeof $("#branchSrchIn").val()==="undefined"?"All Branhes":$("#branchSrchIn").val();if(a=="All Branches"){a=""}else{a="branchSrchIn"}getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","MCF All Customer Accounts","gnrlOrgID",a,"","radio",true,"","acctNoFindAccId","acctNoFindRawTxt","clear",1,"",function(){$("#acctNoFind").val($("#acctNoFindRawTxt").val().split(" [")[0])})}function getAccountStatement2(g,a,d,f){var b=$("#acctNoFind").val();if(b.trim()==""){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Enter Account Number!",callback:function(){}});return}var e=typeof $("#pageNoAH").val()==="undefined"?1:$("#pageNoAH").val();var j=typeof $("#DsplySze").val()==="undefined"?10:$("#DsplySze").val();var k=typeof $("#SortBy").val()==="undefined"?"":$("#SortBy").val();var c=typeof $("#StrtDate").val()==="undefined"?"":$("#StrtDate").val();var h=typeof $("#EndDate").val()==="undefined"?"":$("#EndDate").val();if(g=="clear"){srchFor="%";e=1}else{if(g=="next"){e=parseInt(e)+1}else{if(g=="previous"){e=parseInt(e)-1}}}linkArgs="grp=17&typ=1&pg="+d+"&subPgNo="+f+"&pageNoAH="+e+"&limitSze="+j+"&sortBy="+k+"&qStrtDte="+c+"&qEndDte="+h+"&acctNoFind="+b;$body=$("body");openATab(a,linkArgs)}function getAccountStatement(e,a,j){var b=$("#acctNoFind").val();if(b.trim()==""){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Enter Account Number!",callback:function(){}});return}var d=typeof $("#pageNoAH").val()==="undefined"?1:$("#pageNoAH").val();var g=typeof $("#DsplySze").val()==="undefined"?10:$("#DsplySze").val();var h=typeof $("#SortBy").val()==="undefined"?"":$("#SortBy").val();var c=typeof $("#StrtDate").val()==="undefined"?"":$("#StrtDate").val();var f=typeof $("#EndDate").val()==="undefined"?"":$("#EndDate").val();if(e=="clear"){srchFor="%";d=1}else{if(e=="next"){d=parseInt(d)+1}else{if(e=="previous"){d=parseInt(d)-1}}}j=j+"&pageNoAH="+d+"&limitSze="+g+"&sortBy="+h+"&qStrtDte="+c+"&qEndDte="+f+"&acctNoFind="+b;$body=$("body");openATab(a,j)}function getLoanWriteOffForm(l,m,c,o,d,f,g,h,e,a,j,n){if(typeof n==="undefined"||n===null){n=function(){var p=1}}if(!$.fn.DataTable.isDataTable("#"+a)){var k=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{k.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{k.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+m).html(b.responseText);$("#"+l).off("hidden.bs.modal");$("#"+l).one("hidden.bs.modal",function(p){getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.9","loanWriteOffs");$("#"+m).html("");$("#"+c).html("");$(p.currentTarget).unbind()});$("#"+c).html(o);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+l).on("show.bs.modal",function(p){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){n()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+h+"&PKeyID="+e)}function deleteLoanWriteOff(a){var c;var b;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Loan Write-Off?",callback:function(e){if(e){c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;if(g=="SORRY"){$msg="SORRY! Can't Delete an Loan Write-Off that is in active Use.";c.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});b.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}else{c.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});b.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.9","loanWriteOffs")}}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=15&subPgNo=4.9&q=DELETE&PKeyID="+a)}}});d.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function saveLoanWriteOff(a,d,c){var e;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var k;var h=typeof $("#loanWriteOffId").val()==="undefined"?-1:$("#loanWriteOffId").val();var n=typeof $("#loanWriteOffTrnsDte").val()==="undefined"?"":$("#loanWriteOffTrnsDte").val();var g=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var m=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();var f=typeof $("#loanWriteOffReason").val()==="undefined"?"":$("#loanWriteOffReason").val();var l=typeof $("#loanWriteOffAmount").val()==="undefined"?0:$("#loanWriteOffAmount").val();if(parseInt(m)<=0||m==-1||m==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Loan Request",callback:function(){}});return false}if(f.trim()==""||f==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Write-Off Reason",callback:function(){}});return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});e.find(".modal-content").css({"margin-top":function(){var p=$(window).height();var o=$(".modal-dialog").height();var q=p/2;return q+"px"}});var j=new FormData();j.append("grp",17);j.append("typ",1);j.append("q","UPDATE");j.append("pg",a);j.append("subPgNo",d);j.append("vtyp",c);j.append("loanWriteOffId",h);j.append("loanWriteOffTrnsDte",n);j.append("bnkBranchID",g);j.append("loanRqstID",m);j.append("loanWriteOffReason",f);$.ajax({url:"index.php",type:"POST",data:j,async:true,success:function(o){var p="";if(/^[\],:{}\s]*$/.test(o.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){k=$.parseJSON(o);$("#loanWriteOffId").val(k.loanWriteOffId);e.modal("hide");getLoanWriteOffForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Loan Write-Off",15,d,0,"EDIT",k.loanWriteOffId,"indCustTable","indCustTableRow1",function(){p="Loan Write-Off Successfully Saved!";b=bootbox.alert({size:"small",title:"Rhomicom Message",message:p,callback:function(){}})})}else{p=o;e.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:p,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function submitWithdrawLoanWriteOff(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var n;var p;var s;var m;var g="";var r="";$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var e=typeof $("#loanWriteOffId").val()==="undefined"?-1:$("#loanWriteOffId").val();var o=typeof $("#loanWriteOffTrnsDte").val()==="undefined"?"":$("#loanWriteOffTrnsDte").val();var l=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var t=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();var k=typeof $("#loanWriteOffReason").val()==="undefined"?"":$("#loanWriteOffReason").val();var j=typeof $("#loanWriteOffAmount").val()==="undefined"?0:$("#loanWriteOffAmount").val();var q;var f="Are you sure you want to submit Loan Write-Off for Authorization?";if(d=="SUBMIT"){q=99;r="SUBMITTED for Authorization";g="Submitting...";if(parseInt(t)<=0||t==-1||t==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Loan Request",callback:function(){}});return false}if(k.trim()==""||k==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Write-Off Reason",callback:function(){}});return false}if(j.trim()==""||j==undefined||j.trim()==0){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Loan Request with a positive Balance",callback:function(){}});return false}}else{if(d=="WITHDRAW"){r="WITHDRAWN";g="Withdrawing...";q=3;f="Are you sure you want to Withdrawal Loan Write-Off?"}else{if(d=="REJECT"){r="REJECTED";g="Rejecting...";q=4;f="Are you sure you want to Reject Loan Write-Off?"}else{if(d=="AUTHORIZE"){r="AUTHORIZED";g="Authorizing...";q=5;f="Are you sure you want to Authorize Loan Write-Off?"}else{if(d=="REVERSE"){r="REVERSED";g="Reversing...";q=6;f="Are you sure you want to REVERSE this Loan Write-Off?";bootbox.alert({size:"small",title:"Rhomicom Message",message:"Constructing.......Please Wait",callback:function(){}});return false}}}}}var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("pg",a);h.append("subPgNo",c);h.append("q","UPDATE");h.append("vtyp",b);h.append("actyp",q);h.append("loanWriteOffId",e);h.append("loanWriteOffTrnsDte",o);h.append("bnkBranchID",l);h.append("loanRqstID",t);h.append("loanWriteOffReason",k);h.append("loanWriteOffAmount",j);m=bootbox.confirm({title:"Rhomicom Message",message:f,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(u){if(u){$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");p=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> '+g+" Please Wait...</div>"});p.find(".modal-content").css({"margin-top":function(){var x=$(window).height();var v=$(".modal-dialog").height();var y=(x-v)/2;return y+"px"}});$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(v){p.modal("hide");var w="";if(/^[\],:{}\s]*$/.test(v.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){getLoanWriteOffForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Loan Write-Off",15,4.9,0,"EDIT",e,"indCustTable","indCustTableRow1",function(){s=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Loan Write-Off Successfully "+r,callback:function(){}})})}else{s=bootbox.alert({size:"small",title:"Rhomicom Message",message:v,callback:function(){}});return false}s.find(".modal-content").css({"margin-top":function(){var y=$(window).height();var x=$(".modal-dialog").height();var z=(y-x-150)/2;return z+"px"}})},cache:false,contentType:false,processData:false})}}})});mnBox.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function processLoanWriteOff(b){var f=typeof $("#loanWriteOffId").val()==="undefined"?-1:$("#loanWriteOffId").val();var c;var a;var e;var d="PROCESS";if(b==1){d="VOID"}e=bootbox.confirm({size:"small",message:"Are you sure you want to "+d+" this Loan Write-Off?</br>Please Note: This action cannot be undone if you select 'Yes'",callback:function(g){if(g){c=bootbox.alert({title:"Processing........",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Processesing...Please Wait...</div>',callback:function(){}});c.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});var h;if(window.XMLHttpRequest){h=new XMLHttpRequest()}else{h=new ActiveXObject("Microsoft.XMLHTTP")}h.onreadystatechange=function(){var j;if(h.readyState===4&&h.status===200){j=h.responseText;getLoanWriteOffForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Loan Write-Off",15,4.9,0,"EDIT",f,"indCustTable","indCustTableRow1",function(){c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:j,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k-150)/2;return m+"px"}})})}};h.open("POST","index.php",true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send("grp=17&typ=1&pg=15&subPgNo=4.9&q=UPDATE&actyp=1&loanWriteOffId="+f+"&prcsOptn="+b)}}});e.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g-150)/2;return k+"px"}})}function getAllLoanClsfctns(d,h,e){var c=typeof $("#allLoanClsfctnsSrchFor").val()==="undefined"?"%":$("#allLoanClsfctnsSrchFor").val();var b=typeof $("#allLoanClsfctnsSrchIn").val()==="undefined"?"Both":$("#allLoanClsfctnsSrchIn").val();var a=typeof $("#allLoanClsfctnsPageNo").val()==="undefined"?1:$("#allLoanClsfctnsPageNo").val();var g=typeof $("#allLoanClsfctnsDsplySze").val()==="undefined"?10:$("#allLoanClsfctnsDsplySze").val();var f=typeof $("#allLoanClsfctnsSortBy").val()==="undefined"?"":$("#allLoanClsfctnsSortBy").val();if(d=="clear"){c="%";a=1}else{if(d=="next"){a=parseInt(a)+1}else{if(d=="previous"){a=parseInt(a)-1}}}e=e+"&searchfor="+c+"&searchin="+b+"&pageNo="+a+"&limitSze="+g+"&sortBy="+f;openATab(h,e)}function enterKeyFuncAllLoanClsfctns(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllLoanClsfctns(b,f,d)}}function delLoanClsfctns(d){var a=d.split("_")[1];var c=-1;var e="Loan Classification";if(typeof $("#allLoanClsfctnsRow"+a+"_PkeyID").val()==="undefined"){}else{c=$("#allLoanClsfctnsRow"+a+"_PkeyID").val()}var b=bootbox.confirm({title:"Remove "+e+"?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this '+e+"?<br/>Action cannot be Undone!</p>",buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Remove "+e+"?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing '+e+"...Please Wait...</p>"});g.init(function(){if(c>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:8,q:"DELETECONF",subPgNo:"1.9",actyp:11,pKeyID:c},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h);if(h.indexOf("Success")!==-1){$("#"+d).remove()}},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){$("#"+d).remove();g.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function saveLoanClsfctns(g,f){var e="Loan Classifications";var d="";var a=true;var c="";$("#allLoanClsfctnsTable").find("tr").each(function(m,j){if(m>0){if(typeof $(j).attr("id")==="undefined"){}else{var q=$(j).attr("id").split("_")[1];var n=$("#allLoanClsfctnsRow"+q+"_PkeyID").val();var k=$("#allLoanClsfctnsRow"+q+"_ClsfctnNm").val();if(k.trim()===""){a=false;c+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Name for Column No. '+m+" cannot be empty!</span></p>";$("#allLoanClsfctnsRow"+q+"_ClsfctnNm").addClass("rho-error")}else{$("#allLoanClsfctnsRow"+q+"_ClsfctnNm").removeClass("rho-error")}var l=$("#allLoanClsfctnsRow"+q+"_RangeLow").val();if(l.trim()===""){a=false;c+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Range Low for Column No. '+m+" cannot be empty!</span></p>";$("#allLoanClsfctnsRow"+q+"_RangeLow").addClass("rho-error")}else{$("#allLoanClsfctnsRow"+q+"_RangeLow").removeClass("rho-error")}var h=$("#allLoanClsfctnsRow"+q+"_RangeHigh").val();if(h.trim()===""){a=false;c+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Range High for Column No. '+m+" cannot be empty!</span></p>";$("#allLoanClsfctnsRow"+q+"_RangeHigh").addClass("rho-error")}else{$("#allLoanClsfctnsRow"+q+"_RangeHigh").removeClass("rho-error")}var o=$("#allLoanClsfctnsRow"+q+"_PrvsnPrcnt").val();if(o.trim()===""){a=false;c+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Provision percentage for Column No. '+m+" cannot be empty!</span></p>";$("#allLoanClsfctnsRow"+q+"_PrvsnPrcnt").addClass("rho-error")}else{$("#allLoanClsfctnsRow"+q+"_PrvsnPrcnt").removeClass("rho-error")}if(parseFloat(h)<parseFloat(l)){a=false;c+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Range High for Column No. '+m+" cannot be greater than Range High!</span></p>";$("#allLoanClsfctnsRow"+q+"_RangeLow").addClass("rho-error");$("#allLoanClsfctnsRow"+q+"_RangeHigh").addClass("rho-error")}else{}if(a===false){}else{$("#allLoanClsfctnsRow"+q+"_RangeLow").removeClass("rho-error");$("#allLoanClsfctnsRow"+q+"_RangeHigh").removeClass("rho-error");var p=typeof $("input[name='allLoanClsfctnsRow"+q+"_IsEnbld']:checked").val()==="undefined"?"NO":"YES";d=d+$("#allLoanClsfctnsRow"+q+"_PkeyID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLoanClsfctnsRow"+q+"_ClsfctnNm").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLoanClsfctnsRow"+q+"_RangeLow").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLoanClsfctnsRow"+q+"_RangeHigh").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allLoanClsfctnsRow"+q+"_PrvsnPrcnt").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+p.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|"}}}});if(rhotrim(c,"; ")!==""){bootbox.alert({title:"System Alert!",message:c});return false}var b=bootbox.alert({title:"Save "+e,size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving '+e+"...Please Wait...</p>",callback:function(){openATab(g,f)}});b.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:8,subPgNo:"1.9",q:"UPDATECONF",actyp:11,slctdLoanClsfctns:d},success:function(h){setTimeout(function(){b.find(".bootbox-body").html(h)},500)},error:function(h,k,j){console.warn(h.responseText)}})})})}function getAllDfltGlobalVars(d,h,e){var c=typeof $("#allDfltGlobalVarsSrchFor").val()==="undefined"?"%":$("#allDfltGlobalVarsSrchFor").val();var b=typeof $("#allDfltGlobalVarsSrchIn").val()==="undefined"?"Both":$("#allDfltGlobalVarsSrchIn").val();var a=typeof $("#allDfltGlobalVarsPageNo").val()==="undefined"?1:$("#allDfltGlobalVarsPageNo").val();var g=typeof $("#allDfltGlobalVarsDsplySze").val()==="undefined"?10:$("#allDfltGlobalVarsDsplySze").val();var f=typeof $("#allDfltGlobalVarsSortBy").val()==="undefined"?"":$("#allDfltGlobalVarsSortBy").val();if(d=="clear"){c="%";a=1}else{if(d=="next"){a=parseInt(a)+1}else{if(d=="previous"){a=parseInt(a)-1}}}e=e+"&searchfor="+c+"&searchin="+b+"&pageNo="+a+"&limitSze="+g+"&sortBy="+f;openATab(h,e)}function enterKeyFuncAllDfltGlobalVars(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllDfltGlobalVars(b,f,d)}}function saveDfltGlobalVars(g,f){var e="Global Variables";var c="";var a=true;var d="";$("#allDfltGlobalVarsTable").find("tr").each(function(l,m){if(l>0){if(typeof $(m).attr("id")==="undefined"){}else{var j=$(m).attr("id").split("_")[1];var k=$("#allDfltGlobalVarsRow"+j+"_PkeyID").val();var n=$("#allDfltGlobalVarsRow"+j+"_VarDataType").val();if(n.trim()===""){a=false;d+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Data Type for Column No. '+l+" cannot be empty!</span></p>";$("#allDfltGlobalVarsRow"+j+"_VarDataType").addClass("rho-error")}else{$("#allDfltGlobalVarsRow"+j+"_VarDataType").removeClass("rho-error")}var h=$("#allDfltGlobalVarsRow"+j+"_VarValue").val();if(h.trim()===""){a=false;d+='<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;color:red;">Value for Column No. '+l+" cannot be empty!</span></p>";$("#allDfltGlobalVarsRow"+j+"_VarValue").addClass("rho-error")}else{$("#allDfltGlobalVarsRow"+j+"_VarValue").removeClass("rho-error")}if(a===false){}else{c=c+$("#allDfltGlobalVarsRow"+j+"_PkeyID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allDfltGlobalVarsRow"+j+"_VarValue").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allDfltGlobalVarsRow"+j+"_VarDataType").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|"}}}});if(rhotrim(d,"; ")!==""){bootbox.alert({title:"System Alert!",message:d});return false}var b=bootbox.alert({title:"Save "+e,size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Saving '+e+"...Please Wait...</p>",callback:function(){openATab(g,f)}});b.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:8,subPgNo:"1.8",q:"UPDATECONF",actyp:10,slctdDfltGlobalVars:c},success:function(h){setTimeout(function(){b.find(".bootbox-body").html(h)},500)},error:function(h,k,j){console.warn(h.responseText)}})})})}function processFixedDepositInvestment(b){$("#prsFDInvBtn").attr("disabled","disabled");$("#voidFDInvBtn").attr("disabled","disabled");var c=typeof $("#invstmntID").val()==="undefined"?-1:$("#invstmntID").val();var d;var a;var f;var e="PROCESS";if(b==1){e="REVERSE"}f=bootbox.confirm({size:"small",message:"Are you sure you want to "+e+" this Investment?</br>Please Note: This action cannot be undone if you select 'Yes'",callback:function(g){if(g){d=bootbox.alert({title:"Processing........",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Processesing...Please Wait...</div>',callback:function(){}});d.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});var h;if(window.XMLHttpRequest){h=new XMLHttpRequest()}else{h=new ActiveXObject("Microsoft.XMLHTTP")}h.onreadystatechange=function(){var j;if(h.readyState===4&&h.status===200){$("#prsFDInvBtn").removeAttr("disabled");$("#voidFDInvBtn").removeAttr("disabled");j=h.responseText;getInvestmentsForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Investment",25,5.2,0,"EDIT",c,"indCustTableRow1",function(){d.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:j,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k-150)/2;return m+"px"}})})}};h.open("POST","index.php",true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send("grp=17&typ=1&pg=25&subPgNo=5.2&q=UPDATE&actyp=3&invstmntID="+c+"&prcsOptn="+b)}}});f.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g-150)/2;return k+"px"}})}function delTrnsChqLine_LoanRpmnt(d){var f="CHEQUE Transaction Line";var a=d.split("_")[1];var c=-1;var e="";if(typeof $("#oneVmsTrnsRow"+a+"_TrnsLnID").val()==="undefined"){}else{c=$("#oneVmsTrnsRow"+a+"_TrnsLnID").val();e=$("#oneVmsTrnsRow"+a+"_ChqNo").val()}var b=bootbox.confirm({title:"Delete "+f+"?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">DELETE</span> this linked role set?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(g){if(g===true){var h=bootbox.alert({title:"Delete "+f+"?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Deleting '+f+"...Please Wait...</p>"});h.init(function(){if(c>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.3,q:"DELETE",actyp:2,trnsLnID:c,chqNo:e},success:function(j){setTimeout(function(){h.find(".bootbox-body").html(j);if(j.indexOf("Success")!==-1){$("#"+d).remove()}},500)},error:function(l,j,k){h.find(".bootbox-body").html(k)}})})}else{setTimeout(function(){$("#"+d).remove();h.find(".bootbox-body").html("Row Removed Successfully!");calcCshBrkdwnRowVal("oneVmsTrnsRow_1")},500)}})}}})}function listCustAccountsForRpmnt(){var a=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();if(parseInt(a)<=0){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Get repayment details first!",callback:function(){}});return false}getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","All Bank Accounts (For Loan Repayment)","gnrlOrgID","bnkCustomerID","","radio",true,"","loanRpmntSrcAcctID","loanRpmntSrcAcct","clear",1,"")}function getAcctDetails_LoanRpmnt(a,e,d,c){var f=$("#acctNoFind").val();if(f.trim()==""){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Enter Account Number!",callback:function(){}});return}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){var h="";var m=b.responseText;if(/^[\],:{}\s]*$/.test(m.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){json=$.parseJSON(m);$("#acctID").val(json.accountDetails.accountID);$("#acctNo").val(json.accountDetails.accountNo);$("#acctStatus").val(json.accountDetails.status);$("#acctCrncy").val(json.accountDetails.currNm);$("#acctType").val(json.accountDetails.acctType);$("#acctCustomer").val(json.accountDetails.custId);$("#prsnTypeEntity").val(json.accountDetails.prsnTypeEntity);$("#acctBranch").val(json.accountDetails.branchId);$("#acctTitle").val(json.accountDetails.acctTitle);$("#mandate").val(json.accountDetails.mandate);$("#bnkCustomerID").val(json.accountDetails.bnkCustomerID);if(a==15&&e=="4.3"){$("#clrdBal").css({color:"red"});$("#clrdBal").val(addCommas(Number((json.accountBalance.clrBal+",").replace(/[^-?0-9\.]/g,"")).toFixed(2)));$("#unclrdBal").css({color:"red"});$("#unclrdBal").val(addCommas(Number((json.accountBalance.unclrBal+",").replace(/[^-?0-9\.]/g,"")).toFixed(2)))}else{if(Number((json.accountBalance.clrBal+",").replace(/[^-?0-9\.]/g,""))>0){$("#clrdBal").css({color:"green"})}else{$("#clrdBal").css({color:"red"})}$("#clrdBal").val(addCommas(Number((json.accountBalance.clrBal+",").replace(/[^-?0-9\.]/g,"")).toFixed(2)));if(Number((json.accountBalance.unclrBal+",").replace(/[^-?0-9\.]/g,""))>0){$("#unclrdBal").css({color:"green"})}else{$("#unclrdBal").css({color:"red"})}$("#unclrdBal").val(addCommas(Number((json.accountBalance.unclrBal+",").replace(/[^-?0-9\.]/g,"")).toFixed(2)))}$("#wtdrwlLimitNo").val(json.accountWdrwlLimit.limitNo);$("#wtdrwlLimitAmt").val(json.accountWdrwlLimit.limitAmount);var r=json.signatories.length;var k="";var n=0;var p=0;for(n=0;n<r;n++){p++;k=k+'<tr id="acctSignatoriesTblAddRow_'+p+'"><td class="lovtd">'+p+'</td><td  class="lovtd" id="acctSignatoriesTblAddRow'+p+'_name">'+json.signatories[n].name+'</td><td class="lovtd" style="text-align: center !important;"><input type="checkbox" class="form-check-input"></td><td class="lovtd"><button type="button" class="btn btn-info btn-sm" onclick="viewSignatoryForm(\'myLovModal\', \'myLovModalBody\', \'myLovModalTitle\', \'acctSignatoryForm\', \'\', \'Signatory\', 13, 2.1, 5, \'VIEW\','+json.signatories[n].id+');" style="padding:2px !important;">View Signatory</button></td><td class="lovtd">'+json.signatories[n].bioData+'</td><td  class="lovtd" style="display:none;" id="acctSignatoriesTblAddRow'+p+'_ID">'+json.signatories[n].id+'</td><td style="display:none;" id="acctSignatoriesTblAddRow'+p+'_MndtrySign">'+json.signatories[n].toSignMndtry+"</td></tr>"}$("#acctSignatoriesTblTbody").children("tr").remove();$("#acctSignatoriesTblAdd").append(k);var q=json.acctTrnsHistory.length;var o="";var l=0;var g=0;for(l=0;l<q;l++){g++;o=o+'<tr id="acctHistoryTblAddAddRow'+g+'"><td class="lovtd"><button type="button" class="btn btn-default btn-sm" data-toggle="tooltip" data-placement="bottom" title="View Transaction Details" onclick="getOneVmsTrnsForm('+json.acctTrnsHistory[l].acctTrnsId+", '"+json.acctTrnsHistory[l].trnsType+"', 30, 'ShowDialog',"+json.acctTrnsHistory[l].vwType+');" style="padding:2px !important;"><img src="cmn_images/kghostview.png" style="height:20px; width:auto; position: relative; vertical-align: middle;"></button></td><td class="lovtd">'+json.acctTrnsHistory[l].trnsDate+'</td><td class="lovtd">'+json.acctTrnsHistory[l].trnsDesc+'</td><td class="lovtd">'+json.acctTrnsHistory[l].trnsNo+'</td><td class="lovtd" style="text-align:right;font-weight:bold;">'+json.acctTrnsHistory[l].amount+'</td><td class="lovtd" style="text-align:right;font-weight:bold;color:blue;">'+json.acctTrnsHistory[l].netClrdBal+'</td><td class="lovtd" style="text-align:right;font-weight:bold;color:blue;">'+json.acctTrnsHistory[l].netUnclrdBal+'</td><td class="lovtd">'+json.acctTrnsHistory[l].status+'</td><td class="lovtd">'+json.acctTrnsHistory[l].authorizer+'</td><td style="display:none;">'+json.acctTrnsHistory[l].acctTrnsId+"</td></tr>"}$("#acctHistoryTblTbody").children("tr").remove();$("#acctHistoryTblAdd").append(o)}else{h=m;if(h=="INVALID ACCOUNT NUMBER"){$("#acctID").val("");$("#acctNo").val("");$("#acctStatus").val("");$("#acctCrncy").val("");$("#acctType").val("");$("#acctCustomer").val("");$("#prsnTypeEntity").val("");$("#acctBranch").val("");$("#acctTitle").val("");$("#mandate").val("");$("#clrdBal").val("");$("#unclrdBal").val("");$("#wtdrwlLimitNo").val("");$("#wtdrwlLimitAmt").val("");$("#acctSignatoriesTblTbody").children("tr").remove();bootbox.alert({size:"small",title:"Rhomicom Message",message:h,callback:function(){}})}else{alert("Hello "+m)}}$body.removeClass("mdlloadingDiag")}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+a+"&subPgNo="+e+"&vtyp="+d+"&vtypActn="+c+"&PKeyID="+f)}function enterKeyFuncFind(d,c,g,f,b){var a=(typeof d.which==="number")?d.which:d.keyCode;if(a==13){getCustData(c,g,f,b)}}function removeActivateLien(g){var c=typeof $("#lienStatus").val()==="undefined"?"Incomplete":$("#lienStatus").val();var e="Approve and Save this Lien";if(c=="Remove"){$("#lienStatus").val("Active");$("#endDate").val("31-Dec-4000");$("#removeActivateBtn").html("Remove Lien and Save")}else{var b=new Date();var a=b.getDate();if(a<10){a="0"+a}var d=b.getMonth()+1;var f=b.getFullYear();$("#lienStatus").val("Remove");$("#removeActivateBtn").html("Activate Lien and Save");$("#endDate").val(a+"-"+getMonthMon(d)+"-"+f)}saveAccountLienForm("myLovModal",g)}function getOvdrftIntrstPymntForm(l,m,c,o,d,f,g,h,e,a,j,n){if(typeof n==="undefined"||n===null){n=function(){var p=1}}if(!$.fn.DataTable.isDataTable("#"+a)){var k=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{k.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{k.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+m).html(b.responseText);$("#"+l).off("hidden.bs.modal");$("#"+l).one("hidden.bs.modal",function(p){getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.12","ovdrftIntrstPymnt");$("#"+m).html("");$("#"+c).html("");$(p.currentTarget).unbind()});$("#"+c).html(o);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+l).on("show.bs.modal",function(p){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){n()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+h+"&PKeyID="+e)}function deleteOvdrftIntrstPymnt(a){var c;var b;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Loan Write-Off?",callback:function(e){if(e){c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;if(g=="SORRY"){$msg="SORRY! Can't Delete an Loan Write-Off that is in active Use.";c.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});b.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}else{c.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});b.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.12","ovdrftIntrstPymnt")}}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=15&subPgNo=4.12&q=DELETE&PKeyID="+a)}}});d.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function saveOvdrftIntrstPymnt(a,d,c){var e;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var m;var j=typeof $("#ovdrftIntrstPymntId").val()==="undefined"?-1:$("#ovdrftIntrstPymntId").val();var g=typeof $("#ovdrftIntrstPymntTrnsDte").val()==="undefined"?"":$("#ovdrftIntrstPymntTrnsDte").val();var k=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var n=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();var h=typeof $("#ovdrftIntrstPymntReason").val()==="undefined"?"":$("#ovdrftIntrstPymntReason").val();var f=typeof $("#ovdrftIntrstPymntAmount").val()==="undefined"?0:$("#ovdrftIntrstPymntAmount").val();if(parseInt(n)<=0||n==-1||n==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Loan Request",callback:function(){}});return false}if(h.trim()==""||h==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Interest Processing Description",callback:function(){}});return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});e.find(".modal-content").css({"margin-top":function(){var p=$(window).height();var o=$(".modal-dialog").height();var q=p/2;return q+"px"}});var l=new FormData();l.append("grp",17);l.append("typ",1);l.append("q","UPDATE");l.append("pg",a);l.append("subPgNo",d);l.append("vtyp",c);l.append("ovdrftIntrstPymntId",j);l.append("ovdrftIntrstPymntTrnsDte",g);l.append("bnkBranchID",k);l.append("loanRqstID",n);l.append("ovdrftIntrstPymntReason",h);l.append("ovdrftIntrstPymntAmount",f);$.ajax({url:"index.php",type:"POST",data:l,async:true,success:function(o){var p="";if(/^[\],:{}\s]*$/.test(o.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(o);$("#ovdrftIntrstPymntId").val(m.ovdrftIntrstPymntId);e.modal("hide");getOvdrftIntrstPymntForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Overdraft Interest Processing",15,d,0,"EDIT",m.ovdrftIntrstPymntId,"indCustTable","indCustTableRow1",function(){p="Overdraft Interest Processing Successfully Saved!";b=bootbox.alert({size:"small",title:"Rhomicom Message",message:p,callback:function(){}})})}else{p=o;e.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:p,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function submitWithdrawOvdrftIntrstPymnt(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var n;var o;var t;var l;var h="";var r="";$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var p=typeof $("#ovdrftIntrstPymntId").val()==="undefined"?-1:$("#ovdrftIntrstPymntId").val();var m=typeof $("#ovdrftIntrstPymntTrnsDte").val()==="undefined"?"":$("#ovdrftIntrstPymntTrnsDte").val();var k=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var u=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();var f=typeof $("#ovdrftIntrstPymntReason").val()==="undefined"?"":$("#ovdrftIntrstPymntReason").val();var e=typeof $("#ovdrftIntrstPymntAmount").val()==="undefined"?0:$("#ovdrftIntrstPymntAmount").val();var s=typeof $("#ovdrftIntrstPymntAccruedAmnt").val()==="undefined"?0:$("#ovdrftIntrstPymntAccruedAmnt").val();var q;var g="Are you sure you want to submit Overdraft Interest Processing for Authorization?";if(d=="SUBMIT"){q=99;r="SUBMITTED for Authorization";h="Submitting...";if(parseInt(u)<=0||u==-1||u==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Loan Request",callback:function(){}});return false}if(f.trim()==""||f==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Write-Off Reason",callback:function(){}});return false}if(parseInt(p)<=0||p==-1||p==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Save First",callback:function(){}});return false}if(s.trim()==""||s==undefined||s.trim()==0){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select an OD Request with a positive Balance",callback:function(){}});return false}if(parseInt(p)<=0||p==-1||p==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Save First",callback:function(){}});return false}if(e.trim()==""||e==undefined||e.trim()==0){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Positive Payment Amount",callback:function(){}});return false}if(parseFloat(e)>0&&parseFloat(s)<parseFloat(e)){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Enter a Payment Amount less than the Total Accrued Interest of "+formatAsMoney(s),callback:function(){}});return false}}else{if(d=="WITHDRAW"){r="WITHDRAWN";h="Withdrawing...";q=3;g="Are you sure you want to Withdrawal Overdraft Interest Processing?"}else{if(d=="REJECT"){r="REJECTED";h="Rejecting...";q=4;g="Are you sure you want to Reject Overdraft Interest Processing?"}else{if(d=="AUTHORIZE"){r="AUTHORIZED";h="Authorizing...";q=5;g="Are you sure you want to Authorize Overdraft Interest Processing?"}else{if(d=="REVERSE"){r="REVERSED";h="Reversing...";q=6;g="Are you sure you want to REVERSE this Overdraft Interest Processing?";bootbox.alert({size:"small",title:"Rhomicom Message",message:"Constructing.......Please Wait",callback:function(){}});return false}}}}}var j=new FormData();j.append("grp",17);j.append("typ",1);j.append("pg",a);j.append("subPgNo",c);j.append("q","UPDATE");j.append("vtyp",b);j.append("actyp",q);j.append("ovdrftIntrstPymntId",p);j.append("ovdrftIntrstPymntTrnsDte",m);j.append("bnkBranchID",k);j.append("loanRqstID",u);j.append("ovdrftIntrstPymntReason",f);j.append("ovdrftIntrstPymntAmount",e);l=bootbox.confirm({title:"Rhomicom Message",message:g,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(v){if(v){$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");o=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> '+h+" Please Wait...</div>"});o.find(".modal-content").css({"margin-top":function(){var y=$(window).height();var x=$(".modal-dialog").height();var z=(y-x)/2;return z+"px"}});$.ajax({url:"index.php",type:"POST",data:j,async:true,success:function(w){o.modal("hide");var x="";if(/^[\],:{}\s]*$/.test(w.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){getOvdrftIntrstPymntForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Overdraft Interest Processing",15,4.12,0,"EDIT",p,"indCustTable","indCustTableRow1",function(){t=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Overdraft Interest Processing Successfully "+r,callback:function(){}})})}else{t=bootbox.alert({size:"small",title:"Rhomicom Message",message:w,callback:function(){}});return false}t.find(".modal-content").css({"margin-top":function(){var z=$(window).height();var y=$(".modal-dialog").height();var A=(z-y-150)/2;return A+"px"}})},cache:false,contentType:false,processData:false})}}})});mnBox.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function processOvdrftIntrstPymnt(b){var d=typeof $("#ovdrftIntrstPymntId").val()==="undefined"?-1:$("#ovdrftIntrstPymntId").val();var g=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();var c;var a;var f;var e="PROCESS";if(b==1){e="VOID"}f=bootbox.confirm({size:"small",message:"Are you sure you want to "+e+" this Overdraft Interest Processing?</br>Please Note: This action cannot be undone if you select 'Yes'",callback:function(h){if(h){c=bootbox.alert({title:"Processing........",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Processesing...Please Wait...</div>',callback:function(){}});c.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k-150)/2;return m+"px"}});var j;if(window.XMLHttpRequest){j=new XMLHttpRequest()}else{j=new ActiveXObject("Microsoft.XMLHTTP")}j.onreadystatechange=function(){var k;if(j.readyState===4&&j.status===200){k=j.responseText;getOvdrftIntrstPymntForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Overdraft Interest Processing",15,4.12,0,"EDIT",d,"indCustTable","indCustTableRow1",function(){c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:k,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var m=$(window).height();var l=$(".modal-dialog").height();var n=(m-l-150)/2;return n+"px"}})})}};j.open("POST","index.php",true);j.setRequestHeader("Content-type","application/x-www-form-urlencoded");j.send("grp=17&typ=1&pg=15&subPgNo=4.12&q=UPDATE&actyp=1&ovdrftIntrstPymntId="+d+"&prcsOptn="+b+"&loanRqstID="+g)}}});f.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function getCstmrCrspndncForm(l,m,c,o,d,f,g,h,e,a,j,n){if(typeof n==="undefined"||n===null){n=function(){var p=1}}if(!$.fn.DataTable.isDataTable("#"+a)){var k=$("#"+a).DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#"+a+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{k.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+a+" tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{k.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){$("#"+m).html(b.responseText);$("#"+l).off("hidden.bs.modal");$("#"+l).one("hidden.bs.modal",function(p){getCustData("clear","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.5","cstmrCrspndnc");$("#"+m).html("");$("#"+c).html("");$(p.currentTarget).unbind()});$("#"+c).html(o);$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+l).on("show.bs.modal",function(p){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+l).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){n()})}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+d+"&subPgNo="+f+"&vtyp="+g+"&vtypActn="+h+"&PKeyID="+e)}function deleteCstmrCrspndnc(b){var c;var a;var d;d=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Correspondence?",callback:function(e){if(e){c=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});c.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;if(g=="SORRY"){$msg="SORRY! Can't Delete an Correspondence that is in active Use.";c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:$msg,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}else{c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.5","cstmrCrspndnc")}}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=11&subPgNo=1.5&q=DELETE&PKeyID="+b)}}});d.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function saveCstmrCrspndnc(a,d,c){var e;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var p;var j=typeof $("#cstmrCrspndncId").val()==="undefined"?-1:$("#cstmrCrspndncId").val();var q=typeof $("#acctNoFindAccId").val()==="undefined"?-1:$("#acctNoFindAccId").val();var u=typeof $("#bnkCustomerID").val()==="undefined"?-1:$("#bnkCustomerID").val();var y=typeof $("#branchID").val()==="undefined"?-1:$("#branchID").val();var x=typeof $("#custType").val()==="undefined"?"":$("#custType").val();var s=typeof $("#requestDate").val()==="undefined"?"":$("#requestDate").val();var m=typeof $("#requestorNm").val()==="undefined"?"":$("#requestorNm").val();var l=typeof $("#trnsctnID").val()==="undefined"?"":$("#trnsctnID").val();var w=typeof $("#requestTypeID").val()==="undefined"?"":$("#requestTypeID").val();var k=typeof $("#requestDetails").val()==="undefined"?"":$("#requestDetails").val();var g=typeof $("#assignedToPrsnID").val()==="undefined"?-1:$("#assignedToPrsnID").val();var f=typeof $("#urgency").val()==="undefined"?"":$("#urgency").val();var h=typeof $("#expectedCloseDate").val()==="undefined"?"":$("#expectedCloseDate").val();var t=typeof $("#requestStatus").val()==="undefined"?"":$("#requestStatus").val();var n=typeof $("#actualCloseDate").val()==="undefined"?"":$("#actualCloseDate").val();var o=typeof $("#closedByPersonId").val()==="undefined"?-1:$("#closedByPersonId").val();var v=typeof $("#closedActionDetails").val()==="undefined"?"":$("#closedActionDetails").val();if(parseInt(q)<=0||q==-1||q==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter a valid Account Number",callback:function(){}});return false}if(s.trim()==""||s==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a Request Date",callback:function(){}});return false}if(m.trim()==""||m==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Requestor's Details",callback:function(){}});return false}if(w.trim()==""||w==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Correspondence/Request Type",callback:function(){}});return false}if(k.trim()==""||k==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide details of request",callback:function(){}});return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});e.find(".modal-content").css({"margin-top":function(){var A=$(window).height();var z=$(".modal-dialog").height();var B=A/2;return B+"px"}});var r=new FormData();r.append("grp",17);r.append("typ",1);r.append("q","UPDATE");r.append("pg",a);r.append("subPgNo",d);r.append("vtyp",c);r.append("cstmrCrspndncId",j);r.append("acctNoFindAccId",q);r.append("bnkCustomerID",u);r.append("branchID",y);r.append("custType",x);r.append("requestDate",s);r.append("requestorNm",m);r.append("trnsctnID",l);r.append("requestTypeID",w);r.append("requestDetails",k);r.append("assignedToPrsnID",g);r.append("urgency",f);r.append("expectedCloseDate",h);r.append("requestStatus",t);r.append("actualCloseDate",n);r.append("closedByPersonId",o);r.append("closedActionDetails",v);$.ajax({url:"index.php",type:"POST",data:r,async:true,success:function(z){var A="";if(/^[\],:{}\s]*$/.test(z.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){p=$.parseJSON(z);$("#cstmrCrspndncId").val(p.cstmrCrspndncId);e.modal("hide");getCstmrCrspndncForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Correspondence",11,d,0,"EDIT",p.cstmrCrspndncId,"indCustTable","indCustTableRow1",function(){A="Correspondence Successfully Saved!";b=bootbox.alert({size:"small",title:"Rhomicom Message",message:A,callback:function(){}})})}else{A=z;e.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:A,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function submitWithdrawCstmrCrspndnc(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var s;var o;var y;var m;var k="";var v="";$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var j=typeof $("#cstmrCrspndncId").val()==="undefined"?-1:$("#cstmrCrspndncId").val();var t=typeof $("#acctNoFindAccId").val()==="undefined"?-1:$("#acctNoFindAccId").val();var z=typeof $("#bnkCustomerID").val()==="undefined"?-1:$("#bnkCustomerID").val();var E=typeof $("#branchID").val()==="undefined"?-1:$("#branchID").val();var D=typeof $("#custType").val()==="undefined"?"":$("#custType").val();var w=typeof $("#requestDate").val()==="undefined"?"":$("#requestDate").val();var p=typeof $("#requestorNm").val()==="undefined"?"":$("#requestorNm").val();var n=typeof $("#trnsctnID").val()==="undefined"?"":$("#trnsctnID").val();var C=typeof $("#requestTypeID").val()==="undefined"?"":$("#requestTypeID").val();var l=typeof $("#requestDetails").val()==="undefined"?"":$("#requestDetails").val();var g=typeof $("#assignedToPrsnID").val()==="undefined"?-1:$("#assignedToPrsnID").val();var e=typeof $("#urgency").val()==="undefined"?"":$("#urgency").val();var h=typeof $("#expectedCloseDate").val()==="undefined"?"":$("#expectedCloseDate").val();var x=typeof $("#requestStatus").val()==="undefined"?"":$("#requestStatus").val();var q=typeof $("#actualCloseDate").val()==="undefined"?"":$("#actualCloseDate").val();var r=typeof $("#closedByPersonId").val()==="undefined"?-1:$("#closedByPersonId").val();var B=typeof $("#closedActionDetails").val()==="undefined"?"":$("#closedActionDetails").val();var f;var A="Are you sure you want to submit Correspondence for Authorization?";if(d=="SUBMIT"){f=99;v="SUBMITTED for Authorization";k="Submitting...";if(parseInt(t)<=0||t==-1||t==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please enter a valid Account Number",callback:function(){}});return false}if(w.trim()==""||w==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a Request Date",callback:function(){}});return false}if(p.trim()==""||p==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Requestor's Details",callback:function(){}});return false}if(C.trim()==""||C==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Correspondence/Request Type",callback:function(){}});return false}if(l.trim()==""||l==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide details of request",callback:function(){}});return false}}else{if(d=="WITHDRAW"){v="WITHDRAWN";k="Withdrawing...";f=3;A="Are you sure you want to Withdrawal Correspondence?"}else{if(d=="REJECT"){v="REJECTED";k="Rejecting...";f=4;A="Are you sure you want to Reject Correspondence?"}else{if(d=="AUTHORIZE"){v="AUTHORIZED";k="Authorizing...";f=5;A="Are you sure you want to Authorize Correspondence?"}else{if(d=="CLOSE"){v="CLOSED";k="Closing...";f=6;A="Are you sure you want to CLOSE this Correspondence?";if(q.trim()==""||q==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Close Date",callback:function(){}});return false}if(parseInt(r)<=0||r==-1||r==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select an Actioned By Person",callback:function(){}});return false}if(B.trim()==""||B==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide a summary of the Action Taken",callback:function(){}});return false}}}}}}var u=new FormData();u.append("grp",17);u.append("typ",1);u.append("pg",a);u.append("subPgNo",c);u.append("q","UPDATE");u.append("vtyp",b);u.append("actyp",f);u.append("cstmrCrspndncId",j);u.append("acctNoFindAccId",t);u.append("bnkCustomerID",z);u.append("branchID",E);u.append("custType",D);u.append("requestDate",w);u.append("requestorNm",p);u.append("trnsctnID",n);u.append("requestTypeID",C);u.append("requestDetails",l);u.append("assignedToPrsnID",g);u.append("urgency",e);u.append("expectedCloseDate",h);u.append("requestStatus",x);u.append("actualCloseDate",q);u.append("closedByPersonId",r);u.append("closedActionDetails",B);m=bootbox.confirm({title:"Rhomicom Message",message:A,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(F){if(F){$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");o=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> '+k+" Please Wait...</div>"});o.find(".modal-content").css({"margin-top":function(){var H=$(window).height();var G=$(".modal-dialog").height();var I=(H-G)/2;return I+"px"}});$.ajax({url:"index.php",type:"POST",data:u,async:true,success:function(G){o.modal("hide");var H="";if(/^[\],:{}\s]*$/.test(G.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){getCstmrCrspndncForm("myFormsModaLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Correspondence",11,1.5,0,"EDIT",j,"indCustTable","indCustTableRow1",function(){y=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Correspondence Successfully "+v,callback:function(){}})})}else{y=bootbox.alert({size:"small",title:"Rhomicom Message",message:G,callback:function(){}});return false}y.find(".modal-content").css({"margin-top":function(){var J=$(window).height();var I=$(".modal-dialog").height();var K=(J-I-150)/2;return K+"px"}})},cache:false,contentType:false,processData:false})}}})});mnBox.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function getAcctDetails_CustCrspndnce(a,c){var d=$("#acctNoFind").val();if(d.trim()==""){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Enter Account Number!",callback:function(){}});return}$body=$("body");$body.addClass("mdlloadingDiag");var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){var f="";var e=b.responseText;if(/^[\],:{}\s]*$/.test(e.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){json=$.parseJSON(e);$("#acctNoFindAccId").val(json.accountDetails.accountID);$("#acctNoFind").val(json.accountDetails.acctNo);$("#custType").val(json.accountDetails.custType);$("#bnkCustomer").val(json.accountDetails.custNm);$("#bnkCustomerID").val(json.accountDetails.custID);$("#branchID").val(json.accountDetails.branchID);$("#acctTitle").val(json.accountDetails.acctTitle);$("#branchNm").val(json.accountDetails.branchNm);$("#mandate").val(json.accountDetails.mandate)}else{f=e;if(f=="INVALID ACCOUNT NUMBER"){$("#acctNoFindID").val(-1);$("#acctNoFind").val("");$("#custType").val("");$("#bnkCustomer").val("");$("#bnkCustomerID").val(-1);$("#branchID").val(-1);$("#acctTitle").val("");$("#branchNm").val("");$("#mandate").val("");bootbox.alert({size:"small",title:"Rhomicom Message",message:f,callback:function(){}})}}$body.removeClass("mdlloadingDiag")}};b.open("POST","index.php",true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send("grp=17&typ=1&pg="+a+"&subPgNo="+c+"&PKeyID="+d)}function imprtNtnlID(){var c="";var a=true;var b=bootbox.confirm({title:"Import National ID?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:green;font-weight:bold;font-style:italic;">IMPORT NATIONAL ID</span> to overwrite existing ones?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(d){if(d===true){if(isReaderAPIAvlbl()){$("#allOtherFileInput6").val("");$("#allOtherFileInput6").off("change");$("#allOtherFileInput6").change(function(){var j=$(this).val();var g=document.getElementById("allOtherFileInput6");var h=g.files[0];var f="";f+='<span style="font-weight:bold;">'+escape(h.name)+"</span><br />\n";f+=" - FileType: "+(h.type||"n/a")+"<br />\n";f+=" - FileSize: "+h.size+" bytes<br />\n";f+=" - LastModified: "+(h.lastModifiedDate?h.lastModifiedDate.toLocaleDateString():"n/a")+"<br />\n";var e=new FileReader();BootstrapDialog.show({size:BootstrapDialog.SIZE_LARGE,type:BootstrapDialog.TYPE_DEFAULT,title:"Validating Selected File",message:'<div id="myProgress"><div id="myBar"></div></div><div id="myInformation"><i class="fa fa-spin fa-spinner"></i> Validating Selected File...Please Wait...</div><br/><div id="fileInformation">'+f+"</div>",animate:true,closable:true,closeByBackdrop:false,closeByKeyboard:false,onshow:function(k){setTimeout(function(){var l=k.getButton("btn-srvr-prcs");l.disable();e.onerror=function(m){switch(m.target.error.code){case m.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case m.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case m.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};e.onprogress=function(n){if(n.lengthComputable){var m=Math.round((n.loaded/n.total)*100);var o=document.getElementById("myBar");o.style.width=m+"%";if(m<100){$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>'+m+"% Validating Selected File...Please Wait...</span>")}else{$("#myInformation").html('<span style="color:green;"><i class="fa fa-check"></i>'+m+"% Validating Selected File Completed!</span>");var p=k.getButton("btn-srvr-prcs");if(a==true){p.enable()}else{p.disable()}}}};e.onabort=function(m){alert("File read cancelled")};e.onloadstart=function(n){var m=document.getElementById("myBar");m.style.width="1%";$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>1% Started Importing National ID...Please Wait...</span>')};e.onload=function(w){try{var u=w.target.result;var C=$.csv.toArrays(u);var t=0;var r=0;var D=0;var x="";var p="";var o="";var m="";var B="";var A="";var v="";var n="";for(var s in C){for(var z in C[s]){r++;switch(r){case 1:x=C[s][z];break;case 2:p=C[s][z];break;case 3:o=C[s][z];break;case 4:m=C[s][z];break;case 5:B=C[s][z];break;case 6:A=C[s][z];break;case 7:v=C[s][z];break;default:var y=bootbox.alert({title:"Error-Validating Selected File",size:"small",message:'<span style="color:red;font-weight:bold:">An error occurred reading this file.Invalid Column in File!</span>',callback:function(){a=false;e.abort()}})}}if(t===0){if(x.toUpperCase()==="CUST NO"&&p.toUpperCase()==="NATIONALITY**"&&o.toUpperCase()==="ID TYPE**"){}else{var y=bootbox.alert({title:"Error-Import National ID",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){a=false;e.abort()}})}}if(1==1){c=c+x.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+p.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+m.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+B.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+A.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+v.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";D++}r=0;t++}f+='<br/><span style="color:blue;font-weight:bold;">No. of Valid Rows:'+D;f+="<br/>Total No. of Rows:"+t+"</span>";$("#fileInformation").html(f)}catch(q){var y=bootbox.alert({title:"Error-Import National ID",size:"small",message:"Error:"+q.message,callback:function(){a=false;e.abort()}})}};e.readAsText(h)},500)},buttons:[{label:"Cancel",icon:"glyphicon glyphicon-menu-left",cssClass:"btn-default",action:function(k){a=false;e.abort();k.close()}},{id:"btn-srvr-prcs",label:"Start Server Processing",icon:"glyphicon glyphicon-menu-right",cssClass:"btn-primary",action:function(l){if(a==true){l.close();saveNtnlID(c)}else{var k=bootbox.alert({title:"Error-Import National ID",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){}})}}}]})});performFileClick("allOtherFileInput6")}}}})}function saveNtnlID(b){if(b.trim()===""){bootbox.alert({title:"System Alert!",size:"small",message:'<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;">No Data to Send!</span></p>'});return false}var a=bootbox.alert({title:"Importing National ID",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Importing National ID...Please Wait...</div>',callback:function(){clearInterval(prgstimerid2);getCustData("clear","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.1","mcfIndCstmr")}});a.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.1,q:"UPDATE",actyp:7,dataToSend:b}});prgstimerid2=window.setInterval(rfrshSaveNtnlID,1000)})})}function rfrshSaveNtnlID(){$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.1,q:"UPDATE",actyp:6},success:function(b){var a=document.getElementById("myBar1");a.style.width=b.percent+"%";$("#myInformation1").html(b.message);if(b.percent>=100){window.clearInterval(prgstimerid2)}},error:function(a,c,b){console.log(c+" "+b);console.warn(a.responseText)}})}function imprtOtherPersons(){var c="";var a=true;var b=bootbox.confirm({title:"Import Other Persons?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:green;font-weight:bold;font-style:italic;">IMPORT OTHER PERSONS</span> to overwrite existing ones?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(d){if(d===true){if(isReaderAPIAvlbl()){$("#allOtherFileInput6").val("");$("#allOtherFileInput6").off("change");$("#allOtherFileInput6").change(function(){var j=$(this).val();var g=document.getElementById("allOtherFileInput6");var h=g.files[0];var f="";f+='<span style="font-weight:bold;">'+escape(h.name)+"</span><br />\n";f+=" - FileType: "+(h.type||"n/a")+"<br />\n";f+=" - FileSize: "+h.size+" bytes<br />\n";f+=" - LastModified: "+(h.lastModifiedDate?h.lastModifiedDate.toLocaleDateString():"n/a")+"<br />\n";var e=new FileReader();BootstrapDialog.show({size:BootstrapDialog.SIZE_LARGE,type:BootstrapDialog.TYPE_DEFAULT,title:"Validating Selected File",message:'<div id="myProgress"><div id="myBar"></div></div><div id="myInformation"><i class="fa fa-spin fa-spinner"></i> Validating Selected File...Please Wait...</div><br/><div id="fileInformation">'+f+"</div>",animate:true,closable:true,closeByBackdrop:false,closeByKeyboard:false,onshow:function(k){setTimeout(function(){var l=k.getButton("btn-srvr-prcs");l.disable();e.onerror=function(m){switch(m.target.error.code){case m.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case m.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case m.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};e.onprogress=function(n){if(n.lengthComputable){var m=Math.round((n.loaded/n.total)*100);var o=document.getElementById("myBar");o.style.width=m+"%";if(m<100){$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>'+m+"% Validating Selected File...Please Wait...</span>")}else{$("#myInformation").html('<span style="color:green;"><i class="fa fa-check"></i>'+m+"% Validating Selected File Completed!</span>");var p=k.getButton("btn-srvr-prcs");if(a==true){p.enable()}else{p.disable()}}}};e.onabort=function(m){alert("File read cancelled")};e.onloadstart=function(n){var m=document.getElementById("myBar");m.style.width="1%";$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>1% Started Importing Other Persons...Please Wait...</span>')};e.onload=function(W){try{var L=W.target.result;var T=$.csv.toArrays(L);var V=0;var J=0;var x=0;var X="";var P="";var E="";var K="";var F="";var u="";var R="";var D="";var p="";var M="";var w="";var I="";var Q="";var U="";var s="";var A="";var C="";var H="";var v="";var n="";var r="";var z="";var q="";var y="";var m="";var o="";var G="";var S="";for(var t in T){for(var B in T[t]){J++;switch(J){case 1:X=T[t][B];break;case 2:P=T[t][B];break;case 3:E=T[t][B];break;case 4:K=T[t][B];break;case 5:F=T[t][B];break;case 6:u=T[t][B];break;case 7:R=T[t][B];break;case 8:D=T[t][B];break;case 9:p=T[t][B];break;case 10:M=T[t][B];break;case 11:w=T[t][B];break;case 12:I=T[t][B];break;case 13:Q=T[t][B];break;case 14:U=T[t][B];break;case 15:s=T[t][B];break;case 16:A=T[t][B];break;case 17:C=T[t][B];break;case 18:H=T[t][B];break;case 19:v=T[t][B];break;case 20:n=T[t][B];break;case 21:r=T[t][B];break;case 22:z=T[t][B];break;case 23:q=T[t][B];break;case 24:y=T[t][B];break;case 25:m=T[t][B];break;case 26:o=T[t][B];break;case 27:G=T[t][B];break;case 28:S=T[t][B];break;default:var N=bootbox.alert({title:"Error-Validating Selected File",size:"small",message:'<span style="color:red;font-weight:bold:">An error occurred reading this file.Invalid Column in File!</span>',callback:function(){a=false;e.abort()}})}}if(V===0){if(X.toUpperCase()==="NO."&&P.toUpperCase()==="CUSTOMER ID**"&&E.toUpperCase()==="TITLE**"){}else{var N=bootbox.alert({title:"Error-Import Other Persons",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){a=false;e.abort()}})}}if(1==1){c=c+X.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+P.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+E.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+K.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+F.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+u.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+R.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+D.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+p.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+M.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+w.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+I.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+Q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+U.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+s.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+A.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+C.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+H.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+v.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+n.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+r.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+z.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+y.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+m.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+G.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+S.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";x++}J=0;V++}f+='<br/><span style="color:blue;font-weight:bold;">No. of Valid Rows:'+x;f+="<br/>Total No. of Rows:"+V+"</span>";$("#fileInformation").html(f)}catch(O){var N=bootbox.alert({title:"Error-Import Other Persons",size:"small",message:"Error:"+O.message,callback:function(){a=false;e.abort()}})}};e.readAsText(h)},500)},buttons:[{label:"Cancel",icon:"glyphicon glyphicon-menu-left",cssClass:"btn-default",action:function(k){a=false;e.abort();k.close()}},{id:"btn-srvr-prcs",label:"Start Server Processing",icon:"glyphicon glyphicon-menu-right",cssClass:"btn-primary",action:function(l){if(a==true){l.close();saveOtherPersons(c)}else{var k=bootbox.alert({title:"Error-Import Other Persons",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){}})}}}]})});performFileClick("allOtherFileInput6")}}}})}function saveOtherPersons(b){if(b.trim()===""){bootbox.alert({title:"System Alert!",size:"small",message:'<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;">No Data to Send!</span></p>'});return false}var a=bootbox.alert({title:"Importing Other Persons/Processes",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Importing Other Persons/Processes...Please Wait...</div>',callback:function(){clearInterval(prgstimerid2);getCustData("clear","#allmodules","grp=17&typ=1&pg=1&subPgNo=1.4","mcfOthPCstmr")}});a.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.4,q:"UPDATE",actyp:5,dataToSend:b}});prgstimerid2=window.setInterval(rfrshSaveOtherPersons,1000)})})}function rfrshSaveOtherPersons(){$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.4,q:"UPDATE",actyp:6},success:function(b){var a=document.getElementById("myBar1");a.style.width=b.percent+"%";$("#myInformation1").html(b.message);if(b.percent>=100){window.clearInterval(prgstimerid2)}},error:function(a,c,b){console.log(c+" "+b);console.warn(a.responseText)}})}function imprtLoanApplctns(){var c="";var a=true;var b=bootbox.confirm({title:"Import Loan Applications?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:green;font-weight:bold;font-style:italic;">IMPORT LOAN APPLICATIONS</span> to overwrite existing ones?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(d){if(d===true){if(isReaderAPIAvlbl()){$("#allOtherFileInput6").val("");$("#allOtherFileInput6").off("change");$("#allOtherFileInput6").change(function(){var j=$(this).val();var g=document.getElementById("allOtherFileInput6");var h=g.files[0];var f="";f+='<span style="font-weight:bold;">'+escape(h.name)+"</span><br />\n";f+=" - FileType: "+(h.type||"n/a")+"<br />\n";f+=" - FileSize: "+h.size+" bytes<br />\n";f+=" - LastModified: "+(h.lastModifiedDate?h.lastModifiedDate.toLocaleDateString():"n/a")+"<br />\n";var e=new FileReader();BootstrapDialog.show({size:BootstrapDialog.SIZE_LARGE,type:BootstrapDialog.TYPE_DEFAULT,title:"Validating Selected File",message:'<div id="myProgress"><div id="myBar"></div></div><div id="myInformation"><i class="fa fa-spin fa-spinner"></i> Validating Selected File...Please Wait...</div><br/><div id="fileInformation">'+f+"</div>",animate:true,closable:true,closeByBackdrop:false,closeByKeyboard:false,onshow:function(k){setTimeout(function(){var l=k.getButton("btn-srvr-prcs");l.disable();e.onerror=function(m){switch(m.target.error.code){case m.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case m.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case m.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};e.onprogress=function(n){if(n.lengthComputable){var m=Math.round((n.loaded/n.total)*100);var o=document.getElementById("myBar");o.style.width=m+"%";if(m<100){$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>'+m+"% Validating Selected File...Please Wait...</span>")}else{$("#myInformation").html('<span style="color:green;"><i class="fa fa-check"></i>'+m+"% Validating Selected File Completed!</span>");var p=k.getButton("btn-srvr-prcs");if(a==true){p.enable()}else{p.disable()}}}};e.onabort=function(m){alert("File read cancelled")};e.onloadstart=function(n){var m=document.getElementById("myBar");m.style.width="1%";$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>1% Started Importing Loan Applications...Please Wait...</span>')};e.onload=function(K){try{var C=K.target.result;var R=$.csv.toArrays(C);var z=0;var v=0;var T=0;var s="";var t="";var r="";var J="";var n="";var m="";var M="";var P="";var o="";var p="";var D="";var A="";var w="";var y="";var E="";var I="";var G="";var F="";var H="";var q="";var B="";var O="";var Q="";var S="";for(var x in R){for(var N in R[x]){v++;switch(v){case 1:s=R[x][N];break;case 2:t=R[x][N];break;case 3:r=R[x][N];break;case 4:J=R[x][N];break;case 5:n=R[x][N];break;case 6:m=R[x][N];break;case 7:M=R[x][N];break;case 8:P=R[x][N];break;case 9:o=R[x][N];break;case 10:p=R[x][N];break;case 11:D=R[x][N];break;case 12:A=R[x][N];break;case 13:w=R[x][N];break;case 14:y=R[x][N];break;case 15:E=R[x][N];break;case 16:I=R[x][N];break;case 17:G=R[x][N];break;case 18:F=R[x][N];break;case 19:H=R[x][N];break;case 20:q=R[x][N];break;case 21:B=R[x][N];break;case 22:O=R[x][N];break;case 23:Q=R[x][N];break;case 24:S=R[x][N];break;default:var L=bootbox.alert({title:"Error-Validating Selected File",size:"small",message:'<span style="color:red;font-weight:bold:">An error occurred reading this file.Invalid Column in File!</span>',callback:function(){a=false;e.abort()}})}}if(z===0){if(s.toUpperCase()==="LOAN NO"&&t.toUpperCase()==="APPLICATION DATE**"&&r.toUpperCase()==="LOAN AMOUNT**"){}else{var L=bootbox.alert({title:"Error-Import Loan Applications",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){a=false;e.abort()}})}}if(1==1){c=c+s.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+t.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+r.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+J.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+n.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+m.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+M.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+P.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+p.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+D.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+A.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+w.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+y.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+E.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+I.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+G.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+F.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+H.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+B.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+O.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+Q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+S.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";T++}v=0;z++}f+='<br/><span style="color:blue;font-weight:bold;">No. of Valid Rows:'+T;f+="<br/>Total No. of Rows:"+z+"</span>";$("#fileInformation").html(f)}catch(u){var L=bootbox.alert({title:"Error-Import Loan Applications",size:"small",message:"Error:"+u.message,callback:function(){a=false;e.abort()}})}};e.readAsText(h)},500)},buttons:[{label:"Cancel",icon:"glyphicon glyphicon-menu-left",cssClass:"btn-default",action:function(k){a=false;e.abort();k.close()}},{id:"btn-srvr-prcs",label:"Start Server Processing",icon:"glyphicon glyphicon-menu-right",cssClass:"btn-primary",action:function(l){if(a==true){l.close();saveLoanApplctns(c)}else{var k=bootbox.alert({title:"Error-Import Loan Applications",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){}})}}}]})});performFileClick("allOtherFileInput6")}}}})}function saveLoanApplctns(b){if(b.trim()===""){bootbox.alert({title:"System Alert!",size:"small",message:'<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;">No Data to Send!</span></p>'});return false}var a=bootbox.alert({title:"Importing Loan Applications/Processes",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Importing Loan Applications/Processes...Please Wait...</div>',callback:function(){clearInterval(prgstimerid2);getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.1")}});a.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.1,q:"UPDATE",actyp:5,dataToSend:b}});prgstimerid2=window.setInterval(rfrshSaveLoanApplctns,1000)})})}function rfrshSaveLoanApplctns(){$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.1,q:"UPDATE",actyp:6},success:function(b){var a=document.getElementById("myBar1");a.style.width=b.percent+"%";$("#myInformation1").html(b.message);if(b.percent>=100){window.clearInterval(prgstimerid2)}},error:function(a,c,b){console.log(c+" "+b);console.warn(a.responseText)}})}function imprtDisbursements(){var h="Loan Disbursements";var g="";var b=true;var e="";if(rhotrim(e,"; ")!==""){bootbox.alert({title:"System Alert!",message:e});return false}var d;var a;var f;var c;f=bootbox.confirm({size:"small",message:"Are you sure you want to import Loan Disbursements?",callback:function(j){if(j){c=bootbox.alert({title:"Save "+h,size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Processing '+h+"...Please Wait...</p>",callback:function(){getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.2")}});c.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.2,q:"UPDATE",actyp:1},success:function(k){setTimeout(function(){c.find(".bootbox-body").html(k)},500)},error:function(k,m,l){console.warn(k.responseText)}})})})}}});f.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function imprtLoanSchedules(){var c="";var a=true;var b=bootbox.confirm({title:"Import Loan Schedules?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:green;font-weight:bold;font-style:italic;">IMPORT LOAN SCHEDULES</span> to overwrite existing ones?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(d){if(d===true){if(isReaderAPIAvlbl()){$("#allOtherFileInput6").val("");$("#allOtherFileInput6").off("change");$("#allOtherFileInput6").change(function(){var j=$(this).val();var g=document.getElementById("allOtherFileInput6");var h=g.files[0];var f="";f+='<span style="font-weight:bold;">'+escape(h.name)+"</span><br />\n";f+=" - FileType: "+(h.type||"n/a")+"<br />\n";f+=" - FileSize: "+h.size+" bytes<br />\n";f+=" - LastModified: "+(h.lastModifiedDate?h.lastModifiedDate.toLocaleDateString():"n/a")+"<br />\n";var e=new FileReader();BootstrapDialog.show({size:BootstrapDialog.SIZE_LARGE,type:BootstrapDialog.TYPE_DEFAULT,title:"Validating Selected File",message:'<div id="myProgress"><div id="myBar"></div></div><div id="myInformation"><i class="fa fa-spin fa-spinner"></i> Validating Selected File...Please Wait...</div><br/><div id="fileInformation">'+f+"</div>",animate:true,closable:true,closeByBackdrop:false,closeByKeyboard:false,onshow:function(k){setTimeout(function(){var l=k.getButton("btn-srvr-prcs");l.disable();e.onerror=function(m){switch(m.target.error.code){case m.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case m.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case m.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};e.onprogress=function(n){if(n.lengthComputable){var m=Math.round((n.loaded/n.total)*100);var o=document.getElementById("myBar");o.style.width=m+"%";if(m<100){$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>'+m+"% Validating Selected File...Please Wait...</span>")}else{$("#myInformation").html('<span style="color:green;"><i class="fa fa-check"></i>'+m+"% Validating Selected File Completed!</span>");var p=k.getButton("btn-srvr-prcs");if(a==true){p.enable()}else{p.disable()}}}};e.onabort=function(m){alert("File read cancelled")};e.onloadstart=function(n){var m=document.getElementById("myBar");m.style.width="1%";$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>1% Started Importing Loan Schedules...Please Wait...</span>')};e.onload=function(D){try{var y=D.target.result;var G=$.csv.toArrays(y);var v=0;var r=0;var H=0;var p="";var n="";var o="";var C="";var z="";var t="";var I="";var B="";var w="";var m="";var x="";var s="";var A="";for(var u in G){for(var F in G[u]){r++;switch(r){case 1:p=G[u][F];break;case 2:n=G[u][F];break;case 3:o=G[u][F];break;case 4:C=G[u][F];break;case 5:z=G[u][F];break;case 6:t=G[u][F];break;case 7:I=G[u][F];break;case 8:B=G[u][F];break;case 9:w=G[u][F];break;case 10:m=G[u][F];break;case 11:x=G[u][F];break;case 12:s=G[u][F];break;case 13:A=G[u][F];break;default:var E=bootbox.alert({title:"Error-Validating Selected File",size:"small",message:'<span style="color:red;font-weight:bold:">An error occurred reading this file.Invalid Column in File!</span>',callback:function(){a=false;e.abort()}})}}if(v===0){if(p.toUpperCase()==="LOAN NO"&&n.toUpperCase()==="REPAY DATE**"&&o.toUpperCase()==="BEGINNING BALANCE**"){}else{var E=bootbox.alert({title:"Error-Import Loan Schedules",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){a=false;e.abort()}})}}if(1==1){c=c+p.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+n.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+C.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+z.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+t.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+I.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+B.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+w.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+m.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+x.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+s.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+A.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";H++}r=0;v++}f+='<br/><span style="color:blue;font-weight:bold;">No. of Valid Rows:'+H;f+="<br/>Total No. of Rows:"+v+"</span>";$("#fileInformation").html(f)}catch(q){var E=bootbox.alert({title:"Error-Import Loan Schedules",size:"small",message:"Error:"+q.message,callback:function(){a=false;e.abort()}})}};e.readAsText(h)},500)},buttons:[{label:"Cancel",icon:"glyphicon glyphicon-menu-left",cssClass:"btn-default",action:function(k){a=false;e.abort();k.close()}},{id:"btn-srvr-prcs",label:"Start Server Processing",icon:"glyphicon glyphicon-menu-right",cssClass:"btn-primary",action:function(l){if(a==true){l.close();saveLoanSchedules(c)}else{var k=bootbox.alert({title:"Error-Import Loan Schedules",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){}})}}}]})});performFileClick("allOtherFileInput6")}}}})}function saveLoanSchedules(b){if(b.trim()===""){bootbox.alert({title:"System Alert!",size:"small",message:'<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;">No Data to Send!</span></p>'});return false}var a=bootbox.alert({title:"Importing Loan Schedules/Processes",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Importing Loan Schedules/Processes...Please Wait...</div>',callback:function(){clearInterval(prgstimerid2);getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.2")}});a.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.2,q:"UPDATE",actyp:5,dataToSend:b}});prgstimerid2=window.setInterval(rfrshSaveLoanSchedules,1000)})})}function rfrshSaveLoanSchedules(){$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.1,q:"UPDATE",actyp:6},success:function(b){var a=document.getElementById("myBar1");a.style.width=b.percent+"%";$("#myInformation1").html(b.message);if(b.percent>=100){window.clearInterval(prgstimerid2)}},error:function(a,c,b){console.log(c+" "+b);console.warn(a.responseText)}})}function viewRefLoanRqst(){var a=typeof $("#refLoanrqstID").val()==="undefined"?-1:$("#refLoanrqstID").val();if(parseInt(a)>0){getLoanRqstForm("myFormsModalLgz","myFormsModalBodyLgz","myFormsModalTitleLgz","View Loan Request",15,4.1,0,"VIEW",a,"indCustTable","indCustTableRow1")}else{bootbox.alert({title:"Rhomicom Alert",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid Reference Loan!</span>',callback:function(){}});return false}}function rjctAutrzCustDataRqst(d,c,e,g){var f;var h;var j=1;var a="Withdrawing.";var b="Are you sure you want to "+d+" this Change Request?";if(d=="REJECT"){a="Rejecting.";j=2}else{if(d=="AUTHORIZE"){a="Authorizing.";j=3}}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var m;var l=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var k=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();bootbox.confirm({title:"Rhomicom Message",message:b,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(n){if(n){f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">'+a+". Please Wait...</span></div>"});f.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=q/2;return r+"px"}});var o=new FormData();o.append("grp",17);o.append("typ",1);o.append("q","UPDATE");o.append("pg",c);o.append("subPgNo",e);o.append("vtyp",g);o.append("custID",l);o.append("actyp",j);o.append("rvsnTtl",k);$.ajax({url:"index.php",type:"POST",data:o,async:true,success:function(p){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var q="";if(/^[\],:{}\s]*$/.test(p.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(p);if(d=="REJECT"){q="Change Request Successfully REJECTED!"}else{if(d=="AUTHORIZE"){q="Change Request Successfully AUTHORIZED!"}else{q="Change Request successfully WITHDRAWN"}}getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","View Customer Profile",11,e,0,"VIEW",l,"","indCustTableRow1",-1,function(){f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})})}else{q=p;f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function rjctAutrzCustDataRqstNew(e,c,f,h){var g;var j;var k=1;var a="Withdrawing.";var b="Are you sure you want to "+e+" this Change Request?";var d="VIEW CORPORATE CUSTOMER PROFILE";if(f==1.3){d="VIEW CUSTOMER GROUP"}if(e=="REJECT"){a="Rejecting.";k=2}else{if(e=="AUTHORIZE"){a="Authorizing.";k=3}}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var n;var m=typeof $("#custID").val()==="undefined"?-1:$("#custID").val();var l=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();bootbox.confirm({title:"Rhomicom Message",message:b,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(o){if(o){g=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">'+a+". Please Wait...</span></div>"});g.find(".modal-content").css({"margin-top":function(){var r=$(window).height();var q=$(".modal-dialog").height();var s=r/2;return s+"px"}});var p=new FormData();p.append("grp",17);p.append("typ",1);p.append("q","UPDATE");p.append("pg",c);p.append("subPgNo",f);p.append("vtyp",h);p.append("custID",m);p.append("actyp",k);p.append("rvsnTtl",l);$.ajax({url:"index.php",type:"POST",data:p,async:true,success:function(q){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var r="";if(/^[\],:{}\s]*$/.test(q.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){n=$.parseJSON(q);if(e=="REJECT"){r="Change Request Successfully REJECTED!"}else{if(e=="AUTHORIZE"){r="Change Request Successfully AUTHORIZED!"}else{r="Change Request successfully WITHDRAWN"}}getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg",d,11,f,0,"VIEW",m,"","indCustTableRow1",-1,function(){g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:r,callback:function(){}})})}else{r=q;g.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:r,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function rjctAutrzPrsnDataRqst(d,c,e,g){var f;var h;var j=1;var a="Withdrawing.";var b="Are you sure you want to "+d+" this Change Request?";if(d=="REJECT"){a="Rejecting.";j=2}else{if(d=="AUTHORIZE"){a="Authorizing.";j=3}}getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");var m;var l=typeof $("#personID").val()==="undefined"?-1:$("#personID").val();var k=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();bootbox.confirm({title:"Rhomicom Message",message:b,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(n){if(n){f=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;">'+a+". Please Wait...</span></div>"});f.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=q/2;return r+"px"}});var o=new FormData();o.append("grp",17);o.append("typ",1);o.append("q","UPDATE");o.append("pg",c);o.append("subPgNo",e);o.append("vtyp",g);o.append("personID",l);o.append("actyp",j);o.append("rvsnTtl",k);$.ajax({url:"index.php",type:"POST",data:o,async:true,success:function(p){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var q="";if(/^[\],:{}\s]*$/.test(p.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=$.parseJSON(p);if(d=="REJECT"){q="Change Request Successfully REJECTED!"}else{if(d=="AUTHORIZE"){q="Change Request Successfully AUTHORIZED!"}else{q="Change Request successfully WITHDRAWN"}}getCustomersForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","View Customer Profile",11,e,0,"VIEW",l,"","indCustTableRow1",-1,function(){f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})})}else{q=p;f.modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})}},cache:false,contentType:false,processData:false})}}})})}function rejectAuthorizedCustAccnt(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var j;var f=typeof $("#acctID").val()==="undefined"?-1:$("#acctID").val();var e=typeof $("#rvsnTtl").val()==="undefined"?0:$("#rvsnTtl").val();$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var g;var k="Are you sure you want to submit account for Approval?";if(d=="REJECT"){g=2;k="Are you sure you want to reject this Customer Account?"}else{if(d=="WITHDRAW"){g=3;k="Are you sure you want to withdraw this Customer Account?"}else{g=4;k="Are you sure you want to Authorize this Customer Account?"}}var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("pg",a);h.append("subPgNo",c);h.append("q","UPDATE");h.append("vtyp",b);h.append("actyp",g);h.append("acctID",f);h.append("accMndte",accMndte);h.append("rvsnTtl",e);bootbox.confirm({title:"Rhomicom Message",message:k,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(l){if(l){$body=$("body");$body.addClass("mdlloadingDiag");$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(m){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var n="";if(/^[\],:{}\s]*$/.test(m.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=$.parseJSON(m);f=j.acctID}else{}getCustAcctsForm("myFormsModalCA","myFormsModalBodyCA","myFormsModalTitleCA","View Customer Account",13,2.1,0,"VIEW",f,"custAcctTable","indCustTableRow1",-1,function(){bootbox.alert({size:"small",title:"Rhomicom Message",message:m,callback:function(){}})})},cache:false,contentType:false,processData:false})}}})})}function imprtOverdraftDisbursements(){var h="Overdraft Disbursements";var g="";var b=true;var e="";if(rhotrim(e,"; ")!==""){bootbox.alert({title:"System Alert!",message:e});return false}var d;var a;var f;var c;f=bootbox.confirm({size:"small",message:"Are you sure you want to import Overdraft Disbursements?",callback:function(j){if(j){c=bootbox.alert({title:"Save "+h,size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Processing '+h+"...Please Wait...</p>",callback:function(){getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.2")}});c.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.2,q:"UPDATE",actyp:2},success:function(k){setTimeout(function(){c.find(".bootbox-body").html(k)},500)},error:function(k,m,l){console.warn(k.responseText)}})})})}}});f.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function getAllGuarantors(c,f,d){var b=typeof $("#allGuarantorsSrchFor").val()==="undefined"?"%":$("#allGuarantorsSrchFor").val();var a=typeof $("#allGuarantorsPageNo").val()==="undefined"?1:$("#allGuarantorsPageNo").val();var e=typeof $("#allGuarantorsDsplySze").val()==="undefined"?10:$("#allGuarantorsDsplySze").val();if(c=="clear"){b="%";a=1}else{if(c=="next"){a=parseInt(a)+1}else{if(c=="previous"){a=parseInt(a)-1}}}d=d+"&searchfor="+b+"&pageNo="+a+"&limitSze="+e;openATab(f,d)}function enterKeyFuncAllGuarantors(c,b,f,d){var a=(typeof c.which==="number")?c.which:c.keyCode;if(a==13){getAllGuarantors(b,f,d)}}function onChangeOfGrpApplcntType(){var a=typeof $("#grpApplicantType").val()==="undefined"?"":$("#grpApplicantType").val();if(a=="Group"){$("#bnkCustomerLbl").css("display","none");$("#bnkCustomerID").val($("#custGrpID").val());$("#bnkCustomer").val($("#custGrp").val());$("#grpMembersDiv").css("display","block")}else{$("#bnkCustomerLbl").css("display","");$("#bnkCustomerID").val(-1);$("#bnkCustomer").val("");$("#grpMembersDiv").css("display","none")}}function imprtCustAccntsTrnsctns(){var c="";var a=true;var b=bootbox.confirm({custNo:"Import Customer Accounts Transactions?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:green;font-weight:bold;font-style:italic;">IMPORT CUSTOMER ACCOUNT TRANSACTIONS</span>?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(d){if(d===true){if(isReaderAPIAvlbl()){$("#allOtherFileInput6").val("");$("#allOtherFileInput6").off("change");$("#allOtherFileInput6").change(function(){var j=$(this).val();var g=document.getElementById("allOtherFileInput6");var h=g.files[0];var f="";f+='<span style="font-weight:bold;">'+escape(h.name)+"</span><br />\n";f+=" - FileType: "+(h.type||"n/a")+"<br />\n";f+=" - FileSize: "+h.size+" bytes<br />\n";f+=" - LastModified: "+(h.lastModifiedDate?h.lastModifiedDate.toLocaleDateString():"n/a")+"<br />\n";var e=new FileReader();BootstrapDialog.show({size:BootstrapDialog.SIZE_LARGE,type:BootstrapDialog.TYPE_DEFAULT,custNo:"Validating Selected File",message:'<div id="myProgress"><div id="myBar"></div></div><div id="myInformation"><i class="fa fa-spin fa-spinner"></i> Validating Selected File...Please Wait...</div><br/><div id="fileInformation">'+f+"</div>",animate:true,closable:true,closeByBackdrop:false,closeByKeyboard:false,onshow:function(k){setTimeout(function(){var l=k.getButton("btn-srvr-prcs");l.disable();e.onerror=function(m){switch(m.target.error.code){case m.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case m.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case m.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};e.onprogress=function(n){if(n.lengthComputable){var m=Math.round((n.loaded/n.total)*100);var o=document.getElementById("myBar");o.style.width=m+"%";if(m<100){$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>'+m+"% Validating Selected File...Please Wait...</span>")}else{$("#myInformation").html('<span style="color:green;"><i class="fa fa-check"></i>'+m+"% Validating Selected File Completed!</span>");var p=k.getButton("btn-srvr-prcs");if(a==true){p.enable()}else{p.disable()}}}};e.onabort=function(m){alert("File read cancelled")};e.onloadstart=function(n){var m=document.getElementById("myBar");m.style.width="1%";$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>1% Started Importing Customer Accounts...Please Wait...</span>')};e.onload=function(I){try{var B=I.target.result;var O=$.csv.toArrays(B);var y=0;var u=0;var R=0;var p="";var Q="";var J="";var v="";var r="";var F="";var L="";var q="";var G="";var z="";var o="";var w="";var A="";var P=999;var m=99999999;var n="";var D="";var N="";var H="";var s="";var E="";var C=0;for(var x in O){for(var M in O[x]){u++;switch(u){case 1:p=O[x][M];break;case 2:Q=O[x][M];break;case 3:J=O[x][M];break;case 4:v=O[x][M];break;case 5:r=O[x][M];break;case 6:F=O[x][M];break;case 7:L=O[x][M];break;case 8:q=O[x][M];break;case 9:G=O[x][M];break;case 10:z=O[x][M];break;case 11:o=O[x][M];break;case 12:w=O[x][M];break;case 13:A=O[x][M];break;case 14:P=O[x][M];break;case 15:m=O[x][M];break;case 16:n=O[x][M];break;case 17:D=O[x][M];break;case 18:N=O[x][M];break;case 19:H=O[x][M];break;case 20:s=O[x][M];break;case 21:E=O[x][M];break;case 22:C=O[x][M];break;default:var K=bootbox.alert({custNo:"Error-Validating Selected File",size:"small",message:'<span style="color:red;font-weight:bold:">An error occurred reading this file.Invalid Column in File!</span>',callback:function(){a=false;e.abort()}})}}if(y===0){if(p.toUpperCase()==="NO."&&Q.toUpperCase()==="CUSTOMER TYPE**"&&J.toUpperCase()==="CUSTOMER NO.**"){}else{var K=bootbox.alert({custNo:"Error-Import Customer Account Transactions",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){a=false;e.abort()}})}}if(1==1){c=c+p.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+Q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+J.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+v.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+r.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+F.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+L.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+q.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+G.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+z.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+w.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+A.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+P.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+m.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+n.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+D.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+N.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+H.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+s.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+E.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+C.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";R++}u=0;y++}f+='<br/><span style="color:blue;font-weight:bold;">No. of Valid Rows:'+R;f+="<br/>Total No. of Rows:"+y+"</span>";$("#fileInformation").html(f)}catch(t){var K=bootbox.alert({custNo:"Error-Import Customer Accounts",size:"small",message:"Error:"+t.message,callback:function(){a=false;e.abort()}})}};e.readAsText(h)},500)},buttons:[{label:"Cancel",icon:"glyphicon glyphicon-menu-left",cssClass:"btn-default",action:function(k){a=false;e.abort();k.close()}},{id:"btn-srvr-prcs",label:"Start Server Processing",icon:"glyphicon glyphicon-menu-right",cssClass:"btn-primary",action:function(l){if(a==true){l.close();saveCustAccnts(c)}else{var k=bootbox.alert({custNo:"Error-Import Customer Accounts",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){}})}}}]})});performFileClick("allOtherFileInput6")}}}})}function populateLoanSchedules(){var h="Overdraft Disbursements";var g="";var b=true;var e="";if(rhotrim(e,"; ")!==""){bootbox.alert({title:"System Alert!",message:e});return false}var d;var a;var f;var c;f=bootbox.confirm({size:"small",message:"Are you sure you want to pupulate Loan Schedules?",callback:function(j){if(j){c=bootbox.alert({title:"Pupulate Loan Schedules",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Populating Loan Schedules...Please Wait...</p>',callback:function(){getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.2")}});c.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.2,q:"UPDATE",actyp:3},success:function(k){setTimeout(function(){c.find(".bootbox-body").html(k)},500)},error:function(k,m,l){console.warn(k.responseText)}})})})}}});f.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}})}function getOneMergeCustsForm(d,c,a,f,g,e){if(typeof a==="undefined"||a===null){a="ShowDialog"}if(typeof f==="undefined"||f===null){f=13}var b="grp=17&typ=1&pg=1&subPgNo=1.9&sbmtdRowID="+d+"&tblrVwTyp="+f;doAjaxWthCallBck(b,"myFormsModaly",a,g,"myFormsModalyTitle","myFormsModalyBody",function(){if(!$.fn.DataTable.isDataTable("#oneVmsTrnsLnsTable")){var h=$("#oneVmsTrnsLnsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false})}$("#oneVmsTrnsLnsTable").wrap('<div class="dataTables_scroll"/>');$("#myFormsModaly").off("hidden.bs.modal");$("#myFormsModaly").one("hidden.bs.modal",function(j){$("#myFormsModalyBody").html("");getCustData("","#allmodules","grp=17&typ=1&pg=1&subPgNo="+c,e);$(j.currentTarget).unbind()})})}function insertNewMergeCustsRowsNew(c,a,b){insertNewRowBe4(c,a,b,function(){$('[data-toggle="tooltip"]').tooltip();$(".vmsCbTtl").focus(function(){$(this).select()});$(".vmsCbQty").focus(function(){$(this).select()});$(".vmsFncCrncy").focus(function(){$(this).select()})})}function mergeCustsNos(a,c,b){var d;$body=$("body");var e="";var f=0;$("#oneMergeCustsLnsTable").find("tr").each(function(k,m){if(k>0){if(typeof $(m).attr("id")==="undefined"){}else{var j=$(m).attr("id").split("_")[1];if(typeof $("#oneMergeCustsRow"+j+"_prmryCustNo").val()==="undefined"){}else{var h=true;var g=typeof $("#oneMergeCustsRow"+j+"_prmryCustNo").val()==="undefined"?"":$("#oneMergeCustsRow"+j+"_prmryCustNo").val();if(g==""){h=false;$("#oneMergeCustsRow"+j+"_prmryCustNo").addClass("rho-error")}else{$("#oneMergeCustsRow"+j+"_prmryCustNo").removeClass("rho-error")}var l=typeof $("#oneMergeCustsRow"+j+"_scndryCustNo").val()==="undefined"?0:$("#oneMergeCustsRow"+j+"_scndryCustNo").val();if(l==""){h=false;$("#oneMergeCustsRow"+j+"_scndryCustNo").addClass("rho-error")}else{$("#oneMergeCustsRow"+j+"_scndryCustNo").removeClass("rho-error")}if(h===true){e=e+$("#oneMergeCustsRow"+j+"_prmryCustNo").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#oneMergeCustsRow"+j+"_scndryCustNo").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";f=f+1}else{$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Fix all Highlighted Errors1!",callback:function(){}});return false}}}}});if(f<=0){$body.removeClass("mdlloadingDiag");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Fix all Highlighted Errors2!",callback:function(){}});return false}bootbox.confirm({title:"Rhomicom Message",message:"Are you sure you want to Merge these Customer Numbers?",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(g){if(g){$body.addClass("mdlloadingDiag");var h;if(window.XMLHttpRequest){h=new XMLHttpRequest()}else{h=new ActiveXObject("Microsoft.XMLHTTP")}h.onreadystatechange=function(){if(h.readyState===4&&h.status===200){var j=h.responseText;if(j=="Merger Succcessful"){$("#myFormsModaly").modal("hide");bootbox.alert({size:"small",title:"Rhomicom Message",message:j,callback:function(){}})}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:j,callback:function(){}})}$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloadingDiag")}};h.open("POST","index.php",true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send("grp=17&typ=1&pg=11&vtyp="+c+"&q=UPDATE&subPgNo="+b+"&slctdTrnsCustNoLines="+e)}}})}function removeSltdAgntRcd(a){$("#"+a).remove()}function autoLoadGrpMembers(){var a="Group Members";var c="";var h=true;var e="";if(rhotrim(e,"; ")!==""){bootbox.alert({title:"System Alert!",message:e});return false}var k=typeof $("#loanRqstID").val()==="undefined"?-1:$("#loanRqstID").val();var j=typeof $("#custGrpID").val()==="undefined"?-1:$("#custGrpID").val();var l=typeof $("#custType").val()==="undefined"?"":$("#custType").val();if(l=="Group"&&j==-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");$("#custGrp").css("border-color","red");$("#custGrp").css("border-width","2px");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Group First!",callback:function(){}});return false}if(k==""||parseInt(k)<=-1){$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please save Loan Request First!",callback:function(){}});return false}var d;var g;var b;var f;b=bootbox.confirm({size:"small",message:"Are you sure you want to AUTO-LOAD Group Members?",callback:function(m){if(m){f=bootbox.alert({title:"AUTO-LOAD Group",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> AUTO-LOADING Group Members...Please Wait...</p>',callback:function(){getLoanRqstForm("myFormsModalLg","myFormsModalBodyLg","myFormsModalTitleLg","Edit Loan Request",15,4.1,0,"EDIT",k,"indCustTable","indCustTableRow1")}});f.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.1,q:"UPDATE",actyp:3,loanRqstID:k,grpCustId:j},success:function(n){setTimeout(function(){f.find(".bootbox-body").html(n)},500)},error:function(n,p,o){console.warn(n.responseText)}})})})}}});b.find(".modal-content").css({"margin-top":function(){var n=$(window).height();var m=$(".modal-dialog").height();var o=(n-m-150)/2;return o+"px"}})}function delLoanGrpMembers(d){var a=d.split("_")[1];var c=-1;var e="Group Member";if(typeof $("#grpMembersDetRow"+a+"_PkeyID").val()==="undefined"){}else{c=$("#grpMembersDetRow"+a+"_PkeyID").val()}var b=bootbox.confirm({title:"Remove "+e+"?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">REMOVE</span> this '+e+"?<br/>Action cannot be Undone!</p>",buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(f){if(f===true){var g=bootbox.alert({title:"Remove "+e+"?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Removing '+e+"...Please Wait...</p>"});g.init(function(){if(c>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,q:"DELETE",subPgNo:4.1,actyp:2,PKeyID:c},success:function(h){setTimeout(function(){g.find(".bootbox-body").html(h);if(h.indexOf("Success")!==-1){$("#"+d).remove()}},500)},error:function(k,h,j){g.find(".bootbox-body").html(j)}})})}else{setTimeout(function(){$("#"+d).remove();g.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function printStatementOfAccount(l,e,d,c,a,b){var h=typeof $("#StrtDate").val()==="undefined"?"01-Jan-1900":$("#StrtDate").val();var f=typeof $("#EndDate").val()==="undefined"?"31-Dec-4000":$("#EndDate").val();var k=typeof $("#acctNoFindAccId").val()==="undefined"?-1:$("#acctNoFindAccId").val();var g="";var j=e+"~"+k+"|"+c+"~"+h+"|"+a+"~"+f+"|"+d+"~"+b+"|-190~PDF";g=encodeURI(j);if(k>0){getSilentRptsRnSts(l,-1,g)}else{bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select an account number First!",callback:function(){}});return false}}function populateCashColt(a,c,b,e){var d=$("#"+a).val();if(d==""||parseInt(d)<=0){$("#"+a).val($("#"+b).val());$("#"+c).val($("#"+e).val())}}function getInvestmentsLqdtnForm(k,l,b,n,c,e,f,g,d,h,m){$("#allOtherInputData99").val(0);if(typeof m==="undefined"||m===null){m=function(){var o=1}}$("#tblRowID").val(h);if(!$.fn.DataTable.isDataTable("#indCustTable")){var j=$("#indCustTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#indCustTable tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{j.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#indCustTable tbody").on("mouseenter","tr",function(){if($(this).hasClass("highlight")){$(this).removeClass("highlight")}else{j.$("tr.highlight").removeClass("highlight");$(this).addClass("highlight")}})}$body=$("body");$body.addClass("mdlloadingDiag");var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){$("#"+b).html(n);$("#"+l).html(a.responseText);$("#"+k).off("hidden.bs.modal");$("#"+k).one("hidden.bs.modal",function(o){getCustData("","#allmodules","grp=17&typ=1&pg=5&subPgNo="+e,"invstmntsLqdtn");$("#"+b).html("");$("#"+l).html("");$(o.currentTarget).unbind()});$(function(){$(".form_date").datetimepicker({format:"d-M-yyyy",language:"en",weekStart:0,todayBtn:true,autoclose:true,todayHighlight:true,keyboardNavigation:true,startView:2,minView:2,maxView:4,forceParse:true})});$("#"+k).off("show.bs.modal");$("#"+k).on("show.bs.modal",function(o){$(this).find(".modal-body").css({"max-height":"100%"})});$body.removeClass("mdlloadingDiag");$("#"+k).modal({backdrop:"static",keyboard:false});$body=$("body");$(document).ready(function(){m()})}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg="+c+"&subPgNo="+e+"&vtyp="+f+"&vtypActn="+g+"&lqdtnID="+d)}function deleteInvestmentLqdtn(d){var b;var a;var c;c=bootbox.confirm({size:"small",message:"Are you sure you want to delete this Liquidation?",callback:function(e){if(e){b=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Deleting. Please Wait...</div>'});b.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g)/2;return k+"px"}});var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject("Microsoft.XMLHTTP")}f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var g=f.responseText;b.modal("hide");if(g=="SORRY"){a=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Failed to Delete Liquidation.</br>Only Liquidations with statuses 'Incomplete','Rejected' or 'Withdrawn' can be deleted.",callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});return false}a=bootbox.alert({size:"small",title:"Rhomicom Message",message:g,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});getCustData("clear","#allmodules","grp=17&typ=1&pg=5&subPgNo=5.3","invstmntsLqdtn")}};f.open("POST","index.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send("grp=17&typ=1&pg=25&subPgNo=5.3&q=DELETE&lqdtnID="+d)}}});c.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function dsplyInvstmntForm(){var a=typeof $("#invstmntID2").val()==="undefined"?-1:$("#invstmntID2").val();if(parseInt(a)<=0){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please Select an Investment First",callback:function(){}});return false}getInvestmentsForm("myFormsModalLgZ","myFormsModalLgZBody","myFormsModalLgZTitle","View Investment",25,5.2,0,"VIEW",a,"indCustTableRow1")}function saveInvestmentLqdtn(a,d,c){var e;var b;getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){var k;var m=typeof $("#lqdtnId").val()==="undefined"?-1:$("#lqdtnId").val();var l=typeof $("#lqdtnTrnsDte").val()==="undefined"?"":$("#lqdtnTrnsDte").val();var j=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var f=typeof $("#lqdtnOfficerID").val()==="undefined"?-1:$("#lqdtnOfficerID").val();var g=typeof $("#invstmntID").val()==="undefined"?-1:$("#invstmntID").val();var o=typeof $("#lqdtnReason").val()==="undefined"?"":$("#lqdtnReason").val();var n=typeof $("#lqdtnTtlInterest").val()==="undefined"?0:$("#lqdtnTtlInterest").val();if(parseInt(g)<=0||g==-1||g==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select an Investment",callback:function(){}});return false}if(o.trim()==""||o==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide purpose of Liquidation",callback:function(){}});return false}$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");e=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i><span style="font-weight:bold; color:green;"> Saving. Please Wait...</span></div>'});e.find(".modal-content").css({"margin-top":function(){var q=$(window).height();var p=$(".modal-dialog").height();var r=q/2;return r+"px"}});var h=new FormData();h.append("grp",17);h.append("typ",1);h.append("q","UPDATE");h.append("pg",a);h.append("subPgNo",d);h.append("vtyp",c);h.append("lqdtnId",m);h.append("lqdtnTrnsDte",l);h.append("bnkBranchID",j);h.append("lqdtnOfficerID",f);h.append("invstmntID",g);h.append("lqdtnReason",o);$.ajax({url:"index.php",type:"POST",data:h,async:true,success:function(p){var q="";if(/^[\],:{}\s]*$/.test(p.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){k=$.parseJSON(p);$("#lqdtnId").val(k.lqdtnId);e.modal("hide");getInvestmentsLqdtnForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Investment Liquidation",25,d,0,"EDIT",k.lqdtnId,"indCustTableRow1",function(){b=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Investment Liquidation Successfully Saved!",callback:function(){}})})}else{q=p;e.modal("hide");b=bootbox.alert({size:"small",title:"Rhomicom Message",message:q,callback:function(){}})}},cache:false,contentType:false,processData:false})})}function submitWithdrawlqdtn(a,c,b,d){getMsgAsync("grp=1&typ=11&q=Check Session",function(){var m;var n;var t;var l;var h="";var p="";$body.removeClass("mdlloadingDiag");$body.removeClass("mdlloading");var s=typeof $("#lqdtnId").val()==="undefined"?-1:$("#lqdtnId").val();var q=typeof $("#lqdtnTrnsDte").val()==="undefined"?"":$("#lqdtnTrnsDte").val();var k=typeof $("#bnkBranchID").val()==="undefined"?-1:$("#bnkBranchID").val();var e=typeof $("#lqdtnOfficerID").val()==="undefined"?-1:$("#lqdtnOfficerID").val();var g=typeof $("#invstmntID").val()==="undefined"?-1:$("#invstmntID").val();var u=typeof $("#lqdtnReason").val()==="undefined"?"":$("#lqdtnReason").val();var r=typeof $("#lqdtnTtlInterest").val()==="undefined"?0:$("#lqdtnTtlInterest").val();var o;var f="Are you sure you want to submit Investment Liquidation for Authorization?";if(d=="SUBMIT"){o=99;p="SUBMITTED for Authorization";h="Submitting...";if(parseInt(g)<=0||g==-1||g==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please select a Loan Request",callback:function(){}});return false}if(u.trim()==""||u==undefined){bootbox.alert({size:"small",title:"Rhomicom Message",message:"Please provide Write-Off Reason",callback:function(){}});return false}}else{if(d=="WITHDRAW"){p="WITHDRAWN";h="Withdrawing...";o=3;f="Are you sure you want to Withdrawal Investment Liquidation?"}else{if(d=="REJECT"){p="REJECTED";h="Rejecting...";o=4;f="Are you sure you want to Reject Investment Liquidation?"}else{if(d=="AUTHORIZE"){p="AUTHORIZED";h="Authorizing...";o=5;f="Are you sure you want to Authorize Investment Liquidation?"}else{if(d=="REVERSE"){p="REVERSED";h="Reversing...";o=6;f="Are you sure you want to REVERSE this Investment Liquidation?";bootbox.alert({size:"small",title:"Rhomicom Message",message:"Constructing.......Please Wait",callback:function(){}});return false}}}}}var j=new FormData();j.append("grp",17);j.append("typ",1);j.append("pg",a);j.append("subPgNo",c);j.append("q","UPDATE");j.append("vtyp",b);j.append("actyp",o);j.append("lqdtnId",s);j.append("lqdtnTrnsDte",q);j.append("bnkBranchID",k);j.append("lqdtnOfficerID",e);j.append("invstmntID",g);j.append("lqdtnReason",u);j.append("lqdtnTtlInterest",r);l=bootbox.confirm({title:"Rhomicom Message",message:f,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(v){if(v){$body.removeClass("mdlloading");$body.removeClass("mdlloadingDiag");n=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> '+h+" Please Wait...</div>"});n.find(".modal-content").css({"margin-top":function(){var y=$(window).height();var x=$(".modal-dialog").height();var z=(y-x)/2;return z+"px"}});$.ajax({url:"index.php",type:"POST",data:j,async:true,success:function(w){n.modal("hide");var x="";if(/^[\],:{}\s]*$/.test(w.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){getInvestmentsLqdtnForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Investment Liquidation",25,c,0,"EDIT",s,"indCustTableRow1",function(){t=bootbox.alert({size:"small",title:"Rhomicom Message",message:"Investment Liquidation Successfully "+p,callback:function(){}})})}else{t=bootbox.alert({size:"small",title:"Rhomicom Message",message:w,callback:function(){}});return false}t.find(".modal-content").css({"margin-top":function(){var z=$(window).height();var y=$(".modal-dialog").height();var A=(z-y-150)/2;return A+"px"}})},cache:false,contentType:false,processData:false})}}})});mnBox.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e-150)/2;return g+"px"}})}function processlqdtn(b){$("#prcsLqdtnBtn").attr("disabled","disabled");$("#rvsLqdtnBtn").attr("disabled","disabled");var f=typeof $("#lqdtnId").val()==="undefined"?-1:$("#lqdtnId").val();var c;var a;var e;var d="PROCESS";if(b==1){d="VOID"}e=bootbox.confirm({size:"small",message:"Are you sure you want to "+d+" this Investment Liquidation?</br>Please Note: This action cannot be undone if you select 'Yes'",callback:function(g){if(g){c=bootbox.alert({title:"Processing........",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Processesing...Please Wait...</div>',callback:function(){}});c.find(".modal-content").css({"margin-top":function(){var k=$(window).height();var j=$(".modal-dialog").height();var l=(k-j-150)/2;return l+"px"}});var h;if(window.XMLHttpRequest){h=new XMLHttpRequest()}else{h=new ActiveXObject("Microsoft.XMLHTTP")}h.onreadystatechange=function(){var j;if(h.readyState===4&&h.status===200){$("#prcsLqdtnBtn").removeAttr("disabled");$("#rvsLqdtnBtn").removeAttr("disabled");j=h.responseText;getInvestmentsLqdtnForm("myFormsModalxLG","myFormsModalxLGBody","myFormsModalxLGTitle","Edit Investment Liquidation",25,5.3,0,"EDIT",f,"indCustTableRow1",function(){c.modal("hide");a=bootbox.alert({size:"small",title:"Rhomicom Message",message:j,callback:function(){}});a.find(".modal-content").css({"margin-top":function(){var l=$(window).height();var k=$(".modal-dialog").height();var m=(l-k-150)/2;return m+"px"}})})}};h.open("POST","index.php",true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send("grp=17&typ=1&pg=25&subPgNo=5.3&q=UPDATE&actyp=1&lqdtnId="+f+"&prcsOptn="+b)}}});e.find(".modal-content").css({"margin-top":function(){var j=$(window).height();var g=$(".modal-dialog").height();var k=(j-g-150)/2;return k+"px"}})}function getAccountStatementKD(b){var a=(typeof b.which==="number")?b.which:b.keyCode;if(a==13){getAccountStatement("","#allmodules","grp=17&typ=1&pg=2&subPgNo=2.3")}}function onClickAcctProduct(){var a=$("#dataAdminPrdtTypeSrchIn option:selected").val();if(a==="All Account Types"){bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red !important;'><i>Please select an Account Type First!</i></span>",callback:function(){}});return false}else{if(a==="Loan"){getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","MCF All Loan Products","dataAdminPrdtTypeSrchInID","","","radio",true,"","dataAdminBnkPrdtTypeSrchInID","dataAdminBnkPrdtTypeSrchIn","clear",1,"")}else{getLovsPage("myLovModal","myLovModalTitle","myLovModalBody","MCF All Savings and Investments Products","dataAdminPrdtTypeSrchInID","","","radio",true,"","dataAdminBnkPrdtTypeSrchInID","dataAdminBnkPrdtTypeSrchIn","clear",1,"")}}}function imprtLoanDsbsmntDates(){var c="";var a=true;var b=bootbox.confirm({title:"Import Loan Disbursement Dates?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:green;font-weight:bold;font-style:italic;">IMPORT LOAN DISBURSEMENT DATES</span>?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(d){if(d===true){if(isReaderAPIAvlbl()){$("#allOtherFileInput6").val("");$("#allOtherFileInput6").off("change");$("#allOtherFileInput6").change(function(){var j=$(this).val();var g=document.getElementById("allOtherFileInput6");var h=g.files[0];var f="";f+='<span style="font-weight:bold;">'+escape(h.name)+"</span><br />\n";f+=" - FileType: "+(h.type||"n/a")+"<br />\n";f+=" - FileSize: "+h.size+" bytes<br />\n";f+=" - LastModified: "+(h.lastModifiedDate?h.lastModifiedDate.toLocaleDateString():"n/a")+"<br />\n";var e=new FileReader();BootstrapDialog.show({size:BootstrapDialog.SIZE_LARGE,type:BootstrapDialog.TYPE_DEFAULT,title:"Validating Selected File",message:'<div id="myProgress"><div id="myBar"></div></div><div id="myInformation"><i class="fa fa-spin fa-spinner"></i> Validating Selected File...Please Wait...</div><br/><div id="fileInformation">'+f+"</div>",animate:true,closable:true,closeByBackdrop:false,closeByKeyboard:false,onshow:function(k){setTimeout(function(){var l=k.getButton("btn-srvr-prcs");l.disable();e.onerror=function(m){switch(m.target.error.code){case m.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case m.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case m.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};e.onprogress=function(n){if(n.lengthComputable){var m=Math.round((n.loaded/n.total)*100);var o=document.getElementById("myBar");o.style.width=m+"%";if(m<100){$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>'+m+"% Validating Selected File...Please Wait...</span>")}else{$("#myInformation").html('<span style="color:green;"><i class="fa fa-check"></i>'+m+"% Validating Selected File Completed!</span>");var p=k.getButton("btn-srvr-prcs");if(a==true){p.enable()}else{p.disable()}}}};e.onabort=function(m){alert("File read cancelled")};e.onloadstart=function(n){var m=document.getElementById("myBar");m.style.width="1%";$("#myInformation").html('<span style="color:green;"><i class="fa fa-spin fa-spinner"></i>1% Started Importing Loan Disbursement Dates...Please Wait...</span>')};e.onload=function(n){try{var q=n.target.result;var r=$.csv.toArrays(q);var v=0;var s=0;var u=0;var o="";var m="";for(var x in r){for(var w in r[x]){s++;switch(s){case 1:o=r[x][w];break;case 2:m=r[x][w];break;default:var t=bootbox.alert({title:"Error-Validating Selected File",size:"small",message:'<span style="color:red;font-weight:bold:">An error occurred reading this file.Invalid Column in File!</span>',callback:function(){a=false;e.abort()}})}}if(v===0){if(o.toUpperCase()==="LOANNO"&&m.toUpperCase()==="DISBURSEDDATE"){}else{var t=bootbox.alert({title:"Error-Import Loan Disbursement Date",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){a=false;e.abort()}})}}if(1==1){c=c+o.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+m.replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";u++}s=0;v++}f+='<br/><span style="color:blue;font-weight:bold;">No. of Valid Rows:'+u;f+="<br/>Total No. of Rows:"+v+"</span>";$("#fileInformation").html(f)}catch(p){var t=bootbox.alert({title:"Error-Import Loan Disbursement Dates",size:"small",message:"Error:"+p.message,callback:function(){a=false;e.abort()}})}};e.readAsText(h)},500)},buttons:[{label:"Cancel",icon:"glyphicon glyphicon-menu-left",cssClass:"btn-default",action:function(k){a=false;e.abort();k.close()}},{id:"btn-srvr-prcs",label:"Start Server Processing",icon:"glyphicon glyphicon-menu-right",cssClass:"btn-primary",action:function(l){if(a==true){l.close();saveLoanDsbsmntDates(c)}else{var k=bootbox.alert({title:"Error-Import Loan Disbursement Dates",size:"small",message:'<span style="color:red;font-weight:bold:">Invalid File Selected!</span>',callback:function(){}})}}}]})});performFileClick("allOtherFileInput6")}}}})}function saveLoanDsbsmntDates(b){if(b.trim()===""){bootbox.alert({title:"System Alert!",size:"small",message:'<p><span style="font-family: georgia, times;font-size: 12px;font-style:italic;font-weight:bold;">No Data to Send!</span></p>'});return false}var a=bootbox.alert({title:"Importing Loan Disbursement Dates/Processes",size:"small",message:'<div id="myProgress1"><div id="myBar1"></div></div><div id="myInformation1"><i class="fa fa-spin fa-spinner"></i> Importing Loan Disbursement Dates/Processes...Please Wait...</div>',callback:function(){clearInterval(prgstimerid2);getCustData("clear","#allmodules","grp=17&typ=1&pg=4&subPgNo=4.1")}});a.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.1,q:"UPDATE",actyp:6,dataToSend:b}});prgstimerid2=window.setInterval(rfrshSaveLoanDsbsmntDates,1000)})})}function rfrshSaveLoanDsbsmntDates(){$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:11,subPgNo:1.1,q:"UPDATE",actyp:6},success:function(b){var a=document.getElementById("myBar1");a.style.width=b.percent+"%";$("#myInformation1").html(b.message);if(b.percent>=100){window.clearInterval(prgstimerid2)}},error:function(a,c,b){console.log(c+" "+b);console.warn(a.responseText)}})}function displayCrdtCharts(){var b=document.getElementById("pieChart");var c=document.getElementById("barChart");var d=document.getElementById("lineChart");box=bootbox.dialog({size:"small",message:'<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Loading Charts. Please Wait...</div>'});box.find(".modal-content").css({"margin-top":function(){var f=$(window).height();var e=$(".modal-dialog").height();var g=(f-e)/2;return g+"px"}});var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{a=new ActiveXObject("Microsoft.XMLHTTP")}a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){var D=a.responseText;var k="";box.modal("hide");if(/^[\],:{}\s]*$/.test(D.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){obj=$.parseJSON(D);var q=obj.agingAnalsys.currentLn;var u=obj.agingAnalsys.upTo30Days;var x=obj.agingAnalsys.to60Days;var g=obj.agingAnalsys.to90Days;var r=obj.agingAnalsys.to120Days;var A=obj.agingAnalsys.to150Days;var o=obj.agingAnalsys.from151Days;var E=obj.dsbmntAnalysis001.January;var v=obj.dsbmntAnalysis001.February;var B=obj.dsbmntAnalysis001.March;var j=obj.dsbmntAnalysis001.April;var F=obj.dsbmntAnalysis001.May;var m=obj.dsbmntAnalysis001.June;var z=obj.dsbmntAnalysis002.January;var t=obj.dsbmntAnalysis002.February;var y=obj.dsbmntAnalysis002.March;var h=obj.dsbmntAnalysis002.April;var C=obj.dsbmntAnalysis002.May;var l=obj.dsbmntAnalysis002.June;if(b){var e=b.getContext("2d");var s=new Chart(e,{type:"pie",data:{labels:["Current Loans","Up to 30 days","31 -> 60 days","61 -> 90 days","91 -> 120 days","121 -> 150 days","151 days and above"],datasets:[{data:[q,u,x,g,r,A,o],backgroundColor:["#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360","#00FF00","#800080"],hoverBackgroundColor:["#FF5A5E","#5AD3D1","#FFC870","#A8B3C5","#616774","#00FF00","#800080"]}]},options:{responsive:true}})}if(c){var n=c.getContext("2d");var w=new Chart(n,{type:"bar",data:{labels:["Current Loans","Up to 30 days","31 -> 60 days","61 -> 90 days","91 -> 120 days","121 -> 150 days","151 days and above"],datasets:[{label:"Loan Aging Analysis",data:[q,u,x,g,r,A,o],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)","rgba(255, 255, 0, 0.3)"],borderColor:["rgba(255,99,132,1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)","rgba(255, 255, 0, 1)"],borderWidth:1}]},optionss:{scales:{yAxes:[{ticks:{beginAtZero:true}}]}}})}if(d){var f=d.getContext("2d");var p=new Chart(f,{type:"line",data:{labels:["January","February","March","April","May","June"],datasets:[{label:"Somanya",fillColor:"rgba(255, 99, 132, 0.2)",strokeColor:"rgba(255, 99, 132, 1)",pointColor:"rgba(255, 99, 132, 1)",pointStrokeColor:"#F7464A",pointHighlightFill:"#F7464A",pointHighlightStroke:"rgba(255, 99, 132, 1)",data:[E,v,B,j,F,m]},{label:"Nkrukan",fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:[z,t,y,h,C,l]}]},options:{responsive:true}})}}else{k=D;box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"No Data Found!",callback:function(){}})}}};a.open("POST","index.php",true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send("grp=17&typ=1&pg=4&subPgNo=4.11&vtyp=1")}function getOneSuplmntryRpymntAccntsForm(d,e,f,b,a){if(typeof b==="undefined"||b===null){b="ShowDialog"}var c="grp=17&typ=1&pg=15&subPgNo=4.112&vtyp="+e+"&vtypActn="+f+"&sbmtdLoanRqstID="+d+"&trnsStatus="+a;doAjaxWthCallBck(c,"myFormsModaly",b,"Supplemtary Repayment Accounts","myFormsModalyTitle","myFormsModalyBody",function(){$("#allOtherInputData99").val("0");$("#allSuplmntryRpymntAccntsForm").submit(function(h){h.preventDefault();return false});$("#myFormsModaly").off("hidden.bs.modal");$("#myFormsModaly").one("hidden.bs.modal",function(h){$(h.currentTarget).unbind()});if(!$.fn.DataTable.isDataTable("#allSuplmntryRpymntAccntsTable")){var g=$("#allSuplmntryRpymntAccntsTable").DataTable({paging:false,ordering:false,info:false,bFilter:false,scrollX:false});$("#allSuplmntryRpymntAccntsTable").wrap('<div class="dataTables_scroll"/>')}$('[data-toggle="tooltip"]').tooltip()})}function saveSuplmntryRpymntAccnts(e,c){var d=$("#sbmtdLoanRqstID").val();var b="";var h="";var l=0;var a=0;var f=1;$("#allSuplmntryRpymntAccntsTable").find("tr").each(function(n,o){if(n>0){if(typeof $(o).attr("id")==="undefined"){}else{var m=$(o).attr("id").split("_")[1];if(typeof $("#allSuplmntryRpymntAccntsRow"+m+"_AccountID").val()==="undefined"){}else{if($("#allSuplmntryRpymntAccntsRow"+m+"_AccountID").val()==""||$("#allSuplmntryRpymntAccntsRow"+m+"_AccountID").val()=="-1"){$("#allSuplmntryRpymntAccntsRow"+m+"_AccountDesc").css("border-color","red");$("#allSuplmntryRpymntAccntsRow"+m+"_AccountDesc").css("border-width","2px");l=l+1}else{$("#allSuplmntryRpymntAccntsRow"+m+"_AccountDesc").css("border-color","#ccc");$("#allSuplmntryRpymntAccntsRow"+m+"_AccountDesc").css("border-width","1px")}if($("#allSuplmntryRpymntAccntsRow"+m+"_IsEnabled").val()==""||$("#allSuplmntryRpymntAccntsRow"+m+"_IsEnabled").val()==""){$("#allSuplmntryRpymntAccntsRow"+m+"_IsEnabled").css("border-color","red");$("#allSuplmntryRpymntAccntsRow"+m+"_IsEnabled").css("border-width","2px");l=l+1}else{$("#allSuplmntryRpymntAccntsRow"+m+"_IsEnabled").css("border-color","#ccc");$("#allSuplmntryRpymntAccntsRow"+m+"_IsEnabled").css("border-width","1px")}if(l<=0){h=h+$("#allSuplmntryRpymntAccntsRow"+m+"_SuplmntryRpymntAccntsID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#sbmtdLoanRqstID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allSuplmntryRpymntAccntsRow"+m+"_AccountID").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"~"+$("#allSuplmntryRpymntAccntsRow"+m+"_IsEnabled").val().replace(/(~)/g,"{-;-;}").replace(/(\|)/g,"{:;:;}")+"|";a=a+1}f=f+1}}}});if(l>0){box2=bootbox.alert({size:"small",title:"Rhomicom Message",message:"<span style='color:red;'><b><i>Please enter data in all highlighted Payment Plan Setup record(s)</i></b></span>",callback:function(){}});return false}var b="Saving Supplementary Repayment Accounts(s)...Please Wait...";var j="Save Supplementary Repayment Accounts(s)?";var k="Account(s) Saved";var g=bootbox.alert({title:j,size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> '+b+"</p>",callback:function(){var m=typeof $("#recCnt").val()==="undefined"?0:$("#recCnt").val();if(parseInt(m)>0){getOneSuplmntryRpymntAccntsForm(d,4.112,e,"ReloadDialog",c)}}});g.init(function(){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,vtyp:6,subPgNo:4.1,q:"UPDATE",actyp:3,slctdSuplmntryRpymntAccnts:h},success:function(m){var n=m;setTimeout(function(){if(/^[\],:{}\s]*$/.test(n.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var o=$.parseJSON(n);$("#recCnt").val(parseInt(o.recCntInst)+parseInt(o.recCntUpdt));var p="<span style='color:green;font-weight:bold !important;'>"+k+"</br><i>"+o.recCntInst+" record(s) inserted</br>"+o.recCntUpdt+" Setup record(s) updated</i></span>";g.find(".bootbox-body").html(p)}else{g.find(".bootbox-body").html(n)}},500)},error:function(m,o,n){console.warn(m.responseText)}})})})}function deleteSuplmntryRpymntAccnts(e){var a=e.split("_")[1];var d=e.split("_")[0];var c=-1;var g="";if(typeof $("#"+d+a+"_SuplmntryRpymntAccntsID").val()==="undefined"){}else{c=$("#"+d+a+"_SuplmntryRpymntAccntsID").val();var f=$("#"+e).find("td");g=$.trim(f.eq(2).text())}var b=bootbox.confirm({title:"Delete Row?",size:"small",message:'<p style="text-align:center;">Are you sure you want to <span style="color:red;font-weight:bold;font-style:italic;">DELETE</span> this Row?<br/>Action cannot be Undone!</p>',buttons:{confirm:{label:'<i class="fa fa-check"></i> Yes',className:"btn-success"},cancel:{label:'<i class="fa fa-times"></i> No',className:"btn-danger"}},callback:function(h){if(h===true){var j=bootbox.alert({title:"Delete Row?",size:"small",message:'<p><i class="fa fa-spin fa-spinner"></i> Deleting Row...Please Wait...</p>',callback:function(){$("body").css("padding-right","0px")}});j.init(function(){if(c>0){getMsgAsyncSilent("grp=1&typ=11&q=Check Session",function(){$body=$("body");$body.removeClass("mdlloading");$.ajax({method:"POST",url:"index.php",data:{grp:17,typ:1,pg:15,subPgNo:4.1,q:"DELETE",actyp:6,PKeyID:c},success:function(k){setTimeout(function(){j.find(".bootbox-body").html(k);if(k.indexOf("Success")!==-1){$("#"+e).remove()}},500)},error:function(m,k,l){j.find(".bootbox-body").html(l)}})})}else{setTimeout(function(){$("#"+e).remove();j.find(".bootbox-body").html("Row Removed Successfully!")},500)}})}}})}function onClickOfRpymntAccountLov(){var a=typeof $("#crdtType").val()==="undefined"?"":$("#crdtType").val();var b="Invalid Credit Type";if(a=="Overdraft"){var b="All Bank Accounts (For Loan Repayment)"}else{if(a=="Loan"){var b="Loan Repayment Accounts"}}getLovsPage("myLovModal","myLovModalTitle","myLovModalBody",b,"gnrlOrgID","bnkCustomerID","","radio",true,"","rpmntSrcAcctID","rpmntSrcAcct","clear",1,"")};